{"version":3,"sources":["/home/circleci/src/utils/eulerFromQuaternion.js","/home/circleci/src/utils/commandUtils.js","/home/circleci/src/commands/Cubes.js","/home/circleci/src/commands/DrawPolygon/index.js","/home/circleci/src/commands/FilledPolygons.js","/home/circleci/src/commands/GLText.js","/home/circleci/src/commands/GLTFScene.js","/home/circleci/src/commands/Points.js","/home/circleci/src/utils/getOrthographicBounds.js","/home/circleci/src/camera/cameraProject.js","/home/circleci/src/camera/cameraStateSelectors.js","/home/circleci/src/camera/CameraStore.js","/home/circleci/src/camera/camera.js","/home/circleci/src/camera/CameraListener.js","/home/circleci/src/utils/common.js","/home/circleci/src/utils/Raycast.js","/home/circleci/src/WorldviewReactContext.js","/home/circleci/src/commands/Command.js","/home/circleci/src/utils/HitmapObjectIdManager.js","/home/circleci/src/utils/queuePromise.js","/home/circleci/src/utils/signal.js","/home/circleci/src/WorldviewContext.js","/home/circleci/src/Worldview.js","/home/circleci/src/utils/aggregate.js","/home/circleci/src/utils/Bounds.js","/home/circleci/src/utils/fromGeometry.js","/home/circleci/src/utils/parseGLB.js","/home/circleci/src/utils/getChildrenForHitmapDefaults.js","/home/circleci/src/commands/Cylinders.js","/home/circleci/src/commands/Cones.js","/home/circleci/src/commands/Arrows.js","/home/circleci/src/commands/Lines.js","/home/circleci/src/commands/Axes.js","/home/circleci/src/commands/Spheres.js","/home/circleci/src/commands/DrawPolygon/PolygonBuilder.js","/home/circleci/src/commands/Triangles.js","/home/circleci/src/commands/Text.js","/home/circleci/src/commands/Grid.js","/home/circleci/src/commands/Overlay.js","/home/circleci/project/packages/webviz-core/src/hooksImporter.js","/home/circleci/project/packages/webviz-core/src/components/Panel.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/index.js","/home/circleci/project/packages/webviz-core/src/hooks/useGlobalVariables.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Transforms.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/index.js","webpack:///./packages/webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss?2d0e","/home/circleci/project/packages/webviz-core/src/components/MessageHistoryDEPRECATED/index.js","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/parseRosPath.js","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/isTypicalFilterName.js","/home/circleci/project/packages/webviz-core/src/components/Autocomplete.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/interactionUtils.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/PointCloudBuilder.js","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/util.js","/home/circleci/project/packages/webviz-core/src/panels/Plot/index.js","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/MessagePathInput.js","/home/circleci/project/packages/webviz-core/src/components/ValidatedInput.js","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems.js","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/messagePathsForDatatype.js","/home/circleci/project/packages/webviz-core/src/util/plotColors.js","/home/circleci/project/packages/webviz-core/shared/panelToolbarStyles.js","/home/circleci/project/packages/webviz-core/src/panels/StateTransitions/index.js","/home/circleci/project/packages/webviz-core/src/components/TopicToRenderMenu.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/Interactions.js","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/getDiff.js","/home/circleci/project/packages/webviz-core/src/components/ExpandingToolbar.js","/home/circleci/project/packages/webviz-core/src/panels/ImageView/util.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils.js","/home/circleci/project/packages/webviz-core/src/components/validators.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/MeasuringTool.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/SearchText.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TopicTreeV2.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TreeNodeRow.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/VisibilityToggle.js","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticsHistory.js","/home/circleci/project/packages/webviz-core/src/components/TimeBasedChart/index.js","/home/circleci/project/packages/webviz-core/src/components/ReactChartjs/index.js","/home/circleci/project/packages/webviz-core/src/components/ReactChartjs/zoomAndPanHelpers.js","/home/circleci/project/packages/webviz-core/src/util/supportsOffscreenCanvas.js","/home/circleci/project/packages/webviz-core/src/util/WebWorkerManager.js","/home/circleci/project/packages/webviz-core/src/panels/Plot/internalTypes.js","/home/circleci/project/packages/webviz-core/src/util/toolsColorScheme.js","/home/circleci/project/packages/webviz-core/src/util/toggle.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/UnlinkGlobalVariables.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/UnlinkWrapper.js","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/index.js","webpack:///./packages/webviz-core/src/panels/RawMessages/index.module.scss?af85","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/useLatestMessageDataItem.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/Readers.js","webpack:///./packages/webviz-core/src/panels/ImageView/ImageCanvas.module.scss?5d90","/home/circleci/project/packages/webviz-core/src/panels/ImageView/CameraModel.js","/home/circleci/project/packages/webviz-core/src/panels/Rosout/LevelToString.js","webpack:///./packages/webviz-core/src/panels/Rosout/LogMessage.module.scss?a579","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/index.js","/home/circleci/project/packages/webviz-core/src/util/Pose.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/index.js","/home/circleci/project/packages/webviz-core/src/util/yaml.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicSelector/TopicDisplayModeSelector.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/NodeName.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TreeNodeDotMenu.js","/home/circleci/project/packages/webviz-core/src/components/KeyboardShortcut.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/utils/index.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/GPUPointClouds/buffers.js","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticStatusPanel.js","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticStatus.js","webpack:///./packages/webviz-core/src/panels/diagnostics/DiagnosticStatus.module.scss?5b1f","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticStatus.module.scss","/home/circleci/project/packages/webviz-core/src/panels/Plot/index.help.md","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/grammar.ne","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/constants.js","webpack:///./packages/webviz-core/src/components/Panel.module.scss?4cd7","/home/circleci/project/packages/webviz-core/src/components/Panel.module.scss","/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotChart.js","webpack:///./packages/webviz-core/src/panels/Plot/PlotChart.module.scss?7749","/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotChart.module.scss","/home/circleci/project/packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartTooltip.js","webpack:///./packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartTooltip.module.scss?d62c","/home/circleci/project/packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartTooltip.module.scss","/home/circleci/project/packages/webviz-core/src/components/createSyncingComponent.js","/home/circleci/project/packages/webviz-core/src/components/ReactChartjs/ChartJSWorker.js","/home/circleci/project/packages/webviz-core/src/components/ReactChartjs/ChartJSManager.js","/home/circleci/project/packages/webviz-core/src/components/ReactChartjs/ChartJSWorker.worker.js","/home/circleci/project/packages/webviz-core/src/util/FakeRpc.js","/home/circleci/project/packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartLegend.js","/home/circleci/project/packages/webviz-core/src/components/TimeBasedChart/constants.js","/home/circleci/project/packages/webviz-core/src/panels/Plot/derivative.js","/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotLegend.js","webpack:///./packages/webviz-core/src/panels/Plot/PlotLegend.module.scss?7c0a","/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotLegend.module.scss","webpack:///./packages/webviz-core/src/components/MessagePathSyntax/MessagePathInput.module.scss?b3b7","/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/MessagePathInput.module.scss","webpack:///./packages/webviz-core/src/components/Autocomplete.module.scss?43e7","/home/circleci/project/packages/webviz-core/src/components/Autocomplete.module.scss","/home/circleci/project/packages/webviz-core/src/util/fuzzyFilter.js","/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotMenu.js","webpack:///./packages/webviz-core/src/panels/Plot/PlotMenu.module.scss?44fc","/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotMenu.module.scss","/home/circleci/project/packages/webviz-core/src/panels/StateTransitions/index.help.md","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticStatusPanel.help.md","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.js","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.help.md","webpack:///./packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.module.scss?8c10","/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.module.scss","/home/circleci/project/packages/webviz-core/src/panels/GlobalVariables/index.js","/home/circleci/project/packages/webviz-core/src/panels/GlobalVariables/index.help.md","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GeneralInfo.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableName.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/LinkToGlobalVariable.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/GlobalVariableLink/UnlinkGlobalVariable.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/TopicLink.js","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/Diff.js","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/getValueActionForValue.js","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/index.help.md","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/index.module.scss","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/Metadata.js","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/RawMessagesIcons.js","/home/circleci/project/packages/webviz-core/src/panels/RawMessages/utils.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/LinkedGlobalVariableList.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/ObjectDetails.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/PointCloudDetails.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/logger.js","webpack:///./packages/webviz-core/src/components/ExpandingToolbar.module.scss?f213","/home/circleci/project/packages/webviz-core/src/components/ExpandingToolbar.module.scss","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Interactions/InteractionContextMenu.js","/home/circleci/project/packages/webviz-core/src/panels/GlobalVariableSlider/index.js","/home/circleci/project/packages/webviz-core/src/components/GlobalVariableSlider.js","/home/circleci/project/packages/webviz-core/src/components/SliderWithTicks.js","/home/circleci/project/packages/webviz-core/src/components/TextField.js","/home/circleci/project/packages/webviz-core/src/panels/ImageView/index.js","/home/circleci/project/packages/webviz-core/src/panels/ImageView/ImageCanvas.js","/home/circleci/project/packages/webviz-core/src/panels/ImageView/ImageCanvas.module.scss","/home/circleci/project/packages/webviz-core/src/panels/ImageView/ImageCanvas.worker.js","/home/circleci/project/packages/webviz-core/src/panels/ImageView/renderImage.js","/home/circleci/project/packages/webviz-core/src/panels/ImageView/decodings.js","/home/circleci/project/packages/webviz-core/src/components/ContextMenu/index.js","/home/circleci/project/packages/webviz-core/src/panels/ImageView/index.help.md","webpack:///./packages/webviz-core/src/panels/ImageView/index.module.scss?9402","/home/circleci/project/packages/webviz-core/src/panels/ImageView/index.module.scss","/home/circleci/project/packages/webviz-core/src/util/synchronizeMessages.js","/home/circleci/project/packages/webviz-core/src/panels/Internals.js","/home/circleci/project/packages/webviz-core/src/panels/NodePlayground/index.js","/home/circleci/project/packages/webviz-core/src/panels/NodePlayground/BottomBar/index.js","/home/circleci/project/packages/webviz-core/src/panels/NodePlayground/BottomBar/DiagnosticsSection.js","/home/circleci/project/packages/webviz-core/src/panels/NodePlayground/BottomBar/LogsSection.js","/home/circleci/project/packages/webviz-core/src/panels/NodePlayground/playground-icon.svg","/home/circleci/project/packages/webviz-core/src/panels/NodePlayground/Sidebar.js","/home/circleci/project/packages/webviz-core/src/panels/NodePlayground/index.help.md","/home/circleci/project/packages/webviz-core/src/panels/Note/index.js","/home/circleci/project/packages/webviz-core/src/panels/Note/index.help.md","/home/circleci/project/packages/webviz-core/src/panels/NumberOfRenders.js","/home/circleci/project/packages/webviz-core/src/panels/PlaybackPerformance.js","/home/circleci/project/packages/webviz-core/src/components/Sparkline.js","/home/circleci/project/packages/webviz-core/src/panels/Publish/index.js","/home/circleci/project/packages/webviz-core/src/panels/Publish/buildSampleMessage.js","/home/circleci/project/packages/webviz-core/src/components/Publisher.js","/home/circleci/project/packages/webviz-core/src/panels/Rosout/index.js","/home/circleci/project/packages/webviz-core/src/panels/Rosout/index.help.md","webpack:///./packages/webviz-core/src/panels/Rosout/index.module.scss?c0d1","/home/circleci/project/packages/webviz-core/src/panels/Rosout/index.module.scss","/home/circleci/project/packages/webviz-core/src/panels/Rosout/LogMessage.js","/home/circleci/project/packages/webviz-core/src/panels/Rosout/LogMessage.module.scss","/home/circleci/project/packages/webviz-core/src/components/LogList.js","/home/circleci/project/packages/webviz-core/src/panels/SubscribeToList.js","/home/circleci/project/packages/webviz-core/src/panels/Tab/index.js","/home/circleci/project/packages/webviz-core/src/panels/Tab/index.help.md","/home/circleci/project/packages/webviz-core/src/assets/emptyBox.svg","/home/circleci/project/packages/webviz-core/src/panels/TwoDimensionalPlot/index.js","/home/circleci/project/packages/webviz-core/src/panels/TwoDimensionalPlot/index.help.md","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/FrameCompatibility.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/index.help.md","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/LayoutForTopicTreeV2.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/DebugStats.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/Polygons.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/utils/drawToolUtils.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/LayoutToolbar.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/CameraInfo/index.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Crosshair.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/FollowTFControl.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/MainToolbar.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/MeasureMarker.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/index.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/MessageCollector.js","/home/circleci/project/packages/webviz-core/src/util/Bounds.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TopicSettingsModal.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/noMatches.svg","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/renderTreeNodes.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/renderNamespaceNodes.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TextHighlight.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TextMiddleTruncate.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TopicTreeSwitcher.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/useSceneBuilderAndTransformsData.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/TransformsBuilder.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/World.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/index.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/PoseMarkers.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/CarModel/index.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/CarModel/carModel.glb","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/LaserScans.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/OccupancyGrids.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/index.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/GPUPointClouds/index.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/GPUPointClouds/memoization.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/GPUPointClouds/decodeMarker.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/GPUPointClouds/VertexBufferCache.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/commands/LinedConvexHulls.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/withTransforms.js","/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/LaserScanVert.js","/home/circleci/project/packages/webviz-core/src/util/installChartjs.js","/home/circleci/project/packages/webviz-core/src/util/multicolorLineChart.js"],"names":["out","m","mat3","m11","m12","m13","m22","m23","m32","m33","Math","rgb","r","g","b","props","React.createElement","getChildrenForHitmap","reglCommand","cubes","children","polygons","React","rest","triangles","poly","points","shouldConvert","pose","earcutPoints","flattenedPoints","array","Float32Array","i","x","y","z","flatten3D","indices","earcut","newPoints","originalIndex","getEarcutPoints","scale","originalMarker","getChildrenForHitmapWithOriginalMarker","command","useState","alphabet","charSet","Set","memoizedBuildAtlas","memoizeOne","tinySDF","ctx","memoizedCreateCanvas","resolution","textureWidth","rowHeight","charInfo","width","dx","textureHeight","textureData","Uint8Array","data","j","atlasTexture","height","format","wrap","mag","min","regl","drawText","depth","enable","defaultDepth","mask","blend","primitive","uniforms","atlas","atlasSize","fontSize","cutoff","scaleInvariant","scaleInvariantSize","isHitmap","viewportHeight","viewportWidth","isPerspective","cameraFovY","instances","count","attributes","position","texCoord","srcOffset","buffer","divisor","destOffset","srcWidth","alignmentOffset","billboard","foregroundColor","backgroundColor","highlightColor","enableBackground","enableHighlight","posePosition","poseOrientation","estimatedInstances","text","Error","destOffsets","srcWidths","srcOffsets","totalInstances","yOffsets","totalWidth","getMarkerYOffset","markerInstances","lineCount","fgColor","toColor","marker","outline","bgColor","isColorDark","hlColor","a","char","info","index","totalHeight","setMarkerYOffset","makeTextCommand","createInstancedGetChildrenForHitmap","model","context","useContext","loadedModel","useDebugValue","value","setValue","useEffect","useCallback","unloaded","fn","result","deps","useAsyncValue","async","response","fetch","status","parseGLB","useModel","BoundingBox","constructor","left","getOrthographicBounds","zDistance","aspect","distanceToGround","tmp4","DEFAULT_TEXT_COLOR","pointToVec3","orientationToVec4","w","vec3ToPoint","vec4ToOrientation","pointToVec3Array","toRGBA","val","vec4ToRGBA","color","Array","getCSSColor","toRGBAArray","colors","defaultReglBlend","func","src","dst","srcAlpha","dstAlpha","equation","alpha","defaultReglDepth","defaultBlend","withPose","newVert","vert","newUniforms","_position","_rotation","orientation","getVertexColors","constantRGBAArray","colorBuffer","usage","arr","isNaN","intToRGB","getIdFromPixel","fromSpherical","rSinPhi","UNIT_X_VECTOR","Object","TEMP_VEC3","TEMP_MAT","TEMP_QUAT","stateSelector","state","perspectiveSelector","createSelector","perspective","distanceSelector","distance","phiSelector","phi","thetaOffsetSelector","thetaOffset","targetOrientationSelector","targetOrientation","targetHeadingSelector","vec3","orientationSelector","quat","positionSelector","targetHeading","view","mat4","billboardRotation","UNIT_Z_VECTOR","DEFAULT_CAMERA_STATE","target","targetOffset","fovy","near","far","CameraStore","handler","initialCameraState","key","this","offset","zoomPercent","newDistance","startingDistance","distanceAfterZoom","projection","selectors","cameraState","getProjection","bounds","top","getView","toScreenCoord","viewport","combinedProjView","vX","vY","vWidth","vHeight","vec4","vec","project","point","diffY","DEFAULT_KEYMAP","KeyA","KeyD","KeyE","KeyF","KeyQ","KeyR","KeyS","KeyW","KeyX","KeyZ","CameraListener","mouse","clientY","clientX","e","_el","_getMouseOnScreen","_buttons","cameraStore","document","moveX","_rect","moveY","_initialMouse","magnitude","_getMagnitude","cameraRotate","cameraMove","code","moveSpeed","zoomSpeed","spinSpeed","shiftKeys","action","keyMap","_shiftKey","zoom","yaw","tilt","console","_keys","has","_getKeyMotion","pixelY","normalizeWheel","wheelAmount","dir","amount","percentage","zoomPercentage","componentDidMount","listen","window","passive","componentWillUnmount","listener","_isLeftMouseDown","_isRightMouseDown","base","_getMoveMagnitude","startDragging","_endDragging","_moveKeyboard","dt","motion","cameraZoom","_startKeyTimer","lastStamp","requestAnimationFrame","stamp","_stopKeyTimer","cancelAnimationFrame","render","tabIndex","style","draggable","ref","el","onMouseDown","onMouseUp","onBlur","onContextMenu","onKeyDown","onKeyUp","_onKeyUp","getNodeEnv","process","tempVec","tempMat","Ray","origin","distanceToPoint","planeIntersection","planeCoordinate","d","cosine","getRayFromClick","camera","projectionMatrix","viewMatrix","vp","invVp","mouseX","mouseY","rayPoint","rayOrigin","rayDir","Command","nextProps","componentDidUpdate","_updateContext","instance","handleMouseEvent","mouseHandler","objects","WorldviewReactContext","HitmapObjectIdManager","ids","start","fill","map","_","last","id","objectHitmapId","object","_objectsByObjectHitmapIdMap","instanceIndex","_instanceIndexByObjectHitmapIdMap","_commandsByObjectMap","get","queuePromise","calling","nextCalls","returnPromise","promise","Promise","res","rej","resolve","reject","signal","queuedFn","args","nextArgs","nextPromise","error","compile","cmd","WorldviewContext","onCameraStateChange","Map","undefined","canvasX","initializedData","canvasY","enableStackedObjectEvents","cachedReadHitmapCall","shallowequal","mouseEventObject","_fbo","framebuffer","currentObjectId","excludedObjects","mouseEventsWithCommands","counter","maxStackedObjectCount","pixel","_hitmapObjectIdManager","getObjectByObjectHitmapId","getCommandForObject","arguments","_drawCalls","drawCalls","drawInput","_compiled","hitmapProps","assignNextColors","initialize","canvas","_instrumentCommands","createREGL","extensions","profile","uncompiledCommand","compiledCommand","compiledCameraCommand","fbo","dimension","destroy","onMount","_commands","onUnmount","unregisterPaintCallback","paintFn","registerDrawCall","registerPaintCallback","setDimension","paint","_paint","Date","paintCall","Proxy","apply","thisArg","DEFAULT_BACKGROUND_COLOR","handleWorldviewMouseInteraction","err","WorldviewBase","_dragStartPos","deltaX","deltaY","worldviewContext","worldviewHandler","clientLeft","ray","disableHitmapForEvents","hitmapOnMouseMove","mouseEventsByCommand","aggregationMap","item","existingItems","aggregate","canvasBackgroundColor","_canvas","_renderDebug","mem","reglCommandObjects","mapValues","total","pickBy","rows","border","paddingRight","bottom","right","fontFamily","isFixedCamera","canvasHtml","maxWidth","maxHeight","onDoubleClick","onMouseMove","_onMouseMove","showDebug","overflow","Worldview","Bound","Number","update","scratch","positions","vertexArray","concat","elements","face","elementsArray","Uint16Array","buff","colorBuff","frag","arrayBuffer","DataView","magic","readUint32","version","totalLength","byteLength","chunkLength","chunkData","jsonData","findNextChunkOfType","json","JSON","TextDecoder","decode","binary","accessors","accessorInfo","WebGLRenderingContext","arrayType","componentType","numComponents","type","bufferView","images","imgInfo","self","Blob","mimeType","nonInstancedGetChildrenForHitmapFromSingleProp","useOriginalMarkerProp","eventCallbackMarker","prop","hitmapProp","hitmapColor","nonInstancedGetChildrenForHitmap","instancedGetChildrenForHitmapFromSingleProp","matchedExcludedObjects","filteredIndices","instanceCount","idColors","startColor","allColors","idx","pointCountPerInstance","createCylinderGeometry","numSegments","sideFaces","endCapFaces","theta","bottomLeftPt","topRightPt","cone","bottomRightPt","topLeftPt","cylinders","fromGeometry","Cylinders","cones","Cones","memo","passedProps","omit","end","basePosition","tipPosition","length","headWidthX","headWidthY","headLength","shaftWidthX","shaftWidthY","shaftLength","shaftPosition","headPosition","FLOAT_BYTES","POINT_BYTES","DEFAULT_MONOCHROME_COLOR","POINT_TYPES","BL","TR","BR","TL","VERTICES_PER_INSTANCE","k","lines","pointTypeBuffer","debugColorBuffer","defaultPosePositionBuffer","flatten","defaultPoseRotationBuffer","positionBuffer1","positionBuffer2","posePositionBuffer","poseRotationBuffer","thickness","joined","pointType","colorB","debug","stride","monochrome","colorC","positionA","positionB","positionC","positionD","hasInstancedPoses","poseRotation","colorArray","pointArray","allocatedPoints","positionArray","rotationArray","numInputPoints","alreadyClosed","ax","ay","az","bx","by","bz","pointsEqual","shouldClose","numTotalPoints","off","n","fillPointArray","monochromeColor","convertedMonochromeColor","convertColors","convertedColors","lastIndex","fillColorArray","effectiveNumPoints","poses","positionOffset","rotationOffset","convertedPosition","convertedRotation","fillPoseArrays","commands","inProps","renderLine","Lines","p","xAxis","yAxis","zAxis","Axes","faces","prevMeridianPt","pt","prevPt","spheres","Spheres","multiplyScale","factor","DEFAULT_COLOR","ACTIVE_POLYGON_COLOR","ACTIVE_POINT_COLOR","DRAW_SCALE","DRAW_POINT_SCALE","HITMAP_SCALE","HITMAP_POINT_SCALE","POSE","PolygonPoint","Polygon","name","polygonLinesGetChildrenForHitmap","PolygonLines","polygonPointsGetChildrenForHitmap","PolygonPoints","originalMarkers","convertedPoint","sphereList","areEqual","point1","x1","y1","z1","x2","y2","z2","point2","isClosed","polygon","activePolygon","pointX","pointY","dX","dY","uniquePoints","acc","shortestDistance","shortestIndex","px","py","dist","newPoint","isFirstClick","isCtrlClick","clickObject","isActivePolygonClosed","addPolygon","pushPoint","floatingPoint","updateActivePoint","closeActivePolygon","deletePolygon","filter","deletePoint","selectObject","isActive","defaultSingleColorDepth","defaultVetexColorDepth","single","vertex","items","singleColorItems","vertexColorItems","Triangles","NO_POSE","DEFAULT_SCALE","DEFAULT_BG_COLOR","cssHasBeenInserted","isColorEqual","TextElement","insertGlobalCss","hasBgColor","textColor","autoBackgroundColor","_prevBgColor","hexBgColor","_text","textContent","Text","textComponents","current","textContainer","componentsToRemove","coord","_textContainerRef","BG_COLOR_LIGHT","BG_COLOR_DARK","font","hashMarkerPosition","offsets","glConstantToRegl","drawModel","globalAlpha","poseMatrix","baseColorTexture","baseColorFactor","nodeMatrix","normal","singleTexCoord","whiteTexture","getDrawCalls","memoizeWeak","textures","textureInfo","sampler","bitmap","wrapS","wrapT","node","mesh","material","texInfo","normals","texCoords","drawMesh","drawNode","rootTransform","withContext","DEFAULT_GRID_COLOR","grid","bound","Grid","Overlay","coordinates","renderItem","max","pointSize","size","hooks","getGlobalHooks","panelsByCategory","perPanelHooks","areHooksImported","DiagnosticStatusPanel","require","default","DiagnosticSummary","GlobalVariables","GlobalVariableSlider","ImageViewPanel","Internals","NodePlayground","Note","NumberOfRenders","PlaybackPerformance","Plot","Publish","RawMessages","Rosout","StateTransitions","SubscribeToList","Tab","TwoDimensionalPlot","ThreeDimensionalViz","ndash","ros","title","component","utilities","debugging","BlurIcon","GridIcon","HexagonIcon","HexagonMultipleIcon","PentagonOutlineIcon","RadarIcon","RobotIcon","LaserScanVert","defaultMapPalette","POINT_CLOUD_DATATYPE","POSE_STAMPED_DATATYPE","SUPPORTED_MARKER_DATATYPES","VISUALIZATION_MSGS_MARKER_DATATYPE","VISUALIZATION_MSGS_MARKER_ARRAY_DATATYPE","SENSOR_MSGS_LASER_SCAN_DATATYPE","NAV_MSGS_OCCUPANCY_GRID_DATATYPE","GEOMETRY_MSGS_POLYGON_STAMPED_DATATYPE","defaultConfig","pinnedIds","hardwareIdFilter","topicToRender","DIAGNOSTIC_TOPIC","ImageView","cameraTopic","enabledMarkerTopics","customMarkerTopicOptions","transformMarkers","synchronize","mode","imageMarkerDatatypes","canTransformMarkersByTopic","topic","includes","getVariableSpecificOutput","paths","customStateTransitionColors","checkedKeys","expandedKeys","followTf","modifiedNamespaceTopics","pinTopics","topicSettings","autoSyncCameraState","allSupportedMarkers","renderAdditionalMarkers","topics","iconsByDatatype","icons","AdditionalToolbarItems","setGlobalVariablesInSceneBuilder","globalVariables","selectionState","topicsToRender","consumeMessage","msg","consumeMethods","errors","topicsWithError","set","datatype","getMessagePose","message","addMarkerToCollector","add","setTopicError","getSyntheticArrowMarkerColor","getFlattenedPose","getOccupancyGridValues","getMapPalette","consumePose","getMarkerColor","markerColor","hasBlacklistTopics","ungroupedNodesCategory","rootTransformFrame","defaultFollowTransformFrame","skipTransformFrame","docLinkFunction","installChartJs","PanelComponent","ConnectedPanel","childId","config","originalConfig","saveConfig","tabId","mosaicActions","MosaicContext","mosaicWindowActions","MosaicWindowContext","layout","useSelector","panels","savedProps","selectedPanelIds","mosaic","isSelected","validSelectedPanelIds","useMemo","panelId","getPanelTypeFromId","TAB_PANEL_TYPE","isOnlyPanel","isParent","datatypes","capabilities","PanelAPI","useDataSourceInfo","dispatch","useDispatch","actions","bindActionCreators","savePanelConfigs","saveFullPanelConfig","changePanelLayout","addSelectedPanelId","removeSelectedPanelId","setSelectedPanelIds","quickActionsKeyPressed","setQuickActionsKeyPressed","shiftKeyPressed","setShiftKeyPressed","cmdKeyPressed","setCmdKeyPressed","fullScreen","setFullScreen","isHovered","setIsHovered","fullScreenLocked","setFullScreenLocked","showTabPanelSelectionWarning","setShowTabPanelSelectionWarning","panelsByType","getPanelsByType","panelType","panelComponentConfig","isTabPanel","saveCompleteConfig","configToSave","options","silent","keepLayoutInUrl","configs","historyOptions","updatePanelConfig","perPanelFunc","openSiblingPanel","siblingConfigCreator","siblingComponent","PanelList","getComponentForType","siblingDefaultConfig","ownPath","getPath","siblingPathEnd","getOtherBranch","siblingPath","slice","siblingId","getNodeAtPath","getRoot","siblingConfig","newPanelPath","split","then","newPanelId","onOverlayClick","metaKey","createTabPanel","tabPanelId","changePanelPayload","saveConfigsPayload","groupPanels","groupPanelsOutput","createTabs","createTabsOutput","closePanel","splitPanel","remove","newId","getPanelIdForType","activeTabLayout","tabs","activeTabIdx","pathToPanelInTab","getPathFromNode","newTabLayout","updateTree","path","spec","$set","first","second","direction","newTabConfig","updateTabPanelLayout","onMouseEnter","onMouseLeave","enterFullscreen","exitFullScreen","onReleaseQuickActionsKey","keyUpHandlers","keyDownHandlers","Shift","Meta","Escape","Provider","enabled","global","onClick","BLUE","className","styles","root","rootFullScreen","col","dataTest","clip","notClickable","data-tab-options","tabActionsOverlay","small","marginBottom","data-tab-options-no-op","prohibitedSelection","quickActionsOverlay","data-panel-overlay","disabled","data-panel-overlay-exit","displayName","MemoizedConnectedPanel","addLinkTooltip","hasNestedValue","highlight","label","linkedGlobalVariable","markerKeyPath","nestedValueStyle","marginLeft","onlyRenderAddLink","unlinkTooltip","variableValue","linkedGlobalVariables","linkedGlobalVariableLocal","getLinkedGlobalVariable","isArrayBuffer","ArrayBuffer","isView","renderUnlink","addToLinkedGlobalVariable","renderAddLink","wrapperStyle","cursor","SWrapper","SValue","SGlobalVariableLink","tooltip","setIsOpen","linkedVar","styled","span","SPath","SP","SGlobalVariableForm","form","toolbar","setGlobalVariables","overwriteGlobalVariables","setLinkedGlobalVariables","tempPos","tempScale","tempOrient","stripLeadingSlash","startsWith","Transform","create","reset","identity","matrix","valid","fromRotationTranslation","isChildOfTransform","rootId","parent","output","input","multiply","getTranslation","getScaling","determinant","inverse","getRotation","TfStore","values","storage","consume","tfMessage","child_frame_id","parentId","header","frame_id","tf","rotation","translation","transform","original","frameId","rootOfTransform","transformID","Interactions","content","module","locals","exports","ZERO_TIME","freeze","sec","nsec","historySize","startTime","memoizedPaths","useShallowMemo","subscribeTopics","getTopicsFromPaths","messagesByTopic","useMessagesByTopic","Infinity","cachedGetMessagePathDataItems","useCachedGetMessagePathDataItems","itemsByPath","obj","rosPath","topicName","queriedData","push","uniq","parseRosPath","grammarObj","Grammar","fromCompiled","grammar","memoize","parser","Parser","feed","results","test","measureText","family","parseInt","defaultGetText","Autocomplete","PureComponent","super","_ignoreFocus","clearOnFocus","_autocomplete","refs","activeElement","setState","focused","event","disableAutoSelect","removeEventListener","selectionStart","selectionEnd","select","stopPropagation","preventDefault","addEventListener","_ignoreBlur","onChange","focus","onSelect","currentTarget","scrollTop","showAllItems","blur","createRef","menu","scrollHeight","clientHeight","setSelectionRange","autocompleteKey","autoSize","getItemValue","getItemText","placeholder","selectedItem","filterText","sortWhenFiltering","minWidth","menuStyle","inputStyle","autocompleteItems","hasError","open","selectedItemValue","isHighlighted","itemValue","data-highlighted","data-test-auto-item","autocompleteItem","highlighted","selected","_onChange","_onSelect","inputProps","inputError","autoCorrect","autoCapitalize","spellCheck","onFocus","_onFocus","_onBlur","_onMouseDown","_onKeyDown","renderMenu","menuItems","maxNumberOfItems","ceil","innerHeight","menuItemsToShow","maxBy","innerWidth","onScroll","_onScroll","renderMenuWrapper","body","createPortal","flex","linkedGlobalVariablesKeyByTopicWithPath","memoizedGetLinkedVariablesKeyByTopicWithPath","topicWithPath","getTopicWithPath","reverse","join","getLinkedGlobalVariableKeyByTopicWithPath","keyBy","memoizedGetLinkedGlobalVariablesKeyByName","reduce","maybeFullyDecodedMarker","fields","allPoints","clickedPoint","baseIdx","baseColorR","baseColorG","baseColorB","clickedPointColor","additionalField","getAdditionalFieldNames","additionalFieldValues","fieldName","row_step","point_step","getFieldOffsetsAndReaders","pointCount","otherFieldsValues","row","dataOffset","dataStart","reader","fieldValue","read","EMPTY_ARRAY","REQUIRED_FLOAT32_FIELDS","DATATYPE","uint8","uint16","int16","int32","float32","getReader","Float32Reader","Uint8Reader","Uint16Reader","Int16Reader","Int32Reader","log","parseHexColor","assert","mapMarker","decodeAllFields","settings","is_bigendian","offsetsAndReaders","float32Field","xOffset","yOffset","zOffset","rgbOffset","colorMode","flatColor","DEFAULT_FLAT_COLOR","autoMinValue","autoMaxValue","minColorFieldValue","maxColorFieldValue","minValue","maxValue","useRGB","useFlatColor","parsedFlatColor","flatColorR","flatColorG","flatColorB","colorFieldReader","colorField","warn","colorFieldValues","Float64Array","pointDataStart","x3","x4","pointStart","colorStart","colorFieldValue","colorFieldRange","parsedMinColor","minColor","parsedMaxColor","maxColor","pct","minR","minG","minB","maxR","maxG","maxB","lerp","setRainbowColor","allFields","field","difference","h","floor","f","memoizedMapMarker","isEqual","maxSize","getDisplayName","hardware_id","some","kv","truncate","getDiagnosticId","level","from","diagnosticsByLevel","nodeArray","forEach","OK","WARN","ERROR","STALE","LEVEL_NAMES","substring","hardwareId","indexOf","timestampMethod","minYValue","maxYValue","showLegend","xAxisVal","xAxisPath","currentMinY","useRef","currentMaxY","saveCurrentYs","minY","maxY","setMinMax","toString","allPaths","compact","center","datasets","tooltips","getDatasetsAndTooltips","helpContent","floating","menuContent","parseFloat","hot","getExamplePrimitive","primitiveType","MessagePathInputUnconnected","nativeEvent","newCursorPosition","setImmediate","onTimestampMethodChange","autocomplete","autocompleteType","autocompleteRange","keepGoingAfterTopicName","validTypes","substr","prioritizedDatatype","noMultiSlices","disableAutocomplete","structureTraversalResult","find","traverseStructure","messagePathStructures","messagePath","validTerminatingStructureItem","structureItem","autocompleteFilterText","getTopicNames","msgPathPart","structureType","keys","nextByName","nameLoc","messagePathsForDatatype","msgPath","endsWith","initialFilterLength","repr","replace","invalidGlobalVariablesVariable","globalVars","variableName","loc","startLoc","valueLoc","Boolean","getFirstInvalidVariableFromRosPath","noHeaderStamp","topicHasNoHeaderStamp","orderedAutocompleteItems","partition","topicsByTopicName","display","justifyContent","timestampMethodDropdownContainer","_onTimestampMethodChange","toggleComponent","contents","placement","timestampMethodDropdown","timestampMethodDropdownError","lineHeight","timestampItemError","EDIT_FORMAT","YAML","editFormat","setEditFormat","ValidatedInput","onSelectFormat","newFormat","useLayoutEffect","SEditBox","div","STransparentDropdownButton","StyledTextarea","textarea","SError","red","ValidatedInputBase","dataValidator","onError","parse","stringify","setError","inputStr","setInputStr","prevIncomingVal","inputRef","isEditing","setIsEditing","memorizedInputValidation","newInputVal","onChangeFcn","newVal","newError","trim","isArray","validationResult","validationErrorToString","handleChange","inputElem","data-test","JsonInput","YamlInput","InputComponent","toUpperCase","providerTopics","unmemoizedFilledInPaths","filledInPaths","fillInGlobalVariablesInPath","memoizedFilledInPaths","useDeepMemo","cachesByPath","useChangeDetector","filledInPath","weakMap","WeakMap","messagePathDataItems","getMessagePathDataItems","filterMatches","currentValue","messagePathPart","variable","structures","traverse","pathIndex","pathItem","nextPathItem","startIdx","endIdx","newPath","isTypicalFilterName","next","constantName","prevPathItem","enumMap","enumValuesByDatatypeAndField","messagePaths","builtString","typicalFilterName","sort","lastDatatypes","lastStructures","structureFor","rosDatatype","msgField","isConstant","rosPrimitives","currentItem","lineColors","toolsColorScheme","blue","medium","orange","yellow","purple","dark","cyan","green","paleGreen","lightColor","brighten","darkColor","darken","PanelToolbarLabel","PanelToolbarInput","transitionableRosTypes","SRoot","SAddButton","show","SChartContainerOuter","SChartContainerInner","inputColor","setAlpha","toHexString","inputColorBright","lighten","SInputContainer","shrink","css","SInputDelete","yAxes","ticks","mixins","monospaceFont","fontColor","maxRotation","plugins","datalabels","anchor","align","weight","multicolorLineYOffset","scaleOptions","yAxisTicks","newPaths","onlyTopicsHeight","heightPerTopic","yLabels","_path","dataItem","borderWidth","pointBackgroundColor","pointBorderColor","pointHoverRadius","pointRadius","pointStyle","showLine","baseColors","grey","previousValue","previousTimestamp","timestamp","getTimestampForMessage","toSec","subtractTimes","valueForColor","round","positiveModulo","unshift","String","dataPoint","showDatalabel","labelColor","isSynced","splice","_onInputChange","_onInputTimestampMethodChange","topicsGroups","singleTopicDatatype","defaultTopicToRender","availableTopics","topicGroup","suffix","parentTopic","renderTopics","fade","group","tooltipProps","LIGHT1","ORANGE","icon","SDiv","SSpan","available","topicDiv","fontStyle","parentTopicSpan","SIconSpan","disableAutoOpenClickedObject","PanelContext","InteractionsBaseComponent","SRow","SLabel","HIGHLIGHT","SEmptyState","TEXT_MUTED","selectedObject","interactionData","isDrawing","onClearSelectedObject","defaultSelectedTab","selectedTab","setSelectedTab","selectedObjectChanged","isPointCloud","maybeFullyDecodedObject","decodeAdditionalFields","buttons","onSelectTab","newSelectedTab","ToolGroup","ToolGroupFixedSizePane","checked","getDiff","before","after","idLabel","showFullMessageForDiff","idToCompareWith","allItems","candidateIdsToCompareWith","every","idKey","beforeItem","afterItem","candidateIdBefore","candidateIdAfter","unmatchedAfterById","diff","innerDiff","isEmpty","isDeleted","diffLabels","DELETED","labelText","ID","allKeys","afterIsNotObj","ADDED","idLabelObj","beforeIsNotObj","CHANGED","DARK6","indicator","jsonTreeTheme","base0B","diffLabelsByLabelText","SToolGroupFixedSizePane","PANE_WIDTH","selectedTabLocal","Children","child","selectedChild","expanded","tabBar","tab","spaceSeparator","tabBody","imageTopic","allCameraNamespaces","cameraNamespace","getCameraNamespace","availableMarkerTopics","enabledTopic","pop","imageTopicsByNamespace","vals","outsideWidth","outsideHeight","insideWidth","insideHeight","rightX","bottomY","rawMarkerData","markers","cameraInfo","cameraModel","originalHeight","originalWidth","CameraModel","splitTopic","topicPart","currentCameraState","followOrientation","transforms","newCameraState","targetPose","getTargetPose","lastTargetPoseRef","lastTargetPose","params","URLSearchParams","location","search","getZoomDistanceFromURLParam","mergeWith","objVal","srcVal","objectTopic","newGlobalVariables","objectForPath","prevCameraState","prevTargetPose","prevFollowTf","prevFollowOrientation","newFollowTf","newFollowOrientation","heading","cameraStateSelectors","rotateZ","assign","getEquivalentOffsetsWithoutTarget","emptyPose","pz","ox","oy","oz","ow","isRequired","isNumber","isBoolean","isNumberArray","expectArrLen","isOrientation","isNumberArrayErr","quaternionSum","abs","minLength","maxLength","len","RegExp","createValidator","rules","rule","validator","isXYPointArray","isPolygons","MeasuringTool","Component","newMeasureState","measureState","onMeasureInfoChange","measurePoints","clickInfo","mouseDownCoords","mouseUpCoords","arrayToPoint","measureActive","_canvasMouseMoveHandler","_canvasMouseUpHandler","_canvasMouseDownHandler","dist_string","hypot","toFixed","YELLOW","getHighlightedIndices","searchText","highlightedIndicesSet","match","startingIndex","lowerCaseSearchText","toLowerCase","lowerCaseText","range","glTextEnabled","searchTextOpen","selectedMatchIndex","setSearchTextMatches","searchTextMatches","glText","numMatches","highlightedIndices","throttledSetSearchTextMatches","throttle","trailing","matches","toggleSearchTextOpen","setSearchText","setSelectedMatchIndex","searchInputRef","useSearchMatches","currentMatch","rootTf","hasCurrentMatchChanged","useDeepChangeDetector","subtract","onFollowChange","iterateCurrentIndex","iterator","newIndex","alignItems","flexDirection","padding","borderRadius","autoFocus","shiftKey","MAX_DATA_SOURCE_TOGGLES_WIDTH","TOGGLE_WRAPPER_SIZE","TopicTreeV2Container","MAX_CONTAINER_WIDTH_RATIO","SWITCHER_WIDTH","ROW_HEIGHT","isXSWidth","DARK4","DISABLED","STopicTreeV2","TEXTL1","TOOLBAR","STopicTreeHeader","DARK5","SFilter","SInput","SSwitcherIcon","ROW_CONTENT_HEIGHT","SNoMatches","SNoMatchesText","availableNamespacesByTopic","containerHeight","containerWidth","derivedCustomSettingsByKey","getIsNamespaceCheckedByDefault","getIsTreeNodeVisibleInScene","getIsTreeNodeVisibleInTree","rootTreeNode","sceneErrorsByKey","setCurrentEditingTopic","setFilterText","setShowTopicTree","shouldExpandAllKeys","showTopicTree","toggleCheckAllAncestors","toggleCheckAllDescendants","toggleNamespaceChecked","toggleNodeChecked","toggleNodeExpanded","topicDisplayMode","renderTopicTree","scrollContainerRef","checkedKeysSet","treeHeight","CONTAINER_SPACING","SWITCHER_HEIGHT","maxAvailableContainerWidth","treeWidth","providerAvailable","DOT_MENU_WIDTH","filterTextFieldRef","expandedKeysRef","hasRootNodeChanged","topLevelNodesCollapsed","showNoMatchesState","headerRightIconStyle","margin","showErrorBadge","Tree","treeData","itemHeight","selectable","onExpand","newExpandedKeys","autoExpandParent","switcherIcon","hasChildren","nodeVisibleInScene","sceneErrors","derivedCustomSettings","nodeChecked","isDefaultSettings","showTopicSettings","canEditDatatype","showTopicSettingsChanged","showTopicError","showGroupError","rowWidth","TREE_SPACING","rightActionWidth","maxNodeNameWidth","errorTooltip","SErrorList","errStr","SErrorItem","STreeNodeRow","visibleInScene","SLeft","SErrorCount","SIconWrapper","RED","SRightActions","SToggles","overrideColor","onToggle","onShiftToggle","onAltToggle","clickable","nodeKey","TOPIC_ROW_PADDING","ul","li","SDotMenuPlaceholder","altKey","SToggle","getStyles","DISABLED_COLOR","TOGGLE_SIZE_CONFIG","NORMAL","SMALL","sizeInNumber","enabledColor","disabledColor","toRgbString","background","diagnostics","useDiagnostics","addMessage","statusArray","computeDiagnosticInfo","oldInfo","diagnosticsById","delete","newEntry","sortKey","sortedIndexBy","sortedAutocompleteEntries","defaultDiagnosticsBuffer","LEVELS","useMessageReducer","restore","SyncTimeAxis","dataItems","minX","maxX","SResetZoom","SBar","SLegend","MemoizedTooltips","Fragment","delay","chartComponent","hasUnmounted","bar","hasUserPanOrZoomed","setHasUserPannedOrZoomed","forceUpdate","onVisibilityChange","visibilityState","pauseFrame","useMessagePipeline","messagePipeline","onChartUpdate","resumeFrame","yAxisScaleId","onScaleBoundsUpdate","scales","firstYScale","onPanZoom","onResetZoom","resetZoom","hasVerticalExclusiveZoom","setHasVerticalExclusiveZoom","hasHorizontalExclusiveZoom","setHasHorizontalExclusiveZoom","zoomMode","v","keyUphandlers","removeTooltip","ReactDOM","unmountComponentAtNode","parentNode","removeChild","updateTooltip","currentChartComponent","tooltipItem","tooltipData","_tooltip","createElement","appendChild","canvasRect","getBoundingClientRect","pageX","pageY","xMousePosition","tooltipElement","getElementAtXAxis","getChartjsOptions","xAxes","annotations","defaultXTicksSettings","defaultYTicksSettings","defaultXAxis","gridLines","zeroLineColor","maintainAspectRatio","animation","duration","responsiveAnimationDuration","legend","line","tension","hover","intersect","annotation","datasetId","drawLegend","canToggleLines","toggleLine","linesToHide","xVals","pts","chartProps","dataset","zoomOptions","ChartComponent","defaultProps","hasData","syncedMinMax","syncedMinX","syncedMaxX","capture","devicePixelRatio","webWorkerManager","WebWorkerManager","ChartJSWorker","uuid","v4","_chartRpc","forceDisableWorkerRendering","registerWorkerListener","_id","_usingWebWorker","mainThreadRpc","workerRpc","getFakeRpcs","MainThreadChartJSWorker","element","boundingRect","newEvent","native","_getRpc","send","scaleBoundsUpdate","_onUpdateScaleBounds","percentZoomX","percentZoomY","focalPoint","wheelZoomHandler","whichAxesParam","_onPanZoom","_panning","rect","persist","transferControlToOffscreen","_setupPanAndPinchHandlers","_node","chartUpdateId","onEndChartUpdate","_onEndChartUpdateCallbacks","finally","callback","unregisterWorkerListener","threshold","panOptions","hammerManager","Hammer","Manager","Pinch","Pan","hammerPanHandler","_currentDeltaX","_currentDeltaY","on","setTimeout","handlePinch","_currentPinchScaling","pointers","xy","_ref","onWheel","_onWheel","_onClick","sensitivity","speed","chartId","chartInstance","ca","chartArea","storeOriginalOptions","whichAxes","scaleKey","isHorizontal","directionEnabled","zoomScale","zoomCumulativeDeltaByChartId","panMode","panScale","panCumulativeDeltaByChartId","originalOptions","originalOptionsByChartId","timeOptions","time","tickOptions","offsetX","offsetY","speedPercent","cancelable","zoomNumericalScale","newDiff","centerPoint","minPercent","getValueForPixel","minDelta","maxDelta","zoomFunctions","category","labels","chart","minIndex","lastLabelIndex","maxIndex","chartCenter","centerPointer","linear","logarithmic","panNumericalScale","delta","tickOpts","prevStart","prevEnd","newMin","getPixelForValue","newMax","valueOf","panFunctions","offsetAmt","panSpeed","step","classType","maxWorkerCount","_classType","_maxWorkerCount","_workerStates","_allListeners","testing_getWorkerState","workerState","listenerIds","worker","rpc","Rpc","setupReceiveReportErrorHandler","emptyIndex","workerStateIndex","terminate","light","predicate","newArray","showList","links","listStyle","marginRight","listHtml","SList","linkedGlobalVariableName","SListItem","danger","flexShrink","newLinkedGlobalVariables","STopicWithPath","SExistingLinks","marginTop","GlobalVariableName","SForm","isOpen","SUnlinkWrapper","leftPadding","isSingleElemArray","dataWithoutWrappingArray","topicPath","diffMethod","diffTopicPath","diffEnabled","topicRosPath","rootStructureItem","expandAll","setExpandAll","expandedFields","setExpandedFields","consecutiveMsgs","prevTickMsg","prevTickObj","currTickObj","useLatestMessageDataItem","diffTopicObj","inTimetickDiffMode","baseItem","diffItem","onTopicPathChange","newTopicPath","onDiffTopicPathChange","newDiffTopicPath","onToggleDiff","onToggleExpandAll","onLabelClick","keypath","expandedFieldsCopy","valueRenderer","keyPath","iconWrapper","isHovering","lastKeyPath","valueAction","getValueActionForValue","childStructureItem","getStructureItemForPath","enumMapping","basePath","itemLabel","smallNumberArrayStr","DATA_ARRAY_PREVIEW_LIMIT","HighlightedValue","iconBox","renderSingleTopicOrDiffOutput","shouldExpandNode","hideWrappingArray","link","getMessageDocumentationLink","shouldDisplaySingleVal","singleVal","diffData","diffLabelTexts","CheckboxComponent","CheckboxMarkedIcon","CheckboxBlankOutlineIcon","scroll","container","diffMessage","verticalAlign","labelRenderer","raw","SDiffSpan","hideRoot","invertTheme","getItemString","getItemStringForDiff","postprocessValue","theme","tree","nestedNode","nodeType","baseStyle","textDecoration","nestedObj","nestedObjKey","nestedNodeLabel","nestedNodeChildren","active","topicInputs","newDiffMethod","noPortal","prevMessageAndData","messageAndData","setUint8","getFloat32","getInt32","getUint16","getInt16","DISTORTION_STATE","binning_x","binning_y","roi","distortion_model","D","K","P","R","_distortionState","adjustBinning","adjustRoi","x_offset","y_offset","unrectifyPoint","rectX","rectY","fx","fy","cx","cy","X","Y","W","xp","yp","r2","r4","r6","a1","k1","k2","p1","p2","barrel_correction","ypp","BaseRenderer","cleared","frame","setSubscriptions","currentTime","playerState","activeData","isPlaying","useComputedCameraState","onSetSubscriptions","subscriptions","TRANSFORM_TOPIC","TRANSFORM_STATIC_TOPIC","callbackInputsRef","configCameraState","configFollowOrientation","configFollowTf","getNewCameraStateOnFollowChange","onAlignXYAxis","newCameraStateObj","oldConfig","useImperativeHandle","Renderer","forwardRef","FrameCompatibilityDEPRECATED","PoseClass","PointClass","empty","OrientationClass","DrawingTools","onSetDrawingTabType","onSetPolygons","polygonBuilder","selectedPolygonEditFormat","accent","str","yaml","safeLoad","safeDump","noCompatMode","menuTooltip","TOPIC_DISPLAY_MODES","SHOW_TREE","filterInputPlaceholder","SHOW_SELECTED","SHOW_AVAILABLE","SHOW_ALL","targetStr","xsWidthElem","SName","STopicNameDisplay","SDisplayName","endTextLength","DEFAULT_END_TEXT_LENGTH","ev","prevIsOpen","Item","SItemContent","clipboard","copy","description","descriptionMaxWidth","SKeyboardShortcut","SDescription","SKeyWrapper","SKey","GRAY","DARK9","rounded","textSize","kbd","COLORS","BLACK","PINK","LIME","CYAN","WHITE","AQUA","MAGENTA","DARKGRAY","PURPLE","setRgba","rgba255","toRgb","t","tinycolor","fromRatio","toTypedArray","Int8Array","byteOffset","TextureCacheEntry","texture","mipmap","getTexture","store","entry","FLOAT_SIZE","hasValidStride","reinterpretBufferToFloat","extractValues","readers","expandBufferToFloat","BYTES_PER_ELEMENT","NaN","selectedHardwareId","selectedName","newTopicToRender","splitFraction","selectedId","selectedDisplayName","hasSelection","scrollX","additionalIcons","renderTopicToRenderMenu","onChangeSplitFraction","newSplitFraction","ResizeHandle","attrs","divider","KeyValueTable","table","allowedTags","sanitize","__html","allowedAttributes","td","th","HAS_ANY_HTML","getFormattedKeyValues","keyHtml","valueHtml","DiagnosticStatus","collapsedSections","_resizeMouseMove","_resizeMouseUp","_tableRef","clamp","inCollapsedSection","ellipsisShown","keyIsSection","valIsSection","section","onClickSection","colSpan","collapsedSection","valuePath","openPlotPanelIconElem","stateTransitionsIcon","openSiblingStateTransitionsPanel","plotIcon","openSiblingPlotPanel","_renderKeyValueCell","keyCell","valueCell","cls","html","dangerouslySetInnerHTML","statusClass","data-test-resizehandle","_resizeMouseDown","borderRight","borderLeft","_renderKeyValueSections","Lexer","ParserRules","modifier","ParserStart","bool","int8","uint32","int64","uint64","float64","string","datasetsAndTooltips","isReferenceLinePlotPathType","datasetKey","outerIdx","entries","elapsedTime","innerIdx","queriedPath","valueNum","getXForPoint","isTime","timeValue","formatTimeRaw","derivativePoints","derivativeTooltips","borderColor","getDatasetAndTooltipsFromMessagePlotPath","fixedYAxisWidth","getAnnotations","drawTime","scaleID","borderDash","getAnnotationFromReferenceLine","scaleId","precision","TimeBasedChartTooltip","timestampReceiveTime","timestampHeaderStamp","formatTime","defaultShown","reducer","dataById","componentsById","reducedData","hasRenderedIds","leading","_recompute","shouldComponentUpdate","newReducedData","_throttledForceUpdate","inWorkerEnvironment","postMessage","onmessage","_managersById","_rpc","setupWorker","receive","manager","ChartJSManager","getScaleBounds","doZoom","resetZoomDelta","doPan","resetPanDelta","getDatalabelAtEvent","hideAllTicksScaleCallback","hideFirstAndLastTicksScaleCallback","displayTicksInSecondsCallback","mapChartElementToEventElement","_datasetIndex","_index","_view","datasetKeyProvider","Chart","_addFunctionsToConfig","_chartInstance","helpers","configMerge","currentDatasets","_getCurrentDatasets","nextDatasets","_checkDatasets","currentDatasetsIndexed","pid","otherDatasetProps","otherDataProps","pointElements","getElementsAtEventForMode","xAxisElements","nearestXAxisElement","item2","chartDatalabel","$datalabels","getLabelAtEvent","$context","dataIndex","formatter","staticColor","afterFit","scaleInstance","displayXAxesTicksInSeconds","Worker","FakeRpc","proxiedWorker","transfer","handlers","checkboxStyle","TimeBasedChartLegend","pointSvg","PLOT_DOT_DASHED_STYLE","stroke","strokeWidth","strokeDasharray","PLOT_DASHED_STYLE","fontWeight","whiteSpace","_toggleLine","newTooltips","secondsDifference","previousTooltip","lastPath","onInputChange","onInputTimestampMethodChange","toggleToHideLegend","toggleToShowLegend","legendToggle","itemIconContainer","zIndex","btnStyle","newXAxisVal","itemInput","itemInputDisabled","plotableRosTypes","isReferenceLinePlotPath","itemIcon","itemRemove","addLine","getText","needle","option","haystack","charPos","score","isValidInput","csv","getCSVData","blob","downloadFiles","fileName","downloadCsvFile","getHeader","combinedLines","receiveTime","receiveTimeFloat","formatData","LevelClasses","ok","stale","NodeRow","onClickPin","isPinned","nodeRow","data-test-diagnostic-row","pinIcon","pinned","getSortedNodes","nodes","sortBy","showDetails","togglePinned","renderHardwareFilter","opacity","panel","pinnedNodes","getNodesByLevel","AutoSizer","List","rowRenderer","rowProps","renderRow","rowCount","overscanRowCount","SDeleteIcon","SGlobalVariables","parseJson","keyValMap","ArrowDown","ArrowUp","JSONInput","internalValue","setInternalValue","lastPropsValue","parsedValue","isValid","newParsedValue","ValidatedResizingInput","invalidInputs","changeGlobalKey","newKey","oldKey","pick","btnMessage","setBtnMessage","globalVariableNames","linkedGlobalVariablesKeyByName","linked","unlinked","url","queryParams","GLOBAL_VARIABLES_QUERY_KEY","host","UnlinkGlobalVariables","without","readOnly","queryCommandSupported","SGlobalVariableName","_setIsOpen","setName","getInitialName","newValue","addLink","highlightIconStyle","onSubmit","primary","usePanelContext","openRawMessages","STopicLink","splitItemLabel","diffArrow","beforeText","afterText","rootValue","singleSlicePath","multiSlicePath","pivotPath","keyPathJoined","part","onClickCopy","dataToCopy","dataWithoutLargeArrays","cloneDeepWith","SMetadata","rel","href","CopyMessageButton","openPlotPanel","pathSuffix","openStateTransitionsPanel","onPivot","itemType","itemString","formatDuration","sqrt","getArrow","filterKeys","parts","pkg","filename","ROS_COMMON_MSGS","atan2","counts","getChangeCounts","startingCounts","possibleLabelTexts","float","GREEN","STable","wordBreak","showInstance","setShowInstance","instanceObject","getInstanceObj","dropdownText","full","ObjectDetails","objectToDisplay","SObjectDetails","metadataByIndex","originalObject","getClickedInfo","additionalFieldNames","hasAdditionalFieldNames","onCopy","dataRows","rowData","dataStr","colorStyle","charAt","selectedObjects","clickedPosition","onSelectObject","SInteractionContextMenu","SMenu","menuText","SId","SMenuItem","STopic","STooltip","PURPLE1","YELLOW1","minMaxValidatorFn","stepValidatorFn","SliderSettingsMenu","updateConfig","sliderProps","globalVariableName","updateSliderProps","partial","onChangeVariableName","newGlobalVariableName","onChangeMin","onChangeMax","onChangeStep","validateOnBlur","GlobalVariableSliderPanel","globalVariableValue","saveSliderProps","updatedConfig","additionalOutput","SliderWithTicks","SSliderContainer","draw","drawTicks","TICK_FONT","getNonOverlappingLabels","measuredLabels","stepLabels","sumBy","tickWidth","futureTime","sliderConfig","steps","clearRect","fillStyle","fillText","STextField","STextFieldLabel","TextField","defaultValue","focusOnMount","hideInlineError","validate","handleBlur","errorStyle","TopicTimestampSpan","TopicTimestamp","styleObj","BottomBar","containsOpen","imageCanvasStyles","inScreenshotTests","ToggleComponent","dropDownStyles","imageTopicsByNamespaceSelector","imageTopics","groupTopics","AddTopic","onSelectTopic","s","panelHooks","defaultAvailableMarkerTopics","getMarkerOptions","availableAndEnabledMarkerTopics","onToggleMarkerName","markerTopic","onChangeCameraTopic","newCameraTopic","newAvailableMarkerTopics","newEnabledMarkerTopics","getRelatedMarkerTopics","onChangeScale","newScale","onToggleSynchronize","SubMenu","cameraInfoTopic","getCameraInfoTopic","shouldSynchronize","imageAndMarkerTopics","imageScale","synchronizedMessages","memoizedTopics","reducers","getSynchronizingReducers","request","newMessage","useOptionallySynchronizedMessages","imageMessage","markersToRender","renderedMarkerTimestamps","stamps","onStartRenderImage","renderToolbar","controls","renderImageTopicDropdown","missingRequiredCameraInfo","closeOnChange","dropdownItem","topicOption","renderMarkerDropdown","markerTopics","renderEmptyState","image","ContainsOpen","canTransformMarkers","topicTimestamp","textBright","SErrorMessage","ImageCanvasWorker","ImageCanvas","openZoomChart","canvasRenderer","_canvasRenderer","loadZoomFromConfig","_getRpcWorker","transferableCanvas","_canvasRef","panZoomCanvas","getTransform","updatedPercentage","checkOutOfBounds","bitmapDimensions","moveTo","_divRef","maxZoom","minZoom","smoothScroll","filterKey","dy","dz","fitPercent","goToTargetPercentage","keepInBounds","imageViewportWidth","offsetWidth","imageViewportHeight","offsetHeight","getImageViewport","createPanZoom","applyPanZoom","renderCurrentImage","toBlob","ContextMenu","downloadImage","zoomAbs","moveToCenter","fillPercent","targetPercentage","onFinishImageRender","dimensions","renderImage","zoomChart","data-zoom-menu","menuItem","notInteractive","borderBottom","onZoomMinus","data-panel-minus-zoom","onZoomPlus","data-panel-add-zoom","onZoomFit","onZoomFill","useMainThreadRenderingForTesting","_onVisibilityChange","prevProps","innerA","innerB","innerKey","handleWidth","handleHeight","onResize","onCanvasRightClick","_setCanvasRef","onOutsideClick","renderZoomChart","magnify","clickMagnify","data-magnify-icon","clearCanvas","markerData","buildMarkerData","hasLoggedCameraModelError","rawData","encoding","ImageData","decodeYUV","decodeRGB8","decodeBGR8","decodeFloat1c","decodeBayerRGGB8","decodeBayerBGGR8","decodeBayerGBRG8","decodeBayerGRBG8","decodeMono8","decodeMono16","createImageBitmap","decodeMessageToBitmap","getContext","resizeCanvas","drawImage","save","messages","paintMarker","paintMarkers","paintBitmap","close","maybeUnrectifyPoint","beginPath","arc","PI","outline_color","lineWidth","strokeStyle","lineTo","maybeUnrectifiedPoint","closePath","outline_colors","fill_color","textBaseline","filled","metrics","fillRect","makeSpecializedDecodeBayer","tl","tr","bl","br","Function","yuv","c","u","inIdx","outIdx","bgr","gray","mono8","ch","mono16","hide","Tooltip","getHeaderStamp","TimeUtil","compare","allItemStampsNewestFirst","synchronizedItemsByPath","itemsMatchingStamp","getSynchronizedState","found","thisStamp","areSame","getSynchronizedMessages","matchingMessage","newMessagesByTopic","newSynchronizedMessages","allMessageStampsNewestFirst","syncedMsgs","msgsByTopic","isLessThan","Container","getSubscriptionGroup","requester","getPublisherGroup","advertiser","pipelineSubscriptions","publishers","pipelinePublishers","groupedSubscriptions","subscriptionGroups","grouped","groupBy","renderedSubscriptions","topicsByName","sub","originalTopic","renderedPublishers","groupedPublishers","recordGroup","setRecordGroup","recordingTopics","setRecordingTopics","recordedData","historyRecorder","isPrimary","recordSubs","downloadTextFile","Editor","lazy","skeletonBody","DEFAULT_WEBVIZ_NODE_PREFIX","UnsavedDot","isSaved","NodePlaygroundSettings","vimMode","SecurityBarWrapper","REDL1","TrustButton","button","SecurityBar","SWelcomeScreen","WelcomeScreen","addNewNode","updateExplorer","selectedNodeId","editorForStorybook","explorer","userNodes","userNodeDiagnostics","needsUserTrust","trusted","setUserNodes","payload","selectedNodeDiagnostics","selectedNode","scriptBackStack","setScriptBackStack","currentScript","isCurrentScriptSelectedNode","isNodeSaved","sourceCode","selectedNodeLogs","logs","inputTitle","DARK2","testItems","additionalBackStackItems","newNodeId","trustUserNode","trustSelectedNode","saveNode","script","setScriptOverride","goBack","setScriptCode","backStack","selectNode","nodeId","deleteNode","flexGrow","DARK1","large","newNodeName","data-nativeundoredo","Suspense","fallback","resizeKey","SHeaderItem","HeaderItem","numItems","paddingBottom","bottomBarDisplay","setBottomBarDisplay","autoScroll","setAutoScroll","clearLogs","clearUserNodeLogs","scrollContainer","scrolledUp","overflowY","severityColors","Hint","YELLOWL1","Info","BLUEL1","Warning","ORANGEL1","severityIcons","severity","source","startColumn","startLineNumber","severityLabel","invert","DiagnosticSeverity","errorLoc","valueColorMap","number","base09","boolean","base08","renderTreeObj","LIGHT","_extends","prototype","hasOwnProperty","call","_objectWithoutProperties","viewBox","xmlns","strokeLinecap","strokeLinejoin","MenuWrapper","ExplorerWrapper","GRAY2","ListItem","SFlex","NodesList","collapse","updateSearch","RedDot","otherMarkdownDocsForTest","nodesSelected","docsSelected","linkTarget","nodePlaygroundDocs","STextArea","onChangeText","noteText","panelRenderCount","messageHistoryRenderCount","useMessageReducerRenderCount","messagePipelineRenderCount","HooksComponent","MessagePipelineRendersComponent","textAlign","getNumberOfRendersCountsForTests","PlaybackPerformanceItem","Sparkline","maximum","timeRange","decimalPlaces","now","playbackInfo","lastPlaybackInfo","perfPoints","framerate","bagTimeMs","lastSeekTime","renderTimeMs","shift","nowStamp","STextAreaContainer","SErrorText","getTopicName","cachedProps","datatypeNames","parsedObject","_publisher","publish","newState","parsedAny","parseInput","changed","sampleMessage","stringifiedSampleMessage","_renderMenuContent","advancedView","buttonText","buttonTooltip","buttonColor","canPublish","PlayerCapabilities","advertise","buttonRowStyle","_onChangeTopic","_onSelectTopic","_onSelectDatatype","_publish","buildSampleMessage","builtin","builtinSampleValues","sample","arrayLength","Publisher","_getContext","_context","_setPublishers","setPublishers","MessagePipelineConsumer","Creatable","LOG_LEVEL_OPTIONS","KNOWN_LOG_LEVELS","stringsToOptions","strs","getShouldDisplayMsg","minLogLevel","searchTerms","searchTermsInLowerCase","term","searchTerm","RosoutPanel","selectedOptions","seenNodeNames","msgs","nodeNameOptions","filtersBar","severityFilter","clearable","searchable","optionHeight","optionRenderer","styleProp","selectValue","focusedOption","logStyle","VirtualizedSelectFocusedOption","_onLogLevelChange","valueComponent","nodeFilter","multi","closeOnSelect","_onNodeFilterChange","selectComponent","promptTextCreator","itemsCountField","_getFilteredMessages","_filterFn","_renderRow","paddingTop","topicToRenderMenu","ROSOUT_TOPIC","_renderFiltersBar","PadStart","padStart","Stamp","altStr","file","strLevel","levelClassName","toLocaleLowerCase","listId","cache","CellMeasurerCache","fixedWidth","lastWidth","lastItems","lastRenderTime","clearAll","containerEl","getElementById","newAutoScroll","onResetView","deferredMeasurementCache","CellMeasurer","columnIndex","rowIndex","containerProps","scrollToIndex","messagesSeen","seenBefore","STab","numTabs","clearBgStyle","SDropTarget","isOver","cssColors","textDisabled","textMuted","SEmptyStateText","EmptyDropTarget","mosaicId","drop","useDrop","accept","MosaicDragType","WINDOW","monitor","getItem","collect","selectTab","editTab","newTabs","removeTab","lastIdx","addTab","newTab","onChangeLayout","currentLayout","Consumer","panelContext","showHiddenControlsOnHover","bind","UnconnectedPanelLayout","importHooks","setMosaicId","removeRootDropTarget","DEFAULT_TAB_PANEL_CONFIG","rx","ry","SContainer","VALID_TYPES","keysToPick","isValidMinMaxVal","minXVal","maxXVal","minYVal","maxYVal","getBufferedMinMax","allVals","minVal","maxVal","yAxisLabel","xAxisLabel","lineTension","order","allXs","allYs","scaleLabel","labelString","pan","isTargetingCanvas","tooltipDatapoint","tooltipLabel","dataPoints","datapoint","_datapoint","currentTooltip","tooltipStyles","emptyMessage","ChildComponent","baseTopics","FrameCompatibilityComponent","forwardedRef","childProps","setTopics","componentSetSubscriptions","newTopics","lastClearTime","latestFrame","autoTextBackgroundColor","enableShortDisplayNames","flattenMarkers","showCrosshair","containerRef","setDebug","setPolygonBuilder","PolygonBuilder","measureInfo","setMeasureInfo","currentEditingTopic","searchTextProps","useSearchText","useReducer","measuringElRef","drawingTabType","setDrawingTabType","selectedObjectState","setSelectedObjectState","getUpdatedGlobalVariablesBySelectedObject","sceneBuilder","transformsBuilder","SceneBuilder","TransformsBuilder","setOnForceUpdate","topicTreeConfig","staticallyAvailableNamespacesByTopic","supportedMarkerDatatypesSet","defaultTopicSettings","startupPerPanelHooks","getDefaultTopicTreeV2","getStaticallyAvailableNamespacesByTopic","getDefaultSettings","sceneErrorsByTopicKey","topicTreeTopics","hasFeatureColumn","selectedNamespacesByTopic","selectedTopicNames","playerId","clear","rootTfID","setPlayerId","setTransforms","setFlattenMarkers","setSelectedNamespacesByTopic","setTopicSettings","selectedTopics","setFrame","setCurrentTime","setSelectedTransforms","handleDrawPolygons","eventName","POLYGON_TAB_TYPE","handleEvent","currentDrawingTabType","currentHandleDrawPolygons","measuringHandler","onControlsOverlayClick","onExitTopicTreeFocus","toggleCameraMode","toggleDebug","contains","selectedObj","currentSaveConfig","useExperimentalFeature","ctrlKey","markerProviders","cursorType","MapComponent","videoRecordingStyle","visibility","videoRecordingMode","memoizedScene","getScene","mapNamespaces","mapElement","scene","clientWidth","sceneBuilderMessage","collectors","getMessages","world","DrawPolygons","onToggleCameraMode","onToggleDebug","InteractionContextMenu","renderCount","stats","bufferCount","elementsCount","textureCount","shaderCount","textureSize","getTotalTextureSize","bufferSize","getTotalBufferSize","polygonPoints","setPolygonPoints","polygonsToPoints","selectedFormat","newPolygonPoints","pointsToPolygons","polygonPointsValidator","getFormattedString","getPolygonLineDistances","pointsPerPolygon","pointsToJson","pointsToYaml","polyPoints","additionalToolbarItemsElem","cartographer","tfToFollow","measuringTool","measureDistance","edit","setEdit","camPos2DTrimmed","ZERO_VEC3","num","UncontrolledValidatedInput","cameraStateValidator","CameraStateInfo","paddingLeft","newPos","newTargetOffset","point2DValidator","crosshairPoint","crosshair","extraThickness","ns","treeNodeToTfId","buildTfTree","roots","allNodes","setDepth","getDescendants","padEnd","defaultFollowTfFrame","forceShowFrameList","setForceShowFrameList","hovering","setHovering","lastSelectedFrame","setLastSelectedFrame","tfTree","nodesWithoutDefaultFollowTfFrame","newFollowTfFrame","getDefaultFollowTransformFrame","getFollowButtonTooltip","onClickFollowButton","onSelectFrame","autocompleteNode","openFrameList","onMouseLeaveDebounced","debounce","cancel","followingCustomFrame","showFrameList","selectedFrameId","cameraModeTip","toggleMeasureState","startPoint","defaultSphere","defaultPose","endPoint","buildSyntheticArrowMarker","flattenedZHeightPose","POSE_MARKER_SCALE","rootTransformID","topicsMissingFrameIds","topicsMissingTransforms","topicsWithBadFrameIds","Bounds","_updateErrorsByTopic","_addError","namespaces","_reportBadFrameId","badFrameError","frameIds","topicMissingError","_consumeMarker","mappedMessage","originalInfo","originalPosition","sourcePose","decayTimeInSec","_topicSettings","decayTime","lifetime","fromSec","_clock","setClock","_consumeMarkerArray","_consumeOccupancyGrid","_consumeNonMarkerMessage","closed","lastSeenMessages","consumeMarkerArray","consumeNonMarkerMessage","MessageCollector","flush","_consumeMessage","collector","_playerId","reportedErrorTopics","topicsToFlush","other","setEnabledNamespaces","enabledNamespaces","hasErrors","_onForceUpdate","errorsByTopic","getSceneErrorsByTopic","_consumeNamespace","allNamespaces","namespaceIsEnabled","_setTopicError","deleteMarker","deleteAll","_transformMarkerPose","minZ","MAX_SAFE_INTEGER","parseColorSetting","addMarker","_consumeTopic","renderMarkers","topicMarkers","_addMarkerToCollector","overrideCommand","arrow","cube","sphere","cylinder","LINED_CONVEX_HULL_RENDERING_SETTING","linedConvexHull","lineStrip","lineList","cubeList","triangleList","pointcloud","poseMarker","laserScan","filledPolygon","instancedLineList","MessageWithLifetime","isExpired","getLifetime","expiresAt","isGreaterThan","hasLifetime","clock","_addItem","existing","MIN_SAFE_INTEGER","STopicSettingsEditor","TEXT","STitle","h3","SDatatype","SEditorWrapper","MainEditor","collectorMessage","onFieldChange","onSettingsChange","topicSettingsEditorForDatatype","defaultSettingsByColumn","getSettingsByColumnWithDefaults","settingsByColumn","newSettings","SECOND_SOURCE_PREFIX","editorElem","RenderToBodyComponent","onRequestClose","contentStyle","renderTreeNodes","titleWidth","showVisible","showAvailable","itemChildren","availableNamespaces","namespaceNodes","namespace","namespaceKey","generateNodeKey","visible","TooltipRow","TooltipTable","TooltipDescription","childrenNodes","topicNode","maxNodeNameLen","ICON_SIZE","INNER_LEFT_MARGIN","STextHighlight","autoEscape","highlightClassName","searchWords","textToHighlight","testShowTooltip","startTextLen","startText","endText","elem","STextMiddleTruncate","SStart","SEnd","STopicTreeSwitcher","transition","pointerEvents","SErrorsBadge","hasChangedPlayerId","newAvailableTfs","availableTfsRef","tfsNotYetAdded","availableTfs","mapKeys","sceneErrorsByKeyMemo","originPosition","originOrientation","defaultArrowMarker","defaultArrowScale","unitXVector","fromValues","originAxes","unitVector","tempOrientation","getAxesArrowMarkers","axis","axisId","rotationTo","getTransformedAxisArrowMarker","getAxisTextMarker","textPose","MARKER_MSG_TYPES","TEXT_VIEW_FACING","tempTranslation","throwawayQuat","getArrowToParentMarkers","childPose","parentPose","selections","addMarkersForTransform","markersForTransform","o","provider","getMarkers","additionalMarkers","TextComponent","GLText","textMarkers","useGLText","PointCloudsComponent","GPUPointClouds","PointClouds","hideDebug","OccupancyGrids","layerIndex","Arrows","Points","Cubes","PoseMarkers","LaserScans","ALPHABET","scaleInvariantFontSize","FilledPolygons","LinedConvexHulls","fromCodePoint","models","useCarModel","shaftWidth","headWidth","pos","transformQuat","tipPoint","scaleAndAdd","tailPoint","GLTFScene","loadCarModel","carModelURL","samplers","minFilter","LINEAR","isCircle","pointShape","angle_min","angle_increment","range_min","range_max","ranges","intensity","intensities","occupancyGrids","positionBuffer","TextureCache","paletteTextures","palette","decodedMarkers","instancedGetChildrenForHitmap","pointCloud","pointCloudCommand","markerCache","updateMarkerCache","decoded","positionBufferCache","VertexBufferCache","colorBufferCache","getCachedBuffer","vertexBuffer","memoized","hitmapColors","minGradientColor","maxGradientColor","minColorValue","maxColorValue","onPreRender","onPostRender","decodeMarker","createPositionBuffer","createColorBuffer","POSITIVE_INFINITY","NEGATIVE_INFINITY","hasMinValue","hasMaxValue","getVertexCount","getVertexValue","_previous","_current","_deleteBuffer","cached","getTriangleChildrenForHitmap","onlyRenderInHitmap","faceIndices","trianglePoints","index1","index2","index3","convertedColor","Transforms","prevState","tfs","skipTranformFrame","tfs_static","PropTypes","any","ChartJSChart","annotationPlugin","datalabelPlugin","register","defaults","multicolorLine","scatter","controllers","extend","ease","startIndex","meta","getMeta","getDataset","area","_children","originalY","originalDatasets","setColor","newColor"],"mappings":"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","file":"hooks_bundle.js","sourcesContent":["// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat3 } from \"gl-matrix\";\n\nimport type { Vec3, Vec4 } from \"../types\";\n\nconst scratch = [0, 0, 0, 0, 0, 0, 0, 0, 0];\n\n// gl-matrix clone of three.js Euler.setFromQuaternion\n// assumes default XYZ order\nexport default function eulerFromQuaternion(out: number[], q: Vec4): Vec3 {\n  const m = mat3.fromQuat(scratch, q);\n  const m11 = m[0], m12 = m[3], m13 = m[6]; // prettier-ignore\n  const             m22 = m[4], m23 = m[7]; // prettier-ignore\n  const             m32 = m[5], m33 = m[8]; // prettier-ignore\n\n  out[1] = Math.asin(m13 < -1 ? -1 : m13 > 1 ? 1 : m13);\n  if (Math.abs(m13) < 0.99999) {\n    out[0] = Math.atan2(-m23, m33);\n    out[2] = Math.atan2(-m12, m11);\n  } else {\n    out[0] = Math.atan2(m32, m22);\n    out[2] = 0;\n  }\n  return (out: any);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Color, Point, Orientation, ReglCommand, Vec4, Vec3 } from \"../types\";\n\nconst rotateGLSL = `\n  uniform vec3 _position;\n  uniform vec4 _rotation;\n\n  // rotate a 3d point v by a rotation quaternion q\n  vec3 rotate(vec3 v, vec4 q) {\n    vec3 temp = cross(q.xyz, v) + q.w * v;\n    return v + (2.0 * cross(q.xyz, temp));\n  }\n\n  vec3 applyPose(vec3 point) {\n    // rotate the point and then add the position of the pose\n    return rotate(point, _rotation) + _position;\n  }\n`;\n\nconst DEFAULT_TEXT_COLOR = { r: 1, g: 1, b: 1, a: 1 };\n\nexport const pointToVec3 = ({ x, y, z }: Point): Vec3 => {\n  return [x, y, z];\n};\nexport const orientationToVec4 = ({ x, y, z, w }: Orientation): Vec4 => {\n  return [x, y, z, w];\n};\n\nexport const vec3ToPoint = ([x, y, z]: Vec3): Point => ({ x, y, z });\n\nexport const vec4ToOrientation = ([x, y, z, w]: Vec4): Orientation => ({ x, y, z, w });\n\nexport const pointToVec3Array = (points: Point[]) => {\n  const result = new Float32Array(points.length * 3);\n  let i = 0;\n  for (const { x, y, z } of points) {\n    result[i++] = x;\n    result[i++] = y;\n    result[i++] = z;\n  }\n  return result;\n};\n\nexport const toRGBA = (val: Color) => {\n  return [val.r, val.g, val.b, val.a];\n};\n\nexport const vec4ToRGBA = (color: Vec4): Color => ({ r: color[0], g: color[1], b: color[2], a: color[3] });\n\nexport const toColor = (val: Color | Vec4): Color => (Array.isArray(val) ? vec4ToRGBA(val) : val);\n\nexport function getCSSColor(color: Color = DEFAULT_TEXT_COLOR) {\n  const { r, g, b, a } = color;\n  return `rgba(${(r * 255).toFixed()}, ${(g * 255).toFixed()}, ${(b * 255).toFixed()}, ${a.toFixed(3)})`;\n}\n\nconst toRGBAArray = (colors: $ReadOnlyArray<Color>): Float32Array => {\n  const result = new Float32Array(colors.length * 4);\n  let i = 0;\n  for (const { r, g, b, a } of colors) {\n    result[i++] = r;\n    result[i++] = g;\n    result[i++] = b;\n    result[i++] = a;\n  }\n  return result;\n};\n\nconst constantRGBAArray = (count: number, { r, g, b, a }: Color): Float32Array => {\n  const result = new Float32Array(count * 4);\n  for (let i = 0; i < count; i++) {\n    result[4 * i + 0] = r;\n    result[4 * i + 1] = g;\n    result[4 * i + 2] = b;\n    result[4 * i + 3] = a;\n  }\n  return result;\n};\n\n// default blend func params to be mixed into regl commands\nexport const defaultReglBlend = {\n  enable: true,\n  // this is the same gl.BlendFunc used by three.js by default\n  func: {\n    src: \"src alpha\",\n    dst: \"one minus src alpha\",\n    srcAlpha: 1,\n    dstAlpha: \"one minus src alpha\",\n  },\n  equation: {\n    rgb: \"add\",\n    alpha: \"add\",\n  },\n};\n\nexport const defaultReglDepth = {\n  enable: true,\n  mask: true,\n};\n\nexport const defaultDepth = {\n  enable: (context: any, props: any) => (props.depth && props.depth.enable) || defaultReglDepth.enable,\n  mask: (context: any, props: any) => (props.depth && props.depth.mask) || defaultReglDepth.mask,\n};\n\nexport const defaultBlend = {\n  ...defaultReglBlend,\n  enable: (context: any, props: any) => (props.blend && props.blend.enable) || defaultReglBlend.enable,\n  func: (context: any, props: any) => (props.blend && props.blend.func) || defaultReglBlend.func,\n};\n\n// TODO: deprecating, remove before 1.x release\nexport const blend = defaultBlend;\n\n// takes a regl command definition object and injects\n// position and rotation from the object pose and also\n// inserts some glsl helpers to apply the pose to points in a fragment shader\nexport function withPose(command: ReglCommand): ReglCommand {\n  const { vert, uniforms } = command;\n  const newVert = vert.replace(\"#WITH_POSE\", rotateGLSL);\n  const newUniforms = {\n    ...uniforms,\n    _position: (context, props) => {\n      const { position } = props.pose;\n      return Array.isArray(position) ? position : pointToVec3(position);\n    },\n    _rotation: (context, props) => {\n      const { orientation: r } = props.pose;\n      return Array.isArray(r) ? r : [r.x, r.y, r.z, r.w];\n    },\n  };\n  return {\n    ...command,\n    vert: newVert,\n    uniforms: newUniforms,\n  };\n}\n\nexport function getVertexColors({\n  colors,\n  color,\n  points,\n}: {\n  colors?: $ReadOnlyArray<Color> | $ReadOnlyArray<Vec4>,\n  color: Color,\n  points: $ReadOnlyArray<Point>,\n}): Float32Array | $ReadOnlyArray<Vec4> {\n  if ((!colors || !colors.length) && color) {\n    return constantRGBAArray(points.length, color);\n  }\n  if (colors) {\n    // $FlowFixMe this will go away once we consolidate getVertexColors and colorBuffer\n    return shouldConvert(colors) ? toRGBAArray(colors) : colors;\n  }\n  return [];\n}\n\nfunction hasNestedArrays(arr: any[]) {\n  return arr.length && Array.isArray(arr[0]);\n}\n\n// Returns a function which accepts a single color, an array of colors, and the number of instances,\n// and returns a color attribute buffer for use in regl.\n// If there are multiple colors in the colors array, one color will be assigned to each instance.\n// In the case of a single color, the same color will be used for all instances.\nexport function colorBuffer(regl: any) {\n  const buffer = regl.buffer({\n    usage: \"dynamic\",\n    data: [],\n  });\n\n  return function(color: any, colors: any, length: number) {\n    let data, divisor;\n    if (!colors || !colors.length) {\n      data = shouldConvert(color) ? toRGBA(color) : color;\n      divisor = length;\n    } else {\n      data = shouldConvert(colors) ? toRGBAArray(colors) : colors;\n      divisor = 1;\n    }\n    return {\n      buffer: buffer({\n        usage: \"dynamic\",\n        data,\n      }),\n      divisor,\n    };\n  };\n}\n\n// used to determine if the input/array of inputs is an object like {r: 0, g: 0, b: 0} or [0,0,0]\nexport function shouldConvert(props: any) {\n  if (!props || hasNestedArrays(props) || !isNaN(props[0])) {\n    return false;\n  }\n  return true;\n}\n\nexport function intToRGB(i: number = 0): Vec4 {\n  const r = ((i >> 16) & 255) / 255;\n  const g = ((i >> 8) & 255) / 255;\n  const b = (i & 255) / 255;\n  return [r, g, b, 1];\n}\n\nexport function getIdFromColor(rgb: Vec4): number {\n  const r = rgb[0] * 255;\n  const g = rgb[1] * 255;\n  const b = rgb[2] * 255;\n  return b | (g << 8) | (r << 16);\n}\n\nexport function getIdFromPixel(rgb: Uint8Array): number {\n  const r = rgb[0];\n  const g = rgb[1];\n  const b = rgb[2];\n  return b | (g << 8) | (r << 16);\n}\n\n// gl-matrix clone of three.js Vector3.setFromSpherical\n// phi: polar angle (between poles, 0 - pi)\n// theta: azimuthal angle (around equator, 0 - 2pi)\nexport function fromSpherical(out: number[], r: number, theta: number, phi: number): Vec3 {\n  const rSinPhi = r * Math.sin(phi);\n  out[0] = rSinPhi * Math.sin(theta);\n  out[1] = r * Math.cos(phi);\n  out[2] = rSinPhi * Math.cos(theta);\n  return (out: any);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Cube } from \"../types\";\nimport fromGeometry from \"../utils/fromGeometry\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nconst cubes = fromGeometry(\n  [\n    // bottom face corners\n    [-0.5, -0.5, -0.5],\n    [-0.5, 0.5, -0.5],\n    [0.5, -0.5, -0.5],\n    [0.5, 0.5, -0.5],\n    // top face corners\n    [-0.5, -0.5, 0.5],\n    [-0.5, 0.5, 0.5],\n    [0.5, -0.5, 0.5],\n    [0.5, 0.5, 0.5],\n  ],\n  [\n    // bottom\n    [0, 1, 2],\n    [1, 2, 3],\n    // top\n    [4, 5, 6],\n    [5, 6, 7],\n    // left\n    [0, 2, 4],\n    [2, 4, 6],\n    // right\n    [1, 3, 5],\n    [3, 5, 7],\n    //front\n    [2, 3, 6],\n    [3, 6, 7],\n    //back\n    [0, 1, 4],\n    [1, 4, 5],\n  ]\n);\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Cubes(props: { ...CommonCommandProps, children: Cube[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={cubes} />;\n}\n","// @flow\n\n//  Copyright (c) 2019-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport type { Line, Point, Vec3, Scale, GetChildrenForHitmap, SphereList } from \"../../types\";\nimport { vec4ToRGBA, vec3ToPoint } from \"../../utils/commandUtils\";\nimport Lines from \"../Lines\";\nimport Spheres from \"../Spheres\";\n\nexport function multiplyScale(scale: Scale, factor: number): Scale {\n  return { x: scale.x * factor, y: scale.y * factor, z: scale.z * factor };\n}\n\nexport const DEFAULT_COLOR = [1, 1, 1, 1];\nexport const ACTIVE_POLYGON_COLOR = [0.8, 0, 0.8, 1];\nexport const ACTIVE_POINT_COLOR = [1, 0.2, 1, 1];\nexport const LINE_STRIP = \"line strip\";\nconst POINT_SIZE_FACTOR = 1.3;\nexport const DRAW_SCALE = { x: 0.1, y: 0.1, z: 0.1 };\nexport const DRAW_POINT_SCALE = multiplyScale(DRAW_SCALE, POINT_SIZE_FACTOR);\nexport const HITMAP_SCALE = { x: 0.5, y: 0.5, z: 0.5 };\nexport const HITMAP_POINT_SCALE = multiplyScale(HITMAP_SCALE, POINT_SIZE_FACTOR);\nexport const POSE = {\n  position: { x: 0, y: 0, z: 0 },\n  orientation: { x: 0, y: 0, z: 0, w: 0 },\n};\n\nlet count = 1;\n\nexport class PolygonPoint {\n  id: number;\n  point: Vec3;\n  active: boolean = false;\n\n  constructor(points: Vec3) {\n    this.id = count++;\n    this.point = points;\n  }\n}\n\nexport class Polygon {\n  id: number;\n  name: string;\n  points: PolygonPoint[] = [];\n  active: boolean = false;\n\n  constructor(name: string = \"\") {\n    this.name = name;\n    this.id = count++;\n  }\n}\n\nexport type DrawPolygonType = Polygon;\n\ntype Props = {\n  children: DrawPolygonType[],\n};\n\nconst polygonLinesGetChildrenForHitmap: GetChildrenForHitmap = <T: any>(\n  props: T,\n  assignNextColors,\n  excludedObjects\n) => {\n  // This is almost identical to the default nonInstancedGetChildrenForHitmap, with changes marked.\n  return props\n    .map((prop) => {\n      if (excludedObjects.some(({ object }) => object === prop)) {\n        return null;\n      }\n      const hitmapProp = { ...prop };\n      // Change from original: pass the original marker as a callback object instead of this marker.\n      const [hitmapColor] = assignNextColors(prop.originalMarker, 1);\n      // Change from original: increase scale for hitmap\n      hitmapProp.scale = HITMAP_SCALE;\n\n      hitmapProp.color = hitmapColor;\n      if (hitmapProp.colors && hitmapProp.points && hitmapProp.points.length) {\n        hitmapProp.colors = new Array(hitmapProp.points.length).fill(hitmapColor);\n      }\n      return hitmapProp;\n    })\n    .filter(Boolean);\n};\n\n/**\n * Draw the polygon lines\n */\nclass PolygonLines extends React.Component<Props> {\n  render() {\n    const polygons = this.props.children;\n    const lines: Line[] = [];\n    for (const poly of polygons) {\n      const color = poly.active ? ACTIVE_POLYGON_COLOR : DEFAULT_COLOR;\n      const points: (Point | Vec3)[] = poly.points.map(({ point }) => vec3ToPoint(point));\n\n      lines.push({\n        primitive: LINE_STRIP,\n        pose: POSE,\n        points,\n        scale: DRAW_SCALE,\n        color: vec4ToRGBA(color),\n        originalMarker: poly,\n      });\n    }\n\n    return <Lines getChildrenForHitmap={polygonLinesGetChildrenForHitmap}>{lines}</Lines>;\n  }\n}\n\nconst polygonPointsGetChildrenForHitmap: GetChildrenForHitmap = <T: any>(\n  props: T,\n  assignNextColors,\n  excludedObjects\n) => {\n  // This is similar to the default nonInstancedGetChildrenForHitmap, with changes marked.\n  return props\n    .map((prop) => {\n      if (excludedObjects.some(({ object }) => object === prop)) {\n        return null;\n      }\n      const hitmapProp = { ...prop };\n      // Change from original: assign a non-instanced color to each point color, even though this marker uses\n      // instancing.\n      // This is so that we can have a unique callback object for each point.\n      hitmapProp.colors = hitmapProp.colors.map((color, index) => {\n        return assignNextColors(prop.originalMarkers[index], 1);\n      });\n      // Change from original: increase scale for hitmap\n      hitmapProp.scale = HITMAP_POINT_SCALE;\n      return hitmapProp;\n    })\n    .filter(Boolean);\n};\n\n/**\n * Draw the polygon points at the end of each lines\n */\nclass PolygonPoints extends React.Component<Props> {\n  render() {\n    const polygons = this.props.children;\n    const points = [];\n    const colors = [];\n    const originalMarkers = [];\n\n    for (const poly of polygons) {\n      const color = poly.active ? ACTIVE_POLYGON_COLOR : DEFAULT_COLOR;\n      for (const point of poly.points) {\n        const convertedPoint = vec3ToPoint(point.point);\n        points.push(convertedPoint);\n        colors.push(point.active ? ACTIVE_POINT_COLOR : color);\n        originalMarkers.push(point);\n      }\n    }\n\n    const sphereList: SphereList = {\n      points,\n      colors,\n      pose: POSE,\n      scale: DRAW_POINT_SCALE,\n      originalMarkers,\n    };\n\n    return <Spheres getChildrenForHitmap={polygonPointsGetChildrenForHitmap}>{[sphereList]}</Spheres>;\n  }\n}\n\nexport default function DrawPolygons({ children: polygons = [] }: Props) {\n  if (polygons.length === 0) {\n    return null;\n  }\n\n  return (\n    <React.Fragment>\n      <PolygonLines>{polygons}</PolygonLines>\n      <PolygonPoints>{polygons}</PolygonPoints>\n    </React.Fragment>\n  );\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport earcut from \"earcut\";\nimport React from \"react\";\n\nimport type { Vec3, Point, PolygonType } from \"../types\";\nimport { shouldConvert, pointToVec3 } from \"../utils/commandUtils\";\nimport { getChildrenForHitmapWithOriginalMarker } from \"../utils/getChildrenForHitmapDefaults\";\nimport Triangles from \"./Triangles\";\n\nconst NO_POSE = {\n  position: { x: 0, y: 0, z: 0 },\n  orientation: { x: 0, y: 0, z: 0, w: 0 },\n};\n\nconst DEFAULT_SCALE = { x: 1, y: 1, z: 1 };\n\nfunction flatten3D(points: Vec3[]): Float32Array {\n  const array = new Float32Array(points.length * 3);\n  for (let i = 0; i < points.length; i++) {\n    const [x, y, z] = points[i];\n    array[i * 3] = x;\n    array[i * 3 + 1] = y;\n    array[i * 3 + 2] = z;\n  }\n  return array;\n}\n\nfunction getEarcutPoints(points: Vec3[]): (Vec3 | Point)[] {\n  const flattenedPoints = flatten3D(points);\n  const indices = earcut(flattenedPoints, null, 3);\n  const newPoints = [];\n  for (let i = 0; i < indices.length; i++) {\n    const originalIndex = indices[i];\n    newPoints.push(points[originalIndex]);\n  }\n  return newPoints;\n}\n\ntype Props = {\n  children: PolygonType[],\n};\n\n// command to draw a filled polygon\nfunction FilledPolygons({ children: polygons = [], ...rest }: Props) {\n  const triangles = polygons.map((poly) => {\n    // $FlowFixMe flow doesn't know how shouldConvert works\n    const points: Vec3[] = shouldConvert(poly.points) ? poly.points.map(pointToVec3) : poly.points;\n    const pose = poly.pose ? poly.pose : NO_POSE;\n    const earcutPoints = getEarcutPoints(points);\n    return {\n      ...poly,\n      points: earcutPoints,\n      pose,\n      scale: DEFAULT_SCALE,\n      originalMarker: poly,\n    };\n  });\n\n  // Overwrite the triangle's default getChildrenForHitmap because we want to event as if each triangle is a single\n  // polygon.\n  return (\n    <Triangles getChildrenForHitmap={getChildrenForHitmapWithOriginalMarker} {...rest}>\n      {triangles}\n    </Triangles>\n  );\n}\n\nexport default FilledPolygons;\n","// @flow\n\nimport TinySDF from \"@mapbox/tiny-sdf\";\nimport memoizeOne from \"memoize-one\";\nimport React, { useState } from \"react\";\n\nimport type { Color } from \"../types\";\nimport { defaultBlend, defaultDepth, toColor } from \"../utils/commandUtils\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\nimport { isColorDark, type TextMarker } from \"./Text\";\n\n// The GLText command renders text from a Signed Distance Field texture.\n// There are many external resources about SDFs and text rendering in WebGL, including:\n// https://steamcdn-a.akamaihd.net/apps/valve/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\n// https://blog.mapbox.com/drawing-text-with-signed-distance-fields-in-mapbox-gl-b0933af6f817\n// http://hack.chrons.me/opengl-text-rendering/\n// https://stackoverflow.com/questions/25956272/better-quality-text-in-webgl\n//\n// Approach\n// ========\n// Characters from the font are measured using a <canvas> and the SDFs are drawn into a texture up front\n// (and whenever new characters are being rendered). Then one instanced draw call is made with an instance\n// per character which reads from the corresponding place in the texture atlas.\n//\n// Possible future improvements\n// ============================\n// - Allow customization of font style, maybe highlight ranges.\n// - Consider a solid rectangular background instead of an outline. This is challenging because the\n//   instances currently overlap, so there will be z-fighting, but might be possible using the stencil buffer and multiple draw calls.\n// - Somehow support kerning and more advanced font metrics. However, the web font APIs may not\n//   provide support for this. Some font info could be generated/stored offline, possibly including the atlas.\n// - Explore multi-channel SDFs.\n\ntype TextMarkerProps = TextMarker & {\n  billboard?: ?boolean,\n  highlightedIndices?: Array<number>,\n  highlightColor?: ?Color,\n};\ntype Props = {\n  ...CommonCommandProps,\n  children: $ReadOnlyArray<TextMarkerProps>,\n  autoBackgroundColor?: boolean,\n  scaleInvariantFontSize?: number,\n  resolution?: number,\n  alphabet?: string[],\n};\n\ntype CharacterLocations = {\n  [char: string]: {|\n    x: number,\n    y: number,\n    width: number,\n  |},\n};\n\n// Font size used in rendering the atlas. This is independent of the `scale` of the rendered text.\nconst MIN_RESOLUTION = 40;\nconst DEFAULT_RESOLUTION = 160;\nconst MAX_ATLAS_WIDTH = 512;\nconst SDF_RADIUS = 8;\nconst CUTOFF = 0.25;\nconst BUFFER = 10;\n\nconst BG_COLOR_LIGHT = Object.freeze({ r: 1, g: 1, b: 1, a: 1 });\nconst BG_COLOR_DARK = Object.freeze({ r: 0, g: 0, b: 0, a: 1 });\n\nconst memoizedCreateCanvas = memoizeOne((font) => {\n  const canvas = document.createElement(\"canvas\");\n  const ctx = canvas.getContext(\"2d\");\n  ctx.font = font;\n  return ctx;\n});\n\nconst hashMarkerPosition = (marker: TextMarker): string => {\n  const { x, y, z } = marker.pose.position;\n  // The hash is a simple string with all three components\n  return `x${x}y${y}z${z}`;\n};\n\nconst getMarkerYOffset = (offsets: Map<string, number>, marker: TextMarker) => {\n  return offsets.get(hashMarkerPosition(marker)) || 0;\n};\n\nconst setMarkerYOffset = (offsets: Map<string, number>, marker: TextMarker, yOffset: number) => {\n  offsets.set(hashMarkerPosition(marker), yOffset);\n};\n\n// Build a single font atlas: a texture containing all characters and position/size data for each character.\nconst createMemoizedBuildAtlas = () =>\n  memoizeOne(\n    // We update charSet mutably but monotonically. Pass in the size to invalidate the cache.\n    (charSet: Set<string>, _setSize, resolution: number, atlasTexture: any): CharacterLocations => {\n      const tinySDF = new TinySDF(resolution, BUFFER, SDF_RADIUS, CUTOFF, \"sans-serif\", \"normal\");\n      const ctx = memoizedCreateCanvas(`${resolution}px sans-serif`);\n\n      let textureWidth = 0;\n      const rowHeight = resolution + 2 * BUFFER;\n      const charInfo = {};\n\n      // Measure and assign positions to all characters\n      let x = 0;\n      let y = 0;\n      for (const char of charSet) {\n        const width = ctx.measureText(char).width;\n        const dx = Math.ceil(width) + 2 * BUFFER;\n        if (x + dx > MAX_ATLAS_WIDTH) {\n          x = 0;\n          y += rowHeight;\n        }\n        charInfo[char] = { x, y, width };\n        x += dx;\n        textureWidth = Math.max(textureWidth, x);\n      }\n\n      const textureHeight = y + rowHeight;\n      const textureData = new Uint8Array(textureWidth * textureHeight);\n\n      // Use tiny-sdf to create SDF images for each character and copy them into a single texture\n      for (const char of charSet) {\n        const { x, y } = charInfo[char];\n        const data = tinySDF.draw(char);\n        for (let i = 0; i < tinySDF.size; i++) {\n          for (let j = 0; j < tinySDF.size; j++) {\n            // if this character is near the right edge, we don't actually copy the whole square of data\n            if (x + j < textureWidth) {\n              textureData[textureWidth * (y + i) + x + j] = data[i * tinySDF.size + j];\n            }\n          }\n        }\n      }\n\n      atlasTexture({\n        data: textureData,\n        width: textureWidth,\n        height: textureHeight,\n        format: \"alpha\",\n        wrap: \"clamp\",\n        mag: \"linear\",\n        min: \"linear\",\n      });\n      return charInfo;\n    }\n  );\n\nconst vert = `\n  precision mediump float;\n\n  uniform mat4 projection, view, billboardRotation;\n  uniform float fontSize;\n  uniform vec2 atlasSize;\n  uniform bool scaleInvariant;\n  uniform float scaleInvariantSize;\n  uniform float viewportHeight;\n  uniform float viewportWidth;\n  uniform bool isPerspective;\n  uniform float cameraFovY;\n\n  // per-vertex attributes\n  attribute vec2 texCoord;\n  attribute vec2 position;\n\n  // per-instance (character) attributes\n  attribute vec2 srcOffset;\n  attribute float srcWidth;\n  attribute vec2 destOffset;\n\n  // per-marker attributes\n  attribute vec3 scale;\n  attribute float billboard;\n  attribute vec2 alignmentOffset;\n  attribute float enableBackground;\n  attribute float enableHighlight;\n  attribute vec4 foregroundColor;\n  attribute vec4 backgroundColor;\n  attribute vec4 highlightColor;\n  attribute vec3 posePosition;\n  attribute vec4 poseOrientation;\n\n  varying vec2 vTexCoord;\n  varying float vEnableBackground;\n  varying vec4 vForegroundColor;\n  varying vec4 vBackgroundColor;\n  varying vec4 vHighlightColor;\n  varying float vEnableHighlight;\n  varying float vBillboard;\n\n  // rotate a 3d point v by a rotation quaternion q\n  // like applyPose(), but we need to use a custom per-instance pose\n  vec3 rotate(vec3 v, vec4 q) {\n    vec3 temp = cross(q.xyz, v) + q.w * v;\n    return v + (2.0 * cross(q.xyz, temp));\n  }\n\n  vec4 computeVertexPosition(vec3 markerPos) {\n    vec3 pos;\n    if (billboard == 1.0) {\n      pos = (billboardRotation * vec4(markerPos, 1.0)).xyz + posePosition;\n    } else {\n      pos = rotate(markerPos, poseOrientation) + posePosition;\n    }\n    return projection * view * vec4(pos, 1.0);\n  }\n\n  void main () {\n    // Scale invariance only works for billboards\n    bool scaleInvariantEnabled = scaleInvariant && billboard == 1.0;\n\n    vec2 srcSize = vec2(srcWidth, fontSize);\n    vec3 markerSpacePos = vec3((destOffset + position * srcSize + alignmentOffset) / fontSize, 0);\n\n    if (!scaleInvariantEnabled) {\n      // Apply marker scale only when scale invariance is disabled\n      markerSpacePos *= scale;\n    } else {\n      // If scale invariance is enabled, the text will be rendered at a constant\n      // scale regardless of the zoom level.\n      // The given scaleInvariantSize is in pixels. We need to scale it based on\n      // the current canvas resolution to get the proper dimensions later in NDC\n      float scaleInvariantFactor = scaleInvariantSize / viewportHeight;\n      if (isPerspective) {\n        // When using a perspective projection, the effect is achieved by using\n        // the w-component for scaling, which is obtained by first projecting\n        // the marker position into clip space.\n        gl_Position = computeVertexPosition(markerSpacePos);\n        scaleInvariantFactor *= gl_Position.w;\n        // We also need to take into account the camera's half vertical FOV\n        scaleInvariantFactor *= cameraFovY;\n      } else {\n        // Compute inverse aspect ratio\n        float invAspect = viewportHeight / viewportWidth;\n        // When using orthographic projection, the scaling factor is obtain from\n        // the camera projection itself.\n        // We also need applied the inverse aspect ratio\n        scaleInvariantFactor *= 2.0 * invAspect / length(projection[0].xyz);\n      }\n      // Apply scale invariant factor\n      markerSpacePos *= scaleInvariantFactor;\n    }\n\n    // Compute final vertex position\n    gl_Position = computeVertexPosition(markerSpacePos);\n\n    vTexCoord = (srcOffset + texCoord * srcSize) / atlasSize;\n    vEnableBackground = enableBackground;\n    vForegroundColor = foregroundColor;\n    vBackgroundColor = backgroundColor;\n    vHighlightColor = highlightColor;\n    vEnableHighlight = enableHighlight;\n    vBillboard = billboard;\n  }\n`;\n\nconst frag = `\n  #extension GL_OES_standard_derivatives : enable\n  precision mediump float;\n  uniform mat4 projection;\n  uniform sampler2D atlas;\n  uniform float cutoff;\n  uniform bool scaleInvariant;\n  uniform float scaleInvariantSize;\n  uniform bool isHitmap;\n\n  varying vec2 vTexCoord;\n  varying float vEnableBackground;\n  varying vec4 vForegroundColor;\n  varying vec4 vBackgroundColor;\n  varying vec4 vHighlightColor;\n  varying float vEnableHighlight;\n  varying float vBillboard;\n\n  void main() {\n    float dist = texture2D(atlas, vTexCoord).a;\n\n    // fwidth(dist) is used to provide some anti-aliasing. However it's currently only used\n    // when the solid background is enabled, because the alpha blending and\n    // depth test don't work together nicely for partially-transparent pixels.\n    float edgeStep = smoothstep(1.0 - cutoff - fwidth(dist), 1.0 - cutoff, dist);\n\n    if (scaleInvariant && vBillboard == 1.0 && scaleInvariantSize <= 20.0) {\n      // If scale invariant is enabled and scaleInvariantSize is \"too small\", do not interpolate\n      // the raw distance value since at such small scale, the SDF approach causes some\n      // visual artifacts.\n      // The value used for checking if scaleInvariantSize is \"too small\" is arbitrary and\n      // was defined after some experimentation.\n      edgeStep = dist;\n    }\n\n    if (isHitmap) {\n      // When rendering for the hitmap buffer, we draw flat polygons using the foreground color\n      // instead of the actual glyphs. This way we increase the selection range and provide a\n      // better user experience.\n      gl_FragColor = vForegroundColor;\n    } else if (vEnableHighlight > 0.5) {\n      gl_FragColor = mix(vHighlightColor, vec4(0, 0, 0, 1), edgeStep);\n    } else if (vEnableBackground > 0.5) {\n      gl_FragColor = mix(vBackgroundColor, vForegroundColor, edgeStep);\n    } else {\n      gl_FragColor = vForegroundColor;\n      gl_FragColor.a *= edgeStep;\n    }\n\n    if (gl_FragColor.a == 0.) {\n      discard;\n    }\n  }\n`;\n\nfunction makeTextCommand(alphabet?: string[]) {\n  // Keep the set of rendered characters around so we don't have to rebuild the font atlas too often.\n  const charSet = new Set(alphabet || []);\n  const memoizedBuildAtlas = createMemoizedBuildAtlas();\n\n  const command = (regl: any) => {\n    const atlasTexture = regl.texture();\n\n    const drawText = regl({\n      // When using scale invariance, we want the text to be drawn on top\n      // of other elements. This is achieved by disabling depth testing\n      // In addition, make sure the <GLText /> command is the last one\n      // being rendered.\n      depth: {\n        enable: (ctx, props) => (props.scaleInvariant ? false : defaultDepth.enable(ctx, props)),\n        mask: (ctx, props) => (props.scaleInvariant ? false : defaultDepth.mask(ctx, props)),\n      },\n      blend: defaultBlend,\n      primitive: \"triangle strip\",\n      vert,\n      frag,\n      uniforms: {\n        atlas: atlasTexture,\n        atlasSize: () => [atlasTexture.width, atlasTexture.height],\n        fontSize: regl.prop(\"resolution\"),\n        cutoff: CUTOFF,\n        scaleInvariant: regl.prop(\"scaleInvariant\"),\n        scaleInvariantSize: regl.prop(\"scaleInvariantSize\"),\n        isHitmap: regl.prop(\"isHitmap\"),\n        viewportHeight: regl.context(\"viewportHeight\"),\n        viewportWidth: regl.context(\"viewportWidth\"),\n        isPerspective: regl.context(\"isPerspective\"),\n        cameraFovY: regl.context(\"fovy\"),\n      },\n      instances: regl.prop(\"instances\"),\n      count: 4,\n      attributes: {\n        position: [[0, 0], [0, -1], [1, 0], [1, -1]],\n        texCoord: [[0, 0], [0, 1], [1, 0], [1, 1]], // flipped\n        srcOffset: (ctx, props) => ({ buffer: props.srcOffsets, divisor: 1 }),\n        destOffset: (ctx, props) => ({ buffer: props.destOffsets, divisor: 1 }),\n        srcWidth: (ctx, props) => ({ buffer: props.srcWidths, divisor: 1 }),\n        scale: (ctx, props) => ({ buffer: props.scale, divisor: 1 }),\n        alignmentOffset: (ctx, props) => ({ buffer: props.alignmentOffset, divisor: 1 }),\n        billboard: (ctx, props) => ({ buffer: props.billboard, divisor: 1 }),\n        foregroundColor: (ctx, props) => ({ buffer: props.foregroundColor, divisor: 1 }),\n        backgroundColor: (ctx, props) => ({ buffer: props.backgroundColor, divisor: 1 }),\n        highlightColor: (ctx, props) => ({ buffer: props.highlightColor, divisor: 1 }),\n        enableBackground: (ctx, props) => ({ buffer: props.enableBackground, divisor: 1 }),\n        enableHighlight: (ctx, props) => ({ buffer: props.enableHighlight, divisor: 1 }),\n        posePosition: (ctx, props) => ({ buffer: props.posePosition, divisor: 1 }),\n        poseOrientation: (ctx, props) => ({ buffer: props.poseOrientation, divisor: 1 }),\n      },\n    });\n\n    return (props: $ReadOnlyArray<TextMarkerProps>, isHitmap: boolean) => {\n      let estimatedInstances = 0;\n      for (const { text } of props) {\n        if (typeof text !== \"string\") {\n          throw new Error(`Expected typeof 'text' to be a string. But got type '${typeof text}' instead.`);\n        }\n\n        for (const char of text) {\n          ++estimatedInstances;\n          charSet.add(char);\n        }\n      }\n      const charInfo = memoizedBuildAtlas(charSet, charSet.size, command.resolution, atlasTexture);\n\n      const destOffsets = new Float32Array(estimatedInstances * 2);\n      const srcWidths = new Float32Array(estimatedInstances);\n      const srcOffsets = new Float32Array(estimatedInstances * 2);\n\n      // These don't vary across characters within a marker, but the divisor can't be dynamic so we have to duplicate the data for each character.\n      const alignmentOffset = new Float32Array(estimatedInstances * 2);\n      const scale = new Float32Array(estimatedInstances * 3);\n      const foregroundColor = new Float32Array(estimatedInstances * 4);\n      const backgroundColor = new Float32Array(estimatedInstances * 4);\n      const highlightColor = new Float32Array(estimatedInstances * 4);\n      const enableBackground = new Float32Array(estimatedInstances);\n      const billboard = new Float32Array(estimatedInstances);\n      const posePosition = new Float32Array(estimatedInstances * 3);\n      const poseOrientation = new Float32Array(estimatedInstances * 4);\n      const enableHighlight = new Float32Array(estimatedInstances);\n\n      let totalInstances = 0;\n\n      // Markers sharing the same position will be rendered in multiple lines.\n      // We keep track of offsets for the y-coordinate.\n      // We cannot use same value comparison here, so the\n      // key of the map is a hash based on the marker's position\n      // (see hashMarkerPosition() above).\n      const yOffsets = new Map<string, number>();\n\n      for (const marker of props) {\n        let totalWidth = 0;\n        let x = 0;\n        let y = getMarkerYOffset(yOffsets, marker);\n        let markerInstances = 0;\n        let lineCount = 1; // every text has at least one line\n\n        // If we need to render text for hitmap framebuffer, we only render the polygons using\n        // the foreground color (which needs to be converted to RGBA since it's a vec4).\n        // See comment on fragment shader above\n        const fgColor = toColor(\n          isHitmap ? marker.color || [0, 0, 0, 1] : marker.colors?.[0] || marker.color || BG_COLOR_LIGHT\n        );\n        const outline = marker.colors?.[1] != null || command.autoBackgroundColor;\n        const bgColor = toColor(\n          marker.colors?.[1] || (command.autoBackgroundColor && isColorDark(fgColor) ? BG_COLOR_LIGHT : BG_COLOR_DARK)\n        );\n        const hlColor = marker?.highlightColor || { r: 1, b: 0, g: 1, a: 1 };\n\n        for (let i = 0; i < marker.text.length; i++) {\n          const char = marker.text[i];\n          if (char === \"\\n\") {\n            x = 0;\n            // Make sure every line in the text is offsetted correctly\n            y += command.resolution;\n            lineCount++;\n            continue;\n          }\n          const info = charInfo[char];\n          const index = totalInstances + markerInstances;\n\n          // Calculate per-character attributes\n          destOffsets[2 * index + 0] = x;\n          destOffsets[2 * index + 1] = -y;\n          srcOffsets[2 * index + 0] = info.x + BUFFER;\n          // In order to make sure there's enough room for glyphs' descenders (i.e. 'g'),\n          // we need to apply an extra offset based on the font resolution.\n          // The value used to compute the offset is a result of experimentation.\n          srcOffsets[2 * index + 1] = info.y + BUFFER + 0.05 * command.resolution;\n          srcWidths[index] = info.width;\n\n          x += info.width;\n          totalWidth = Math.max(totalWidth, x);\n\n          // Copy per-marker attributes. These are duplicated per character so that we can draw\n          // all characters from all markers in a single draw call.\n\n          billboard[index] = marker.billboard ?? true ? 1 : 0;\n\n          scale[3 * index + 0] = marker.scale.x;\n          scale[3 * index + 1] = marker.scale.y;\n          scale[3 * index + 2] = marker.scale.z;\n\n          posePosition[3 * index + 0] = marker.pose.position.x;\n          posePosition[3 * index + 1] = marker.pose.position.y;\n          posePosition[3 * index + 2] = marker.pose.position.z;\n\n          poseOrientation[4 * index + 0] = marker.pose.orientation.x;\n          poseOrientation[4 * index + 1] = marker.pose.orientation.y;\n          poseOrientation[4 * index + 2] = marker.pose.orientation.z;\n          poseOrientation[4 * index + 3] = marker.pose.orientation.w;\n\n          foregroundColor[4 * index + 0] = fgColor.r;\n          foregroundColor[4 * index + 1] = fgColor.g;\n          foregroundColor[4 * index + 2] = fgColor.b;\n          foregroundColor[4 * index + 3] = fgColor.a;\n\n          backgroundColor[4 * index + 0] = bgColor.r;\n          backgroundColor[4 * index + 1] = bgColor.g;\n          backgroundColor[4 * index + 2] = bgColor.b;\n          backgroundColor[4 * index + 3] = bgColor.a;\n\n          highlightColor[4 * index + 0] = hlColor.r;\n          highlightColor[4 * index + 1] = hlColor.g;\n          highlightColor[4 * index + 2] = hlColor.b;\n          highlightColor[4 * index + 3] = hlColor.a;\n\n          enableHighlight[index] = marker.highlightedIndices && marker.highlightedIndices.includes(i) ? 1 : 0;\n\n          enableBackground[index] = outline ? 1 : 0;\n\n          ++markerInstances;\n        }\n\n        const totalHeight = y + command.resolution;\n        for (let i = 0; i < markerInstances; i++) {\n          alignmentOffset[2 * (totalInstances + i) + 0] = -totalWidth / 2;\n          alignmentOffset[2 * (totalInstances + i) + 1] = totalHeight / 2;\n        }\n\n        // Compute the y-coordinate's offset for the next overlapped marker, if any.\n        // Basically, we add as many offsets as numbers of lines in the marker's text.\n        // Since the y-coordinate is inverted when computing destOffset[] a few lines above\n        // we need an additional command.resolution offset (precomputed in totalHeight).\n        setMarkerYOffset(yOffsets, marker, totalHeight + lineCount * command.resolution);\n\n        totalInstances += markerInstances;\n      }\n\n      drawText({\n        instances: totalInstances,\n\n        isHitmap: !!isHitmap,\n        scaleInvariant: command.scaleInvariant,\n        resolution: command.resolution,\n        scaleInvariantSize: command.scaleInvariantSize,\n\n        // per-character\n        srcOffsets,\n        destOffsets,\n        srcWidths,\n\n        // per-marker\n        alignmentOffset,\n        billboard,\n        enableBackground,\n        enableHighlight,\n        foregroundColor,\n        backgroundColor,\n        highlightColor,\n        poseOrientation,\n        posePosition,\n        scale,\n      });\n    };\n  };\n  command.autoBackgroundColor = false;\n  return command;\n}\n\nexport default function GLText(props: Props) {\n  const [command] = useState(() => makeTextCommand(props.alphabet));\n  // HACK: Worldview doesn't provide an easy way to pass a command-level prop into the regl commands,\n  // so just attach it to the command object for now.\n  command.autoBackgroundColor = props.autoBackgroundColor;\n  command.resolution = Math.max(MIN_RESOLUTION, props.resolution || DEFAULT_RESOLUTION);\n  command.scaleInvariant = props.scaleInvariantFontSize != null;\n  command.scaleInvariantSize = props.scaleInvariantFontSize ?? 0;\n  const getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\n\n  return <Command getChildrenForHitmap={getChildrenForHitmap} reglCommand={command} {...props} />;\n}\n","// @flow\n\n//  Copyright (c) 2019-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat4 } from \"gl-matrix\";\nimport memoizeWeak from \"memoize-weak\";\nimport React, { useContext, useState, useEffect, useCallback, useDebugValue } from \"react\";\n\nimport type { Pose, Scale, MouseHandler } from \"../types\";\nimport { defaultBlend, pointToVec3, orientationToVec4 } from \"../utils/commandUtils\";\nimport { getChildrenForHitmapWithOriginalMarker } from \"../utils/getChildrenForHitmapDefaults\";\nimport parseGLB, { type GLBModel } from \"../utils/parseGLB\";\nimport WorldviewReactContext from \"../WorldviewReactContext\";\nimport Command from \"./Command\";\n\nfunction glConstantToRegl(value: ?number): ?string {\n  if (value === undefined) {\n    return undefined;\n  }\n  // prettier-ignore\n  switch (value) {\n    // min/mag filters\n    case WebGLRenderingContext.NEAREST: return \"nearest\";\n    case WebGLRenderingContext.LINEAR: return \"linear\";\n    case WebGLRenderingContext.NEAREST_MIPMAP_NEAREST: return \"nearest mipmap nearest\";\n    case WebGLRenderingContext.NEAREST_MIPMAP_LINEAR: return \"nearest mipmap linear\";\n    case WebGLRenderingContext.LINEAR_MIPMAP_NEAREST: return \"linear mipmap nearest\";\n    case WebGLRenderingContext.LINEAR_MIPMAP_LINEAR: return \"linear mipmap linear\";\n    // texture wrapping modes\n    case WebGLRenderingContext.REPEAT: return \"repeat\";\n    case WebGLRenderingContext.CLAMP_TO_EDGE: return \"clamp\";\n    case WebGLRenderingContext.MIRRORED_REPEAT: return \"mirror\";\n  }\n  throw new Error(`unhandled constant value ${JSON.stringify(value)}`);\n}\n\nconst drawModel = (regl) => {\n  const command = regl({\n    primitive: \"triangles\",\n    blend: defaultBlend,\n    uniforms: {\n      globalAlpha: regl.context(\"globalAlpha\"),\n      poseMatrix: regl.context(\"poseMatrix\"),\n\n      baseColorTexture: regl.prop(\"baseColorTexture\"),\n      baseColorFactor: regl.prop(\"baseColorFactor\"),\n      nodeMatrix: regl.prop(\"nodeMatrix\"),\n      \"light.direction\": [0, 0, -1],\n      \"light.ambientIntensity\": 0.5,\n      \"light.diffuseIntensity\": 0.5,\n      hitmapColor: regl.context(\"hitmapColor\"),\n      isHitmap: regl.context(\"isHitmap\"),\n    },\n    attributes: {\n      position: regl.prop(\"positions\"),\n      normal: regl.prop(\"normals\"),\n      texCoord: regl.prop(\"texCoords\"),\n    },\n    elements: regl.prop(\"indices\"),\n    vert: `\n  uniform mat4 projection, view;\n  uniform mat4 nodeMatrix;\n  uniform mat4 poseMatrix;\n  attribute vec3 position, normal;\n  varying vec3 vNormal;\n  attribute vec2 texCoord;\n  varying vec2 vTexCoord;\n\n  void main() {\n    // using the projection matrix for normals breaks lighting for orthographic mode\n    mat4 mv = view * poseMatrix * nodeMatrix;\n    vNormal = normalize((mv * vec4(normal, 0)).xyz);\n    vTexCoord = texCoord;\n    gl_Position = projection * mv * vec4(position, 1);\n  }\n  `,\n    frag: `\n  precision mediump float;\n  uniform bool isHitmap;\n  uniform vec4 hitmapColor;\n  uniform float globalAlpha;\n  uniform sampler2D baseColorTexture;\n  uniform vec4 baseColorFactor;\n  varying mediump vec2 vTexCoord;\n  varying mediump vec3 vNormal;\n\n  // Basic directional lighting from:\n  // http://ogldev.atspace.co.uk/www/tutorial18/tutorial18.html\n  struct DirectionalLight {\n    mediump vec3 direction;\n    lowp float ambientIntensity;\n    lowp float diffuseIntensity;\n  };\n  uniform DirectionalLight light;\n\n  void main() {\n    vec4 baseColor = texture2D(baseColorTexture, vTexCoord) * baseColorFactor;\n    float diffuse = light.diffuseIntensity * max(0.0, dot(vNormal, -light.direction));\n    gl_FragColor = isHitmap ? hitmapColor : vec4((light.ambientIntensity + diffuse) * baseColor.rgb, baseColor.a * globalAlpha);\n  }\n  `,\n  });\n\n  // default values for when baseColorTexture is not specified\n  const singleTexCoord = regl.buffer([0, 0]);\n  const whiteTexture = regl.texture({\n    data: [255, 255, 255, 255],\n    width: 1,\n    height: 1,\n  });\n\n  // build the draw calls needed to draw the model. This will happen whenever the model changes.\n  const getDrawCalls = memoizeWeak((model: GLBModel) => {\n    // upload textures to the GPU\n    const { accessors } = model;\n    const textures =\n      model.json.textures &&\n      model.json.textures.map((textureInfo) => {\n        const sampler = model.json.samplers[textureInfo.sampler];\n        const bitmap = model.images && model.images[textureInfo.source];\n        const texture = regl.texture({\n          data: bitmap,\n          min: glConstantToRegl(sampler.minFilter),\n          mag: glConstantToRegl(sampler.magFilter),\n          wrapS: glConstantToRegl(sampler.wrapS),\n          wrapT: glConstantToRegl(sampler.wrapT),\n        });\n        return texture;\n      });\n    if (model.images) {\n      model.images.forEach((bitmap: ImageBitmap) => bitmap.close());\n    }\n\n    const drawCalls = [];\n    // helper to draw the primitives comprising a mesh\n    function drawMesh(mesh, nodeMatrix) {\n      for (const primitive of mesh.primitives) {\n        const material = model.json.materials[primitive.material];\n        const texInfo = material.pbrMetallicRoughness.baseColorTexture;\n        if (!accessors) {\n          throw new Error(\"Error decoding GLB model: Missing `accessors` in JSON data\");\n        }\n        drawCalls.push({\n          indices: accessors[primitive.indices],\n          positions: accessors[primitive.attributes.POSITION],\n          normals: accessors[primitive.attributes.NORMAL],\n          texCoords: texInfo\n            ? accessors[primitive.attributes[`TEXCOORD_${texInfo.texCoord || 0}`]]\n            : { divisor: 1, buffer: singleTexCoord },\n          baseColorTexture: texInfo ? textures[texInfo.index] : whiteTexture,\n          baseColorFactor: material.pbrMetallicRoughness.baseColorFactor || [1, 1, 1, 1],\n          nodeMatrix,\n        });\n      }\n    }\n\n    // helper to draw all the meshes contained in a node and its child nodes\n    function drawNode(node, parentMatrix) {\n      const nodeMatrix = node.matrix\n        ? mat4.clone(node.matrix)\n        : mat4.fromRotationTranslationScale(\n            mat4.create(),\n            node.rotation || [0, 0, 0, 1],\n            node.translation || [0, 0, 0],\n            node.scale || [1, 1, 1]\n          );\n      mat4.mul(nodeMatrix, parentMatrix, nodeMatrix);\n      if (node.mesh != null) {\n        drawMesh(model.json.meshes[node.mesh], nodeMatrix);\n      }\n      if (node.children) {\n        for (const childIdx of node.children) {\n          drawNode(model.json.nodes[childIdx], nodeMatrix);\n        }\n      }\n    }\n\n    // finally, draw each of the main scene's nodes\n    for (const nodeIdx of model.json.scenes[model.json.scene].nodes) {\n      const rootTransform = mat4.create();\n      mat4.rotateX(rootTransform, rootTransform, Math.PI / 2);\n      mat4.rotateY(rootTransform, rootTransform, Math.PI / 2);\n      drawNode(model.json.nodes[nodeIdx], rootTransform);\n    }\n    return drawCalls;\n  });\n\n  // create a regl command to set the context for each draw call\n  const withContext = regl({\n    context: {\n      poseMatrix: (context, props) =>\n        mat4.fromRotationTranslationScale(\n          mat4.create(),\n          orientationToVec4(props.pose.orientation),\n          pointToVec3(props.pose.position),\n          props.scale ? pointToVec3(props.scale) : [1, 1, 1]\n        ),\n      globalAlpha: (context, props) => (props.alpha == null ? 1 : props.alpha),\n      hitmapColor: (context, props) => props.color || [0, 0, 0, 1],\n      isHitmap: (context, props) => !!props.isHitmap,\n    },\n  });\n\n  return (props, isHitmap) => {\n    const drawCalls = getDrawCalls(props.model);\n    withContext(isHitmap ? { ...props, isHitmap } : props, () => {\n      command(drawCalls);\n    });\n  };\n};\n\ntype Props = {|\n  model: string | (() => Promise<GLBModel>),\n  onClick?: MouseHandler,\n  onDoubleClick?: MouseHandler,\n  onMouseDown?: MouseHandler,\n  onMouseMove?: MouseHandler,\n  onMouseUp?: MouseHandler,\n  children: {\n    pose: Pose,\n    scale: Scale,\n    alpha?: ?number,\n  },\n|};\n\nfunction useAsyncValue<T>(fn: () => Promise<T>, deps: ?(any[])): ?T {\n  const [value, setValue] = useState<?T>();\n  useEffect(\n    useCallback(() => {\n      let unloaded = false;\n      fn().then((result) => {\n        if (!unloaded) {\n          setValue(result);\n        }\n      });\n      return () => {\n        unloaded = true;\n        setValue(undefined);\n      };\n    }, deps || [fn]),\n    deps || [fn]\n  );\n  return value;\n}\n\nfunction useModel(model: string | (() => Promise<GLBModel>)): ?GLBModel {\n  useDebugValue(model);\n  return useAsyncValue(\n    async () => {\n      if (typeof model === \"function\") {\n        return model();\n      }\n      if (typeof model === \"string\") {\n        const response = await fetch(model);\n        if (!response.ok) {\n          throw new Error(`failed to fetch GLTF model: ${response.status}`);\n        }\n        return parseGLB(await response.arrayBuffer());\n      }\n\n      /*:: (model: empty) */\n      throw new Error(`unsupported model prop: ${typeof model}`);\n    },\n    [model]\n  );\n}\n\nexport default function GLTFScene(props: Props) {\n  const { children, model, ...rest } = props;\n\n  const context = useContext(WorldviewReactContext);\n  const loadedModel = useModel(model);\n  useEffect(\n    () => {\n      if (context) {\n        context.onDirty();\n      }\n    },\n    [context, loadedModel]\n  );\n\n  if (!loadedModel) {\n    return null;\n  }\n\n  return (\n    <Command {...rest} reglCommand={drawModel} getChildrenForHitmap={getChildrenForHitmapWithOriginalMarker}>\n      {{ ...children, model: loadedModel, originalMarker: children }}\n    </Command>\n  );\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { PointType, Regl } from \"../types\";\nimport { getVertexColors, pointToVec3, withPose } from \"../utils/commandUtils\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nconst points = (regl: Regl) => {\n  const [min, max] = regl.limits.pointSizeDims;\n  return withPose({\n    primitive: \"points\",\n    vert: `\n    precision mediump float;\n\n    #WITH_POSE\n\n    uniform mat4 projection, view;\n    uniform float pointSize;\n\n    attribute vec3 point;\n    attribute vec4 color;\n    varying vec4 fragColor;\n    void main () {\n      gl_PointSize = pointSize;\n      vec3 pos = applyPose(point);\n      gl_Position = projection * view * vec4(pos, 1);\n      fragColor = color;\n    }\n    `,\n    frag: `\n    precision mediump float;\n    varying vec4 fragColor;\n    void main () {\n      gl_FragColor = vec4(fragColor.x, fragColor.y, fragColor.z, 1);\n    }\n    `,\n    attributes: {\n      point: (context, props) => {\n        return props.points.map((point) => (Array.isArray(point) ? point : pointToVec3(point)));\n      },\n      color: (context, props) => {\n        const colors = getVertexColors(props);\n        return colors;\n      },\n    },\n\n    uniforms: {\n      pointSize: (context, props) => {\n        const size = props.scale.x || 1;\n        return Math.min(max, Math.max(min, size));\n      },\n    },\n\n    count: regl.prop(\"points.length\"),\n  });\n};\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Points(props: { ...CommonCommandProps, children: PointType[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={points} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nclass BoundingBox {\n  left: number;\n  right: number;\n  top: number;\n  bottom: number;\n  width: number;\n  height: number;\n\n  constructor(left: number, top: number) {\n    this.left = left;\n    this.top = top;\n    this.right = -left;\n    this.bottom = -top;\n    this.width = Math.abs(left) * 2;\n    this.height = Math.abs(top) * 2;\n  }\n}\n\nexport default function getOrthographicBounds(zDistance: number, width: number, height: number): BoundingBox {\n  const aspect = width / height;\n  // never go below ground level\n  const distanceToGround = Math.abs(zDistance);\n  const left = (-distanceToGround / 2) * aspect;\n  const top = distanceToGround / 2;\n  return new BoundingBox(left, top);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n// Copied from Jam3/camera-project\n// in order to replace gl-vec4 dependency with gl-matrix\n\nimport { vec4 } from \"gl-matrix\";\n\nimport type { Vec3, Vec4, Mat4 } from \"../types\";\n\nconst NEAR_RANGE = 0;\nconst FAR_RANGE = 1;\nconst tmp4 = [0, 0, 0, 0];\n\nexport default function cameraProject(out: any, vec: Vec3, viewport: Vec4, combinedProjView: Mat4): Vec4 {\n  const vX = viewport[0],\n    vY = viewport[1],\n    vWidth = viewport[2],\n    vHeight = viewport[3],\n    n = NEAR_RANGE,\n    f = FAR_RANGE;\n\n  // convert: clip space -> NDC -> window coords\n  // implicit 1.0 for w component\n  vec4.set(tmp4, vec[0], vec[1], vec[2], 1.0);\n\n  // transform into clip space\n  vec4.transformMat4(tmp4, tmp4, combinedProjView);\n\n  // now transform into NDC\n  const w = tmp4[3];\n  if (w !== 0) {\n    // how to handle infinity here?\n    tmp4[0] = tmp4[0] / w;\n    tmp4[1] = tmp4[1] / w;\n    tmp4[2] = tmp4[2] / w;\n  }\n\n  // and finally into window coordinates\n  // the foruth component is (1/clip.w)\n  // which is the same as gl_FragCoord.w\n  out[0] = vX + (vWidth / 2) * tmp4[0] + (0 + vWidth / 2);\n  out[1] = vY + (vHeight / 2) * tmp4[1] + (0 + vHeight / 2);\n  out[2] = ((f - n) / 2) * tmp4[2] + (f + n) / 2;\n  out[3] = w === 0 ? 0 : 1 / w;\n  return out;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, quat, mat4 } from \"gl-matrix\";\nimport { createSelector } from \"reselect\";\n\nimport type { CameraState, Vec4, Vec3, Mat4 } from \"../types\";\nimport { fromSpherical } from \"../utils/commandUtils\";\n\nconst UNIT_X_VECTOR = Object.freeze([1, 0, 0]);\n\n// reusable arrays for intermediate calculations\nconst TEMP_VEC3 = [0, 0, 0];\nconst TEMP_MAT = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\nconst TEMP_QUAT = [0, 0, 0, 0];\n\nconst stateSelector = (state: CameraState) => state;\n\nconst perspectiveSelector = createSelector(\n  stateSelector,\n  ({ perspective }) => perspective\n);\nconst distanceSelector = createSelector(\n  stateSelector,\n  ({ distance }) => distance\n);\nconst phiSelector = createSelector(\n  stateSelector,\n  ({ phi }) => phi\n);\nconst thetaOffsetSelector = createSelector(\n  stateSelector,\n  ({ thetaOffset }) => thetaOffset\n);\nconst targetOrientationSelector = createSelector(\n  stateSelector,\n  ({ targetOrientation }) => targetOrientation\n);\n\n// the heading direction of the target\nconst targetHeadingSelector: (CameraState) => number = createSelector(\n  targetOrientationSelector,\n  (targetOrientation) => {\n    const out = vec3.transformQuat(TEMP_VEC3, UNIT_X_VECTOR, targetOrientation);\n    const heading = -Math.atan2(out[1], out[0]);\n    return heading;\n  }\n);\n\n// orientation of the camera\nconst orientationSelector: (CameraState) => Vec4 = createSelector(\n  perspectiveSelector,\n  phiSelector,\n  thetaOffsetSelector,\n  (perspective, phi, thetaOffset) => {\n    const result = quat.identity([0, 0, 0, 0]);\n    quat.rotateZ(result, result, -thetaOffset);\n\n    // phi is ignored in 2D mode\n    if (perspective) {\n      quat.rotateX(result, result, phi);\n    }\n    return result;\n  }\n);\n\n// position of the camera\nconst positionSelector: (CameraState) => Vec3 = createSelector(\n  thetaOffsetSelector,\n  phiSelector,\n  distanceSelector,\n  (thetaOffset, phi, distance) => {\n    const position = fromSpherical([], distance, thetaOffset, phi);\n\n    // poles are on the y-axis in spherical coordinates; rearrange so they are on the z axis\n    const [x, y, z] = position;\n    position[0] = -x;\n    position[1] = -z;\n    position[2] = y;\n\n    return position;\n  }\n);\n\n/*\nGet the view matrix, which transforms points from world coordinates to camera coordinates.\n\nAn equivalent and easier way to think about this transformation is that it takes the camera from\nits actual position/orientation in the world, and moves it to have position=0,0,0 and orientation=0,0,0,1.\n\nWe build up this transformation in 5 steps as demonstrated below:\n   T = target\n   < = direction of target\n   * = target with offset (position that the camera is looking at)\n   C = camera (always points toward *)\n\nStarting point: actual positions in world coordinates\n\n  |      *\n  |  <T   C\n  |\n  +--------\n\nStep 1: translate target to the origin\n\n  |\n  |  *\n <T---C----\n\nStep 2: rotate around the origin so the target points forward\n(Here we use the target's heading only, ignoring other components of its rotation)\n\n  |\n  ^\n  T--------\n  |\n  | *\n  C\n\nStep 3: translate the target-with-offset point to be at the origin\n\n ^\n T|\n  |\n  *--------\n C|\n  |\n\n\nStep 4: translate the camera to be at the origin\n(Steps 3 and 4 are both translations, but they're kept separate because it's easier\nto conceptualize: 3 uses the targetOffset and 4 uses the distance+thetaOffset+phi.)\n\n ^\n T\n |\n |*\n C--------\n |\n\nStep 5: rotate the camera to point forward\n\n \\\n  T  |\n     *\n     C--------\n     |\n\n*/\nconst viewSelector: (CameraState) => Mat4 = createSelector(\n  stateSelector,\n  orientationSelector,\n  positionSelector,\n  targetHeadingSelector,\n  ({ target, targetOffset, perspective }, orientation, position, targetHeading) => {\n    const m = mat4.identity([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\n\n    // apply the steps described above in reverse because we use right-multiplication\n\n    // 5. rotate camera to point forward\n    mat4.multiply(m, m, mat4.fromQuat(TEMP_MAT, quat.invert(TEMP_QUAT, orientation)));\n\n    // 4. move camera to the origin\n    if (perspective) {\n      mat4.translate(m, m, vec3.negate(TEMP_VEC3, position));\n    }\n\n    // 3. move center to the origin\n    mat4.translate(m, m, vec3.negate(TEMP_VEC3, targetOffset));\n\n    // 2. rotate target to point forward\n    mat4.rotateZ(m, m, targetHeading);\n\n    // 1. move target to the origin\n    vec3.negate(TEMP_VEC3, target);\n    if (!perspective) {\n      // if using orthographic camera ensure the distance from \"ground\"\n      // stays large so no reasonably tall item goes past the camera\n      TEMP_VEC3[2] = -2500;\n    }\n    mat4.translate(m, m, TEMP_VEC3);\n\n    return m;\n  }\n);\n\nconst billboardRotation: (CameraState) => Mat4 = createSelector(\n  orientationSelector,\n  targetHeadingSelector,\n  (orientation, targetHeading) => {\n    const m = mat4.identity(mat4.create());\n    mat4.rotateZ(m, m, -targetHeading);\n    mat4.multiply(m, m, mat4.fromQuat(TEMP_MAT, orientation));\n    return m;\n  }\n);\n\nexport default {\n  orientation: orientationSelector,\n  position: positionSelector,\n  targetHeading: targetHeadingSelector,\n  view: viewSelector,\n  billboardRotation,\n};\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, quat } from \"gl-matrix\";\n\nimport type { Vec2, Vec3, Vec4 } from \"../types\";\nimport selectors from \"./cameraStateSelectors\";\n\nexport type CameraState = {|\n  distance: number,\n  perspective: boolean,\n  phi: number,\n  target: Vec3,\n  targetOffset: Vec3,\n  targetOrientation: Vec4,\n  thetaOffset: number,\n  fovy: number,\n  near: number,\n  far: number,\n|};\n\n//  we use up on the +z axis\nconst UNIT_Z_VECTOR = Object.freeze([0, 0, 1]);\n// reusable array for intermediate calculations\nconst TEMP_QUAT = [0, 0, 0, 0];\n\nexport const DEFAULT_CAMERA_STATE: CameraState = {\n  distance: 75,\n  perspective: true,\n  phi: Math.PI / 4,\n  target: [0, 0, 0],\n  targetOffset: [0, 0, 0],\n  targetOrientation: [0, 0, 0, 1],\n  thetaOffset: 0,\n  fovy: Math.PI / 4,\n  near: 0.01,\n  far: 5000,\n};\n\nfunction distanceAfterZoom(startingDistance: number, zoomPercent: number): number {\n  // keep distance above 0 so that percentage-based zoom always works\n  return Math.max(0.001, startingDistance * (1 - zoomPercent / 100));\n}\n\nexport default class CameraStore {\n  state: CameraState;\n\n  _onChange: (CameraState) => void;\n\n  constructor(\n    handler: (CameraState) => void = () => {},\n    initialCameraState: $Shape<CameraState> = DEFAULT_CAMERA_STATE\n  ) {\n    this._onChange = handler;\n    this.setCameraState(initialCameraState);\n  }\n\n  setCameraState = (state: $Shape<CameraState>) => {\n    // Fill in missing properties from DEFAULT_CAMERA_STATE.\n    // Mutate the `state` parameter instead of copying -- this\n    // matches the previous behavior of this method, which didn't\n    // fill in missing properties but also didn't copy `state`.\n    for (const [key, value] of Object.entries(DEFAULT_CAMERA_STATE)) {\n      if (state[key] == null) {\n        state[key] = value;\n      }\n    }\n    // `state` must be a valid CameraState now, because we filled in\n    // missing properties from DEFAULT_CAMERA_STATE.\n    this.state = (state: any);\n  };\n\n  cameraRotate = ([x, y]: Vec2) => {\n    // This can happen in 2D mode, when both e.movementX and e.movementY are evaluated as negative and mouseX move is 0\n    if (x === 0 && y === 0) {\n      return;\n    }\n    const { thetaOffset, phi } = this.state;\n    this.setCameraState({\n      ...this.state,\n      thetaOffset: thetaOffset - x,\n      phi: Math.max(0, Math.min(phi + y, Math.PI)),\n    });\n    this._onChange(this.state);\n  };\n\n  // move the camera along x, y axis; do not move up/down\n  cameraMove = ([x, y]: Vec2) => {\n    // moveX and moveY both be 0 sometimes\n    if (x === 0 && y === 0) {\n      return;\n    }\n\n    const { targetOffset, thetaOffset } = this.state;\n\n    // rotate around z axis so the offset is in the target's reference frame\n    const result = [x, y, 0];\n    const offset = vec3.transformQuat(result, result, quat.setAxisAngle(TEMP_QUAT, UNIT_Z_VECTOR, -thetaOffset));\n\n    this.setCameraState({\n      ...this.state,\n      targetOffset: vec3.add(offset, targetOffset, offset),\n    });\n    this._onChange(this.state);\n  };\n\n  cameraZoom = (zoomPercent: number) => {\n    const { distance } = this.state;\n    const newDistance: number = distanceAfterZoom(distance, zoomPercent);\n    if (distance === newDistance) {\n      return;\n    }\n\n    this.setCameraState({\n      ...this.state,\n      distance: newDistance,\n    });\n    this._onChange(this.state);\n  };\n}\n\nexport { selectors };\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat4 } from \"gl-matrix\";\n\nimport type { Vec3, Mat4, CameraCommand, Viewport } from \"../types\";\nimport getOrthographicBounds from \"../utils/getOrthographicBounds\";\nimport project from \"./cameraProject\";\nimport { selectors, DEFAULT_CAMERA_STATE, type CameraState } from \"./CameraStore\";\n\nconst TEMP_MAT = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\n// This is the regl command which encapsulates the camera projection and view matrices.\n// It adds the matrices to the regl context so they can be used by other commands.\nexport default (regl: any) => {\n  return class Camera implements CameraCommand {\n    viewportWidth: number = 0;\n    viewportHeight: number = 0;\n    cameraState: CameraState = DEFAULT_CAMERA_STATE;\n\n    getProjection(): Mat4 {\n      const { near, far, distance, fovy } = this.cameraState;\n      if (!this.cameraState.perspective) {\n        const bounds = getOrthographicBounds(distance, this.viewportWidth, this.viewportHeight);\n        const { left, right, bottom, top } = bounds;\n        return mat4.ortho([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], left, right, bottom, top, near, far);\n      }\n      const aspect = this.viewportWidth / this.viewportHeight;\n      return mat4.perspective([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], fovy, aspect, near, far);\n    }\n\n    getView(): Mat4 {\n      return selectors.view(this.cameraState);\n    }\n\n    // convert a point in 3D space to a point on the screen\n    toScreenCoord(viewport: Viewport, point: Vec3) {\n      const projection = this.getProjection();\n      const view = selectors.view(this.cameraState);\n      const combinedProjView = mat4.multiply(TEMP_MAT, projection, view);\n      const [x, y, z, w] = project([], point, viewport, combinedProjView);\n      if (z < 0 || z > 1 || w < 0) {\n        // resulting point is outside the window depth range\n        return undefined;\n      }\n      const diffY = viewport[3] + viewport[1];\n      const diffX = viewport[0];\n      // move the x value over based on the left of the viewport\n      // and move the y value over based on the bottom of the viewport\n      return [x - diffX, diffY - y, z];\n    }\n\n    draw = regl({\n      // adds context variables to the regl context so they are accessible from commands\n      context: {\n        // use functions, not lambdas here to make sure we can access\n        // the regl supplied this scope: http://regl.party/api#this\n        projection(context, props) {\n          const { viewportWidth, viewportHeight } = context;\n          // save these variables on the camera instance\n          // because we need them for raycasting\n          this.viewportWidth = viewportWidth;\n          this.viewportHeight = viewportHeight;\n          this.cameraState = props;\n          return this.getProjection();\n        },\n\n        view(context, props) {\n          return this.getView();\n        },\n\n        // inverse of the view rotation, used for making objects always face the camera\n        billboardRotation(context, props) {\n          return selectors.billboardRotation(this.cameraState);\n        },\n\n        isPerspective(context, props) {\n          return this.cameraState.perspective;\n        },\n\n        fovy(context, props) {\n          return this.cameraState.fovy;\n        },\n      },\n\n      // adds view and projection as uniforms to every command\n      // and makes them available in the shaders\n      uniforms: {\n        view: regl.context(\"view\"),\n        billboardRotation: regl.context(\"billboardRotation\"),\n        projection: regl.context(\"projection\"),\n      },\n    });\n  };\n};\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport normalizeWheel from \"normalize-wheel\";\nimport * as React from \"react\";\n\nimport type { CameraKeyMap, CameraAction, Vec2 } from \"../types\";\nimport getOrthographicBounds from \"../utils/getOrthographicBounds\";\nimport CameraStore from \"./CameraStore\";\n\nconst PAN_SPEED = 4;\nconst MOUSE_ZOOM_SPEED = 0.3;\nconst KEYBOARD_MOVE_SPEED = 0.3;\nconst KEYBOARD_ZOOM_SPEED = 150;\nconst KEYBOARD_SPIN_SPEED = 1.5;\n\nconst DEFAULT_KEYMAP: CameraKeyMap = {\n  KeyA: \"moveLeft\",\n  KeyD: \"moveRight\",\n  KeyE: \"rotateRight\",\n  KeyF: \"tiltUp\",\n  KeyQ: \"rotateLeft\",\n  KeyR: \"tiltDown\",\n  KeyS: \"moveDown\",\n  KeyW: \"moveUp\",\n  KeyX: \"zoomOut\",\n  KeyZ: \"zoomIn\",\n};\n\ntype KeyMotion = { x?: number, y?: number, zoom?: number, yaw?: number, tilt?: number };\n\ntype Props = {|\n  cameraStore: CameraStore,\n  keyMap?: CameraKeyMap,\n  shiftKeys: boolean,\n  children?: React.ChildrenArray<React.Element<any> | null>,\n|};\n\n// attaches mouse and keyboard listeners to allow for moving the camera on user input\nexport default class CameraListener extends React.Component<Props> {\n  _keyTimer: ?AnimationFrameID;\n  _keys: Set<string> = new Set();\n  _buttons: Set<number> = new Set();\n  _listeners = [];\n  _shiftKey = false;\n  _metaKey = false;\n  _ctrlKey = false;\n\n  _el: ?HTMLDivElement;\n  _rect: ClientRect | DOMRect;\n  _initialMouse: Vec2;\n\n  componentDidMount() {\n    const { _el } = this;\n    if (!_el) {\n      return;\n    }\n\n    this._rect = _el.getBoundingClientRect();\n    const listen = (target: any, name: string, fn) => {\n      target.addEventListener(name, fn);\n      this._listeners.push({ target, name, fn });\n    };\n    listen(document, \"blur\", this._onBlur);\n    listen(window, \"mouseup\", this._onWindowMouseUp);\n    _el.addEventListener(\"wheel\", this._onWheel, { passive: false });\n  }\n\n  componentWillUnmount() {\n    this._listeners.forEach((listener) => {\n      listener.target.removeEventListener(listener.name, listener.fn);\n    });\n    this._endDragging();\n    const { _el } = this;\n    if (!_el) {\n      return;\n    }\n    _el.removeEventListener(\"wheel\", this._onWheel, { passive: false });\n  }\n\n  _getMouseOnScreen = (mouse: MouseEvent) => {\n    const { clientX, clientY } = mouse;\n    const { top, left, width, height } = this._rect;\n    const x = (clientX - left) / width;\n    const y = (clientY - top) / height;\n    return [x, y];\n  };\n\n  _onMouseDown = (e: MouseEvent) => {\n    const { _el } = this;\n    if (!_el) {\n      return;\n    }\n\n    e.preventDefault();\n    this._buttons.add(e.button);\n    _el.focus();\n    this._rect = _el.getBoundingClientRect();\n    this._initialMouse = this._getMouseOnScreen(e);\n    this.startDragging(e);\n  };\n\n  _isLeftMouseDown() {\n    return this._buttons.has(0);\n  }\n\n  _isRightMouseDown() {\n    return this._buttons.has(2);\n  }\n\n  _getMagnitude(base: number = 1) {\n    return this._shiftKey ? base / 10 : base;\n  }\n\n  _getMoveMagnitude() {\n    // avoid interference with drawing tools\n    if (this._ctrlKey) {\n      return { x: 0, y: 0 };\n    }\n\n    const {\n      cameraStore: {\n        state: { distance, perspective },\n      },\n    } = this.props;\n    if (perspective) {\n      // in perspective mode its more like flying, so move by the magnitude\n      // we use the camera distance as a heuristic\n      return { x: distance, y: distance };\n    }\n    // in orthographic mode we know the exact viewable area\n    // which is a square so we can move exactly percentage within it\n    const { width, height } = this._rect;\n    const bounds = getOrthographicBounds(distance, width, height);\n    return { x: bounds.width, y: bounds.height };\n  }\n\n  _onWindowMouseMove = (e: MouseEvent) => {\n    if (!this._buttons.size) {\n      return;\n    }\n    this._shiftKey = e.shiftKey;\n    const {\n      cameraStore: {\n        cameraMove,\n        cameraRotate,\n        state: { perspective },\n      },\n    } = this.props;\n\n    // compute the amount the mouse has moved\n    let moveX, moveY;\n    const mouse = this._getMouseOnScreen(e);\n    // when pointer lock is enabled, we get movementX and movementY (with direction reversed)\n    // instead of the screenX/screenY changing... except, when using synergy, they come through\n    // like regular mousemove events.\n    if ((document: any).pointerLockElement && (e.movementX || e.movementY)) {\n      moveX = -e.movementX / this._rect.width;\n      moveY = -e.movementY / this._rect.height;\n    } else {\n      moveX = this._initialMouse[0] - mouse[0];\n      moveY = this._initialMouse[1] - mouse[1];\n    }\n    this._initialMouse = mouse;\n\n    if (this._isRightMouseDown()) {\n      const magnitude = this._getMagnitude(PAN_SPEED);\n      // in orthographic mode, flip the direction of rotation so \"left\" means \"counterclockwise\"\n      const x = (perspective ? moveX : -moveX) * magnitude;\n      // do not rotate vertically in orthograhpic mode\n      const y = perspective ? moveY * magnitude : 0;\n      cameraRotate([x, y]);\n    }\n\n    if (this._isLeftMouseDown()) {\n      const { x, y } = this._getMoveMagnitude();\n      cameraMove([this._getMagnitude(moveX * x), this._getMagnitude(-moveY * y)]);\n    }\n  };\n\n  _onMouseUp = (e: MouseEvent) => {\n    this._buttons.delete(e.button);\n    this._endDragging();\n  };\n\n  _onWindowMouseUp = (e: MouseEvent) => {\n    const { _el } = this;\n    if (!_el) {\n      return;\n    }\n\n    // do nothing if this container had a mouseup, because we catch it in the onMouseUp handler\n    if (_el.contains((e.target: any)) || e.target === _el) {\n      return;\n    }\n    // If mouseup triggers on the window outside this container, clear any active interactions.\n    // This will allow a mouseup outside the browser window to be handled; otherwise the mouse\n    // \"sticks\" in a down position until another click on this element is received.\n    this._buttons.clear();\n    this._endDragging();\n  };\n\n  startDragging(e: MouseEvent) {\n    if (e.button !== 0 && this._el && typeof this._el.requestPointerLock === \"function\") {\n      this._el.requestPointerLock();\n    }\n    window.addEventListener(\"mousemove\", this._onWindowMouseMove);\n  }\n\n  _endDragging() {\n    window.removeEventListener(\"mousemove\", this._onWindowMouseMove);\n    if (typeof (document: any).exitPointerLock === \"function\") {\n      (document: any).exitPointerLock();\n    }\n  }\n\n  _getKeyMotion = (code: string): ?KeyMotion => {\n    const moveSpeed = this._getMagnitude(KEYBOARD_MOVE_SPEED);\n    const zoomSpeed = this._getMagnitude(KEYBOARD_ZOOM_SPEED);\n    const spinSpeed = this._getMagnitude(KEYBOARD_SPIN_SPEED);\n    const { keyMap, shiftKeys } = this.props;\n    const action: CameraAction | false = (keyMap && keyMap[code]) || DEFAULT_KEYMAP[code] || false;\n\n    if (this._shiftKey && !shiftKeys) {\n      return null;\n    }\n\n    switch (action) {\n      case \"moveRight\":\n        return { x: moveSpeed };\n      case \"moveLeft\":\n        return { x: -moveSpeed };\n      case \"moveUp\":\n        return { y: moveSpeed };\n      case \"moveDown\":\n        return { y: -moveSpeed };\n      case \"zoomIn\":\n        return { zoom: zoomSpeed };\n      case \"zoomOut\":\n        return { zoom: -zoomSpeed };\n      case \"rotateLeft\":\n        return { yaw: -spinSpeed };\n      case \"rotateRight\":\n        return { yaw: spinSpeed };\n      case \"tiltUp\":\n        return { tilt: -spinSpeed };\n      case \"tiltDown\":\n        return { tilt: spinSpeed };\n      case false:\n        return null;\n      default:\n        (action: empty);\n        console.warn(\"Unrecognized key action:\", action);\n        return null;\n    }\n  };\n\n  _moveKeyboard(dt: number) {\n    const motion = { x: 0, y: 0, zoom: 0, yaw: 0, tilt: 0 };\n    this._keys.forEach((code) => {\n      const { x = 0, y = 0, zoom = 0, yaw = 0, tilt = 0 } = this._getKeyMotion(code) || {};\n      motion.x += x;\n      motion.y += y;\n      motion.zoom += zoom;\n      motion.yaw += yaw;\n      motion.tilt += tilt;\n    });\n\n    const {\n      cameraStore: {\n        cameraMove,\n        cameraRotate,\n        cameraZoom,\n        state: { perspective },\n      },\n    } = this.props;\n\n    if (motion.x || motion.y) {\n      const { x, y } = this._getMoveMagnitude();\n      cameraMove([motion.x * x * dt, motion.y * y * dt]);\n    }\n    if (motion.yaw || (perspective && motion.tilt)) {\n      cameraRotate([motion.yaw * dt, perspective ? motion.tilt * dt : 0]);\n    }\n    if (motion.zoom) {\n      cameraZoom(motion.zoom * dt);\n    }\n  }\n\n  _startKeyTimer(lastStamp: ?number) {\n    if (this._keyTimer) {\n      return;\n    }\n    this._keyTimer = requestAnimationFrame((stamp) => {\n      this._moveKeyboard((lastStamp ? stamp - lastStamp : 0) / 1000);\n      this._keyTimer = undefined;\n\n      // Only start the timer if keys are still pressed.\n      // We do this rather than stopping the timer in onKeyUp, because keys held\n      // sometimes actually trigger repeated keyup/keydown, rather than just repeated keydown.\n      // By checking currently-down keys in the requestAnimationFrame callback, we give the browser enough time to\n      // handle both the keyup and keydown before checking whether we should restart the timer.\n      if (this._keys.size) {\n        this._startKeyTimer(stamp);\n      }\n    });\n  }\n\n  _stopKeyTimer() {\n    if (this._keyTimer) {\n      cancelAnimationFrame(this._keyTimer);\n    }\n    this._keyTimer = undefined;\n  }\n\n  _onKeyDown = (e: SyntheticKeyboardEvent<HTMLDivElement>) => {\n    const { keyMap } = this.props;\n    this._shiftKey = e.shiftKey;\n    this._metaKey = e.metaKey;\n    this._ctrlKey = e.ctrlKey;\n    const code = ((e.nativeEvent: any): KeyboardEvent).code;\n\n    // ignore repeated keydown events\n    if (e.repeat || this._keys.has(code)) {\n      e.stopPropagation();\n      e.preventDefault();\n      return;\n    }\n\n    if (e.altKey || e.ctrlKey || e.metaKey) {\n      // we don't currently handle these modifiers\n      return;\n    }\n\n    // allow null, false, or empty keymappings which explicitly cancel Worldview from processing that key\n    if (keyMap && code in keyMap && !keyMap[code]) {\n      return false;\n    }\n\n    // if we respond to this key, start the update timer\n    if (this._getKeyMotion(code)) {\n      this._keys.add(code);\n      this._startKeyTimer();\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  };\n\n  _onKeyUp = (e: SyntheticKeyboardEvent<HTMLDivElement>) => {\n    this._shiftKey = e.shiftKey;\n    this._metaKey = e.metaKey;\n    this._ctrlKey = e.ctrlKey;\n\n    this._keys.delete(((e.nativeEvent: any): KeyboardEvent).code);\n  };\n\n  _onWheel = (e: WheelEvent) => {\n    // stop the wheel event here, as wheel propagation through the entire dom\n    // can cause the browser to slow down & thrash\n    e.preventDefault();\n    e.stopPropagation();\n    this._shiftKey = e.shiftKey;\n\n    // with osx trackpad scrolling, slow to medium pixelY is around +/- 1 to 10\n    // external mouse wheels generally come in higher values around +/- 30 to 50\n    const { pixelX, pixelY } = normalizeWheel(e);\n\n    // shift+scroll on an external mouse may scroll in the X direction instead of Y\n    const wheelAmount = pixelY || pixelX;\n\n    // we use positive value to indicate zooming in\n    // and negative value to zoom out, so reverse the direction of the wheel\n    const dir = Math.sign(wheelAmount) * -1;\n    const amount = Math.abs(wheelAmount);\n    // restrict zoom percentage per tick to between 1 & 50 percent\n    const percentage = Math.max(1, Math.min(amount, 50));\n\n    // support shift+wheel magnitude adjustment\n    const zoomPercentage = this._getMagnitude(percentage * dir * MOUSE_ZOOM_SPEED);\n    this.props.cameraStore.cameraZoom(zoomPercentage);\n  };\n\n  // make sure all movements stop if the document loses focus by resetting modifier keys\n  // to their 'off' position\n  // (e.g. ctrl+tab leaving the page should not leave the ctrl key in the 'on' position)\n  _onBlur = (e: MouseEvent) => {\n    this._keys = new Set();\n    this._ctrlKey = false;\n    this._shiftKey = false;\n    this._metaKey = false;\n    this._stopKeyTimer();\n  };\n\n  _onContextMenu = (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  render() {\n    const { children } = this.props;\n    return (\n      <div\n        tabIndex={0}\n        style={{ outline: \"none\" }}\n        draggable\n        ref={(el) => (this._el = el)}\n        onMouseDown={this._onMouseDown}\n        onMouseUp={this._onMouseUp}\n        onBlur={this._onBlur}\n        onContextMenu={this._onContextMenu}\n        onKeyDown={this._onKeyDown}\n        onKeyUp={this._onKeyUp}>\n        {children}\n      </div>\n    );\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport function getNodeEnv() {\n  return process && process.env && process.env.NODE_ENV;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, mat4 } from \"gl-matrix\";\n\nimport type { CameraCommand, Vec3 } from \"../types\";\n\ntype ClickInfo = { clientX: number, clientY: number, width: number, height: number };\n\nconst tempVec = [0, 0, 0];\nconst tempMat = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\nexport class Ray {\n  origin: Vec3;\n  dir: Vec3;\n  point: Vec3;\n\n  constructor(origin: Vec3, dir: Vec3, point: Vec3) {\n    this.origin = origin;\n    this.dir = dir;\n    this.point = point;\n  }\n\n  distanceToPoint(point: Vec3) {\n    return vec3.distance(this.origin, point);\n  }\n\n  // https://commons.apache.org/proper/commons-math/javadocs/api-3.6/src-html/org/apache/commons/math3/geometry/euclidean/threed/Plane.html#line.394\n  planeIntersection(planeCoordinate: Vec3, planeNormal: Vec3): ?Vec3 {\n    const d = vec3.dot(planeNormal, planeCoordinate);\n    const cosine = vec3.dot(planeNormal, this.dir);\n\n    if (cosine === 0) {\n      return null;\n    }\n\n    const x = (d - vec3.dot(planeNormal, this.origin)) / cosine;\n    const contact = vec3.add([0, 0, 0], this.origin, vec3.scale(tempVec, this.dir, x));\n    return contact;\n  }\n}\n\n// adapted from https://github.com/regl-project/regl/blob/master/example/raycast.js\nexport function getRayFromClick(camera: CameraCommand, { clientX, clientY, width, height }: ClickInfo) {\n  const projectionMatrix = camera.getProjection();\n  const viewMatrix = camera.getView();\n\n  const vp = mat4.multiply(tempMat, projectionMatrix, viewMatrix);\n  const invVp = mat4.invert(tempMat, vp);\n\n  const mouseX = (2.0 * clientX) / width - 1.0;\n  const mouseY = (-2.0 * clientY) / height + 1.0;\n  // get a single point on the camera ray.\n  const rayPoint = vec3.transformMat4([0, 0, 0], [mouseX, mouseY, 0.0], invVp);\n\n  // get the position of the camera.\n  const rayOrigin = vec3.transformMat4([0, 0, 0], [0, 0, 0], mat4.invert(tempMat, viewMatrix));\n  const rayDir = vec3.normalize([0, 0, 0], vec3.subtract(tempVec, rayPoint, rayOrigin));\n\n  return new Ray(rayOrigin, rayDir, rayPoint);\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport { type WorldviewContextType } from \"./WorldviewContext\";\n\n// $FlowFixMe\nexport default React.createContext((undefined: WorldviewContextType | void));\n","// @flow\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type {\n  ComponentMouseHandler,\n  GetChildrenForHitmap,\n  MouseEventEnum,\n  RawCommand,\n  Color,\n  Point,\n  MouseEventObject,\n} from \"../types\";\nimport { getNodeEnv } from \"../utils/common\";\nimport { Ray } from \"../utils/Raycast\";\nimport { type WorldviewContextType } from \"../WorldviewContext\";\nimport WorldviewReactContext from \"../WorldviewReactContext\";\n\nexport const SUPPORTED_MOUSE_EVENTS = [\"onClick\", \"onMouseUp\", \"onMouseMove\", \"onMouseDown\", \"onDoubleClick\"];\n\nexport type MarkerDefault = {\n  id?: number,\n  points?: Point[],\n  color?: Color,\n};\n\nexport type CommonCommandProps = {\n  [MouseEventEnum]: ComponentMouseHandler,\n  layerIndex?: number,\n  getChildrenForHitmap?: GetChildrenForHitmap,\n};\n\ntype Props<T> = {\n  ...CommonCommandProps,\n  children?: T[] | T,\n  // Deprecated, but here for backwards compatibility\n  drawProps?: T[],\n  reglCommand: RawCommand<T>,\n};\n\nexport type CommandProps<T> = Props<T>;\n\n// Component to dispatch children (for drawing) and hitmap props and a reglCommand to the render loop to render with regl.\nexport default class Command<T> extends React.Component<Props<T>> {\n  context: ?WorldviewContextType;\n  static displayName = \"Command\";\n\n  constructor(props: Props<T>) {\n    super(props);\n    // In development put a check in to make sure the reglCommand prop is not mutated.\n    // Similar to how react checks for unsupported or deprecated calls in a development build.\n    if (getNodeEnv() !== \"production\") {\n      // $FlowFixMe\n      this.shouldComponentUpdate = (nextProps: Props) => {\n        if (nextProps.reglCommand !== this.props.reglCommand) {\n          console.error(\"Changing the regl command prop on a <Command /> is not supported.\");\n        }\n        return true;\n      };\n    }\n  }\n\n  componentDidMount() {\n    const context = this.context;\n    if (!context) {\n      return;\n    }\n    context.onMount(this, this.props.reglCommand);\n    this._updateContext();\n  }\n\n  componentDidUpdate() {\n    this._updateContext();\n  }\n\n  componentWillUnmount() {\n    const context = this.context;\n    if (!context) {\n      return;\n    }\n    context.onUnmount(this);\n  }\n\n  _updateContext() {\n    const context = this.context;\n    if (!context) {\n      return;\n    }\n\n    const { reglCommand, layerIndex, getChildrenForHitmap } = this.props;\n    const children = this.props.children || this.props.drawProps;\n    if (children == null) {\n      return;\n    }\n    context.registerDrawCall({\n      instance: this,\n      reglCommand,\n      children,\n      layerIndex,\n      getChildrenForHitmap,\n    });\n  }\n\n  handleMouseEvent(\n    objects: MouseEventObject[],\n    ray: Ray,\n    e: SyntheticMouseEvent<HTMLCanvasElement>,\n    mouseEventName: MouseEventEnum\n  ) {\n    const mouseHandler = this.props[mouseEventName];\n    if (!mouseHandler || !objects.length) {\n      return;\n    }\n    mouseHandler(e, { ray, objects });\n  }\n\n  render() {\n    return (\n      <WorldviewReactContext.Consumer>\n        {(ctx: ?WorldviewContextType) => {\n          if (ctx) {\n            this.context = ctx;\n          }\n          return null;\n        }}\n      </WorldviewReactContext.Consumer>\n    );\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport last from \"lodash/last\";\n\nimport Command from \"../commands/Command\";\nimport type { ObjectHitmapId, Vec4, MouseEventObject } from \"../types\";\nimport { intToRGB } from \"./commandUtils\";\n\nfunction fillArray(start: number, length: number): number[] {\n  return new Array(length).fill(0).map((_, index) => start + index);\n}\n\ntype CommandType = Command<any>;\n\n/*\n * This object manages the mapping between objects that are rendered into the scene and their IDs.\n * It supplies an API for generating IDs for a rendered object and then accessing those objects based on their ID.\n */\nexport default class HitmapObjectIdManager {\n  _objectsByObjectHitmapIdMap: { [ObjectHitmapId]: Object } = {};\n  _commandsByObjectMap: Map<Object, CommandType> = new Map();\n  _nextObjectHitmapId = 1;\n  _instanceIndexByObjectHitmapIdMap: { [ObjectHitmapId]: number } = {};\n\n  assignNextColors = (command: CommandType, object: Object, count: number): Vec4[] => {\n    if (count < 1) {\n      throw new Error(\"Must get at least 1 id\");\n    }\n\n    const ids: ObjectHitmapId[] = fillArray(this._nextObjectHitmapId, count);\n    this._nextObjectHitmapId = last(ids) + 1;\n\n    // Instanced rendering - add to the instanced ID map.\n    if (count > 1) {\n      ids.forEach((id, index) => {\n        this._instanceIndexByObjectHitmapIdMap[id] = index;\n      });\n    }\n\n    // Store the mapping of ID to original marker object\n    for (const id of ids) {\n      this._objectsByObjectHitmapIdMap[id] = object;\n    }\n    this._commandsByObjectMap.set(object, command);\n\n    // Return colors from the IDs.\n    const colors = ids.map((id) => intToRGB(id));\n    return colors;\n  };\n\n  getObjectByObjectHitmapId = (objectHitmapId: ObjectHitmapId): MouseEventObject => {\n    return {\n      object: this._objectsByObjectHitmapIdMap[objectHitmapId],\n      instanceIndex: this._instanceIndexByObjectHitmapIdMap[objectHitmapId],\n    };\n  };\n\n  getCommandForObject = (object: Object): ?CommandType => {\n    return this._commandsByObjectMap.get(object);\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { signal, type Signal } from \"./signal\";\n\ntype QueuedFn = ((...args: any[]) => Promise<any>) & { currentPromise: ?Promise<any> };\n\n// Wait for the previous promise to resolve before starting the next call to the function.\nexport default function queuePromise(fn: (...args: any[]) => Promise<any>): QueuedFn {\n  // Whether we are currently waiting for a promise returned by `fn` to resolve.\n  let calling = false;\n  // The list of calls made to the function was made while a call was in progress.\n  const nextCalls: {| args: any[], promise: Signal<any> |}[] = [];\n\n  function queuedFn(...args) {\n    if (calling) {\n      const returnPromise = signal();\n      nextCalls.push({ args, promise: returnPromise });\n      return returnPromise;\n    }\n    return start(...args);\n  }\n\n  function start(...args) {\n    calling = true;\n\n    const promise = fn(...args).finally(() => {\n      calling = false;\n      queuedFn.currentPromise = undefined;\n      if (nextCalls.length) {\n        const { promise: nextPromise, args: nextArgs } = nextCalls.shift();\n        start(...nextArgs)\n          .then((result) => nextPromise.resolve(result))\n          .catch((error) => nextPromise.reject(error));\n      }\n    });\n    queuedFn.currentPromise = promise;\n\n    return promise;\n  }\n\n  return queuedFn;\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport type Signal<T> = Promise<T> & {\n  resolve: (T) => void,\n  reject: (Error) => void,\n};\n\nexport function signal<T>(): Signal<T> {\n  let resolve;\n  let reject;\n  const promise: any = new Promise((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  promise.resolve = resolve;\n  promise.reject = reject;\n  return promise;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport createREGL from \"regl\";\nimport shallowequal from \"shallowequal\";\n\nimport { camera, CameraStore } from \"./camera/index\";\nimport Command from \"./commands/Command\";\nimport type {\n  Dimensions,\n  RawCommand,\n  CompiledReglCommand,\n  CameraCommand,\n  Vec4,\n  CameraState,\n  MouseEventObject,\n  GetChildrenForHitmap,\n  AssignNextColorsFn,\n} from \"./types\";\nimport { getIdFromPixel, intToRGB } from \"./utils/commandUtils\";\nimport { getNodeEnv } from \"./utils/common\";\nimport HitmapObjectIdManager from \"./utils/HitmapObjectIdManager\";\nimport queuePromise from \"./utils/queuePromise\";\nimport { getRayFromClick } from \"./utils/Raycast\";\n\ntype Props = any;\n\ntype ConstructorArgs = {\n  dimension: Dimensions,\n  canvasBackgroundColor: Vec4,\n  cameraState: CameraState,\n  defaultCameraState?: CameraState,\n  onCameraStateChange: ?(CameraState) => void,\n};\n\ntype InitializedData = {\n  _fbo: any,\n  regl: any,\n  camera: CameraCommand,\n};\n\nexport type DrawInput = {\n  instance: Command<any>,\n  reglCommand: RawCommand<any>,\n  children: Props,\n  layerIndex: ?number,\n  getChildrenForHitmap: ?GetChildrenForHitmap,\n};\n\nexport type PaintFn = () => void;\n\nexport type WorldviewContextType = {\n  onMount(instance: Command<any>, command: RawCommand<any>): void,\n  registerDrawCall(drawInput: DrawInput): void,\n  registerPaintCallback(PaintFn): void,\n  unregisterPaintCallback(PaintFn): void,\n  onUnmount(instance: Command<any>): void,\n  onDirty(): void,\n  +dimension: Dimensions,\n  +initializedData: ?InitializedData,\n};\n\n// Compile instructions with an initialized regl context into a regl command.\n// If the instructions are a function, pass the context to the instructions and compile the result\n// of the function; otherwise, compile the instructions directly\nfunction compile<T>(regl: any, cmd: RawCommand<T>): CompiledReglCommand<T> {\n  const src = cmd(regl);\n  return typeof src === \"function\" ? src : regl(src);\n}\n\n// This is made available to every Command component as `this.context`.\n// It contains all the regl interaction code and is responsible for collecting and executing\n// draw calls, hitmap calls, and raycasting.\n\nexport class WorldviewContext {\n  _commands: Set<RawCommand<any>> = new Set();\n  _compiled: Map<Function, CompiledReglCommand<any>> = new Map();\n  _drawCalls: Map<React.Component<any>, DrawInput> = new Map();\n  _frame: ?AnimationFrameID;\n  _paintCalls: Map<PaintFn, PaintFn> = new Map();\n  _hitmapObjectIdManager: HitmapObjectIdManager = new HitmapObjectIdManager();\n  _cachedReadHitmapCall: ?{\n    arguments: any[],\n    result: Array<[MouseEventObject, Command<any>]>,\n  } = undefined;\n  // store every compiled command object compiled for debugging purposes\n  reglCommandObjects: { stats: { count: number } }[] = [];\n  counters: { paint?: number, render?: number } = {};\n  dimension: Dimensions;\n  onDirty: () => void;\n  cameraStore: CameraStore;\n  canvasBackgroundColor: Vec4 = [0, 0, 0, 1];\n  // group all initialized data together so it can be checked for existence to verify initialization is complete\n  initializedData: ?InitializedData;\n\n  constructor({ dimension, canvasBackgroundColor, cameraState, onCameraStateChange }: ConstructorArgs) {\n    // used for children to call paint() directly\n    this.dimension = dimension;\n    this.canvasBackgroundColor = canvasBackgroundColor;\n    this.cameraStore = new CameraStore((cameraState: CameraState) => {\n      if (onCameraStateChange) {\n        onCameraStateChange(cameraState);\n      } else {\n        // this must be called for Worldview with defaultCameraState prop\n        this.paint();\n      }\n    }, cameraState);\n  }\n\n  initialize(canvas: HTMLCanvasElement) {\n    if (this.initializedData) {\n      throw new Error(\"can not initialize regl twice\");\n    }\n\n    const regl = this._instrumentCommands(\n      createREGL({\n        canvas,\n        extensions: [\n          \"angle_instanced_arrays\",\n          \"oes_texture_float\",\n          \"oes_element_index_uint\",\n          \"oes_standard_derivatives\",\n        ],\n        profile: getNodeEnv() !== \"production\",\n      })\n    );\n    // compile any components which mounted before regl is initialized\n    this._commands.forEach((uncompiledCommand) => {\n      const compiledCommand = compile(regl, uncompiledCommand);\n      this._compiled.set(uncompiledCommand, compiledCommand);\n    });\n\n    const Camera = compile(regl, camera);\n    const compiledCameraCommand = new Camera();\n    // framebuffer object from regl context\n    const fbo = regl.framebuffer({\n      width: Math.round(this.dimension.width),\n      height: Math.round(this.dimension.height),\n    });\n\n    this.initializedData = {\n      _fbo: fbo,\n      camera: compiledCameraCommand,\n      regl,\n    };\n  }\n\n  destroy() {\n    if (this.initializedData) {\n      this.initializedData.regl.destroy();\n    }\n    if (this._frame) {\n      cancelAnimationFrame(this._frame);\n    }\n  }\n\n  // compile a command when it is first mounted, and try to register in _commands and _compiled maps\n  onMount(instance: React.Component<any>, command: RawCommand<any>) {\n    const { initializedData } = this;\n    // do nothing if regl hasn't been initialized yet\n    if (!initializedData || this._commands.has(command)) {\n      return;\n    }\n    this._commands.add(command);\n\n    // for components that mount after regl is initialized\n    this._compiled.set(command, compile(initializedData.regl, command));\n  }\n\n  // unregister children hitmap and draw calls\n  onUnmount(instance: React.Component<any>) {\n    this._drawCalls.delete(instance);\n  }\n\n  unregisterPaintCallback(paintFn: PaintFn) {\n    this._paintCalls.delete(paintFn);\n  }\n\n  registerDrawCall(drawInput: DrawInput) {\n    this._drawCalls.set(drawInput.instance, drawInput);\n  }\n\n  registerPaintCallback(paintFn: PaintFn) {\n    this._paintCalls.set(paintFn, paintFn);\n  }\n\n  setDimension(dimension: Dimensions) {\n    this.dimension = dimension;\n  }\n\n  raycast = (canvasX: number, canvasY: number) => {\n    if (!this.initializedData) {\n      return undefined;\n    }\n\n    const { width, height } = this.dimension;\n    return getRayFromClick(this.initializedData.camera, {\n      clientX: canvasX,\n      clientY: canvasY,\n      width,\n      height,\n    });\n  };\n\n  paint() {\n    try {\n      this._paint();\n    } catch (error) {\n      // Regl automatically tries to reconnect when losing the canvas 3d context.\n      // We should log this error, but it's not important to throw it.\n      if (error.message === \"(regl) context lost\") {\n        console.warn(error);\n      } else {\n        throw error;\n      }\n    }\n  }\n\n  _paint() {\n    const start = Date.now();\n    this.reglCommandObjects.forEach((cmd) => (cmd.stats.count = 0));\n    if (!this.initializedData) {\n      return;\n    }\n    this._cachedReadHitmapCall = null; // clear the cache every time we paint\n    const { regl, camera } = this.initializedData;\n    this._clearCanvas(regl);\n    camera.draw(this.cameraStore.state, () => {\n      const x = Date.now();\n      this._drawInput();\n      this.counters.paint = Date.now() - x;\n    });\n\n    this._paintCalls.forEach((paintCall) => {\n      paintCall();\n    });\n    this.counters.render = Date.now() - start;\n    this._frame = undefined;\n  }\n\n  onDirty = () => {\n    if (undefined === this._frame) {\n      this._frame = requestAnimationFrame(() => this.paint());\n    }\n  };\n\n  readHitmap = queuePromise(\n    (\n      canvasX: number,\n      canvasY: number,\n      enableStackedObjectEvents: boolean,\n      maxStackedObjectCount: number\n    ): Promise<Array<[MouseEventObject, Command<any>]>> => {\n      if (!this.initializedData) {\n        return Promise.reject(new Error(\"regl data not initialized yet\"));\n      }\n      const args = [canvasX, canvasY, enableStackedObjectEvents, maxStackedObjectCount];\n\n      const cachedReadHitmapCall = this._cachedReadHitmapCall;\n      if (cachedReadHitmapCall) {\n        if (shallowequal(cachedReadHitmapCall.arguments, args)) {\n          // Make sure that we aren't returning the exact object identity of the mouseEventObject - we don't know what\n          // callers have done with it.\n          const result = cachedReadHitmapCall.result.map(([mouseEventObject, command]) => [\n            { ...mouseEventObject },\n            command,\n          ]);\n          return Promise.resolve(result);\n        }\n        this._cachedReadHitmapCall = undefined;\n      }\n\n      const { regl, camera, _fbo } = this.initializedData;\n      const { width, height } = this.dimension;\n\n      const x = canvasX;\n      // 0,0 corresponds to the bottom left in the webgl context, but the top left in window coordinates\n      const y = height - canvasY;\n\n      // regl will only resize the framebuffer if the size changed\n      // it uses floored whole pixel values\n      _fbo.resize(Math.floor(width), Math.floor(height));\n\n      return new Promise((resolve) => {\n        // tell regl to use a framebuffer for this render\n        regl({ framebuffer: _fbo })(() => {\n          // clear the framebuffer\n          regl.clear({ color: intToRGB(0), depth: 1 });\n          let currentObjectId = 0;\n          const excludedObjects = [];\n          const mouseEventsWithCommands = [];\n          let counter = 0;\n\n          camera.draw(this.cameraStore.state, () => {\n            // Every iteration in this loop clears the framebuffer, draws the hitmap objects that have NOT already been\n            // seen to the framebuffer, and then reads the pixel under the cursor to find the object on top.\n            // If `enableStackedObjectEvents` is false, we only do this iteration once - we only resolve with 0 or 1\n            // objects.\n            do {\n              if (counter >= maxStackedObjectCount) {\n                // Provide a max number of layers so this while loop doesn't crash the page.\n                console.error(\n                  `Hit ${maxStackedObjectCount} iterations. There is either a bug or that number of rendered hitmap layers under the mouse cursor.`\n                );\n                break;\n              }\n              counter++;\n              regl.clear({ color: intToRGB(0), depth: 1 });\n              this._drawInput(true, excludedObjects);\n\n              // it's possible to get x/y values outside the framebuffer size\n              // if the mouse quickly leaves the draw area during a read operation\n              // reading outside the bounds of the framebuffer causes errors\n              // and puts regl into a bad internal state.\n              // https://github.com/regl-project/regl/blob/28fbf71c871498c608d9ec741d47e34d44af0eb5/lib/read.js#L57\n              if (x < Math.floor(width) && y < Math.floor(height) && x >= 0 && y >= 0) {\n                const pixel = new Uint8Array(4);\n\n                // read pixel value from the frame buffer\n                regl.read({\n                  x,\n                  y,\n                  width: 1,\n                  height: 1,\n                  data: pixel,\n                });\n\n                currentObjectId = getIdFromPixel(pixel);\n                const mouseEventObject = this._hitmapObjectIdManager.getObjectByObjectHitmapId(currentObjectId);\n\n                // Check an error case: if we see an ID/color that we don't know about, it means that some command is\n                // drawing a color into the hitmap that it shouldn't be.\n                if (currentObjectId > 0 && !mouseEventObject) {\n                  console.error(\n                    `Clicked on an unknown object with id ${currentObjectId}. This likely means that a command is painting an incorrect color into the hitmap.`\n                  );\n                }\n                // Check an error case: if we've already seen this object, then the getHitmapFromChildren function\n                // is not respecting the excludedObjects correctly and we should notify the user of a bug.\n                if (\n                  excludedObjects.some(\n                    ({ object, instanceIndex }) =>\n                      object === mouseEventObject.object && instanceIndex === mouseEventObject.instanceIndex\n                  )\n                ) {\n                  console.error(\n                    `Saw object twice when reading from hitmap. There is likely an error in getHitmapFromChildren`,\n                    mouseEventObject\n                  );\n                  break;\n                }\n\n                if (currentObjectId > 0 && mouseEventObject.object) {\n                  const command = this._hitmapObjectIdManager.getCommandForObject(mouseEventObject.object);\n                  excludedObjects.push(mouseEventObject);\n                  if (command) {\n                    mouseEventsWithCommands.push([mouseEventObject, command]);\n                  }\n                }\n              }\n              // If we haven't enabled stacked object events, break out of the loop immediately.\n              // eslint-disable-next-line no-unmodified-loop-condition\n            } while (currentObjectId !== 0 && enableStackedObjectEvents);\n\n            this._cachedReadHitmapCall = {\n              arguments: args,\n              result: mouseEventsWithCommands,\n            };\n            resolve(mouseEventsWithCommands);\n          });\n        });\n      });\n    }\n  );\n\n  _drawInput = (isHitmap?: boolean, excludedObjects?: MouseEventObject[]) => {\n    if (isHitmap) {\n      this._hitmapObjectIdManager = new HitmapObjectIdManager();\n    }\n\n    const drawCalls = Array.from(this._drawCalls.values()).sort((a, b) => (a.layerIndex || 0) - (b.layerIndex || 0));\n    drawCalls.forEach((drawInput: DrawInput) => {\n      const { reglCommand, children, instance, getChildrenForHitmap } = drawInput;\n      if (!children) {\n        return console.debug(`${isHitmap ? \"hitmap\" : \"\"} draw skipped, props was falsy`, drawInput);\n      }\n      const cmd = this._compiled.get(reglCommand);\n      if (!cmd) {\n        return console.warn(\"could not find draw command for\", instance ? instance.constructor.displayName : \"Unknown\");\n      }\n      // draw hitmap\n      if (isHitmap && getChildrenForHitmap) {\n        const assignNextColorsFn: AssignNextColorsFn = (...rest) => {\n          return this._hitmapObjectIdManager.assignNextColors(instance, ...rest);\n        };\n        const hitmapProps = getChildrenForHitmap(children, assignNextColorsFn, excludedObjects || []);\n        if (hitmapProps) {\n          cmd(hitmapProps, true);\n        }\n      } else if (!isHitmap) {\n        cmd(children, false);\n      }\n    });\n  };\n\n  _clearCanvas = (regl: any) => {\n    // Since we aren't using regl.frame and only rendering when we need to,\n    // we need to tell regl to update its internal state.\n    regl.poll();\n    regl.clear({\n      color: this.canvasBackgroundColor,\n      depth: 1,\n    });\n  };\n\n  _instrumentCommands(regl: any) {\n    if (getNodeEnv() === \"production\") {\n      return regl;\n    }\n    return new Proxy(regl, {\n      apply: (target, thisArg, args) => {\n        const command = target(...args);\n        if (typeof command.stats === \"object\") {\n          this.reglCommandObjects.push(command);\n        }\n        return command;\n      },\n    });\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport mapValues from \"lodash/mapValues\";\nimport pickBy from \"lodash/pickBy\";\nimport * as React from \"react\";\nimport ContainerDimensions from \"react-container-dimensions\";\n\nimport { CameraListener, DEFAULT_CAMERA_STATE } from \"./camera/index\";\nimport Command from \"./commands/Command\";\nimport type {\n  MouseHandler,\n  Dimensions,\n  Vec4,\n  CameraState,\n  CameraKeyMap,\n  MouseEventEnum,\n  MouseEventObject,\n} from \"./types\";\nimport aggregate from \"./utils/aggregate\";\nimport { getNodeEnv } from \"./utils/common\";\nimport { Ray } from \"./utils/Raycast\";\nimport { WorldviewContext } from \"./WorldviewContext\";\nimport WorldviewReactContext from \"./WorldviewReactContext\";\n\nconst DEFAULT_BACKGROUND_COLOR = [0, 0, 0, 1];\nexport const DEFAULT_MOUSE_CLICK_RADIUS = 3;\nconst DEFAULT_MAX_NUMBER_OF_HITMAP_LAYERS = 100;\n\nexport type BaseProps = {|\n  keyMap?: CameraKeyMap,\n  shiftKeys: boolean,\n  backgroundColor?: Vec4,\n  // (Deprecated) rendering the hitmap on mouse move is expensive, so disable it by default\n  hitmapOnMouseMove?: boolean,\n  // Disable hitmap generation for specific mouse events\n  // For example, if you want to disable hitmap generating on drag, use: [\"onMouseDown\", \"onMouseMove\", \"onMouseUp\"]\n  disableHitmapForEvents?: MouseEventEnum[],\n  // getting events for objects stacked on top of each other is expensive, so disable it by default\n  enableStackedObjectEvents?: boolean,\n  // allow users to specify the max stacked object count\n  maxStackedObjectCount: number,\n  showDebug?: boolean,\n  children?: React.Node,\n  style: { [styleAttribute: string]: number | string },\n\n  cameraState?: $Shape<CameraState>,\n  onCameraStateChange?: (CameraState) => void,\n  defaultCameraState?: $Shape<CameraState>,\n  // interactions\n  onDoubleClick?: MouseHandler,\n  onMouseDown?: MouseHandler,\n  onMouseUp?: MouseHandler,\n  onMouseMove?: MouseHandler,\n  onClick?: MouseHandler,\n  ...Dimensions,\n|};\n\ntype State = {|\n  worldviewContext: WorldviewContext,\n|};\n\nfunction handleWorldviewMouseInteraction(\n  objects: MouseEventObject[],\n  ray: Ray,\n  e: SyntheticMouseEvent<HTMLCanvasElement>,\n  handler: MouseHandler\n) {\n  const args = { ray, objects };\n\n  try {\n    handler(e, args);\n  } catch (err) {\n    console.error(\"Error during mouse handler\", err);\n  }\n}\n\n// responsible for camera and scene state management\n// takes in children that declaritively define what should be rendered\nexport class WorldviewBase extends React.Component<BaseProps, State> {\n  _canvas: { current: HTMLCanvasElement | null } = React.createRef();\n  _tick: AnimationFrameID | void;\n  _dragStartPos: ?{ x: number, y: number } = null;\n\n  static defaultProps = {\n    maxStackedObjectCount: DEFAULT_MAX_NUMBER_OF_HITMAP_LAYERS,\n    backgroundColor: DEFAULT_BACKGROUND_COLOR,\n    shiftKeys: true,\n    style: {},\n  };\n\n  constructor(props: BaseProps) {\n    super(props);\n    const {\n      width,\n      height,\n      top,\n      left,\n      backgroundColor,\n      onCameraStateChange,\n      cameraState,\n      defaultCameraState,\n      hitmapOnMouseMove,\n      disableHitmapForEvents,\n    } = props;\n    if (onCameraStateChange) {\n      if (!cameraState) {\n        console.warn(\n          \"You provided `onCameraStateChange` without `cameraState`. Use Worldview as a controlled component with `cameraState` and `onCameraStateChange`, or uncontrolled with `defaultCameraState`.\"\n        );\n      }\n      if (cameraState && defaultCameraState) {\n        console.warn(\"You provided both `cameraState` and `defaultCameraState`. `defaultCameraState` will be ignored.\");\n      }\n    } else {\n      if (cameraState) {\n        console.warn(\n          \"You provided `cameraState` without an `onCameraStateChange` handler. This will prevent moving the camera. If the camera should be movable, use `defaultCameraState`, otherwise set `onCameraStateChange`.\"\n        );\n      }\n    }\n\n    if (hitmapOnMouseMove) {\n      if (disableHitmapForEvents) {\n        throw new Error(\n          \"Property 'hitmapOnMouseMove' is deprectated and will be ignored when used along with 'disableHitmapForEvents'.\"\n        );\n      } else {\n        console.warn(\n          \"Property 'hitmapOnMouseMove' is deprectated. Please use 'disableHitmapForEvents' property instead.\"\n        );\n      }\n    }\n\n    this.state = {\n      worldviewContext: new WorldviewContext({\n        dimension: { width, height, top, left },\n        canvasBackgroundColor: backgroundColor || DEFAULT_BACKGROUND_COLOR,\n        // DEFAULT_CAMERA_STATE is applied if both `cameraState` and `defaultCameraState` are not present\n        cameraState: props.cameraState || props.defaultCameraState || DEFAULT_CAMERA_STATE,\n        onCameraStateChange: props.onCameraStateChange || undefined,\n      }),\n    };\n  }\n\n  static getDerivedStateFromProps({ width, height, top, left }: BaseProps, { worldviewContext }: State) {\n    worldviewContext.setDimension({ width, height, top, left });\n    return null;\n  }\n\n  componentDidMount() {\n    if (!this._canvas.current) {\n      return console.warn(\"missing canvas element\");\n    }\n    const { worldviewContext } = this.state;\n    worldviewContext.initialize(this._canvas.current);\n    // trigger rendering in children that require camera to be present, e.g. Text component\n    this.setState({}); //eslint-disable-line\n    // call paint to set the correct viewportWidth and viewportHeight for camera so non-regl components\n    // such as Text can get the correct screen coordinates for the first render\n    worldviewContext.paint();\n  }\n\n  componentWillUnmount() {\n    if (this._tick) {\n      cancelAnimationFrame(this._tick);\n    }\n    this.state.worldviewContext.destroy();\n  }\n\n  componentDidUpdate() {\n    const { worldviewContext } = this.state;\n    // update internal cameraState\n    if (this.props.cameraState) {\n      worldviewContext.cameraStore.setCameraState(this.props.cameraState);\n    }\n    worldviewContext.onDirty();\n  }\n\n  _onDoubleClick = (e: SyntheticMouseEvent<HTMLCanvasElement>) => {\n    this._onMouseInteraction(e, \"onDoubleClick\");\n  };\n\n  _onMouseDown = (e: SyntheticMouseEvent<HTMLCanvasElement>) => {\n    this._dragStartPos = { x: e.clientX, y: e.clientY };\n    this._onMouseInteraction(e, \"onMouseDown\");\n  };\n\n  _onMouseMove = (e: SyntheticMouseEvent<HTMLCanvasElement>) => {\n    this._onMouseInteraction(e, \"onMouseMove\");\n  };\n\n  _onMouseUp = (e: SyntheticMouseEvent<HTMLCanvasElement>) => {\n    this._onMouseInteraction(e, \"onMouseUp\");\n    const { _dragStartPos } = this;\n    if (_dragStartPos) {\n      const deltaX = e.clientX - _dragStartPos.x;\n      const deltaY = e.clientY - _dragStartPos.y;\n      const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n      if (distance < DEFAULT_MOUSE_CLICK_RADIUS) {\n        this._onMouseInteraction(e, \"onClick\");\n      }\n      this._dragStartPos = null;\n    }\n  };\n\n  _onMouseInteraction = (e: SyntheticMouseEvent<HTMLCanvasElement>, mouseEventName: MouseEventEnum) => {\n    const { worldviewContext } = this.state;\n    const worldviewHandler = this.props[mouseEventName];\n\n    if (!(e.target instanceof window.HTMLElement) || e.button !== 0) {\n      return;\n    }\n\n    const { top: clientTop, left: clientLeft } = e.target.getBoundingClientRect();\n    const { clientX, clientY } = e;\n\n    const canvasX = clientX - clientLeft;\n    const canvasY = clientY - clientTop;\n    const ray = worldviewContext.raycast(canvasX, canvasY);\n    if (!ray) {\n      return;\n    }\n\n    // Rendering the hitmap is expensive, so we should disable it for some events.\n    // If 'disableHitmapForEvents' is provided, we ignore any events contained in that property.\n    // Otherwise, we ignore 'onMouseMove' events by default unless 'hitmapOnMouseMove' is 'true'\n    const { hitmapOnMouseMove, disableHitmapForEvents = hitmapOnMouseMove ? [] : [\"onMouseMove\"] } = this.props;\n    if (disableHitmapForEvents.includes(mouseEventName)) {\n      if (worldviewHandler) {\n        return handleWorldviewMouseInteraction([], ray, e, worldviewHandler);\n      }\n      return;\n    }\n\n    // reading hitmap is async so we need to persist the event to use later in the event handler\n    (e: any).persist();\n    worldviewContext\n      .readHitmap(canvasX, canvasY, !!this.props.enableStackedObjectEvents, this.props.maxStackedObjectCount)\n      .then((mouseEventsWithCommands) => {\n        const mouseEventsByCommand: Map<Command<any>, Array<MouseEventObject>> = aggregate(mouseEventsWithCommands);\n        for (const [command, mouseEvents] of mouseEventsByCommand.entries()) {\n          command.handleMouseEvent(mouseEvents, ray, e, mouseEventName);\n          if (e.isPropagationStopped()) {\n            break;\n          }\n        }\n        if (worldviewHandler && !e.isPropagationStopped()) {\n          const mouseEvents = mouseEventsWithCommands.map(([mouseEventObject]) => mouseEventObject);\n          handleWorldviewMouseInteraction(mouseEvents, ray, e, worldviewHandler);\n        }\n      })\n      .catch((e) => {\n        console.error(e);\n      });\n  };\n\n  _renderDebug() {\n    const { worldviewContext } = this.state;\n    const initializedData = worldviewContext.initializedData;\n\n    if (getNodeEnv() === \"production\" || !initializedData) {\n      return null;\n    }\n    const { regl } = initializedData;\n    const mem = window.performance.memory;\n    const style = {\n      bottom: 5,\n      right: 10,\n      width: 200,\n      position: \"absolute\",\n      backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n      color: \"white\",\n      fontFamily: \"monospace\",\n      fontSize: 10,\n    };\n    const { counters, reglCommandObjects } = worldviewContext;\n    const data = mapValues(counters, (val) => `${val} ms`);\n    data[\"draw calls\"] = reglCommandObjects.reduce((total, cmd) => total + cmd.stats.count, 0);\n    if (mem) {\n      data[\"heap used\"] = `${((mem.usedJSHeapSize / mem.jsHeapSizeLimit) * 100).toFixed(3)}%`;\n    }\n\n    Object.assign(data, pickBy(regl.stats, (val) => typeof val === \"number\" && val !== 0));\n    if (regl.stats.bufferCount > 1000) {\n      throw new Error(\"Memory leak: Buffer count > 1000.\");\n    }\n\n    const rows = Object.keys(data).map((key) => {\n      return (\n        <tr key={key} style={{ backgroundColor: \"transparent\", border: \"none\" }}>\n          <td style={{ paddingRight: 10, border: \"none\" }}>{key}</td>\n          <td style={{ width: \"100%\", border: \"none\" }}>{data[key]}</td>\n        </tr>\n      );\n    });\n    return (\n      <table style={style}>\n        <tbody>{rows}</tbody>\n      </table>\n    );\n  }\n\n  render() {\n    const { width, height, showDebug, keyMap, shiftKeys, style, cameraState, onCameraStateChange } = this.props;\n    const { worldviewContext } = this.state;\n    // If we are supplied controlled camera state and no onCameraStateChange callback\n    // then there is a 'fixed' camera from outside of worldview itself.\n    const isFixedCamera = cameraState && !onCameraStateChange;\n    const canvasHtml = (\n      <React.Fragment>\n        <canvas\n          style={{ width, height, maxWidth: \"100%\", maxHeight: \"100%\" }}\n          width={width}\n          height={height}\n          ref={this._canvas}\n          onMouseUp={this._onMouseUp}\n          onMouseDown={this._onMouseDown}\n          onDoubleClick={this._onDoubleClick}\n          onMouseMove={this._onMouseMove}\n        />\n        {showDebug && this._renderDebug()}\n      </React.Fragment>\n    );\n\n    return (\n      <div style={{ position: \"relative\", overflow: \"hidden\", ...style }}>\n        {/* skip rendering CameraListener if Worldview has a fixed camera */}\n        {isFixedCamera ? (\n          canvasHtml\n        ) : (\n          <CameraListener cameraStore={worldviewContext.cameraStore} keyMap={keyMap} shiftKeys={shiftKeys}>\n            {canvasHtml}\n          </CameraListener>\n        )}\n        {worldviewContext.initializedData && (\n          <WorldviewReactContext.Provider value={worldviewContext}>\n            {this.props.children}\n          </WorldviewReactContext.Provider>\n        )}\n      </div>\n    );\n  }\n}\n\nexport type Props = $Diff<React.ElementConfig<typeof WorldviewBase>, Dimensions>;\n\nconst Worldview = (props: Props) => (\n  <ContainerDimensions>\n    {({ width, height, left, top }) => <WorldviewBase width={width} height={height} left={left} top={top} {...props} />}\n  </ContainerDimensions>\n);\n\nWorldview.displayName = \"Worldview\";\n\nexport default Worldview;\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n// Takes an array of [value, key] and aggregates across the keys. Results in a Map of [key, values[]], in order of the\n// keys as seen in the array.\nexport default function aggregate<T, K>(array: Array<[T, K]>): Map<K, T[]> {\n  const aggregationMap = new Map<K, T[]>();\n  array.forEach(([item, key]) => {\n    const existingItems = aggregationMap.get(key) || [];\n    existingItems.push(item);\n    if (!aggregationMap.has(key)) {\n      aggregationMap.set(key, existingItems);\n    }\n  });\n  return aggregationMap;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Point } from \"../types\";\n\n// a single min/max value\nclass Bound {\n  min: number;\n  max: number;\n\n  constructor() {\n    this.min = Number.MAX_SAFE_INTEGER;\n    this.max = Number.MIN_SAFE_INTEGER;\n  }\n  // update the bound based on a value\n  update(value: number) {\n    this.min = Math.min(this.min, value);\n    this.max = Math.max(this.max, value);\n  }\n}\n\n// represents x, y, and z min & max bounds for a 3d scene\nexport default class Bounds {\n  x: Bound;\n  y: Bound;\n  z: Bound;\n\n  constructor() {\n    this.x = new Bound();\n    this.y = new Bound();\n    this.z = new Bound();\n  }\n\n  // update the bounds based on a point\n  update(point: Point) {\n    this.x.update(point.x);\n    this.y.update(point.y);\n    this.z.update(point.z);\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { ReglCommand, Vec3 } from \"../types\";\nimport { withPose, pointToVec3, defaultBlend, defaultDepth, shouldConvert, colorBuffer } from \"./commandUtils\";\n\n// Creates a regl command factory which will render any geometry described by point positions\n// and elements (indexes into the array of positions), and apply the object's pose, scale, and color to it.\nexport default (positions: Vec3[], elements: Vec3[]) => (regl: any): ReglCommand => {\n  const vertexArray = Float32Array.from([].concat(...positions));\n\n  if (elements.some((face) => face.some((i) => i < 0 || i >= 1 << 16))) {\n    throw new Error(\"Element index out of bounds for Uint16\");\n  }\n  const elementsArray = Uint16Array.from([].concat(...elements));\n\n  const buff = regl.buffer({\n    // tell the gpu this buffer's contents will change frequently\n    usage: \"dynamic\",\n    data: [],\n  });\n  const colorBuff = colorBuffer(regl);\n\n  return withPose({\n    vert: `\n    precision mediump float;\n    attribute vec3 point;\n    attribute vec3 offset;\n    attribute vec4 color;\n    uniform mat4 projection, view;\n    uniform vec3 scale;\n    varying vec4 vColor;\n\n    #WITH_POSE\n\n    void main () {\n      vec3 p = applyPose(scale * point) + offset;\n      vColor = color;\n      gl_Position = projection * view * vec4(p, 1);\n    }\n    `,\n    frag: `\n    precision mediump float;\n    varying vec4 vColor;\n    void main () {\n      gl_FragColor = vColor;\n    }`,\n\n    attributes: {\n      point: vertexArray,\n      color: (context, props) => {\n        return colorBuff(props.color, props.colors, props.points ? props.points.length : 1);\n      },\n\n      offset: (context, props) => {\n        const points = shouldConvert(props.points) ? props.points.map(pointToVec3) : props.points || [0, 0, 0];\n        return {\n          buffer: buff({\n            usage: \"dynamic\",\n            data: points,\n          }),\n          divisor: 1,\n        };\n      },\n    },\n\n    elements: elementsArray,\n\n    depth: defaultDepth,\n    blend: defaultBlend,\n\n    uniforms: {\n      scale: (context, props) => (shouldConvert(props.scale) ? pointToVec3(props.scale) : props.scale),\n    },\n\n    count: elementsArray.length,\n\n    instances: (context, props) => (props.points ? props.points.length : 1),\n  });\n};\n","// @flow\n\n//  Copyright (c) 2019-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\ntype TypedArray = Int8Array | Uint8Array | Int16Array | Uint16Array | Uint32Array | Float32Array;\n\nexport type GLBModel = {\n  json: Object,\n  accessors?: TypedArray[],\n  images?: ImageBitmap[],\n};\n\n// Parse a GLB file: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0\n//\n// Returns an object containing the raw json data as well as parsed images (Image) and\n// accessors (TypedArray).\nexport default async function parseGLB(arrayBuffer: ArrayBuffer): Promise<GLBModel> {\n  const data = new DataView(arrayBuffer);\n  let offset = 0;\n\n  function readUint32() {\n    const value = data.getUint32(offset, true);\n    offset += 4;\n    return value;\n  }\n\n  // magic header\n  const magic = readUint32();\n  if (magic !== 0x46546c67) {\n    throw new Error(`incorrect magic value 0x${magic.toString(16)}`);\n  }\n\n  // Binary glTF version\n  const version = readUint32();\n  if (version !== 2) {\n    throw new Error(`incorrect version ${version}`);\n  }\n\n  // total file length\n  const totalLength = readUint32();\n  if (totalLength !== data.byteLength) {\n    throw new Error(`length ${totalLength} doesn't match response length ${data.byteLength}`);\n  }\n\n  function findNextChunkOfType(type) {\n    do {\n      const chunkLength = readUint32();\n      const chunkType = readUint32();\n      if (chunkType === type) {\n        const chunkData = new DataView(data.buffer, offset, chunkLength);\n        offset += chunkLength;\n        return chunkData;\n      }\n      offset += chunkLength;\n    } while (offset < totalLength);\n  }\n\n  const jsonData = findNextChunkOfType(/* JSON */ 0x4e4f534a);\n  if (!jsonData) {\n    throw new Error(\"no JSON chunk found\");\n  }\n\n  const json = JSON.parse(new TextDecoder().decode(jsonData));\n\n  const binary = findNextChunkOfType(/* BIN */ 0x004e4942);\n  if (!binary) {\n    return { json };\n  }\n\n  if (json.buffers[0].uri !== undefined) {\n    throw new Error(\"expected GLB-stored buffer\");\n  }\n\n  // create a TypedArray for each accessor\n  const accessors = json.accessors.map((accessorInfo) => {\n    let arrayType;\n    // prettier-ignore\n    switch (accessorInfo.componentType) {\n      case WebGLRenderingContext.BYTE: arrayType = Int8Array; break;\n      case WebGLRenderingContext.UNSIGNED_BYTE: arrayType = Uint8Array; break;\n      case WebGLRenderingContext.SHORT: arrayType = Int16Array; break;\n      case WebGLRenderingContext.UNSIGNED_SHORT: arrayType = Uint16Array; break;\n      case WebGLRenderingContext.UNSIGNED_INT: arrayType = Uint32Array; break;\n      case WebGLRenderingContext.FLOAT: arrayType = Float32Array; break;\n      default:\n        throw new Error(`unrecognized componentType ${accessorInfo.componentType}`);\n    }\n    let numComponents;\n    // prettier-ignore\n    switch (accessorInfo.type) {\n      case \"SCALAR\": numComponents = 1; break;\n      case \"VEC2\": numComponents = 2; break;\n      case \"VEC3\": numComponents = 3; break;\n      case \"VEC4\": numComponents = 4; break;\n      case \"MAT2\": numComponents = 4; break;\n      case \"MAT3\": numComponents = 9; break;\n      case \"MAT4\": numComponents = 16; break;\n      default:\n        throw new Error(`unrecognized type ${accessorInfo.type}`);\n    }\n    const bufferView = json.bufferViews[accessorInfo.bufferView];\n    if (bufferView.buffer !== 0) {\n      throw new Error(\"only GLB-stored buffers are supported\");\n    }\n    if (bufferView.byteLength % arrayType.BYTES_PER_ELEMENT !== 0) {\n      throw new Error(\"bufferView.byteLength mismatch\");\n    }\n    return new arrayType(\n      binary.buffer,\n      binary.byteOffset + (bufferView.byteOffset || 0) + (accessorInfo.byteOffset || 0),\n      accessorInfo.count * numComponents\n    );\n  });\n\n  // load embedded images\n  const images =\n    json.images &&\n    (await Promise.all(\n      json.images.map((imgInfo) => {\n        const bufferView = json.bufferViews[imgInfo.bufferView];\n        const data = new DataView(binary.buffer, binary.byteOffset + bufferView.byteOffset, bufferView.byteLength);\n        return self.createImageBitmap(new Blob([data], { type: imgInfo.mimeType }));\n      })\n    ));\n\n  return { json, accessors, images };\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { AssignNextColorsFn, MouseEventObject } from \"../types\";\n\nfunction nonInstancedGetChildrenForHitmapFromSingleProp<T: any>(\n  prop: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[],\n  useOriginalMarkerProp: boolean = false\n): ?T {\n  // The marker that we send to event callbacks.\n  const eventCallbackMarker = useOriginalMarkerProp ? prop.originalMarker : prop;\n  if (excludedObjects.some(({ object }) => object === eventCallbackMarker)) {\n    return null;\n  }\n  const hitmapProp = { ...prop };\n  const [hitmapColor] = assignNextColors(eventCallbackMarker, 1);\n  hitmapProp.color = hitmapColor;\n  if (hitmapProp.colors && hitmapProp.points && hitmapProp.points.length) {\n    hitmapProp.colors = new Array(hitmapProp.points.length).fill(hitmapColor);\n  }\n  return hitmapProp;\n}\n\nexport const nonInstancedGetChildrenForHitmap = <T: any>(\n  props: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[]\n): ?T => {\n  if (Array.isArray(props)) {\n    return props\n      .map((prop) => nonInstancedGetChildrenForHitmapFromSingleProp(prop, assignNextColors, excludedObjects))\n      .filter(Boolean);\n  }\n  return nonInstancedGetChildrenForHitmapFromSingleProp(props, assignNextColors, excludedObjects);\n};\n\n// Almost identical to nonInstancedGetChildrenForHitmap, but instead the object passed to event callbacks is the object\n// at `prop.originalMarker`, not just `prop`.\nexport const getChildrenForHitmapWithOriginalMarker = <T: any>(\n  props: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[]\n) => {\n  if (Array.isArray(props)) {\n    return props\n      .map((prop) => nonInstancedGetChildrenForHitmapFromSingleProp(prop, assignNextColors, excludedObjects, true))\n      .filter(Boolean);\n  }\n  return nonInstancedGetChildrenForHitmapFromSingleProp(props, assignNextColors, excludedObjects, true);\n};\n\nfunction instancedGetChildrenForHitmapFromSingleProp<T: any>(\n  prop: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[],\n  pointCountPerInstance\n): ?T {\n  const matchedExcludedObjects = excludedObjects.filter(({ object, instanceIndex }) => object === prop);\n  const filteredIndices = matchedExcludedObjects\n    .map(({ object, instanceIndex }) => instanceIndex)\n    .filter((instanceIndex) => typeof instanceIndex === \"number\");\n  const hitmapProp = { ...prop };\n  const instanceCount = (hitmapProp.points && Math.ceil(hitmapProp.points.length / pointCountPerInstance)) || 1;\n  // This returns 1 color per instance.\n  const idColors = assignNextColors(prop, instanceCount);\n  const startColor = idColors[0];\n  // We have to map these instance colors to `pointCountPerInstance` number of points\n  if (hitmapProp.points && hitmapProp.points.length) {\n    const allColors = new Array(hitmapProp.points.length).fill().map(() => startColor);\n    for (let i = 0; i < instanceCount; i++) {\n      for (let j = 0; j < pointCountPerInstance; j++) {\n        const idx = i * pointCountPerInstance + j;\n        if (idx < allColors.length) {\n          allColors[idx] = idColors[i];\n        }\n      }\n    }\n    hitmapProp.colors = allColors;\n    if (filteredIndices.length) {\n      hitmapProp.points = hitmapProp.points.filter(\n        (_, index) => !filteredIndices.includes(Math.floor(index / pointCountPerInstance))\n      );\n      hitmapProp.colors = hitmapProp.colors.filter(\n        (_, index) => !filteredIndices.includes(Math.floor(index / pointCountPerInstance))\n      );\n    } else if (matchedExcludedObjects.length) {\n      // if we don't have instance indices, just filter out the whole object.\n      return null;\n    }\n  } else {\n    hitmapProp.color = startColor;\n    if (matchedExcludedObjects.length) {\n      return null;\n    }\n  }\n  return hitmapProp;\n}\n\nexport const createInstancedGetChildrenForHitmap = (pointCountPerInstance: number) => <T: any>(\n  props: T,\n  assignNextColors: AssignNextColorsFn,\n  excludedObjects: MouseEventObject[]\n): ?T => {\n  if (Array.isArray(props)) {\n    return props\n      .map((prop) =>\n        instancedGetChildrenForHitmapFromSingleProp(prop, assignNextColors, excludedObjects, pointCountPerInstance)\n      )\n      .filter(Boolean);\n  }\n  return instancedGetChildrenForHitmapFromSingleProp(props, assignNextColors, excludedObjects, pointCountPerInstance);\n};\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Cylinder } from \"../types\";\nimport fromGeometry from \"../utils/fromGeometry\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nexport function createCylinderGeometry(numSegments: number, cone: boolean) {\n  // \"poles\" are the centers of top/bottom faces\n  const northPole = [0, 0, 0.5];\n  const southPole = [0, 0, -0.5];\n\n  const points = [northPole, southPole];\n\n  // Keep side faces separate from top/bottom to improve appearance for semi-transparent colors.\n  // We don't have a good approach to transparency right now but this is a small improvement over mixing the faces.\n  const sideFaces = [];\n  const endCapFaces = [];\n\n  for (let i = 0; i < numSegments; i++) {\n    const theta = (2 * Math.PI * i) / numSegments;\n    const x = 0.5 * Math.cos(theta);\n    const y = 0.5 * Math.sin(theta);\n    points.push([x, y, 0.5], [x, y, -0.5]);\n\n    const bottomLeftPt = points.length - 1;\n    const topRightPt = cone ? 0 : i + 1 === numSegments ? 2 : points.length;\n    const bottomRightPt = i + 1 === numSegments ? 3 : points.length + 1;\n    sideFaces.push([bottomLeftPt, topRightPt, bottomRightPt]);\n    endCapFaces.push([bottomLeftPt, bottomRightPt, 1]);\n    if (!cone) {\n      const topLeftPt = points.length - 2;\n      sideFaces.push([topLeftPt, bottomLeftPt, topRightPt]);\n      endCapFaces.push([topLeftPt, topRightPt, 0]);\n    }\n  }\n  return { points, sideFaces, endCapFaces };\n}\n\nconst { points, sideFaces, endCapFaces } = createCylinderGeometry(30, false);\n\nconst cylinders = fromGeometry(points, sideFaces.concat(endCapFaces));\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Cylinders(props: { ...CommonCommandProps, children: Cylinder[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={cylinders} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Cone } from \"../types\";\nimport fromGeometry from \"../utils/fromGeometry\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\nimport { createCylinderGeometry } from \"./Cylinders\";\n\nconst { points, sideFaces, endCapFaces } = createCylinderGeometry(30, true);\n\nconst cones = fromGeometry(points, sideFaces.concat(endCapFaces));\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Cones(props: { ...CommonCommandProps, children: Cone[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={cones} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, quat } from \"gl-matrix\";\nimport omit from \"lodash/omit\";\nimport React, { memo, Fragment } from \"react\";\n\nimport type { Arrow } from \"../types\";\nimport { pointToVec3, vec3ToPoint, orientationToVec4, vec4ToOrientation } from \"../utils/commandUtils\";\nimport { getChildrenForHitmapWithOriginalMarker } from \"../utils/getChildrenForHitmapDefaults\";\nimport type { CommonCommandProps } from \"./Command\";\nimport Cones from \"./Cones\";\nimport Cylinders from \"./Cylinders\";\n\nconst UNIT_X_VECTOR = Object.freeze([0, 0, 1]);\n\ntype Props = {\n  ...CommonCommandProps,\n  children: Arrow[],\n};\n\nfunction Arrows(props: Props) {\n  const passedProps = omit(props, \"children\");\n  const cylinders = [];\n  const cones = [];\n  for (const marker of props.children) {\n    let shaftWidthX;\n    let shaftWidthY;\n    let shaftLength;\n    let headWidthX;\n    let headWidthY;\n    let headLength;\n\n    let basePosition;\n    let orientation;\n    let dir;\n    if (marker.points && marker.points.length === 2) {\n      const [start, end] = marker.points;\n      basePosition = [start.x, start.y, start.z];\n      const tipPosition = [end.x, end.y, end.z];\n      const length = vec3.distance(basePosition, tipPosition);\n\n      dir = vec3.subtract([0, 0, 0], tipPosition, basePosition);\n      vec3.normalize(dir, dir);\n      orientation = quat.rotationTo([0, 0, 0, 0], UNIT_X_VECTOR, dir);\n\n      headWidthX = headWidthY = marker.scale.y;\n      headLength = marker.scale.z || length * 0.3;\n      shaftWidthX = shaftWidthY = marker.scale.x;\n      shaftLength = length - headLength;\n    } else {\n      basePosition = pointToVec3(marker.pose.position);\n      orientation = orientationToVec4(marker.pose.orientation);\n      quat.rotateY(orientation, orientation, Math.PI / 2);\n      dir = vec3.transformQuat([0, 0, 0], UNIT_X_VECTOR, orientation);\n\n      shaftWidthX = marker.scale.y || 1;\n      shaftWidthY = marker.scale.z || 1;\n      headWidthX = 2 * shaftWidthX;\n      headWidthY = 2 * shaftWidthY;\n\n      // these magic numbers taken from\n      // https://github.com/ros-visualization/rviz/blob/57325fa075893de70f234f4676cdd08b411858ff/src/rviz/default_plugin/markers/arrow_marker.cpp#L113\n      headLength = 0.23 * (marker.scale.x || 1);\n      shaftLength = 0.77 * (marker.scale.x || 1);\n    }\n\n    const shaftPosition = vec3.scaleAndAdd([0, 0, 0], basePosition, dir, shaftLength / 2);\n    const headPosition = vec3.scaleAndAdd([0, 0, 0], basePosition, dir, shaftLength + headLength / 2);\n\n    cylinders.push({\n      // Set the original marker so we can use it in mouse events\n      originalMarker: marker,\n      scale: { x: shaftWidthX, y: shaftWidthY, z: shaftLength },\n      color: marker.color,\n      pose: {\n        position: vec3ToPoint(shaftPosition),\n        orientation: vec4ToOrientation(orientation),\n      },\n    });\n    cones.push({\n      // Set the original marker so we can use it in mouse events\n      originalMarker: marker,\n      scale: { x: headWidthX, y: headWidthY, z: headLength },\n      color: marker.color,\n      pose: {\n        position: vec3ToPoint(headPosition),\n        orientation: vec4ToOrientation(orientation),\n      },\n    });\n  }\n\n  return (\n    <Fragment>\n      <Cylinders getChildrenForHitmap={getChildrenForHitmapWithOriginalMarker} {...passedProps}>\n        {cylinders}\n      </Cylinders>\n      <Cones getChildrenForHitmap={getChildrenForHitmapWithOriginalMarker} {...passedProps}>\n        {cones}\n      </Cones>\n    </Fragment>\n  );\n}\n\nexport default memo<Props>(Arrows);\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport flatten from \"lodash/flatten\";\nimport * as React from \"react\";\n\nimport type { Line, Vec4, Color, Pose } from \"../types\";\nimport { defaultBlend, withPose, toRGBA, shouldConvert, pointToVec3 } from \"../utils/commandUtils\";\nimport { nonInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\n/*\nTriangle-based line drawing.\n\n4 points (a strip of 2 triangles) are drawn for each segment of the line using instanced arrays.\nEach of the 4 points has a distinct \"point type\" which informs how the input point is offset to\nyield the vertices of the triangle.\n\nPassing the input point as an attribute with {divisor: 1} tells GL to use each point for 1 instance,\nthen move on to the next point -- something like `points.map((p) => draw2Triangles(p))`.\n\n4 attributes are used so the vertex shader can see 4 input points at once (reading from the same\nbuffer with different offsets). This is because the positions of the TL/BL endpoints depend on the\nangle ABC, and the positions of TR/BR depend on the angle BCD.\n\nRoughly the segment looks like:\n\n     TL   -   -   -  .TR\n      |          ,.-' |\nA - - B - - -,.-' - - C - - D\n      |  ,.-'         |\n     BL-' -   -   -   BR\n\nWhen two adjacent segments form an obtuse angle, we draw a miter join:\n\n                      TR/TL.\n                 , '   _/|   ' .\n             , '     _/  |       ' .\n         , '       _/    C           ' .\n     , '         _/      |               ' .\n   TL          _/        |        ______,----'TR\n    \\        _/       ,BR/BL.----'            /\n     B     _/    , '          ' .            D\n      \\  _/ , '                   ' .       /\n       BL'                            ' . BR\n\nBut when the angle gets too sharp, we switch to a \"fold\" join, where the two segments overlap at\nthe corner:\n\n        ,TR/BL---C--BR/TL\n       ,    |.\\__  ,     .\n      ,     | .  \\,_      .\n     ,      |  . ,  \\_     .\n    ,       |   ,     \\__   .\n   ,        |  , .       \\__ .\n  TL._      | ,   .        _.TR\n      'B._  |,     .   _.C'\n          'BL       BR'\n\n(A regular bevel join without any overlaps is harder to achieve without artifacts in the sharp-angle\nedge cases.)\n\n*/\n\nconst FLOAT_BYTES = Float32Array.BYTES_PER_ELEMENT;\nconst POINT_BYTES = 3 * FLOAT_BYTES;\nconst DEFAULT_MONOCHROME_COLOR = [1, 1, 1, 0.2];\n\n// The four points forming the triangles' vertices.\n// Values do not matter, they just need to be distinct.\nconst POINT_TYPES = { BL: 0, TR: 1, BR: 2, TL: 3 };\nconst VERTICES_PER_INSTANCE = Object.keys(POINT_TYPES).length;\n\nconst vert = `\nprecision mediump float;\n\nattribute float pointType;\n\n// per-instance attributes\nattribute vec4 colorB;\nattribute vec4 colorC;\nattribute vec3 positionA;\nattribute vec3 positionB;\nattribute vec3 positionC;\nattribute vec3 positionD;\n// per-instance pose attributes\nattribute vec3 posePosition;\nattribute vec4 poseRotation;\n\nuniform mat4 projection, view;\nuniform float viewportWidth;\nuniform float viewportHeight;\nuniform float alpha;\nuniform float thickness;\nuniform bool joined;\nuniform bool scaleInvariant;\n\nvarying vec4 vColor;\n\n${Object.keys(POINT_TYPES)\n  .map((k) => `const float POINT_${k} = ${POINT_TYPES[k]}.0;`)\n  .join(\"\\n\")}\n\n#WITH_POSE\n\nvec3 applyPoseInstance(vec3 point, vec4 rotation, vec3 position) {\n  // rotate the point and then add the position of the pose\n  // this function is defined in WITH_POSE\n  return rotate(point, rotation) + position;\n}\n\nvec2 rotateCCW(vec2 v) {\n  return vec2(-v.y, v.x);\n}\n\nvec2 normalizeOrZero(vec2 v) {\n  return length(v) < 0.00001 ? vec2(0, 0) : normalize(v);\n}\n\nvoid setPosition(vec4 proj, vec2 offset) {\n  gl_Position = proj;\n\n  offset *= thickness / 2.;\n\n  if (scaleInvariant) {\n    // The given thickness is a number of pixels on screen. Divide x by width/2 and\n    // y by height/2 so that they correspond to pixel distances when scaled from clip space to NDC.\n    offset.x /= viewportWidth / 2.0;\n    offset.y /= viewportHeight / 2.0;\n    // Compensate for automatic division by w\n    offset *= proj.w;\n  } else {\n    // The line thickness should be scaled the same way the camera scales other distances.\n    // projection[0].xyz is the result of projecting a unit x-vector, so its length represents\n    // how much distances are scaled by the camera projection.\n    offset *= length(projection[0].xyz);\n    offset.y *= viewportWidth / viewportHeight;\n  }\n\n  gl_Position.xy += offset;\n}\n\nvoid main () {\n  bool isStart = positionA == positionB;\n  bool isEnd = positionC == positionD;\n  bool isLeft = (pointType == POINT_TL || pointType == POINT_BL);\n  bool isTop = (pointType == POINT_TL || pointType == POINT_TR);\n  bool isEndpoint = isLeft ? isStart : isEnd;\n\n  float scale = isTop ? 1. : -1.;\n\n  mat4 projView = projection * view;\n  vec4 projA = projView * vec4(applyPose(applyPoseInstance(positionA, poseRotation, posePosition)), 1);\n  vec4 projB = projView * vec4(applyPose(applyPoseInstance(positionB, poseRotation, posePosition)), 1);\n  vec4 projC = projView * vec4(applyPose(applyPoseInstance(positionC, poseRotation, posePosition)), 1);\n  vec4 projD = projView * vec4(applyPose(applyPoseInstance(positionD, poseRotation, posePosition)), 1);\n\n  vec2 aspectVec = vec2(viewportWidth / viewportHeight, 1.0);\n  vec2 screenA = projA.xy / projA.w * aspectVec;\n  vec2 screenB = projB.xy / projB.w * aspectVec;\n  vec2 screenC = projC.xy / projC.w * aspectVec;\n  vec2 screenD = projD.xy / projD.w * aspectVec;\n\n  vec2 dirAB = normalizeOrZero(screenB - screenA);\n  vec2 dirBC = normalizeOrZero(screenC - screenB);\n  vec2 dirCD = normalizeOrZero(screenD - screenC);\n\n  vec2 perpAB = rotateCCW(dirAB); // vector perpendicular to AB\n  vec2 perpBC = rotateCCW(dirBC); // vector perpendicular to BC\n\n  vColor = isLeft ? colorB : colorC;\n  vColor.a *= alpha;\n\n  vec4 proj = isLeft ? projB : projC;\n\n  // simple case: non-joined line list\n  if (!joined || isEndpoint) {\n    setPosition(proj, scale * perpBC);\n    return;\n  }\n\n  // clamp to prevent rounding errors from breaking the sqrt()s below\n  float cosB = clamp(-dot(dirAB, dirBC), -1., 1.);\n  float cosC = clamp(-dot(dirBC, dirCD), -1., 1.);\n\n  bool tooSharpB = cosB > 0.01;\n  bool tooSharpC = cosC > 0.01;\n  bool tooSharp = isLeft ? tooSharpB : tooSharpC;\n\n  bool turningRightB = dot(dirAB, rotateCCW(dirBC)) > 0.;\n  bool turningRightC = dot(dirBC, rotateCCW(dirCD)) > 0.;\n  bool turningRight = isLeft ? turningRightB : turningRightC;\n\n  if (tooSharp) {\n    // \"fold join\"\n    vec2 perp = isLeft ? perpAB : perpBC;\n    vec2 dir = isLeft ? dirAB : dirBC;\n    float scalePerp = isLeft ? -1. : 1.;\n    float scaleDir = (turningRight == isLeft) ? 1. : -1.;\n    float tanHalfB = sqrt((1. - cosB) / (1. + cosB));\n    float tanHalfC = sqrt((1. - cosC) / (1. + cosC));\n    float tanHalf = isLeft ? tanHalfB : tanHalfC;\n    setPosition(proj, scale * (scalePerp * perp + scaleDir * dir * tanHalf));\n  } else {\n    // miter join\n    vec2 bisectorB = rotateCCW(normalize(dirAB + dirBC)); // angle bisector of ABC\n    vec2 bisectorC = rotateCCW(normalize(dirBC + dirCD)); // angle bisector of BCD\n    vec2 bisector = isLeft ? bisectorB : bisectorC;\n    float sinHalfB = sqrt((1. - cosB) / 2.);\n    float sinHalfC = sqrt((1. - cosC) / 2.);\n    float sinHalf = isLeft ? sinHalfB : sinHalfC;\n    setPosition(proj, scale * bisector / sinHalf);\n  }\n}\n`;\n\nconst frag = `\nprecision mediump float;\nvarying vec4 vColor;\nvoid main () {\n  gl_FragColor = vColor;\n}\n`;\n\nfunction pointsEqual(a, b) {\n  const [ax, ay, az] = shouldConvert(a) ? pointToVec3(a) : a;\n  const [bx, by, bz] = shouldConvert(b) ? pointToVec3(b) : b;\n  return ax === bx && ay === by && az === bz;\n}\n\nconst lines = (regl: any) => {\n  // The point type attribute, reused for each instance\n  const pointTypeBuffer = regl.buffer({\n    type: \"uint16\",\n    usage: \"static\",\n    data: [POINT_TYPES.TL, POINT_TYPES.BL, POINT_TYPES.TR, POINT_TYPES.BR],\n  });\n  const debugColorBuffer = regl.buffer({\n    type: \"float\",\n    usage: \"static\",\n    data: [\n      [0, 1, 1, 1], // cyan\n      [1, 0, 0, 1], // red\n      [0, 1, 0, 1], // green\n      [1, 0, 1, 1], // magenta\n    ],\n  });\n  // The pose position and rotation buffers contain the identity position/rotation, for use when we don't have instanced\n  // poses.\n  const defaultPosePositionBuffer = regl.buffer({\n    type: \"float\",\n    usage: \"static\",\n    data: flatten(new Array(VERTICES_PER_INSTANCE).fill([0, 0, 0])),\n  });\n  const defaultPoseRotationBuffer = regl.buffer({\n    type: \"float\",\n    usage: \"static\",\n    // Rotation array identity is [x: 0, y: 0, z: 0, w: 1]\n    data: flatten(new Array(VERTICES_PER_INSTANCE).fill([0, 0, 0, 1])),\n  });\n\n  // The buffers used for input position & color data\n  const colorBuffer = regl.buffer({ type: \"float\" });\n\n  // All invocations of the vertex shader share data from the positions buffer, but with different\n  // offsets. However, when offset and stride are combined, 3 or 4 attributes reading from the same\n  // buffer produces incorrect results on certain Lenovo hardware running Ubuntu. As a workaround,\n  // we upload the same data into two buffers and have only two attributes reading from each buffer.\n  const positionBuffer1 = regl.buffer({ type: \"float\" });\n  const positionBuffer2 = regl.buffer({ type: \"float\" });\n\n  const posePositionBuffer = regl.buffer({ type: \"float\" });\n  const poseRotationBuffer = regl.buffer({ type: \"float\" });\n\n  const command = regl(\n    withPose({\n      vert,\n      frag,\n      blend: defaultBlend,\n      uniforms: {\n        thickness: regl.prop(\"scale.x\"),\n        viewportWidth: regl.context(\"viewportWidth\"),\n        viewportHeight: regl.context(\"viewportHeight\"),\n        alpha: regl.prop(\"alpha\"),\n        joined: regl.prop(\"joined\"),\n        scaleInvariant: regl.prop(\"scaleInvariant\"),\n      },\n      attributes: {\n        pointType: pointTypeBuffer,\n        colorB: (context, { joined, monochrome, debug }) => ({\n          buffer: debug ? debugColorBuffer : colorBuffer,\n          offset: 0,\n          stride: (joined || monochrome || debug ? 1 : 2) * 4 * FLOAT_BYTES,\n          divisor: monochrome || debug ? 0 : 1,\n        }),\n        colorC: (context, { joined, monochrome, debug }) => ({\n          buffer: debug ? debugColorBuffer : colorBuffer,\n          offset: monochrome || debug ? 0 : 4 * FLOAT_BYTES,\n          stride: (joined || monochrome || debug ? 1 : 2) * 4 * FLOAT_BYTES,\n          divisor: monochrome || debug ? 0 : 1,\n        }),\n        positionA: (context, { joined }) => ({\n          buffer: positionBuffer1,\n          offset: 0,\n          stride: (joined ? 1 : 2) * POINT_BYTES,\n          divisor: 1,\n        }),\n        positionB: (context, { joined }) => ({\n          buffer: positionBuffer1,\n          offset: POINT_BYTES,\n          stride: (joined ? 1 : 2) * POINT_BYTES,\n          divisor: 1,\n        }),\n        positionC: (context, { joined }) => ({\n          buffer: positionBuffer2,\n          offset: 2 * POINT_BYTES,\n          stride: (joined ? 1 : 2) * POINT_BYTES,\n          divisor: 1,\n        }),\n        positionD: (context, { joined }) => ({\n          buffer: positionBuffer2,\n          offset: 3 * POINT_BYTES,\n          stride: (joined ? 1 : 2) * POINT_BYTES,\n          divisor: 1,\n        }),\n        posePosition: (context, { hasInstancedPoses }) => ({\n          buffer: hasInstancedPoses ? posePositionBuffer : defaultPosePositionBuffer,\n          divisor: hasInstancedPoses ? 1 : 0,\n        }),\n        poseRotation: (context, { hasInstancedPoses }) => ({\n          buffer: hasInstancedPoses ? poseRotationBuffer : defaultPoseRotationBuffer,\n          divisor: hasInstancedPoses ? 1 : 0,\n        }),\n      },\n      count: VERTICES_PER_INSTANCE,\n      instances: regl.prop(\"instances\"),\n      primitive: regl.prop(\"primitive\"),\n    })\n  );\n\n  let colorArray = new Float32Array(VERTICES_PER_INSTANCE * 4);\n  let pointArray = new Float32Array(0);\n  let allocatedPoints = 0;\n  let positionArray = new Float32Array(0);\n  let rotationArray = new Float32Array(0);\n\n  function fillPointArray(points: any[], alreadyClosed: boolean, shouldClose: boolean) {\n    const numTotalPoints = points.length + (shouldClose ? 3 : 2);\n    if (allocatedPoints < numTotalPoints) {\n      pointArray = new Float32Array(numTotalPoints * 3);\n      allocatedPoints = numTotalPoints;\n    }\n    points.forEach((point, i) => {\n      const [x, y, z] = shouldConvert(point) ? pointToVec3(point) : point;\n      const off = 3 + i * 3;\n      pointArray[off + 0] = x;\n      pointArray[off + 1] = y;\n      pointArray[off + 2] = z;\n    });\n\n    // The \"prior\" point (A) and \"next\" point (D) need to be set when rendering the first & last\n    // segments, so we copy data from the last point(s) to the beginning of the array, and from the\n    // first point(s) to the end of the array.\n    const n = numTotalPoints * 3;\n    if (alreadyClosed) {\n      // First and last points already match; \"prior\" should be the second-to-last\n      // and \"next\" should be the second.\n      pointArray.copyWithin(0, n - 9, n - 6);\n      pointArray.copyWithin(n - 3, 6, 9);\n    } else if (shouldClose) {\n      // First point is being reused after last point; first *two* points need to be copied at the end\n      pointArray.copyWithin(0, n - 9, n - 6);\n      pointArray.copyWithin(n - 6, 3, 9);\n    } else {\n      // Endpoints are separate; just duplicate first & last points, resulting in square-looking endcaps\n      pointArray.copyWithin(0, 3, 6);\n      pointArray.copyWithin(n - 3, n - 6, n - 3);\n    }\n  }\n\n  function fillPoseArrays(instances: number, poses: Pose[]): ?Error {\n    if (positionArray.length < instances * 3) {\n      positionArray = new Float32Array(instances * 3);\n      rotationArray = new Float32Array(instances * 4);\n    }\n    for (let index = 0; index < poses.length; index++) {\n      const positionOffset = index * 3;\n      const rotationOffset = index * 4;\n      const { position, orientation: r } = poses[index];\n      const convertedPosition = Array.isArray(position) ? position : pointToVec3(position);\n      positionArray[positionOffset + 0] = convertedPosition[0];\n      positionArray[positionOffset + 1] = convertedPosition[1];\n      positionArray[positionOffset + 2] = convertedPosition[2];\n\n      const convertedRotation = Array.isArray(r) ? r : [r.x, r.y, r.z, r.w];\n      rotationArray[rotationOffset + 0] = convertedRotation[0];\n      rotationArray[rotationOffset + 1] = convertedRotation[1];\n      rotationArray[rotationOffset + 2] = convertedRotation[2];\n      rotationArray[rotationOffset + 3] = convertedRotation[3];\n    }\n  }\n\n  function convertColors(colors: any): Vec4[] {\n    return shouldConvert(colors) ? colors.map(toRGBA) : colors;\n  }\n\n  function fillColorArray(\n    color: ?Color | ?Vec4,\n    colors: ?((Color | Vec4)[]),\n    monochrome: boolean,\n    shouldClose: boolean\n  ) {\n    if (monochrome) {\n      if (colorArray.length < VERTICES_PER_INSTANCE * 4) {\n        colorArray = new Float32Array(VERTICES_PER_INSTANCE * 4);\n      }\n      const monochromeColor = color || DEFAULT_MONOCHROME_COLOR;\n      const [convertedMonochromeColor] = convertColors([monochromeColor]);\n      const [r, g, b, a] = convertedMonochromeColor;\n      for (let index = 0; index < VERTICES_PER_INSTANCE; index++) {\n        const offset = index * 4;\n        colorArray[offset + 0] = r;\n        colorArray[offset + 1] = g;\n        colorArray[offset + 2] = b;\n        colorArray[offset + 3] = a;\n      }\n    } else if (colors) {\n      const length = shouldClose ? colors.length + 1 : colors.length;\n      if (colorArray.length < length * 4) {\n        colorArray = new Float32Array(length * 4);\n      }\n      const convertedColors = convertColors(colors);\n      for (let index = 0; index < convertedColors.length; index++) {\n        const offset = index * 4;\n        const [r, g, b, a] = convertedColors[index];\n        colorArray[offset + 0] = r;\n        colorArray[offset + 1] = g;\n        colorArray[offset + 2] = b;\n        colorArray[offset + 3] = a;\n      }\n\n      if (shouldClose) {\n        const [r, g, b, a] = convertedColors[0];\n        const lastIndex = length - 1;\n        colorArray[lastIndex * 4 + 0] = r;\n        colorArray[lastIndex * 4 + 1] = g;\n        colorArray[lastIndex * 4 + 2] = b;\n        colorArray[lastIndex * 4 + 3] = a;\n      }\n    }\n  }\n\n  // Disable depth for debug rendering (so lines stay visible)\n  const render = (debug, commands) => {\n    if (debug) {\n      regl({ depth: { enable: false } })(commands);\n    } else {\n      commands();\n    }\n  };\n\n  // Render one line list/strip\n  function renderLine(props) {\n    const { debug, primitive = \"lines\", scaleInvariant = false } = props;\n    const numInputPoints = props.points.length;\n\n    if (numInputPoints < 2) {\n      return;\n    }\n\n    const alreadyClosed = numInputPoints > 2 && pointsEqual(props.points[0], props.points[numInputPoints - 1]);\n    // whether the first point needs to be duplicated after the last point\n    const shouldClose = !alreadyClosed && props.closed;\n\n    fillPointArray(props.points, alreadyClosed, shouldClose);\n    positionBuffer1({ data: pointArray, usage: \"dynamic\" });\n    positionBuffer2({ data: pointArray, usage: \"dynamic\" });\n\n    const monochrome = !(props.colors && props.colors.length);\n    fillColorArray(props.color, props.colors, monochrome, shouldClose);\n    colorBuffer({ data: colorArray, usage: \"dynamic\" });\n\n    const joined = primitive === \"line strip\";\n    const effectiveNumPoints = numInputPoints + (shouldClose ? 1 : 0);\n    const instances = joined ? effectiveNumPoints - 1 : Math.floor(effectiveNumPoints / 2);\n\n    // fill instanced pose buffers\n    const { poses } = props;\n    const hasInstancedPoses = !!poses && poses.length > 0;\n    if (hasInstancedPoses && poses) {\n      if (instances !== poses.length) {\n        console.error(`Expected ${instances} poses but given ${poses.length} poses: will result in webgl error.`);\n        return;\n      }\n      fillPoseArrays(instances, poses);\n      posePositionBuffer({ data: positionArray, usage: \"dynamic\" });\n      poseRotationBuffer({ data: rotationArray, usage: \"dynamic\" });\n    }\n\n    render(debug, () => {\n      // Use Object.assign because it's actually faster than babel's object spread polyfill.\n      command(\n        Object.assign({}, props, {\n          joined,\n          primitive: \"triangle strip\",\n          alpha: debug ? 0.2 : 1,\n          monochrome,\n          instances,\n          scaleInvariant,\n          hasInstancedPoses,\n        })\n      );\n      if (debug) {\n        command(\n          Object.assign({}, props, {\n            joined,\n            primitive: \"line strip\",\n            alpha: 1,\n            monochrome,\n            instances,\n            scaleInvariant,\n            hasInstancedPoses,\n          })\n        );\n      }\n    });\n  }\n\n  return (inProps: any) => {\n    if (Array.isArray(inProps)) {\n      inProps.forEach(renderLine);\n    } else {\n      renderLine(inProps);\n    }\n  };\n};\n\nexport default function Lines(props: { ...CommonCommandProps, children: Line[] }) {\n  return <Command getChildrenForHitmap={nonInstancedGetChildrenForHitmap} {...props} reglCommand={lines} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport type { Point, Vec3, Line } from \"../types\";\nimport Lines from \"./Lines\";\n\nconst pointToVec3 = (p: Vec3): Point => ({\n  x: p[0],\n  y: p[1],\n  z: p[2],\n});\n\nconst scale = 100;\nconst x = 1 * scale;\nconst xAxisPoints = [[-x, 0, 0], [x, 0, 0]].map(pointToVec3);\nconst yAxisPoints = [[0, -100, 0], [0, 100, 0]].map(pointToVec3);\nconst zAxisPoints = [[0, 0, -100], [0, 0, 100]].map(pointToVec3);\nconst pose = {\n  orientation: { x: 0, y: 0, z: 0, w: 0 },\n  position: { x: 0, y: 0, z: 0 },\n};\nconst xAxis = {\n  pose,\n  points: xAxisPoints,\n  scale: { x: 0.5, y: 0.5, z: 0.5 },\n  color: { r: 0.95, g: 0.26, b: 0.4, a: 1 },\n};\nconst yAxis = {\n  pose,\n  points: yAxisPoints,\n  scale: { x: 0.5, y: 0.5, z: 0.5 },\n  color: { r: 0.02, g: 0.82, b: 0.49, a: 1 },\n};\nconst zAxis = {\n  pose,\n  points: zAxisPoints,\n  scale: { x: 0.5, y: 0.5, z: 0.5 },\n  color: { r: 0.11, g: 0.51, b: 0.92, a: 1 },\n};\n\ntype Axis = Line;\n\ntype Props = {\n  children: Axis[],\n};\n\n// Renders lines along the x, y, and z axes; useful for debugging.\nexport default class Axes extends React.Component<Props> {\n  static defaultProps: Props = {\n    children: [xAxis, yAxis, zAxis],\n  };\n\n  render() {\n    return <Lines>{this.props.children}</Lines>;\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { SphereList } from \"../types\";\nimport fromGeometry from \"../utils/fromGeometry\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nconst NUM_PARALLELS = 15;\nconst NUM_MERIDIANS = 15;\nconst RADIUS = 0.5;\n\nconst northPole = [0, 0, RADIUS];\nconst southPole = [0, 0, -RADIUS];\nconst points = [northPole, southPole];\nconst faces = [];\n\nfor (let i = 0; i < NUM_PARALLELS; i++) {\n  for (let j = 0; j < NUM_MERIDIANS; j++) {\n    const phi = ((i + 1) / (NUM_PARALLELS + 1)) * Math.PI;\n    const z = RADIUS * Math.cos(phi);\n    const width = RADIUS * Math.sin(phi);\n    const theta = (j * 2 * Math.PI) / NUM_MERIDIANS;\n    const x = width * Math.cos(theta);\n    const y = width * Math.sin(theta);\n    points.push([x, y, z]);\n    if (j > 0) {\n      // connect to previous parallel (or north pole)\n      const prevMeridianPt = i === 0 ? 0 : points.length - 1 - NUM_MERIDIANS;\n      faces.push([points.length - 2, points.length - 1, prevMeridianPt]);\n      if (i > 0) {\n        faces.push([points.length - 2, prevMeridianPt - 1, prevMeridianPt]);\n      }\n    }\n  }\n  // connect to previous parallel (or north pole)\n  const prevMeridianPt = i === 0 ? 0 : points.length - 2 * NUM_MERIDIANS;\n  faces.push([points.length - 1, points.length - NUM_MERIDIANS, prevMeridianPt]);\n  if (i > 0) {\n    faces.push([points.length - 1, points.length - NUM_MERIDIANS - 1, prevMeridianPt]);\n  }\n}\n// connect last parallel to south pole\nfor (let j = 0; j < NUM_MERIDIANS; j++) {\n  const pt = points.length - NUM_MERIDIANS + j;\n  const prevPt = j === 0 ? points.length - 1 : pt - 1;\n  faces.push([pt, prevPt, 1]);\n}\n\nconst spheres = fromGeometry(points, faces);\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(1);\nexport default function Spheres(props: { ...CommonCommandProps, children: SphereList[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={spheres} />;\n}\n","// @flow\n\n//  Copyright (c) 2019-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport distance from \"distance-to-line-segment\";\n\nimport type { Vec3, MouseHandler } from \"../../types\";\nimport { PolygonPoint, Polygon } from \"./index\";\n\ntype OptionalZPoint = {\n  x: number,\n  y: number,\n  z?: number,\n};\n\ntype PolygonAddCommand = {\n  points: OptionalZPoint[],\n  name?: string,\n};\n\nfunction areEqual(point1: PolygonPoint, point2: PolygonPoint) {\n  const [x1, y1, z1] = point1.point;\n  const [x2, y2, z2] = point2.point;\n  return x1 === x2 && y1 === y2 && z1 === z2;\n}\n\nfunction isClosed(polygon: Polygon): boolean {\n  const { points } = polygon;\n  for (let i = 0; i < points.length - 1; i++) {\n    if (areEqual(points[i], points[i + 1])) {\n      return true;\n    }\n  }\n  const firstPoint = points[0];\n  const lastPoint = points[points.length - 1];\n  return areEqual(firstPoint, lastPoint);\n}\n\n// Has listeners you can pass to Worldview for mouse interactions\n// internally builds a list of polygons and modifies the polygons\n// based on mouse & keyboard interactions. For now we use mututation internally\n// instead of immutability to keep the number of allocations lower and make\n// the implementation a bit more straightforward\n\nexport default class PolygonBuilder {\n  mouseDown: boolean = false;\n  polygons: Polygon[];\n  onChange: () => void = () => {};\n  activePolygon: ?Polygon;\n  activePoint: ?PolygonPoint;\n  mouseDownPoint: Vec3;\n\n  constructor(polygons: Polygon[] = []) {\n    this.polygons = polygons;\n  }\n\n  isActivePolygonClosed(): boolean {\n    return !!this.activePolygon && isClosed(this.activePolygon);\n  }\n\n  // adds a polygon to the builder, transforming it into the internal representation\n  addPolygon(cmd: PolygonAddCommand): void {\n    const { points, name } = cmd;\n    if (points.length < 3) {\n      return;\n    }\n    // clear any selections\n    this.selectObject();\n\n    const polygon = new Polygon(name);\n    polygon.points = points.map((p) => new PolygonPoint([p.x, p.y, p.z || 0]));\n    if (!isClosed(polygon)) {\n      polygon.points.push(polygon.points[0]);\n    }\n    this.polygons.push(polygon);\n  }\n\n  // push a new point - either adds to the active polygon\n  // or creates a new polygon at this point\n  pushPoint(point: Vec3): void {\n    const { activePolygon } = this;\n    if (activePolygon) {\n      // do not push a point on a closed polygon\n      if (!isClosed(activePolygon)) {\n        const newPoint = new PolygonPoint(point);\n        activePolygon.points.push(newPoint);\n        this.selectObject(newPoint);\n        return;\n      }\n    }\n\n    const polygon = new Polygon();\n    polygon.points.push(new PolygonPoint(point));\n    const floatingPoint = new PolygonPoint(point);\n    polygon.points.push(floatingPoint);\n    this.polygons.push(polygon);\n    this.selectObject(floatingPoint);\n    this.onChange();\n  }\n\n  // updates the active point to the new position\n  updateActivePoint(point: Vec3): void {\n    if (this.activePoint) {\n      this.activePoint.point = point;\n      this.onChange();\n    }\n  }\n\n  // closes the active polygon by either deleting it if\n  // is only 2 points (no \"single sided\" polygons...)\n  // or inserts an 'overlap' point by making the first point\n  // and last point a reference to the same point in the list\n  // this structure of overlap is similar to the structure used by geoJSON\n  // though \"left to right\" ordering is not enforced\n  closeActivePolygon(): void {\n    const polygon = this.activePolygon;\n    if (!polygon) {\n      return;\n    }\n\n    // remove single lines\n    if (polygon.points.length === 2) {\n      this.deletePolygon(polygon);\n    } else {\n      polygon.points.push(polygon.points[0]);\n    }\n    this.onChange();\n  }\n\n  // mouse move handler - should be added to Worldview as a prop\n  onMouseMove: MouseHandler = (e, args) => {\n    // prevent the camera from responding to move if we\n    // have an active object being edited\n    if (this.activePolygon) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n    //const cursor = e.ctrlKey ? 'crosshair' : '';\n    //document.body.style.cursor = cursor;\n\n    if (!this.mouseDown) {\n      return;\n    }\n    if (!args) {\n      return;\n    }\n\n    // early return to only raycast when mouse moves during interaction\n    if (!this.activePoint && !this.activePolygon) {\n      return;\n    }\n\n    const { ray } = args;\n    const point = ray.planeIntersection([0, 0, 0], [0, 0, 1]);\n    // satisfy flow\n    if (!point) {\n      return;\n    }\n\n    // satisfy flow\n    const { activePolygon } = this;\n\n    if (this.activePoint) {\n      this.updateActivePoint(point);\n    } else if (activePolygon && this.mouseDownPoint) {\n      // move polygon\n      const [pointX, pointY] = point;\n      const [mouseX, mouseY] = this.mouseDownPoint;\n      // figure out how far the mouse has moved\n      const dX = pointX - mouseX;\n      const dY = pointY - mouseY;\n\n      // save the new mouse position as for the next computation\n      this.mouseDownPoint = point;\n\n      // only update the 'overlap' point once\n      const uniquePoints = activePolygon.points.reduce((acc, point) => {\n        if (!acc.includes(point)) {\n          acc.push(point);\n        }\n        return acc;\n      }, []);\n\n      // adjust each point's location\n      for (const polygonPoint of uniquePoints) {\n        const { point } = polygonPoint;\n        point[0] = point[0] + dX;\n        point[1] = point[1] + dY;\n      }\n\n      this.onChange();\n    }\n  };\n\n  // deletes a polygon\n  deletePolygon(polygon: Polygon): void {\n    this.polygons = this.polygons.filter((poly) => poly !== polygon);\n    this.activePolygon = null;\n  }\n\n  // deletes a point in the active polygon\n  // if the point is the 'overlap point' create a new one\n  // also deletes the entire polygon if the polygon becomes a 1-sided polygon\n  deletePoint(point: PolygonPoint): void {\n    const { activePolygon } = this;\n    if (!activePolygon) {\n      return;\n    }\n    const newPoints = activePolygon.points.filter((p) => p.id !== point.id);\n    // if the 'overlap' point is deleted, create a new start/end overlap point\n    if (newPoints.length === activePolygon.points.length - 2) {\n      newPoints.push(newPoints[0]);\n    }\n    activePolygon.points = newPoints;\n    this.activePoint = null;\n    if (activePolygon.points.length < 4) {\n      this.deletePolygon(activePolygon);\n    }\n    this.onChange();\n  }\n\n  // key down handler - to be passed to Worldview as a prop\n  onKeyDown = (e: KeyboardEvent): void => {\n    // only respond to key events if we have a selected polygon\n    const { activePolygon } = this;\n    if (!activePolygon) {\n      return;\n    }\n\n    switch (e.key) {\n      case \"Delete\":\n      case \"Backspace\":\n        if (this.activePoint) {\n          this.deletePoint(this.activePoint);\n        } else {\n          this.deletePolygon(activePolygon);\n        }\n        this.onChange();\n        break;\n      default:\n        break;\n    }\n  };\n\n  // select either a point or polygon by id\n  selectObject(object?: Polygon | PolygonPoint) {\n    // clear out any previously active objects\n    this.activePolygon = null;\n    if (this.activePoint) {\n      this.activePoint.active = false;\n    }\n    this.activePoint = null;\n\n    for (const polygon of this.polygons) {\n      let isActive = polygon === object;\n      polygon.active = isActive;\n      if (isActive) {\n        this.activePolygon = polygon;\n      }\n      for (const point of polygon.points) {\n        if (point === object) {\n          // if a point is selected, activate both it\n          // and the polygon it belongs to\n          this.activePoint = point;\n          point.active = true;\n          polygon.active = true;\n          this.activePolygon = polygon;\n          isActive = true;\n        }\n      }\n    }\n\n    this.onChange();\n  }\n\n  // mouse up handler - to be passed to Worldview as a prop\n  onMouseUp: MouseHandler = (e, args) => {\n    if (!e.ctrlKey) {\n      this.mouseDown = false;\n    }\n  };\n\n  // double click handler - to be passed to Worldview as a prop\n  onDoubleClick: MouseHandler = (e, args) => {\n    // satisfy flow\n    if (!args) {\n      return;\n    }\n    if (!args.objects.length) {\n      return;\n    }\n\n    this.selectObject(args.objects[0].object);\n\n    // if a point was double-clicked, delete it\n    if (this.activePoint) {\n      this.deletePoint(this.activePoint);\n      return;\n    }\n\n    // otherwise insert a new point into the nearest line of the active polygon\n    const { activePolygon } = this;\n\n    // if no polygon is active, don't do anything w/ the double-click\n    if (!activePolygon) {\n      return;\n    }\n\n    let shortestDistance = Number.MAX_SAFE_INTEGER;\n    let shortestIndex = -1;\n    const { ray } = args;\n    const point = ray.planeIntersection([0, 0, 0], [0, 0, 1]);\n    if (!point) {\n      return;\n    }\n    const [px, py] = point;\n\n    // find the closest line segment of the active polygon\n    const { points } = activePolygon;\n    for (let i = 0; i < points.length - 1; i++) {\n      const point1 = points[i];\n      const point2 = points[i + 1];\n      const [x1, y1] = point1.point;\n      const [x2, y2] = point2.point;\n\n      // distance.squared is faster since we don't care about the\n      // actual distance, just which line produces the shortest distance\n      const dist = distance.squared(x1, y1, x2, y2, px, py);\n      if (dist < shortestDistance) {\n        shortestDistance = dist;\n        shortestIndex = i;\n      }\n    }\n\n    // insert a new point in the nearest line\n    if (shortestIndex > -1) {\n      const newPoint = new PolygonPoint(point);\n      activePolygon.points.splice(shortestIndex + 1, 0, newPoint);\n      this.activePoint = newPoint;\n    }\n    this.onChange();\n  };\n\n  // mouse down handler - to be passed to Worldview as a prop\n  onMouseDown: MouseHandler = (e, args) => {\n    if (!args) {\n      return;\n    }\n    const { ray } = args;\n\n    const point = ray.planeIntersection([0, 0, 0], [0, 0, 1]);\n\n    // satisfy flow but raycasting should always work\n    if (!point) {\n      return;\n    }\n\n    const isFirstClick = !this.mouseDown;\n    this.mouseDown = true;\n    this.mouseDownPoint = point;\n    const isCtrlClick = e.ctrlKey;\n\n    // single click or click+drag is for selection & moving\n    if (isFirstClick && !isCtrlClick) {\n      const clickObject = args.objects[0];\n      this.selectObject(clickObject && clickObject.object);\n      return this.onChange();\n    }\n\n    // ctrl+click always inserts a point\n    if (isCtrlClick) {\n      this.pushPoint(point);\n      return this.onChange();\n    }\n\n    // if mouse was down & we have a non-control click, close the active polygon\n    this.closeActivePolygon();\n    return this.onChange();\n  };\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Regl, TriangleList } from \"../types\";\nimport {\n  defaultBlend,\n  getVertexColors,\n  pointToVec3Array,\n  shouldConvert,\n  toRGBA,\n  withPose,\n} from \"../utils/commandUtils\";\nimport { createInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\n// TODO(Audrey): default to the actual regl defaults before 1.x release\nconst defaultSingleColorDepth = { enable: true, mask: false };\nconst defaultVetexColorDepth = {\n  enable: true,\n  mask: true,\n  func: \"<=\",\n};\n\nconst singleColor = (regl) =>\n  withPose({\n    primitive: \"triangles\",\n    vert: `\n  precision mediump float;\n\n  attribute vec3 point;\n\n  uniform mat4 projection, view;\n\n  #WITH_POSE\n\n  void main () {\n    vec3 pos = applyPose(point);\n    gl_Position = projection * view * vec4(pos, 1);\n  }\n  `,\n    frag: `\n  precision mediump float;\n  uniform vec4 color;\n  void main () {\n    gl_FragColor = color;\n  }\n  `,\n    attributes: {\n      point: (context, props) => {\n        if (shouldConvert(props.points)) {\n          return pointToVec3Array(props.points);\n        }\n        return props.points;\n      },\n      color: (context, props) => {\n        if (shouldConvert(props.colors) || shouldConvert(props.color)) {\n          return getVertexColors(props);\n        }\n        return props.color || props.colors;\n      },\n    },\n    uniforms: {\n      color: (context, props) => {\n        if (shouldConvert(props.color)) {\n          return toRGBA(props.color);\n        }\n        return props.color;\n      },\n    },\n    // can pass in { enable: true, depth: false } to turn off depth to prevent flicker\n    // because multiple items are rendered to the same z plane\n    depth: {\n      enable: (context, props) => {\n        return (props.depth && props.depth.enable) || defaultSingleColorDepth.enable;\n      },\n      mask: (context, props) => {\n        return (props.depth && props.depth.mask) || defaultSingleColorDepth.mask;\n      },\n    },\n    blend: defaultBlend,\n\n    count: (context, props) => props.points.length,\n  });\n\nconst vertexColors = (regl) =>\n  withPose({\n    primitive: \"triangles\",\n    vert: `\n  precision mediump float;\n\n  attribute vec3 point;\n  attribute vec4 color;\n\n  uniform mat4 projection, view;\n\n  varying vec4 vColor;\n\n  #WITH_POSE\n\n  void main () {\n    vec3 pos = applyPose(point);\n    vColor = color;\n    gl_Position = projection * view * vec4(pos, 1);\n  }\n  `,\n    frag: `\n  precision mediump float;\n  varying vec4 vColor;\n  void main () {\n    gl_FragColor = vColor;\n  }\n  `,\n    attributes: {\n      point: (context, props) => {\n        if (shouldConvert(props.points)) {\n          return pointToVec3Array(props.points);\n        }\n        return props.points;\n      },\n      color: (context, props) => {\n        if (shouldConvert(props.colors) || shouldConvert(props.color)) {\n          return getVertexColors(props);\n        }\n        return props.color || props.colors;\n      },\n    },\n\n    depth: {\n      enable: (context, props) => {\n        return (props.depth && props.depth.enable) || defaultVetexColorDepth.enable;\n      },\n      mask: (context, props) => {\n        return (props.depth && props.depth.mask) || defaultVetexColorDepth.mask;\n      },\n    },\n    blend: defaultBlend,\n\n    count: (context, props) => props.points.length,\n  });\n\n// command to render triangle lists optionally supporting vertex colors for each triangle\nconst triangles = (regl: Regl) => {\n  const single = regl(singleColor(regl));\n  const vertex = regl(vertexColors(regl));\n  return (props: any, isHitmap: boolean) => {\n    const items: TriangleList[] = Array.isArray(props) ? props : [props];\n    const singleColorItems = [];\n    const vertexColorItems = [];\n    items.forEach((item) => {\n      // If the item has onlyRenderInHitmap set, only render it in the hitmap.\n      if (isHitmap || !item.onlyRenderInHitmap) {\n        if (item.colors && item.colors.length) {\n          vertexColorItems.push(item);\n        } else {\n          singleColorItems.push(item);\n        }\n      }\n    });\n\n    single(singleColorItems);\n    vertex(vertexColorItems);\n  };\n};\n\nconst getChildrenForHitmap = createInstancedGetChildrenForHitmap(3);\nexport default function Triangles(props: { ...CommonCommandProps, children: TriangleList[] }) {\n  return <Command getChildrenForHitmap={getChildrenForHitmap} {...props} reglCommand={triangles} />;\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport type { Point, CameraCommand, Dimensions, Color, Pose, Scale, Vec4 } from \"../types\";\nimport { getCSSColor, toColor } from \"../utils/commandUtils\";\nimport { type WorldviewContextType } from \"../WorldviewContext\";\nimport WorldviewReactContext from \"../WorldviewReactContext\";\n\nconst BG_COLOR_LIGHT = \"#ffffff\";\nconst BG_COLOR_DARK = \"rgba(0,0,0,0.8)\";\nconst BRIGHTNESS_THRESHOLD = 128;\nconst DEFAULT_TEXT_COLOR = { r: 1, g: 1, b: 1, a: 1 };\nconst DEFAULT_BG_COLOR = { r: 0, g: 0, b: 0, a: 0.8 };\n\nexport type TextMarker = {\n  name?: string,\n  pose: Pose,\n  scale: Scale,\n  color?: Color | Vec4,\n  colors?: (Color | Vec4)[],\n  text: string,\n};\n\nlet cssHasBeenInserted = false;\nfunction insertGlobalCss() {\n  if (cssHasBeenInserted) {\n    return;\n  }\n  const style = document.createElement(\"style\");\n  style.innerHTML = `\n    .regl-worldview-text-wrapper {\n      position: absolute;\n      white-space: nowrap;\n      z-index: 100;\n      pointer-events: none;\n      top: 0;\n      left: 0;\n      will-change: transform;\n    }\n    .regl-worldview-text-inner {\n      position: relative;\n      left: -50%;\n      top: -0.5em;\n      white-space: pre-line;\n    }\n  `;\n  if (document.body) {\n    document.body.appendChild(style);\n  }\n  cssHasBeenInserted = true;\n}\n\nexport function isColorDark({ r, g, b }: Color): boolean {\n  // ITU-R BT.709 https://en.wikipedia.org/wiki/Rec._709\n  // 0.2126 * 255 * r + 0.7152 * 255 * g + 0.0722 * 255 * b\n  const luma = 54.213 * r + 182.376 * g + 18.411 * b;\n  return luma < BRIGHTNESS_THRESHOLD;\n}\n\nfunction isColorEqual(a: Color, b: Color): boolean {\n  return a.r === b.r && a.g === b.g && a.b === b.b && a.a === b.a;\n}\n\nclass TextElement {\n  wrapper = document.createElement(\"span\");\n  _inner = document.createElement(\"span\");\n  _text = document.createTextNode(\"\");\n  // store prev colors to improve perf\n  _prevTextColor: Color = DEFAULT_TEXT_COLOR;\n  _prevBgColor: ?Color = DEFAULT_BG_COLOR;\n  _prevAutoBackgroundColor: ?boolean = null;\n\n  constructor() {\n    insertGlobalCss();\n    this.wrapper.className = \"regl-worldview-text-wrapper\";\n    this._inner.className = \"regl-worldview-text-inner\";\n    this.wrapper.appendChild(this._inner);\n    this._inner.appendChild(this._text);\n    this.wrapper.style.color = getCSSColor(DEFAULT_TEXT_COLOR);\n  }\n\n  update(marker: TextMarker, left: number, top: number, autoBackgroundColor?: boolean) {\n    this.wrapper.style.transform = `translate(${left.toFixed()}px,${top.toFixed()}px)`;\n    const { color, colors = [] } = marker;\n    const hasBgColor = colors.length >= 2;\n    const textColor = toColor(hasBgColor ? colors[0] : color || [0, 0, 0, 1]);\n\n    if (textColor) {\n      const backgroundColor = toColor(colors[1]);\n      if (!isColorEqual(this._prevTextColor, textColor)) {\n        this._prevTextColor = textColor;\n        this.wrapper.style.color = getCSSColor(textColor);\n      }\n\n      if (!autoBackgroundColor && autoBackgroundColor !== this._prevAutoBackgroundColor) {\n        // remove background color if autoBackgroundColor has changed\n        this._inner.style.background = \"transparent\";\n        this._prevBgColor = null;\n      } else {\n        if (\n          autoBackgroundColor &&\n          (!this._prevBgColor || (this._prevBgColor && !isColorEqual(textColor, this._prevBgColor)))\n        ) {\n          // update background color with automatic dark/light color\n          this._prevBgColor = textColor;\n          const isTextColorDark = isColorDark(textColor);\n          const hexBgColor = isTextColorDark ? BG_COLOR_LIGHT : BG_COLOR_DARK;\n          this._inner.style.background = hexBgColor;\n        } else if (hasBgColor && this._prevBgColor && !isColorEqual(backgroundColor, this._prevBgColor)) {\n          // update background color with colors[1] data\n          this._prevBgColor = backgroundColor;\n          this._inner.style.background = getCSSColor(backgroundColor);\n        }\n      }\n    }\n    this._prevAutoBackgroundColor = autoBackgroundColor;\n\n    if (this._text.textContent !== marker.text) {\n      this._text.textContent = marker.text || \"\";\n    }\n  }\n}\n\ntype Props = {\n  children: TextMarker[],\n  autoBackgroundColor?: boolean,\n};\n\n// Render text on a scene using DOM nodes, similar to the Overlay command.\n// Implementation uses manual DOM manipulation to avoid the performance hit from React tree reconciliation.\nexport default class Text extends React.Component<Props> {\n  _context: ?WorldviewContextType;\n  _textComponents: Map<string | TextMarker, TextElement> = new Map();\n  _textContainerRef: { current: HTMLDivElement | null } = React.createRef();\n\n  static defaultProps = {\n    children: [],\n  };\n\n  componentDidMount() {\n    if (this._context) {\n      this._context.registerPaintCallback(this.paint);\n    }\n  }\n\n  componentWillUnmount = () => {\n    if (this._context) {\n      this._context.unregisterPaintCallback(this.paint);\n    }\n  };\n\n  paint = () => {\n    const context = this._context;\n    const textComponents = this._textComponents;\n    const { children: markers, autoBackgroundColor } = this.props;\n    const { current: textContainer } = this._textContainerRef;\n    const initializedData = context && context.initializedData;\n\n    if (!textContainer || !context || !initializedData) {\n      return;\n    }\n    const {\n      dimension,\n      dimension: { width, height },\n    } = context;\n    const { camera } = initializedData;\n\n    const componentsToRemove = new Set(textComponents.keys());\n\n    for (const marker of markers) {\n      const { pose, name } = marker;\n      const { position } = pose;\n      const coord = this.project(position, camera, dimension);\n      if (!coord) {\n        continue;\n      }\n\n      const [left, top] = coord;\n      if (left < -10 || top < -10 || left > width + 10 || top > height + 10) {\n        continue;\n      }\n\n      let el = textComponents.get(name || marker);\n      if (el) {\n        componentsToRemove.delete(name || marker);\n      } else {\n        el = new TextElement();\n        textComponents.set(name || marker, el);\n        textContainer.appendChild(el.wrapper);\n      }\n\n      el.update(marker, left, top, autoBackgroundColor);\n    }\n\n    for (const key of componentsToRemove) {\n      const el = textComponents.get(key);\n      if (!el) {\n        continue;\n      }\n      el.wrapper.remove();\n      textComponents.delete(key);\n    }\n  };\n\n  project = (point: Point, camera: CameraCommand, dimension: Dimensions) => {\n    const vec = [point.x, point.y, point.z];\n    const { left, top, width, height } = dimension;\n    const viewport = [left, top, width, height];\n    return camera.toScreenCoord(viewport, vec);\n  };\n\n  render() {\n    return (\n      <React.Fragment>\n        <div ref={this._textContainerRef} />\n        <WorldviewReactContext.Consumer>\n          {(ctx: ?WorldviewContextType) => {\n            if (ctx) {\n              this._context = ctx;\n            }\n            return null;\n          }}\n        </WorldviewReactContext.Consumer>\n      </React.Fragment>\n    );\n  }\n}\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport { withPose } from \"../utils/commandUtils\";\nimport { nonInstancedGetChildrenForHitmap } from \"../utils/getChildrenForHitmapDefaults\";\nimport Command, { type CommonCommandProps } from \"./Command\";\n\nconst DEFAULT_GRID_COLOR = [0.3, 0.3, 0.3, 1];\n\nexport function grid() {\n  return withPose({\n    vert: `\n    precision mediump float;\n    uniform mat4 projection, view;\n\n    attribute vec3 point;\n    attribute vec4 color;\n    varying vec4 fragColor;\n\n    void main () {\n      fragColor = color;\n      vec3 p = point;\n      gl_Position = projection * view * vec4(p, 1);\n    }\n    `,\n    frag: `\n      precision mediump float;\n      varying vec4 fragColor;\n      void main () {\n        gl_FragColor = fragColor;\n      }\n    `,\n    primitive: \"lines\",\n    attributes: {\n      point: (context, props) => {\n        const points = [];\n        const bound = props.count;\n        for (let i = -props.count; i < props.count; i++) {\n          points.push([-bound, i, 0]);\n          points.push([bound, i, 0]);\n          points.push([i, -bound, 0]);\n          points.push([i, bound, 0]);\n        }\n        return points;\n      },\n      color: (context, props) => {\n        const color = props.color || DEFAULT_GRID_COLOR;\n        return new Array(props.count * 4 * 2).fill(color);\n      },\n    },\n    count: (context, props) => {\n      // 8 points per count\n      const count = props.count * 4 * 2;\n      return count;\n    },\n  });\n}\n\ntype Props = {\n  ...CommonCommandProps,\n  count: number,\n};\n\n// useful for rendering a grid for debugging in stories\n\nexport default function Grid({ count, ...rest }: Props) {\n  const children = { count };\n  return (\n    <Command getChildrenForHitmap={nonInstancedGetChildrenForHitmap} {...rest} reglCommand={grid}>\n      {children}\n    </Command>\n  );\n}\n\nGrid.defaultProps = { count: 6 };\n","// @flow\n\n//  Copyright (c) 2018-present, GM Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { Point, Vec3, Dimensions, Pose } from \"../types\";\nimport { type WorldviewContextType } from \"../WorldviewContext\";\nimport WorldviewReactContext from \"../WorldviewReactContext\";\n\ntype PoseObj = { pose: Pose };\ntype RenderItemInput<T: PoseObj> = {\n  item: T,\n  coordinates: ?Vec3,\n  index: number,\n  dimension: Dimensions,\n};\n\ntype Props<T: PoseObj> = {\n  children: T[],\n  renderItem: (RenderItemInput<T>) => React.Node,\n};\n\ntype State = {\n  items: React.Node[],\n};\n\n// A command that renders arbitrary DOM nodes on top of the Worldview 3D scene.\n// It supplies coordinates to the `renderItem` prop for positioning DOM nodes relative to the canvas.\nexport default class Overlay<T: PoseObj> extends React.Component<Props<T>, State> {\n  _context: ?WorldviewContextType;\n  state = { items: [] };\n\n  componentDidMount() {\n    if (this._context) {\n      this._context.registerPaintCallback(this.paint);\n    }\n  }\n\n  componentWillUnmount = () => {\n    if (this._context) {\n      this._context.unregisterPaintCallback(this.paint);\n    }\n  };\n\n  paint = () => {\n    const context = this._context;\n    const dimension = context && context.dimension;\n    const { renderItem, children } = this.props;\n    if (!context || !dimension) {\n      return;\n    }\n    const items = children.map((item, index) => {\n      const coordinates = this.project(item.pose.position, context);\n      return renderItem({ item, index, coordinates, dimension });\n    });\n    this.setState({ items });\n  };\n\n  project = (point: Point, context: ?WorldviewContextType): ?Vec3 => {\n    if (!context || !context.initializedData) {\n      return;\n    }\n    const { dimension } = context;\n    const { camera } = context.initializedData;\n\n    const vec = [point.x, point.y, point.z];\n    const { left, top, width, height } = dimension;\n    const viewport = [left, top, width, height];\n    return camera.toScreenCoord(viewport, vec);\n  };\n\n  render() {\n    return (\n      <React.Fragment>\n        <WorldviewReactContext.Consumer>\n          {(ctx: ?WorldviewContextType) => {\n            if (ctx) {\n              this._context = ctx;\n            }\n            return this.state.items;\n          }}\n        </WorldviewReactContext.Consumer>\n      </React.Fragment>\n    );\n  }\n}\n","/* eslint-disable header/header */\n\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport memoize from \"lodash/memoize\";\n\nimport { getGlobalHooks } from \"./loadWebviz\";\nimport { DIAGNOSTIC_TOPIC } from \"./util/globalConstants\";\n\n/*\nWe've split this code out seperately from the rest of the hooks so that we can lazy load these components by\nlazily importing this file at runtime.\n*/\n\nexport function panelsByCategory() {\n  const DiagnosticStatusPanel = require(\"webviz-core/src/panels/diagnostics/DiagnosticStatusPanel\").default;\n  const DiagnosticSummary = require(\"webviz-core/src/panels/diagnostics/DiagnosticSummary\").default;\n  const GlobalVariables = require(\"webviz-core/src/panels/GlobalVariables\").default;\n  const GlobalVariableSlider = require(\"webviz-core/src/panels/GlobalVariableSlider\").default;\n  const ImageViewPanel = require(\"webviz-core/src/panels/ImageView\").default;\n  const Internals = require(\"webviz-core/src/panels/Internals\").default;\n  const NodePlayground = require(\"webviz-core/src/panels/NodePlayground\").default;\n  const Note = require(\"webviz-core/src/panels/Note\").default;\n  const NumberOfRenders = require(\"webviz-core/src/panels/NumberOfRenders\").default;\n  const PlaybackPerformance = require(\"webviz-core/src/panels/PlaybackPerformance\").default;\n  const Plot = require(\"webviz-core/src/panels/Plot\").default;\n  const Publish = require(\"webviz-core/src/panels/Publish\").default;\n  const RawMessages = require(\"webviz-core/src/panels/RawMessages\").default;\n  const Rosout = require(\"webviz-core/src/panels/Rosout\").default;\n  const StateTransitions = require(\"webviz-core/src/panels/StateTransitions\").default;\n  const SubscribeToList = require(\"webviz-core/src/panels/SubscribeToList\").default;\n  const Tab = require(\"webviz-core/src/panels/Tab\").default;\n  const TwoDimensionalPlot = require(\"webviz-core/src/panels/TwoDimensionalPlot\").default;\n  const ThreeDimensionalViz = require(\"webviz-core/src/panels/ThreeDimensionalViz\").default;\n  const { ndash } = require(\"webviz-core/src/util/entities\");\n\n  const ros = [\n    { title: \"2D Plot\", component: TwoDimensionalPlot },\n    { title: \"3D\", component: ThreeDimensionalViz },\n    { title: `Diagnostics ${ndash} Summary`, component: DiagnosticSummary },\n    { title: `Diagnostics ${ndash} Detail`, component: DiagnosticStatusPanel },\n    { title: \"Image\", component: ImageViewPanel },\n    { title: \"Plot\", component: Plot },\n    { title: \"Publish\", component: Publish },\n    { title: \"Raw Messages\", component: RawMessages },\n    { title: \"rosout\", component: Rosout },\n    { title: \"State Transitions\", component: StateTransitions },\n  ];\n\n  const utilities = [\n    { title: \"Global Variables\", component: GlobalVariables },\n    { title: \"Global Variable Slider\", component: GlobalVariableSlider },\n    { title: \"Node Playground\", component: NodePlayground },\n    { title: \"Notes\", component: Note },\n    { title: \"Tab\", component: Tab },\n    { title: \"Webviz Internals\", component: Internals },\n  ];\n\n  const debugging = [\n    { title: \"Number of Renders\", component: NumberOfRenders },\n    { title: \"Playback Performance\", component: PlaybackPerformance },\n    { title: \"Subscribe to List\", component: SubscribeToList },\n  ];\n\n  return { ros, utilities, debugging };\n}\n\nexport function perPanelHooks() {\n  const BlurIcon = require(\"@mdi/svg/svg/blur.svg\").default;\n  const GridIcon = require(\"@mdi/svg/svg/grid.svg\").default;\n  const HexagonIcon = require(\"@mdi/svg/svg/hexagon.svg\").default;\n  const HexagonMultipleIcon = require(\"@mdi/svg/svg/hexagon-multiple.svg\").default;\n  const PentagonOutlineIcon = require(\"@mdi/svg/svg/pentagon-outline.svg\").default;\n  const RadarIcon = require(\"@mdi/svg/svg/radar.svg\").default;\n  const RobotIcon = require(\"@mdi/svg/svg/robot.svg\").default;\n  const LaserScanVert = require(\"webviz-core/src/panels/ThreeDimensionalViz/LaserScanVert\").default;\n  const { defaultMapPalette } = require(\"webviz-core/src/panels/ThreeDimensionalViz/commands/utils\");\n  const { POINT_CLOUD_DATATYPE, POSE_STAMPED_DATATYPE } = require(\"webviz-core/src/util/globalConstants\");\n\n  const SUPPORTED_MARKER_DATATYPES = {\n    // generally supported datatypes\n    VISUALIZATION_MSGS_MARKER_DATATYPE: \"visualization_msgs/Marker\",\n    VISUALIZATION_MSGS_MARKER_ARRAY_DATATYPE: \"visualization_msgs/MarkerArray\",\n    POSE_STAMPED_DATATYPE,\n    POINT_CLOUD_DATATYPE,\n    SENSOR_MSGS_LASER_SCAN_DATATYPE: \"sensor_msgs/LaserScan\",\n    NAV_MSGS_OCCUPANCY_GRID_DATATYPE: \"nav_msgs/OccupancyGrid\",\n    GEOMETRY_MSGS_POLYGON_STAMPED_DATATYPE: \"geometry_msgs/PolygonStamped\",\n  };\n\n  return {\n    DiagnosticSummary: {\n      defaultConfig: {\n        pinnedIds: [],\n        hardwareIdFilter: \"\",\n        topicToRender: DIAGNOSTIC_TOPIC,\n      },\n    },\n    ImageView: {\n      defaultConfig: {\n        cameraTopic: \"\",\n        enabledMarkerTopics: [],\n        customMarkerTopicOptions: [],\n        scale: 0.2,\n        transformMarkers: false,\n        synchronize: false,\n        mode: \"fit\",\n        zoomPercentage: 100,\n        offset: [0, 0],\n      },\n      imageMarkerDatatypes: [\"visualization_msgs/ImageMarker\"],\n      canTransformMarkersByTopic: (topic) => !topic.includes(\"rect\"),\n    },\n    GlobalVariableSlider: {\n      getVariableSpecificOutput: () => null,\n    },\n    StateTransitions: { defaultConfig: { paths: [] }, customStateTransitionColors: {} },\n    ThreeDimensionalViz: {\n      defaultConfig: {\n        checkedKeys: [\"name:Topics\"],\n        expandedKeys: [\"name:Topics\"],\n        followTf: null,\n        cameraState: {},\n        modifiedNamespaceTopics: [],\n        pinTopics: false,\n        topicSettings: {},\n        autoSyncCameraState: false,\n      },\n      SUPPORTED_MARKER_DATATYPES,\n      allSupportedMarkers: [\n        \"arrow\",\n        \"cube\",\n        \"cubeList\",\n        \"cylinder\",\n        \"filledPolygon\",\n        \"grid\",\n        \"instancedLineList\",\n        \"laserScan\",\n        \"linedConvexHull\",\n        \"lineList\",\n        \"lineStrip\",\n        \"pointcloud\",\n        \"points\",\n        \"poseMarker\",\n        \"sphere\",\n        \"sphereList\",\n        \"text\",\n        \"triangleList\",\n      ],\n      renderAdditionalMarkers: () => {},\n      topics: [],\n      iconsByDatatype: {\n        \"visualization_msgs/Marker\": HexagonIcon,\n        \"visualization_msgs/MarkerArray\": HexagonMultipleIcon,\n        \"nav_msgs/OccupancyGrid\": GridIcon,\n        \"sensor_msgs/LaserScan\": RadarIcon,\n        \"geometry_msgs/PolygonStamped\": PentagonOutlineIcon,\n        [POINT_CLOUD_DATATYPE]: BlurIcon,\n        [POSE_STAMPED_DATATYPE]: RobotIcon,\n      },\n      // TODO(Audrey): remove icons config after topic group release\n      icons: {},\n      AdditionalToolbarItems: () => null,\n      LaserScanVert,\n      setGlobalVariablesInSceneBuilder: (globalVariables, selectionState, topicsToRender) => ({\n        selectionState,\n        topicsToRender,\n      }),\n      consumeMessage: (topic, msg, consumeMethods, { errors }) => {\n        errors.topicsWithError.set(topic, `Unrecognized topic datatype for scene: ${msg.datatype}`);\n      },\n      getMessagePose: (msg) => msg.message.pose,\n      addMarkerToCollector(add, topic, marker, setTopicError) {\n        setTopicError(topic, `Unsupported marker type: ${marker.type}`);\n      },\n      getSyntheticArrowMarkerColor: () => ({ r: 0, g: 0, b: 1, a: 0.5 }),\n      getFlattenedPose: () => undefined,\n      getOccupancyGridValues: (topic) => [0.5, \"map\"],\n      getMapPalette() {\n        return defaultMapPalette;\n      },\n      consumePose: () => {},\n      getMarkerColor: (topic, markerColor) => markerColor,\n      hasBlacklistTopics: () => false,\n      ungroupedNodesCategory: \"Topics\",\n      rootTransformFrame: \"map\",\n      defaultFollowTransformFrame: null,\n      skipTransformFrame: null,\n    },\n    RawMessages: { docLinkFunction: () => undefined },\n    installChartJs: () => {\n      require(\"webviz-core/src/util/installChartjs\").default();\n    },\n  };\n}\n\n// Helper function to bypass lazy fetch when running tests\nexport function testSetup() {\n  const hooks = getGlobalHooks();\n  hooks.panelsByCategory = memoize(() => {\n    return panelsByCategory();\n  });\n  hooks.perPanelHooks = memoize(() => {\n    return perPanelHooks();\n  });\n  hooks.areHooksImported = () => true;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport BorderAllIcon from \"@mdi/svg/svg/border-all.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport ExpandAllOutlineIcon from \"@mdi/svg/svg/expand-all-outline.svg\";\nimport FullscreenIcon from \"@mdi/svg/svg/fullscreen.svg\";\nimport GridLargeIcon from \"@mdi/svg/svg/grid-large.svg\";\nimport TrashCanOutlineIcon from \"@mdi/svg/svg/trash-can-outline.svg\";\nimport cx from \"classnames\";\nimport { last } from \"lodash\";\nimport React, { useState, useCallback, useContext, useMemo, type ComponentType } from \"react\";\nimport DocumentEvents from \"react-document-events\";\nimport {\n  getNodeAtPath,\n  updateTree,\n  getPathFromNode,\n  getOtherBranch,\n  isParent,\n  MosaicContext,\n  MosaicWindowContext,\n  type MosaicRootActions,\n  type MosaicWindowActions,\n} from \"react-mosaic-component\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\n\nimport styles from \"./Panel.module.scss\";\nimport { addSelectedPanelId, removeSelectedPanelId, setSelectedPanelIds } from \"webviz-core/src/actions/mosaic\";\nimport { savePanelConfigs, saveFullPanelConfig, changePanelLayout } from \"webviz-core/src/actions/panels\";\nimport Button from \"webviz-core/src/components/Button\";\nimport ErrorBoundary from \"webviz-core/src/components/ErrorBoundary\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport MosaicDragHandle from \"webviz-core/src/components/PanelToolbar/MosaicDragHandle\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport PanelList, { getPanelsByType } from \"webviz-core/src/panels/PanelList\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport type {\n  EditHistoryOptions,\n  SaveConfigsPayload,\n  SaveFullConfigPayload,\n  PanelConfig,\n  SaveConfig,\n} from \"webviz-core/src/types/panels\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { TAB_PANEL_TYPE } from \"webviz-core/src/util/globalConstants\";\nimport {\n  groupPanelsOutput,\n  createTabsOutput,\n  getPanelTypeFromId,\n  getPanelIdForType,\n  updateTabPanelLayout,\n} from \"webviz-core/src/util/layout\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\ntype Props<Config> = { childId?: string, config?: Config, saveConfig?: (Config) => void, tabId?: string };\ntype ActionProps = {|\n  savePanelConfigs: (SaveConfigsPayload) => void,\n  saveFullPanelConfig: (SaveFullConfigPayload) => PanelConfig,\n  changePanelLayout: (panels: any) => void,\n  addSelectedPanelId: (panelId: string) => void,\n  removeSelectedPanelId: (panelId: string) => void,\n  setSelectedPanelIds: (panelIds: string[]) => void,\n|};\ninterface PanelStatics<Config> {\n  panelType: string;\n  defaultConfig: Config;\n}\n\n// HOC that wraps panel in an error boundary and flex box.\n// Gives panel a `config` and `saveConfig`.\n//   export default Panel(MyPanelComponent)\n//\n// `config` comes from Redux, but in stories / tests you can pass in your own:\n//   `<MyPanel config={…} />`\nexport default function Panel<Config: PanelConfig>(\n  PanelComponent: (\n    | ComponentType<{}>\n    | ComponentType<\n        $Shape<{\n          config: Config,\n          saveConfig: SaveConfig<Config>,\n          openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n          topics: Topic[],\n          capabilities: string[],\n          datatypes: RosDatatypes,\n          isHovered: boolean,\n        }>\n      >\n  ) &\n    PanelStatics<Config>\n  // TODO(JP): Add `& PanelStatics<Config>` to the return type when we have figured out\n  // https://stackoverflow.com/questions/52508434/adding-static-variable-to-union-of-class-types\n): ComponentType<Props<Config>> {\n  function ConnectedPanel(props: Props<Config>) {\n    const { childId, config: originalConfig, saveConfig, tabId } = props;\n    const { mosaicActions }: { mosaicActions: MosaicRootActions } = useContext(MosaicContext);\n    const { mosaicWindowActions }: { mosaicWindowActions: MosaicWindowActions } = useContext(MosaicWindowContext);\n\n    const layout = useSelector(({ panels }) => panels.layout);\n    const savedProps = useSelector(({ panels }) => panels.savedProps);\n    const selectedPanelIds = useSelector((state) => state.mosaic.selectedPanelIds);\n    const isSelected = selectedPanelIds.includes(childId);\n\n    const validSelectedPanelIds = useMemo(\n      () => selectedPanelIds.filter((panelId) => getPanelTypeFromId(panelId) !== TAB_PANEL_TYPE),\n      [selectedPanelIds]\n    );\n    const isOnlyPanel = useMemo(() => (tabId ? false : !isParent(layout)), [layout, tabId]);\n    const config = savedProps[childId] || originalConfig || {};\n\n    const { topics, datatypes, capabilities } = PanelAPI.useDataSourceInfo();\n    const dispatch = useDispatch();\n    const actions: ActionProps = useMemo(\n      () =>\n        bindActionCreators(\n          {\n            savePanelConfigs,\n            saveFullPanelConfig,\n            changePanelLayout,\n            addSelectedPanelId,\n            removeSelectedPanelId,\n            setSelectedPanelIds,\n          },\n          dispatch\n        ),\n      [dispatch]\n    );\n\n    const [quickActionsKeyPressed, setQuickActionsKeyPressed] = useState(false);\n    const [shiftKeyPressed, setShiftKeyPressed] = useState(false);\n    const [cmdKeyPressed, setCmdKeyPressed] = useState(false);\n    const [fullScreen, setFullScreen] = useState(false);\n    const [isHovered, setIsHovered] = useState(false);\n    const [fullScreenLocked, setFullScreenLocked] = useState(false);\n    const [showTabPanelSelectionWarning, setShowTabPanelSelectionWarning] = useState(false);\n\n    const panelsByType = useMemo(() => getPanelsByType(), []);\n    const type = PanelComponent.panelType;\n    const title = useMemo(() => panelsByType[type]?.title, [panelsByType, type]);\n    const panelComponentConfig = useMemo(() => ({ ...PanelComponent.defaultConfig, ...config }), [config]);\n\n    const isTabPanel = useMemo(() => childId && getPanelTypeFromId(childId) === TAB_PANEL_TYPE, [childId]);\n\n    // Mix partial config with current config or `defaultConfig`\n    const saveCompleteConfig = useCallback(\n      (configToSave: $Shape<Config>, options: ?{ keepLayoutInUrl?: boolean, historyOptions?: EditHistoryOptions }) => {\n        if (saveConfig) {\n          saveConfig(configToSave);\n        }\n        if (childId) {\n          actions.savePanelConfigs({\n            silent: !!options?.keepLayoutInUrl,\n            configs: [{ id: childId, config: configToSave, defaultConfig: PanelComponent.defaultConfig }],\n            historyOptions: options?.historyOptions,\n          });\n        }\n      },\n      [actions, childId, saveConfig]\n    );\n\n    const updatePanelConfig = useCallback(\n      (panelType: string, perPanelFunc: (PanelConfig) => PanelConfig, historyOptions?: EditHistoryOptions) => {\n        actions.saveFullPanelConfig({ panelType, perPanelFunc, historyOptions });\n      },\n      [actions]\n    );\n\n    // Open a panel next to the current panel, of the specified `panelType`.\n    // If such a panel already exists, we update it with the new props.\n    const openSiblingPanel = useCallback(\n      (panelType: string, siblingConfigCreator: (PanelConfig) => PanelConfig) => {\n        const siblingComponent = PanelList.getComponentForType(panelType);\n        if (!siblingComponent) {\n          return;\n        }\n        const siblingDefaultConfig = siblingComponent.defaultConfig;\n        const ownPath = mosaicWindowActions.getPath();\n\n        // Try to find a sibling summary panel and update it with the `siblingConfig`\n        const siblingPathEnd = last(ownPath) ? getOtherBranch(last(ownPath)) : \"second\";\n        const siblingPath = ownPath.slice(0, -1).concat(siblingPathEnd);\n        const siblingId = getNodeAtPath(mosaicActions.getRoot(), siblingPath);\n        if (typeof siblingId === \"string\" && getPanelTypeFromId(siblingId) === panelType) {\n          const siblingConfig: PanelConfig = { ...siblingDefaultConfig, ...savedProps[siblingId] };\n          actions.savePanelConfigs({\n            configs: [\n              { id: siblingId, config: siblingConfigCreator(siblingConfig), defaultConfig: siblingDefaultConfig },\n            ],\n          });\n          return;\n        }\n\n        // Otherwise, open new panel\n        const newPanelPath = ownPath.concat(\"second\");\n        mosaicWindowActions.split({ type: panelType }).then(() => {\n          const newPanelId = getNodeAtPath(mosaicActions.getRoot(), newPanelPath);\n          actions.savePanelConfigs({\n            configs: [\n              {\n                id: newPanelId,\n                config: siblingConfigCreator(siblingDefaultConfig),\n                defaultConfig: siblingDefaultConfig,\n              },\n            ],\n          });\n        });\n      },\n      [actions, mosaicActions, mosaicWindowActions, savedProps]\n    );\n\n    const onOverlayClick = useCallback(\n      (e) => {\n        if (!fullScreen && quickActionsKeyPressed) {\n          setFullScreen(true);\n          if (shiftKeyPressed) {\n            setFullScreenLocked(true);\n          }\n        }\n\n        // If user clicks a 1st panel, select it\n        // If user clicks a 2nd+ panel without pressing `Cmd`, clear previous selections & select clicked panel\n        if (!e.metaKey) {\n          // Unless we are a Tab panel or in a Tab panel\n          if (tabId || isTabPanel) {\n            return;\n          }\n          if (childId) {\n            actions.setSelectedPanelIds([childId]);\n          }\n          return;\n        }\n\n        // Show a warning if we are pressing `Cmd` and clicking a Tab panel\n        // Don't select any panels\n        if (tabId || isTabPanel) {\n          setShowTabPanelSelectionWarning(true);\n          return;\n        }\n\n        if (selectedPanelIds.includes(childId)) {\n          // If clicked panel is already selected, deselect\n          actions.setSelectedPanelIds(selectedPanelIds.filter((panelId) => panelId !== childId));\n        } else if (childId) {\n          // Otherwise, select clicked panel, while deselecting any already-selected Tab panels\n          // (when panels are grouped to create a Tab panel, that new Tab panel is automatically \"selected\")\n          actions.setSelectedPanelIds(\n            selectedPanelIds.filter((panelId) => getPanelTypeFromId(panelId) !== TAB_PANEL_TYPE).concat([childId])\n          );\n        }\n      },\n      [\n        setShowTabPanelSelectionWarning,\n        fullScreen,\n        quickActionsKeyPressed,\n        selectedPanelIds,\n        tabId,\n        isTabPanel,\n        childId,\n        shiftKeyPressed,\n        actions,\n      ]\n    );\n\n    const createTabPanel = useCallback(\n      (tabPanelId, changePanelPayload, saveConfigsPayload) => {\n        actions.changePanelLayout(changePanelPayload);\n        actions.savePanelConfigs(saveConfigsPayload);\n        actions.setSelectedPanelIds([tabPanelId]);\n      },\n      [actions]\n    );\n\n    const groupPanels = useCallback(\n      () => {\n        const { tabPanelId, changePanelPayload, saveConfigsPayload } = groupPanelsOutput(\n          childId,\n          layout,\n          validSelectedPanelIds\n        );\n        createTabPanel(tabPanelId, changePanelPayload, saveConfigsPayload);\n      },\n      [childId, layout, createTabPanel, validSelectedPanelIds]\n    );\n\n    const createTabs = useCallback(\n      () => {\n        const { tabPanelId, changePanelPayload, saveConfigsPayload } = createTabsOutput(\n          childId,\n          layout,\n          validSelectedPanelIds\n        );\n        createTabPanel(tabPanelId, changePanelPayload, saveConfigsPayload);\n      },\n      [childId, layout, createTabPanel, validSelectedPanelIds]\n    );\n\n    const { closePanel, splitPanel } = useMemo(\n      () => ({\n        closePanel: () => {\n          mosaicActions.remove(mosaicWindowActions.getPath());\n        },\n        splitPanel: () => {\n          if (tabId) {\n            const newId = getPanelIdForType(PanelComponent.panelType);\n            const activeTabLayout = savedProps[tabId].tabs[savedProps[tabId].activeTabIdx].layout;\n            const pathToPanelInTab = getPathFromNode(childId, activeTabLayout);\n            const newTabLayout = updateTree(activeTabLayout, [\n              { path: pathToPanelInTab, spec: { $set: { first: childId, second: newId, direction: \"row\" } } },\n            ]);\n            const newTabConfig = updateTabPanelLayout(newTabLayout, savedProps[tabId]);\n            actions.savePanelConfigs({ configs: [{ id: tabId, config: newTabConfig }, { id: newId, config }] });\n          } else {\n            mosaicWindowActions.split({ type: PanelComponent.panelType });\n          }\n        },\n      }),\n      [actions, childId, config, mosaicActions, mosaicWindowActions, savedProps, tabId]\n    );\n\n    const { onMouseEnter, onMouseLeave, onMouseMove, enterFullscreen, exitFullScreen } = useMemo(\n      () => ({\n        onMouseEnter: () => setIsHovered(true),\n        onMouseLeave: () => setIsHovered(false),\n        onMouseMove: (e) => {\n          if (e.metaKey !== cmdKeyPressed) {\n            setCmdKeyPressed(e.metaKey);\n          }\n        },\n        enterFullscreen: () => {\n          setFullScreen(true);\n          setFullScreenLocked(true);\n        },\n        exitFullScreen: () => {\n          setFullScreen(false);\n          setFullScreenLocked(false);\n        },\n      }),\n      [cmdKeyPressed]\n    );\n\n    const onReleaseQuickActionsKey = useCallback(\n      () => {\n        setQuickActionsKeyPressed(false);\n        if (fullScreen && !fullScreenLocked) {\n          exitFullScreen();\n        }\n      },\n      [exitFullScreen, fullScreen, fullScreenLocked]\n    );\n\n    const { keyUpHandlers, keyDownHandlers } = useMemo(\n      () => ({\n        keyUpHandlers: {\n          \"`\": () => onReleaseQuickActionsKey(),\n          \"~\": () => onReleaseQuickActionsKey(),\n          Shift: () => setShiftKeyPressed(false),\n          Meta: () => {\n            setCmdKeyPressed(false);\n            setShowTabPanelSelectionWarning(false);\n          },\n        },\n        keyDownHandlers: {\n          \"`\": () => setQuickActionsKeyPressed(true),\n          \"~\": () => setQuickActionsKeyPressed(true),\n          Shift: () => setShiftKeyPressed(true),\n          Escape: () => exitFullScreen(),\n          Meta: () => {\n            setCmdKeyPressed(true);\n            setShowTabPanelSelectionWarning(false);\n          },\n        },\n      }),\n      [exitFullScreen, onReleaseQuickActionsKey]\n    );\n    return (\n      // $FlowFixMe - bug prevents requiring panelType on PanelComponent: https://stackoverflow.com/q/52508434/23649\n      <PanelContext.Provider\n        value={{\n          type,\n          id: childId,\n          title,\n          config,\n          saveConfig: saveCompleteConfig,\n          updatePanelConfig,\n          openSiblingPanel,\n          enterFullscreen,\n          isHovered,\n          tabId,\n        }}>\n        {/* Ensure user exits full-screen mode when leaving window, even if key is still pressed down */}\n        <DocumentEvents target={window} enabled onBlur={exitFullScreen} />\n        <KeyListener global keyUpHandlers={keyUpHandlers} keyDownHandlers={keyDownHandlers} />\n        <Flex\n          onClick={onOverlayClick}\n          onMouseEnter={onMouseEnter}\n          onMouseLeave={onMouseLeave}\n          onMouseMove={onMouseMove}\n          style={{ border: `2px solid ${isSelected ? colors.BLUE : \"transparent\"}` }}\n          className={cx({ [styles.root]: true, [styles.rootFullScreen]: fullScreen })}\n          col\n          dataTest=\"panel-mouseenter-container\"\n          clip>\n          {fullScreen ? <div className={styles.notClickable} /> : null}\n          {isSelected && !fullScreen && validSelectedPanelIds.length > 1 && (\n            <div data-tab-options className={styles.tabActionsOverlay}>\n              <Button style={{ backgroundColor: colors.BLUE }} onClick={groupPanels}>\n                <Icon small style={{ marginBottom: 5 }}>\n                  <BorderAllIcon />\n                </Icon>\n                Group in tab\n              </Button>\n              <Button style={{ backgroundColor: colors.BLUE }} onClick={createTabs}>\n                <Icon small style={{ marginBottom: 5 }}>\n                  <ExpandAllOutlineIcon />\n                </Icon>\n                Create {selectedPanelIds.length} tabs\n              </Button>\n            </div>\n          )}\n          {showTabPanelSelectionWarning && (\n            <div data-tab-options-no-op className={styles.prohibitedSelection}>\n              Cannot group Tab panels with other panels\n            </div>\n          )}\n          {type !== TAB_PANEL_TYPE && quickActionsKeyPressed && !fullScreen && (\n            <div className={styles.quickActionsOverlay} data-panel-overlay>\n              <MosaicDragHandle tabId={tabId}>\n                <>\n                  <div>\n                    <FullscreenIcon />\n                    {shiftKeyPressed ? \"Lock fullscreen\" : \"Fullscreen (Shift+click to lock)\"}\n                  </div>\n                  <div>\n                    <Button onClick={closePanel} disabled={isOnlyPanel}>\n                      <TrashCanOutlineIcon />\n                      Remove\n                    </Button>\n                    <Button onClick={splitPanel}>\n                      <GridLargeIcon />\n                      Split\n                    </Button>\n                  </div>\n                  {!isOnlyPanel && <p>Drag to move</p>}\n                </>\n              </MosaicDragHandle>\n            </div>\n          )}\n          {fullScreen ? (\n            <button className={styles.exitFullScreen} onClick={exitFullScreen} data-panel-overlay-exit>\n              <CloseIcon /> <span>Exit fullscreen</span>\n            </button>\n          ) : null}\n          <ErrorBoundary>\n            <PanelComponent\n              config={panelComponentConfig}\n              saveConfig={saveCompleteConfig}\n              openSiblingPanel={openSiblingPanel}\n              topics={[...topics]}\n              datatypes={datatypes}\n              capabilities={capabilities}\n              isHovered={isHovered}\n            />\n          </ErrorBoundary>\n        </Flex>\n      </PanelContext.Provider>\n    );\n  }\n  ConnectedPanel.displayName = `Panel(${PanelComponent.displayName || PanelComponent.name || \"\"})`;\n\n  const MemoizedConnectedPanel = React.memo(ConnectedPanel);\n  // $FlowFixMe - doesn't know underlying memoized PanelComponent's interface\n  MemoizedConnectedPanel.defaultConfig = PanelComponent.defaultConfig;\n  // $FlowFixMe - doesn't know underlying memoized PanelComponent's interface\n  MemoizedConnectedPanel.panelType = PanelComponent.panelType;\n  return MemoizedConnectedPanel;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport GlobalVariableName from \"../GlobalVariableName\";\nimport { getLinkedGlobalVariable } from \"../interactionUtils\";\nimport useLinkedGlobalVariables, { type LinkedGlobalVariable } from \"../useLinkedGlobalVariables\";\nimport LinkToGlobalVariable from \"./LinkToGlobalVariable\";\nimport UnlinkGlobalVariable from \"./UnlinkGlobalVariable\";\nimport UnlinkGlobalVariables from \"./UnlinkGlobalVariables\";\nimport UnlinkWrapper from \"./UnlinkWrapper\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\nconst SWrapper = styled.span`\n  display: inline-flex;\n  align-items: center;\n`;\nexport const SPath = styled.span`\n  opacity: 0.8;\n`;\nexport const SP = styled.p`\n  line-height: 1.4;\n  margin-bottom: 12px;\n`;\nexport const SGlobalVariableLink = styled.span`\n  height: 15px;\n  flex-direction: row;\n  display: inline-flex;\n  align-items: center;\n  word-break: normal;\n  .icon {\n    color: ${colors.highlight};\n  }\n  .link-icon {\n    opacity: 0.2;\n    display: none;\n  }\n  .highlight {\n    opacity: 1;\n    display: inline;\n  }\n  &:hover {\n    .link-icon {\n      opacity: 1;\n    }\n  }\n`;\n\nexport const SGlobalVariableForm = styled.form`\n  background-color: ${colors.toolbar};\n  margin-left: -16px;\n  padding: 12px;\n  width: 240px;\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\n  pointer-events: auto;\n  flex: 0 0 auto;\n  border-radius: 8px;\n  overflow-wrap: break-word;\n`;\n\nconst SValue = styled.span`\n  padding: 0;\n`;\n\ntype Props = {\n  addLinkTooltip?: React.Node,\n  hasNestedValue?: boolean,\n  highlight?: boolean,\n  label?: string,\n  linkedGlobalVariable?: ?LinkedGlobalVariable,\n  markerKeyPath?: string[],\n  nestedValueStyle?: any,\n  onlyRenderAddLink?: boolean,\n  style?: any,\n  topic?: string,\n  unlinkTooltip?: React.Node,\n  variableValue?: any,\n};\n\nexport default function GlobalVariableLink({\n  addLinkTooltip,\n  hasNestedValue,\n  highlight,\n  label,\n  linkedGlobalVariable,\n  markerKeyPath,\n  nestedValueStyle = { marginLeft: 8 },\n  onlyRenderAddLink,\n  style = { marginLeft: 4 },\n  topic,\n  unlinkTooltip,\n  variableValue = null,\n}: Props) {\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n  let linkedGlobalVariableLocal: ?LinkedGlobalVariable = linkedGlobalVariable;\n  if (!linkedGlobalVariableLocal && topic && markerKeyPath) {\n    linkedGlobalVariableLocal = getLinkedGlobalVariable({\n      topic,\n      markerKeyPath,\n      linkedGlobalVariables,\n    });\n  }\n\n  const isArrayBuffer = ArrayBuffer.isView(variableValue);\n  const renderUnlink = !!linkedGlobalVariableLocal;\n  const addToLinkedGlobalVariable = topic && markerKeyPath ? { topic, markerKeyPath, variableValue } : null;\n  const renderAddLink = !renderUnlink && !isArrayBuffer && addToLinkedGlobalVariable;\n  if (!(renderUnlink || renderAddLink)) {\n    return null;\n  }\n\n  const arrayBufferStyle = isArrayBuffer ? style : { cursor: \"pointer\" };\n  let wrapperStyle = hasNestedValue ? nestedValueStyle : style;\n  wrapperStyle = { ...arrayBufferStyle, ...wrapperStyle };\n\n  return (\n    <SWrapper>\n      {label && <SValue>{label}</SValue>}\n      <SGlobalVariableLink style={wrapperStyle}>\n        {linkedGlobalVariableLocal && !onlyRenderAddLink && (\n          <UnlinkWrapper\n            linkedGlobalVariable={linkedGlobalVariableLocal}\n            name={linkedGlobalVariableLocal.name}\n            tooltip={unlinkTooltip}>\n            {({ setIsOpen, linkedGlobalVariable: linkedVar }) => (\n              <UnlinkGlobalVariable linkedGlobalVariable={linkedVar} setIsOpen={setIsOpen} />\n            )}\n          </UnlinkWrapper>\n        )}\n        {renderAddLink && addToLinkedGlobalVariable && (\n          <LinkToGlobalVariable\n            highlight={highlight}\n            tooltip={addLinkTooltip}\n            addToLinkedGlobalVariable={addToLinkedGlobalVariable}\n          />\n        )}\n      </SGlobalVariableLink>\n    </SWrapper>\n  );\n}\n\nexport { GlobalVariableName, UnlinkGlobalVariables };\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\n\nimport { setGlobalVariables, overwriteGlobalVariables } from \"webviz-core/src/actions/panels\";\n\nexport type GlobalVariables = { [string]: any };\n\nexport default function useGlobalVariables(): {|\n  globalVariables: GlobalVariables,\n  setGlobalVariables: (GlobalVariables) => void,\n  overwriteGlobalVariables: (GlobalVariables) => void,\n|} {\n  const globalVariables = useSelector((state) => state.panels.globalVariables);\n  const dispatch = useDispatch();\n  return {\n    globalVariables,\n    ...bindActionCreators({ setGlobalVariables, overwriteGlobalVariables }, dispatch),\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\n\nimport { setLinkedGlobalVariables } from \"webviz-core/src/actions/panels\";\n\nexport type LinkedGlobalVariable = {\n  topic: string,\n  markerKeyPath: string[],\n  name: string,\n};\n\nexport type LinkedGlobalVariables = LinkedGlobalVariable[];\n\nexport default function useLinkedGlobalVariables(): {|\n  linkedGlobalVariables: LinkedGlobalVariables,\n  setLinkedGlobalVariables: (LinkedGlobalVariables) => void,\n|} {\n  const linkedGlobalVariables = useSelector((state) => state.panels.linkedGlobalVariables);\n  const dispatch = useDispatch();\n  return {\n    linkedGlobalVariables,\n    ...bindActionCreators({ setLinkedGlobalVariables }, dispatch),\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat4, vec3, quat } from \"gl-matrix\";\nimport type { Mat4 } from \"gl-matrix\";\n\nimport type { TF, MutablePose, Pose, Point, Orientation } from \"webviz-core/src/types/Messages\";\n\n// allocate some temporary variables\n// so we can copy/in out of them during tf application\n// this reduces GC as this code gets called lot\nconst tempMat = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\nconst tempPos = [0, 0, 0];\nconst tempScale = [0, 0, 0];\nconst tempOrient = [0, 0, 0, 0];\n\nfunction stripLeadingSlash(name: string) {\n  return name.startsWith(\"/\") ? name.slice(1) : name;\n}\n\nexport class Transform {\n  id: string;\n  matrix: Mat4 = mat4.create();\n  parent: ?Transform;\n  valid = false;\n\n  constructor(id: string) {\n    this.id = stripLeadingSlash(id);\n  }\n\n  reset() {\n    mat4.identity(this.matrix);\n    this.valid = true;\n  }\n\n  set(position: Point, orientation: Orientation) {\n    mat4.fromRotationTranslation(\n      this.matrix,\n      quat.set(tempOrient, orientation.x, orientation.y, orientation.z, orientation.w),\n      vec3.set(tempPos, position.x, position.y, position.z)\n    );\n    this.valid = true;\n  }\n\n  isChildOfTransform(rootId: string): boolean {\n    rootId = stripLeadingSlash(rootId);\n    if (!this.parent) {\n      return this.id === rootId;\n    }\n    return this.parent.isChildOfTransform(rootId);\n  }\n\n  rootTransform(): Transform {\n    if (!this.parent) {\n      return this;\n    }\n    return this.parent.rootTransform();\n  }\n\n  apply(output: MutablePose, input: Pose, rootId: string): ?MutablePose {\n    rootId = stripLeadingSlash(rootId);\n    if (this.id === rootId) {\n      output.position.x = input.position.x;\n      output.position.y = input.position.y;\n      output.position.z = input.position.z;\n      output.orientation.x = input.orientation.x;\n      output.orientation.y = input.orientation.y;\n      output.orientation.z = input.orientation.z;\n      output.orientation.w = input.orientation.w;\n      return output;\n    }\n    if (!this.valid) {\n      return null;\n    }\n    if (!this.isChildOfTransform(rootId)) {\n      // Can't apply if this transform doesn't map to the root transform.\n      return null;\n    }\n\n    const { position, orientation } = input;\n    // set a transform matrix from the input pose\n    mat4.fromRotationTranslation(\n      tempMat,\n      quat.set(tempOrient, orientation.x, orientation.y, orientation.z, orientation.w),\n      vec3.set(tempPos, position.x, position.y, position.z)\n    );\n\n    // set transform matrix to (our matrix * pose transform matrix)\n    mat4.multiply(tempMat, this.matrix, tempMat);\n\n    // copy the transform matrix components out into temp variables\n    mat4.getTranslation(tempPos, tempMat);\n\n    // Normalize the values in the matrix by the scale. This ensures that we get the correct rotation\n    // out even if the scale isn't 1 in each axis. The logic from this comes from the threejs\n    // implementation and an SO answer:\n    // - https://github.com/mrdoob/three.js/blob/master/src/math/Matrix4.js#L790-L815\n    // - https://math.stackexchange.com/a/1463487\n    mat4.getScaling(tempScale, tempMat);\n    if (mat4.determinant(tempMat) < 0) {\n      tempScale[0] *= -1;\n    }\n    vec3.inverse(tempScale, tempScale);\n    mat4.scale(tempMat, tempMat, tempScale);\n\n    mat4.getRotation(tempOrient, tempMat);\n\n    // mutate the output w/ the temp values\n    output.position.x = tempPos[0];\n    output.position.y = tempPos[1];\n    output.position.z = tempPos[2];\n    output.orientation.x = tempOrient[0];\n    output.orientation.y = tempOrient[1];\n    output.orientation.z = tempOrient[2];\n    output.orientation.w = tempOrient[3];\n\n    if (!this.parent) {\n      return output;\n    }\n    return this.parent.apply(output, output, rootId);\n  }\n}\n\nclass TfStore {\n  storage = {};\n  get(key: string): Transform {\n    key = stripLeadingSlash(key);\n    let result = this.storage[key];\n    if (result) {\n      return result;\n    }\n    result = new Transform(key);\n    this.storage[key] = result;\n    return result;\n  }\n\n  values = (): Array<Transform> => ((Object.values(this.storage): any): Array<Transform>);\n}\n\nexport default class Transforms {\n  storage = new TfStore();\n\n  // consume a tf message\n  consume(tfMessage: TF) {\n    // child_frame_id is the id of the tf\n    const id = tfMessage.child_frame_id;\n    const parentId = tfMessage.header.frame_id;\n    const tf = this.storage.get(id);\n    const { rotation, translation } = tfMessage.transform;\n    tf.set(translation, rotation);\n    tf.parent = this.storage.get(parentId);\n  }\n\n  // Apply the tf hierarchy to the original pose and update the pose supplied in the output parameter.\n  // This follows the same calling conventions in the gl-mat4 lib, which takes an 'out' parameter as their first argument.\n  // This allows the caller to decide if they want to update the pose by reference\n  // (by reference by supplying it as both the first and second arguments)\n  // or return a new one by calling with apply({ position: { }, orientation: {} }, original).\n  // Returns the output pose, or the input pose if no transform was needed, or null if the transform\n  // is not available -- the return value must not be ignored.\n  apply(output: MutablePose, original: Pose, frameId: string, rootId: string): ?MutablePose {\n    const tf = this.storage.get(frameId);\n    return tf.apply(output, original, rootId);\n  }\n\n  rootOfTransform(transformID: string): Transform {\n    return this.get(transformID).rootTransform();\n  }\n\n  get = (key: string) => this.storage.get(key);\n  values = (): Array<Transform> => this.storage.values();\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport Interactions from \"./Interactions\";\n\nexport * from \"./Interactions\";\nexport { default as InteractionContextMenu } from \"./InteractionContextMenu\";\nexport { default as GlobalVariableLink, UnlinkGlobalVariables } from \"./GlobalVariableLink\";\nexport * from \"./types\";\n\nexport default Interactions;\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Layout.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Layout.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Layout.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { type Node, useMemo } from \"react\";\nimport type { Time } from \"rosbag\";\n\nimport parseRosPath, { getTopicsFromPaths } from \"webviz-core/src/components/MessagePathSyntax/parseRosPath\";\nimport {\n  type MessagePathDataItem,\n  useCachedGetMessagePathDataItems,\n} from \"webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message } from \"webviz-core/src/players/types\";\nimport { useShallowMemo } from \"webviz-core/src/util/hooks\";\n\nexport type MessageHistoryItem = {\n  queriedData: MessagePathDataItem[],\n  message: Message,\n};\n\nexport type MessageHistoryItemsByPath = { [string]: MessageHistoryItem[] };\n\nexport type MessageHistoryData = {|\n  itemsByPath: MessageHistoryItemsByPath,\n  startTime: Time,\n|};\n\ntype Props = {|\n  children: (MessageHistoryData) => Node,\n  paths: string[],\n  historySize?: number,\n|};\n\nconst ZERO_TIME = Object.freeze({ sec: 0, nsec: 0 });\n\n// DEPRECATED in favor of PanelAPI.useMessagesByTopic and useCachedGetMessagePathDataItems.\n//\n// Be sure to pass in a new render function when you want to force a rerender.\n// So you probably don't want to do `<MessageHistoryDEPRECATED>{this._renderSomething}</MessageHistoryDEPRECATED>`.\n// This might be a bit counterintuitive but we do this since performance matters here.\nexport default React.memo<Props>(function MessageHistoryDEPRECATED({ children, paths, historySize }: Props) {\n  const { startTime } = PanelAPI.useDataSourceInfo();\n  const memoizedPaths: string[] = useShallowMemo<string[]>(paths);\n  const subscribeTopics = useMemo(() => getTopicsFromPaths(memoizedPaths), [memoizedPaths]);\n\n  const messagesByTopic = PanelAPI.useMessagesByTopic({\n    topics: subscribeTopics,\n    historySize: historySize || Infinity,\n  });\n\n  const cachedGetMessagePathDataItems = useCachedGetMessagePathDataItems(paths);\n\n  const itemsByPath = useMemo(\n    () => {\n      const obj = {};\n      // Create an array for each path, not just valid paths.\n      for (const path of memoizedPaths) {\n        obj[path] = [];\n        const rosPath = parseRosPath(path);\n        if (!rosPath) {\n          continue;\n        }\n\n        for (const message of messagesByTopic[rosPath.topicName]) {\n          // Add the item (if it exists) to the array.\n          const queriedData = cachedGetMessagePathDataItems(path, message);\n          if (queriedData) {\n            obj[path].push({ message, queriedData });\n          }\n        }\n      }\n      return obj;\n    },\n    [memoizedPaths, messagesByTopic, cachedGetMessagePathDataItems]\n  );\n\n  return useMemo(() => children({ itemsByPath, startTime: startTime || ZERO_TIME }), [\n    children,\n    itemsByPath,\n    startTime,\n  ]);\n});\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { memoize, uniq } from \"lodash\";\nimport { Parser, Grammar } from \"nearley\";\n\nimport type { RosPath } from \"./constants\";\nimport grammar from \"./grammar.ne\";\nimport filterMap from \"webviz-core/src/filterMap\";\n\nconst grammarObj = Grammar.fromCompiled(grammar);\n\nconst parseRosPath: (path: string) => ?RosPath = memoize(\n  (path: string): ?RosPath => {\n    // Need to create a new Parser object for every new string to parse (should be cheap).\n    const parser = new Parser(grammarObj);\n    try {\n      return parser.feed(path).results[0];\n    } catch (_) {\n      return undefined;\n    }\n  }\n);\nexport default parseRosPath;\n\nexport function getTopicsFromPaths(paths: string[]): string[] {\n  return uniq(\n    filterMap(paths, (path) => {\n      const rosPath = parseRosPath(path);\n      return rosPath ? rosPath.topicName : undefined;\n    })\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nexport function isTypicalFilterName(name: string) {\n  return /^id$|_id$|I[dD]$/.test(name);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport cx from \"classnames\";\nimport { maxBy } from \"lodash\";\nimport React, { PureComponent } from \"react\";\nimport ReactAutocomplete from \"react-autocomplete\";\nimport { createPortal } from \"react-dom\";\nimport textWidth from \"text-width\";\n\nimport styles from \"./Autocomplete.module.scss\";\nimport fuzzyFilter from \"webviz-core/src/util/fuzzyFilter\";\n\nconst fontFamily = \"'Inter UI', -apple-system, BlinkMacSystemFont, sans-serif\";\nconst fontSize = 12;\nfunction measureText(text: string): number {\n  return textWidth(text, { family: fontFamily, size: fontSize }) + 3;\n}\n\nconst rowHeight = parseInt(styles.rowHeight);\n\n// <Autocomplete> is a Webviz-specific autocomplete with support for things like multiple\n// autocompletes that seamlessly transition into each other, e.g. when building more complex\n// strings like in the Plot panel.\n//\n// The multiple autocompletes doesn't work super well with react-autocomplete, so we have to\n// reimplement some of its behaviour to make things work properly, such as the `_ignoreBlur`\n// stuff. Mostly, though, we can lean on react-autocomplete to do the heavy lifting.\n//\n// For future reference, the reason `<ReactAutocomplete>` (and we) has to do `_ignoreBlur`, is that\n// when you select an item from the autocomplete menu by clicking, it first triggers a `blur` event\n// on the `<input>`, before triggering a `click` event. If we wouldn't ignore that `blur` event,\n// we'd hide the menu before the `click` event even has a chance of getting fired. So the `blur`\n// event has to be ignored, and the subsequent `focus` event also has to be ignored since it's kind\n// of a \"false\" focus event. (In our case we just don't bother with ignoring the `focus` event since\n// it doesn't cause any problems.)\ntype AutocompleteProps = {|\n  items: mixed[],\n  getItemValue: (mixed) => string,\n  getItemText: (mixed) => string,\n  filterText?: string,\n  value?: string,\n  selectedItem: ?mixed,\n  onChange: (SyntheticInputEvent<HTMLInputElement>, string) => void,\n  onSelect: (string, mixed, Autocomplete) => void, // eslint-disable-line no-use-before-define\n  onBlur?: () => void,\n  hasError: ?boolean,\n  autocompleteKey?: ?string,\n  placeholder?: ?string,\n  autoSize?: boolean,\n  sortWhenFiltering: boolean,\n  clearOnFocus: boolean, // only for uncontrolled use (when onChange is not set)\n  minWidth: number,\n  menuStyle?: any,\n  inputStyle?: any,\n  disableAutoSelect?: boolean,\n|};\n\ntype AutocompleteState = {|\n  focused: boolean,\n  showAllItems: boolean,\n  value?: string,\n|};\n\nfunction defaultGetText(name: string) {\n  return function(item: mixed) {\n    if (typeof item === \"string\") {\n      return item;\n    } else if (item && typeof item === \"object\" && typeof item.value === \"string\") {\n      return item.value;\n    }\n    throw new Error(`you need to provide an implementation of ${name}`);\n  };\n}\n\nexport default class Autocomplete extends PureComponent<AutocompleteProps, AutocompleteState> {\n  _autocomplete: { current: null | Autocomplete };\n  _ignoreFocus: boolean = false;\n  _ignoreBlur: boolean = false;\n\n  static defaultProps = {\n    getItemText: defaultGetText(\"getItemText\"),\n    getItemValue: defaultGetText(\"getItemValue\"),\n    sortWhenFiltering: true,\n    clearOnFocus: false,\n    minWidth: 100,\n  };\n\n  constructor(props: AutocompleteProps) {\n    super(props);\n    this._autocomplete = React.createRef<ReactAutocomplete>();\n    this.state = { focused: false, showAllItems: false };\n  }\n\n  // When we lose the scrollbar, we can safely set `showAllItems: false` again, because all items\n  // will be in view anyway. We cannot set it to false earlier, as `<ReactAutocomplete>` may have a\n  // reference to the highlighted element, which can cause an error if we hide it.\n  componentDidUpdate() {\n    if (\n      this._autocomplete.current &&\n      this._autocomplete.current.refs.menu &&\n      this._autocomplete.current.refs.menu.scrollHeight <= this._autocomplete.current.refs.menu.clientHeight &&\n      this.state.showAllItems\n    ) {\n      this.setState({ showAllItems: false });\n    }\n  }\n\n  setSelectionRange(selectionStart: number, selectionEnd: number) {\n    if (this._autocomplete.current && this._autocomplete.current.refs.input) {\n      this._autocomplete.current.refs.input.setSelectionRange(selectionStart, selectionEnd);\n    }\n    this.setState({ focused: true });\n  }\n\n  focus() {\n    if (this._autocomplete.current && this._autocomplete.current.refs.input) {\n      this._autocomplete.current.refs.input.focus();\n    }\n  }\n\n  blur() {\n    if (this._autocomplete.current && this._autocomplete.current.refs.input) {\n      this._autocomplete.current.refs.input.blur();\n    }\n    this._ignoreBlur = false;\n    this.setState({ focused: false });\n    if (this.props.onBlur) {\n      this.props.onBlur();\n    }\n  }\n\n  _onFocus = () => {\n    if (this._ignoreFocus) {\n      return;\n    }\n    const { clearOnFocus } = this.props;\n    if (\n      this._autocomplete.current &&\n      this._autocomplete.current.refs.input &&\n      document.activeElement === this._autocomplete.current.refs.input\n    ) {\n      this.setState({ focused: true });\n      if (clearOnFocus) {\n        this.setState({ value: \"\" });\n      }\n    }\n  };\n\n  // Wait for a mouseup event, and check in the mouseup event if anything was actually selected, or\n  // if it just was a click without a drag. In the latter case, select everything. This is very\n  // similar to how, say, the browser bar in Chrome behaves.\n  _onMouseDown = (event: SyntheticMouseEvent<HTMLInputElement>) => {\n    if (this.props.disableAutoSelect) {\n      return;\n    }\n    if (this.state.focused) {\n      return;\n    }\n    const onMouseUp = (e: MouseEvent) => {\n      document.removeEventListener(\"mouseup\", onMouseUp, true);\n\n      if (\n        this._autocomplete.current &&\n        this._autocomplete.current.refs.input &&\n        // Make sure that the element is actually still focused.\n        document.activeElement === this._autocomplete.current.refs.input\n      ) {\n        if (\n          this._autocomplete.current.refs.input.selectionStart === this._autocomplete.current.refs.input.selectionEnd\n        ) {\n          this._autocomplete.current.refs.input.select();\n          e.stopPropagation();\n          e.preventDefault();\n        }\n        // Also set `state.focused` for good measure, since we know here that we're focused.\n        this.setState({ focused: true });\n      }\n    };\n    document.addEventListener(\"mouseup\", onMouseUp, true);\n  };\n\n  _onBlur = () => {\n    if (this._ignoreBlur) {\n      return;\n    }\n    if (\n      this._autocomplete.current &&\n      this._autocomplete.current.refs.input &&\n      document.activeElement === this._autocomplete.current.refs.input\n    ) {\n      // Bail if we actually still are focused.\n      return;\n    }\n    this.setState({ focused: false, value: undefined });\n    if (this.props.onBlur) {\n      this.props.onBlur();\n    }\n  };\n\n  _onChange = (event: SyntheticInputEvent<HTMLInputElement>) => {\n    if (this.props.onChange) {\n      this.props.onChange(event, event.target.value);\n    } else {\n      this.setState({ value: event.target.value });\n    }\n  };\n\n  // Make sure the input field gets focused again after selecting, in case we're doing multiple\n  // autocompletes. We pass in `this` to `onSelect` in case the user of this component wants to call\n  // `blur()`.\n  _onSelect = (value: string, item: any) => {\n    if (this._autocomplete.current && this._autocomplete.current.refs.input) {\n      this._autocomplete.current.refs.input.focus();\n      this.setState({ focused: true, value: undefined }, () => {\n        this.props.onSelect(value, item, this);\n      });\n    }\n  };\n\n  // When scrolling down by even a little bit, just show all items. In most cases people won't\n  // do this and instead will type more text to narrow down their autocomplete.\n  _onScroll = (event: SyntheticMouseEvent<HTMLDivElement>) => {\n    if (event.currentTarget.scrollTop > 0) {\n      // Never set `showAllItems` to false here, as `<ReactAutocomplete>` may have a reference to\n      // the highlighted element. We only set it back to false in `componentDidUpdate`.\n      this.setState({ showAllItems: true });\n    }\n  };\n\n  _onKeyDown = (event: SyntheticKeyboardEvent<HTMLInputElement>) => {\n    if (event.key === \"Escape\" || (event.key === \"Enter\" && this.props.items.length === 0)) {\n      this.blur();\n    }\n  };\n\n  render() {\n    const {\n      autocompleteKey,\n      autoSize,\n      getItemValue,\n      getItemText,\n      items,\n      placeholder,\n      selectedItem,\n      value = this.state.value ?? (selectedItem ? getItemText(selectedItem) : null),\n      filterText = value,\n      sortWhenFiltering,\n      minWidth,\n      menuStyle = {},\n      inputStyle = {},\n    } = this.props;\n    const autocompleteItems = fuzzyFilter(items, filterText, getItemText, sortWhenFiltering);\n\n    const { hasError = autocompleteItems.length === 0 } = this.props;\n\n    const open = this.state.focused && autocompleteItems.length > 0;\n    if (!open) {\n      this._ignoreBlur = false;\n    }\n\n    const selectedItemValue = selectedItem != null ? getItemValue(selectedItem) : null;\n    return (\n      <ReactAutocomplete\n        open={open}\n        items={autocompleteItems}\n        getItemValue={getItemValue}\n        renderItem={(item, isHighlighted) => {\n          const itemValue = getItemValue(item);\n          return (\n            <div\n              key={itemValue}\n              data-highlighted={isHighlighted}\n              data-test-auto-item\n              className={cx(styles.autocompleteItem, {\n                [styles.highlighted]: isHighlighted,\n                [styles.selected]: selectedItemValue != null && itemValue === selectedItemValue,\n              })}>\n              {getItemText(item)}\n            </div>\n          );\n        }}\n        onChange={this._onChange}\n        onSelect={this._onSelect}\n        value={value || \"\"}\n        inputProps={{\n          className: cx(styles.input, { [styles.inputError]: hasError }),\n          autoCorrect: \"off\",\n          autoCapitalize: \"off\",\n          spellCheck: \"false\",\n          placeholder,\n          style: {\n            ...inputStyle,\n            fontFamily,\n            fontSize,\n            width: autoSize ? Math.max(measureText(value || placeholder || \"\"), minWidth) : \"100%\",\n          },\n          onFocus: this._onFocus,\n          onBlur: this._onBlur,\n          onMouseDown: this._onMouseDown,\n          onKeyDown: this._onKeyDown,\n        }}\n        renderMenu={(menuItems, val, style) => {\n          // Hacky virtualization. Either don't show all menuItems (typical when the user is still\n          // typing in the autcomplete), or do show them all (once the user scrolls). Not the most\n          // sophisticated, but good enough!\n          const maxNumberOfItems = Math.ceil(window.innerHeight / rowHeight + 10);\n          const menuItemsToShow =\n            this.state.showAllItems || menuItems.length <= maxNumberOfItems * 2\n              ? menuItems\n              : menuItems.slice(0, maxNumberOfItems).concat(menuItems.slice(-maxNumberOfItems));\n\n          // The longest string might not be the widest (e.g. \"|||\" vs \"www\"), but this is\n          // quite a bit faster, so we throw in a nice padding and call it good enough! :-)\n          const width = measureText(getItemText(maxBy(autocompleteItems, (item) => getItemText(item).length))) + 50;\n          const maxHeight = `calc(100vh - 10px - ${style.top}px)`;\n\n          return (\n            <div\n              className={styles.root}\n              key={autocompleteKey /* So we scroll to the top when selecting */}\n              style={\n                // If the autocomplete would fall off the screen, pin it to the right.\n                style.left + width <= window.innerWidth\n                  ? { ...menuStyle, ...style, width, maxWidth: \"100%\", maxHeight }\n                  : { ...menuStyle, ...style, width, maxWidth: \"100%\", maxHeight, left: \"auto\", right: 0 }\n              }\n              onScroll={this._onScroll}>\n              {/* Have to wrap onMouseEnter and onMouseLeave in a separate <div>, as react-autocomplete\n               * would override them on the root <div>. */}\n              <div onMouseEnter={() => (this._ignoreBlur = true)} onMouseLeave={() => (this._ignoreBlur = false)}>\n                {menuItemsToShow}\n              </div>\n            </div>\n          );\n        }}\n        renderMenuWrapper={(menu) => document.body && createPortal(menu, document.body)}\n        ref={this._autocomplete}\n        wrapperStyle={{ flex: \"1 1 auto\", overflow: \"hidden\", marginLeft: 6 }}\n      />\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { keyBy } from \"lodash\";\nimport memoize from \"micro-memoize\";\n\nimport {\n  type LinkedGlobalVariables,\n  type LinkedGlobalVariable,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\n\nexport function getTopicWithPath({ topic, markerKeyPath }: { topic: string, markerKeyPath: string[] }): string {\n  return `${topic}.${getPath(markerKeyPath)}`;\n}\n\nexport function getPath(markerKeyPath: string[]): string {\n  return [...markerKeyPath].reverse().join(\".\");\n}\n\nexport function getLinkedGlobalVariableKeyByTopicWithPath(\n  linkedGlobalVariables: LinkedGlobalVariables\n): { [string]: LinkedGlobalVariable } {\n  return keyBy(linkedGlobalVariables, ({ topic, markerKeyPath }) => getTopicWithPath({ topic, markerKeyPath }));\n}\n\nconst memoizedGetLinkedVariablesKeyByTopicWithPath = memoize(getLinkedGlobalVariableKeyByTopicWithPath);\n\nexport function getLinkedGlobalVariable({\n  topic,\n  markerKeyPath,\n  linkedGlobalVariables,\n}: {\n  topic: string,\n  markerKeyPath: string[],\n  linkedGlobalVariables: LinkedGlobalVariables,\n}): ?LinkedGlobalVariable {\n  const linkedGlobalVariablesKeyByTopicWithPath = memoizedGetLinkedVariablesKeyByTopicWithPath(linkedGlobalVariables);\n  const topicWithPath = getTopicWithPath({ topic, markerKeyPath });\n  return linkedGlobalVariablesKeyByTopicWithPath[topicWithPath];\n}\n\nfunction getLinkedGlobalVariablesKeyByName(linkedGlobalVariables: LinkedGlobalVariables) {\n  return linkedGlobalVariables.reduce((memo, { name, topic, markerKeyPath }) => {\n    if (!memo[name]) {\n      memo[name] = [];\n    }\n    memo[name].push({ topic, markerKeyPath, name });\n    return memo;\n  }, {});\n}\n\nexport const memoizedGetLinkedGlobalVariablesKeyByName = memoize(getLinkedGlobalVariablesKeyByName);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { omit, isEqual, difference } from \"lodash\";\nimport microMemoize from \"micro-memoize\";\nimport { type MouseEventObject } from \"regl-worldview\";\n\nimport { type FieldReader, Float32Reader, Int32Reader, Uint16Reader, Int16Reader, Uint8Reader } from \"./Readers\";\nimport log from \"webviz-core/src/panels/ThreeDimensionalViz/logger\";\nimport {\n  DEFAULT_FLAT_COLOR,\n  type PointCloudSettings,\n  type ColorMode,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/PointCloudSettingsEditor\";\nimport type { PointCloud2, PointField } from \"webviz-core/src/types/Messages\";\nimport { lerp } from \"webviz-core/src/util\";\n\nconst EMPTY_ARRAY = [];\nconst REQUIRED_FLOAT32_FIELDS = [\"x\", \"y\", \"z\"];\nexport const DATATYPE = {\n  uint8: 2,\n  uint16: 4,\n  int16: 3,\n  int32: 5,\n  float32: 7,\n};\n\nexport type FieldOffsetsAndReaders = {\n  [name: string]: { datatype: string, offset: number, reader: ?FieldReader },\n};\n\nexport function getReader(datatype: number, offset: number) {\n  switch (datatype) {\n    case DATATYPE.float32:\n      return new Float32Reader(offset);\n    case DATATYPE.uint8:\n      return new Uint8Reader(offset);\n    case DATATYPE.uint16:\n      return new Uint16Reader(offset);\n    case DATATYPE.int16:\n      return new Int16Reader(offset);\n    case DATATYPE.int32:\n      return new Int32Reader(offset);\n    default:\n      log.error(\"Unsupported datatype\", datatype);\n  }\n}\n\nexport function getFieldOffsetsAndReaders(fields: $ReadOnlyArray<PointField>): FieldOffsetsAndReaders {\n  const result = {};\n  for (const { name, datatype, offset = 0 } of fields) {\n    result[name] = { datatype, offset, reader: getReader(datatype, offset) };\n  }\n  return result;\n}\n\nexport function parseHexColor(color: string) {\n  console.assert(color.length === 7);\n  return parseInt(color.slice(1), 16);\n}\n\nexport function mapMarker(marker: PointCloud2 & { settings?: PointCloudSettings }, decodeAllFields?: boolean) {\n  // http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html\n  const { fields, data, width, row_step, height, point_step, settings = {}, is_bigendian } = marker;\n  const offsetsAndReaders = getFieldOffsetsAndReaders(fields);\n\n  for (const float32Field of REQUIRED_FLOAT32_FIELDS) {\n    if (!offsetsAndReaders[float32Field]) {\n      log.error(`point cloud is missing field '${float32Field}'`);\n      return { points: [], colors: [] };\n    } else if (offsetsAndReaders[float32Field].datatype !== DATATYPE.float32) {\n      log.error(`expected '${float32Field}' to be a float32 field (found ${offsetsAndReaders[float32Field].datatype})`);\n      return { points: [], colors: [] };\n    }\n  }\n  const {\n    x: { offset: xOffset },\n    y: { offset: yOffset },\n    z: { offset: zOffset },\n    rgb: { offset: rgbOffset } = {},\n  } = offsetsAndReaders;\n\n  const colorMode: ColorMode = settings.colorMode\n    ? settings.colorMode\n    : rgbOffset != null\n    ? { mode: \"rgb\" }\n    : { mode: \"flat\", flatColor: DEFAULT_FLAT_COLOR };\n\n  const points = new Uint8Array(width * height * 12);\n  const colors = new Uint8Array(width * height * 3);\n\n  let autoMinValue = true;\n  let autoMaxValue = true;\n  let minColorFieldValue = Infinity;\n  let maxColorFieldValue = -Infinity;\n  if (colorMode.mode === \"gradient\" || colorMode.mode === \"rainbow\") {\n    if (colorMode.minValue != null) {\n      autoMinValue = false;\n      minColorFieldValue = colorMode.minValue;\n    }\n    if (colorMode.maxValue != null) {\n      autoMaxValue = false;\n      maxColorFieldValue = colorMode.maxValue;\n    }\n  }\n\n  // the field \"rgb\" has a special parsing code path - it's packed into the first three bytes of a float32\n  // so if the colorField is rgb don't use a reader - its faster to just read the value directly\n  // it also is the default rendering option if no custom colorField is specified\n  const useRGB = colorMode.mode === \"rgb\" && rgbOffset != null;\n\n  const useFlatColor = colorMode.mode === \"flat\";\n  const parsedFlatColor = colorMode.mode === \"flat\" ? parseHexColor(colorMode.flatColor) : 0;\n  const flatColorR = (parsedFlatColor >> 16) & 0xff;\n  const flatColorG = (parsedFlatColor >> 8) & 0xff;\n  const flatColorB = parsedFlatColor & 0xff;\n\n  const colorFieldReader =\n    colorMode.mode === \"rainbow\" || colorMode.mode === \"gradient\"\n      ? offsetsAndReaders[colorMode.colorField]?.reader\n      : null;\n  if (colorMode.colorField && !colorFieldReader) {\n    log.warn(`color field ${colorMode.colorField} not found in point cloud`);\n  }\n  const colorFieldValues = colorFieldReader ? new Float64Array(width * height) : EMPTY_ARRAY;\n\n  let pointCount = 0;\n  for (let row = 0; row < height; row++) {\n    for (let col = 0; col < width; col++) {\n      const pointDataStart = row * row_step + col * point_step;\n      const x1 = data[pointDataStart + xOffset];\n      const x2 = data[pointDataStart + xOffset + 1];\n      const x3 = data[pointDataStart + xOffset + 2];\n      const x4 = data[pointDataStart + xOffset + 3];\n\n      // if the value is NaN then don't count this point\n      // this is to support non-dense point clouds\n      // https://answers.ros.org/question/234455/pointcloud2-and-pointfield/\n      if ((x4 & 0x7f) === 0x7f && (x3 & 0x80) === 0x80) {\n        continue;\n      }\n\n      const pointStart = pointCount * 12;\n\n      // add x point\n      points[pointStart] = x1;\n      points[pointStart + 1] = x2;\n      points[pointStart + 2] = x3;\n      points[pointStart + 3] = x4;\n\n      // add y point\n      points[pointStart + 4] = data[pointDataStart + yOffset];\n      points[pointStart + 5] = data[pointDataStart + yOffset + 1];\n      points[pointStart + 6] = data[pointDataStart + yOffset + 2];\n      points[pointStart + 7] = data[pointDataStart + yOffset + 3];\n\n      // add z point\n      points[pointStart + 8] = data[pointDataStart + zOffset];\n      points[pointStart + 9] = data[pointDataStart + zOffset + 1];\n      points[pointStart + 10] = data[pointDataStart + zOffset + 2];\n      points[pointStart + 11] = data[pointDataStart + zOffset + 3];\n\n      // add color\n      const colorStart = pointCount * 3;\n      if (useFlatColor) {\n        colors[colorStart] = flatColorR;\n        colors[colorStart + 1] = flatColorG;\n        colors[colorStart + 2] = flatColorB;\n      } else if (useRGB) {\n        // In case of little endianess, colors are in BGR format\n        colors[colorStart + 0] = data[pointDataStart + rgbOffset + (is_bigendian ? 0 : 2)];\n        colors[colorStart + 1] = data[pointDataStart + rgbOffset + 1];\n        colors[colorStart + 2] = data[pointDataStart + rgbOffset + (is_bigendian ? 2 : 0)];\n      } else if (colorFieldReader) {\n        const colorFieldValue = colorFieldReader.read(data, pointDataStart);\n        colorFieldValues[pointCount] = colorFieldValue;\n        if (!Number.isNaN(colorFieldValue)) {\n          if (autoMinValue) {\n            minColorFieldValue = Math.min(minColorFieldValue, colorFieldValue);\n          }\n          if (autoMaxValue) {\n            maxColorFieldValue = Math.max(maxColorFieldValue, colorFieldValue);\n          }\n        }\n      } else {\n        throw new Error(`unexpected color mode ${colorMode.mode}`);\n      }\n      pointCount++;\n    }\n  }\n\n  if (colorFieldReader) {\n    // if min and max are equal set the diff to something huge\n    // so when we divide by it we effectively get zero.\n    // taken from http://docs.ros.org/jade/api/rviz/html/c++/point__cloud__transformers_8cpp_source.html\n    // line 132\n    const colorFieldRange = maxColorFieldValue - minColorFieldValue || Infinity;\n\n    // we need to loop through colorField values again now that we know min/max\n    // and assign a color to the pointCloud for each colorField value\n\n    // use custom gradient\n    if (colorMode.mode === \"gradient\") {\n      const parsedMinColor = parseHexColor(colorMode.minColor);\n      const parsedMaxColor = parseHexColor(colorMode.maxColor);\n      for (let i = 0; i < pointCount; i++) {\n        const offset = i * 3;\n        const val = colorFieldValues[i];\n        const pct = Math.max(0, Math.min((val - minColorFieldValue) / colorFieldRange, 1));\n\n        const minR = (parsedMinColor >> 16) & 0xff;\n        const minG = (parsedMinColor >> 8) & 0xff;\n        const minB = parsedMinColor & 0xff;\n\n        const maxR = (parsedMaxColor >> 16) & 0xff;\n        const maxG = (parsedMaxColor >> 8) & 0xff;\n        const maxB = parsedMaxColor & 0xff;\n\n        colors[offset] = lerp(pct, minR, maxR);\n        colors[offset + 1] = lerp(pct, minG, maxG);\n        colors[offset + 2] = lerp(pct, minB, maxB);\n      }\n    }\n    // use rainbow\n    else if (colorMode.mode === \"rainbow\") {\n      for (let i = 0; i < pointCount; i++) {\n        const offset = i * 3;\n        const val = colorFieldValues[i];\n        const pct = Math.max(0, Math.min((val - minColorFieldValue) / colorFieldRange, 1));\n        setRainbowColor(colors, offset, pct);\n      }\n    } else {\n      throw new Error(`unexpected color mode ${colorMode.mode}`);\n    }\n  }\n\n  return {\n    ...marker,\n    points: new Float32Array(points.buffer, 0, pointCount * 3),\n    colors,\n  };\n}\n\ntype ClickedInfo = {\n  clickedPoint: number[],\n  clickedPointColor?: number[],\n  additionalFieldValues?: { [name: string]: ?number },\n};\n\n// extract clicked point's position, color and additional field values to display in the UI\nexport function getClickedInfo(maybeFullyDecodedMarker: MouseEventObject, instanceIndex: ?number): ?ClickedInfo {\n  const { points, colors, fields, ...rest } = maybeFullyDecodedMarker;\n  const allPoints: number[] = points || [];\n  let result: ?ClickedInfo;\n  if (allPoints.length && instanceIndex != null && instanceIndex >= 0 && instanceIndex * 3 < allPoints.length) {\n    result = { clickedPoint: [] };\n    const baseIdx = instanceIndex * 3;\n    result.clickedPoint.push(allPoints[baseIdx]);\n    result.clickedPoint.push(allPoints[baseIdx + 1]);\n    result.clickedPoint.push(allPoints[baseIdx + 2]);\n    const allColors: number[] = colors || [];\n    const baseColorR = allColors[baseIdx];\n    const baseColorG = allColors[baseIdx + 1];\n    const baseColorB = allColors[baseIdx + 2];\n    if (baseColorR && baseColorG && baseColorB) {\n      result.clickedPointColor = [baseColorR, baseColorG, baseColorB, 1];\n    }\n    const additionalField = getAdditionalFieldNames(fields);\n    if (additionalField.length) {\n      result.additionalFieldValues = additionalField.reduce((memo, fieldName) => {\n        if (rest[fieldName]) {\n          memo[fieldName] = rest[fieldName][instanceIndex];\n        }\n        return memo;\n      }, {});\n    }\n  }\n  return result;\n}\n\nfunction getAdditionalFieldNames(fields: $ReadOnlyArray<PointField>): string[] {\n  const allFields = fields.map((field) => field.name);\n  return difference(allFields, [\"rgb\", \"x\", \"y\", \"z\"]);\n}\n\nexport function decodeAdditionalFields(marker: PointCloud2): { [fieldName: string]: number[] } {\n  const { fields, data, width, row_step, height, point_step } = marker;\n  const offsets = getFieldOffsetsAndReaders(fields);\n  if (!offsets) {\n    return {};\n  }\n\n  let pointCount = 0;\n  const additionalField = getAdditionalFieldNames(fields);\n  const otherFieldsValues = additionalField.reduce((memo, name) => {\n    memo[name] = new Array(width * height);\n    return memo;\n  }, {});\n  for (let row = 0; row < height; row++) {\n    const dataOffset = row * row_step;\n    for (let col = 0; col < width; col++) {\n      const dataStart = col * point_step + dataOffset;\n      for (const fieldName of additionalField) {\n        const reader = offsets[fieldName].reader;\n        if (reader) {\n          const fieldValue = reader.read(data, dataStart);\n          otherFieldsValues[fieldName][pointCount] = fieldValue;\n        }\n      }\n      // increase point count by 1\n      pointCount++;\n    }\n  }\n\n  return {\n    ...omit(marker, \"data\"), // no need to include data since all fields have been decoded\n    ...otherFieldsValues,\n  };\n}\n\n// taken from http://docs.ros.org/jade/api/rviz/html/c++/point__cloud__transformers_8cpp_source.html\n// line 47\nfunction setRainbowColor(colors: Uint8Array, offset: number, pct: number) {\n  const h = (1 - pct) * 5.0 + 1.0;\n  const i = Math.floor(h);\n  let f = h % 1.0;\n  // if i is even\n  if ((i & 1) === 0) {\n    f = 1 - f;\n  }\n  const n = 1 - f;\n  let r = 0;\n  let g = 0;\n  let b = 0;\n  if (i <= 1) {\n    r = n;\n    g = 0;\n    b = 1;\n  } else if (i === 2) {\n    r = 0;\n    g = n;\n    b = 1;\n  } else if (i === 3) {\n    r = 0;\n    g = 1;\n    b = n;\n  } else if (i === 4) {\n    r = n;\n    g = 1;\n    b = 0;\n  } else {\n    r = 1;\n    g = n;\n    b = 0;\n  }\n  colors[offset] = r * 255;\n  colors[offset + 1] = g * 255;\n  colors[offset + 2] = b * 255;\n}\n\n// Compare `data` field by reference because the same marker msg contains the same binary data,\n// and `settings` field by deep-equality check since it's recreated whenever Layout re-renders.\nconst isPointCloudEqual = (a, b) => {\n  return a.data === b.data && isEqual(a.settings, b.settings);\n};\n\nexport const memoizedMapMarker = microMemoize(mapMarker, { isEqual: isPointCloudEqual, maxSize: 30 });\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { truncate } from \"lodash\";\nimport type { Time } from \"rosbag\";\n\nimport { type DiagnosticsBuffer } from \"webviz-core/src/panels/diagnostics/DiagnosticsHistory\";\nimport type { Header } from \"webviz-core/src/types/Messages\";\n\n// Trim the message if it's too long. We sometimes get crazy massive messages here that can\n// otherwise crash our entire UI. I looked at a bunch of messages manually and they are typically\n// way smaller than 5KB, so this is a very generous maximum. But feel free to increase it more if\n// necessary. Exported for tests.\nexport const MAX_STRING_LENGTH = 5000; // 5KB\n\nexport const LEVELS: { OK: 0, WARN: 1, ERROR: 2, STALE: 3 } = { OK: 0, WARN: 1, ERROR: 2, STALE: 3 };\n\nexport const LEVEL_NAMES = {\n  [0]: \"ok\",\n  [1]: \"warn\",\n  [2]: \"error\",\n  [3]: \"stale\",\n};\n\nopaque type _DiagnosticId = string;\ninterface ToString {\n  toString(): string;\n}\n\nexport type DiagnosticId = _DiagnosticId & ToString;\n\nexport type Level = $Values<typeof LEVELS>;\n\nexport type KeyValue = {| key: string, value: string |};\n\nexport type DiagnosticStatusMessage = {|\n  name: string,\n  hardware_id: string,\n  level: Level,\n  message?: string,\n  values?: KeyValue[],\n|};\n\nexport type DiagnosticInfo = {|\n  status: DiagnosticStatusMessage,\n  stamp: Time,\n  id: DiagnosticId,\n  displayName: string,\n|};\n\nexport type DiagnosticStatusArray = {|\n  header: Header,\n  status: DiagnosticStatusMessage[],\n|};\n\nexport type DiagnosticsById = Map<DiagnosticId, DiagnosticInfo>;\nexport type DiagnosticsByLevel = {| [Level]: DiagnosticsById |};\n\nexport function getDiagnosticId(status: DiagnosticStatusMessage): DiagnosticId {\n  // Remove leading slash from hardware_id if present.\n  let hardware_id = status.hardware_id;\n  if (hardware_id.startsWith(\"/\")) {\n    hardware_id = hardware_id.substring(1);\n  }\n  return `|${hardware_id}|${status.name}|`;\n}\n\nexport function getDisplayName(hardwareId: string, name: string) {\n  if (name.indexOf(hardwareId) === 0) {\n    return name;\n  }\n  return `${hardwareId}: ${name}`;\n}\n\n// ensures the diagnostic status message's name consists of both the hardware id and the name\nexport function computeDiagnosticInfo(status: DiagnosticStatusMessage, stamp: Time): DiagnosticInfo {\n  const displayName = getDisplayName(status.hardware_id, status.name);\n  if (status.values && status.values.some(({ value }) => value.length > MAX_STRING_LENGTH)) {\n    status = {\n      ...status,\n      values: status.values\n        ? status.values.map((kv) =>\n            kv.value.length > MAX_STRING_LENGTH\n              ? { key: kv.key, value: truncate(kv.value, { length: MAX_STRING_LENGTH }) }\n              : kv\n          )\n        : undefined,\n    };\n  }\n\n  return {\n    status,\n    stamp,\n    id: getDiagnosticId(status),\n    displayName,\n  };\n}\n\nexport function getNodesByLevel(buffer: DiagnosticsBuffer, hardwareIdFilter: string, level: any): DiagnosticInfo[] {\n  if (!hardwareIdFilter) {\n    return Array.from(buffer.diagnosticsByLevel[level].values());\n  }\n  const nodeArray = [];\n  buffer.diagnosticsByLevel[level].forEach((value) => {\n    if (value.displayName.startsWith(hardwareIdFilter)) {\n      nodeArray.push(value);\n    }\n  });\n  return nodeArray;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { compact, uniq } from \"lodash\";\nimport React, { useEffect, useCallback, useRef } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport helpContent from \"./index.help.md\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport MessageHistoryDEPRECATED, { type MessageHistoryData } from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport type { BasePlotPath, PlotPath } from \"webviz-core/src/panels/Plot/internalTypes\";\nimport PlotChart, { getDatasetsAndTooltips } from \"webviz-core/src/panels/Plot/PlotChart\";\nimport PlotLegend from \"webviz-core/src/panels/Plot/PlotLegend\";\nimport PlotMenu from \"webviz-core/src/panels/Plot/PlotMenu\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\n\nexport const plotableRosTypes = [\n  \"bool\",\n  \"int8\",\n  \"uint8\",\n  \"int16\",\n  \"uint16\",\n  \"int32\",\n  \"uint32\",\n  \"int64\",\n  \"uint64\",\n  \"float32\",\n  \"float64\",\n  \"time\",\n  \"duration\",\n  \"string\",\n];\n\nexport type PlotConfig = {\n  paths: PlotPath[],\n  minYValue: string,\n  maxYValue: string,\n  showLegend: boolean,\n  xAxisVal: \"timestamp\" | \"index\" | \"custom\",\n  xAxisPath?: BasePlotPath,\n};\n\nexport function openSiblingPlotPanel(\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n  topicName: string\n) {\n  openSiblingPanel(\n    \"Plot\",\n    (config: PlotConfig) =>\n      ({\n        ...config,\n        paths: uniq(\n          config.paths\n            .concat([{ value: topicName, enabled: true, timestampMethod: \"receiveTime\" }])\n            .filter(({ value }) => value)\n        ),\n      }: PlotConfig)\n  );\n}\n\ntype Props = {\n  config: PlotConfig,\n  saveConfig: ($Shape<PlotConfig>) => void,\n};\n\nfunction Plot(props: Props) {\n  const { saveConfig, config } = props;\n  const { paths, minYValue, maxYValue, showLegend, xAxisVal, xAxisPath } = config;\n  // Note that the below values are refs since they are only used in callbacks and are not rendered anywhere.\n  const currentMinY = useRef(null);\n  const currentMaxY = useRef(null);\n\n  const saveCurrentYs = useCallback((minY: number, maxY: number) => {\n    currentMinY.current = minY;\n    currentMaxY.current = maxY;\n  }, []);\n\n  const setMinMax = useCallback(\n    () =>\n      saveConfig({\n        minYValue: currentMinY.current != null ? currentMinY.current.toString() : \"\",\n        maxYValue: currentMaxY.current != null ? currentMaxY.current.toString() : \"\",\n      }),\n    [currentMaxY, currentMinY, saveConfig]\n  );\n\n  useEffect(() => {\n    if (!paths.length) {\n      saveConfig({ paths: [{ value: \"\", enabled: true, timestampMethod: \"receiveTime\" }] });\n    }\n  });\n\n  let historySize: ?number;\n  if (xAxisVal === \"index\") {\n    historySize = 1;\n  }\n\n  const allPaths = paths.map(({ value }) => value).concat(compact([xAxisPath?.value]));\n\n  return (\n    <Flex col clip center style={{ position: \"relative\" }}>\n      {/* Don't filter out disabled paths when passing into <MessageHistoryDEPRECATED>, because we still want\n          easy access to the history when turning the disabled paths back on. */}\n      <MessageHistoryDEPRECATED paths={allPaths} {...(historySize ? { historySize } : null)}>\n        {({ itemsByPath, startTime }: MessageHistoryData) => {\n          const { datasets, tooltips } = getDatasetsAndTooltips(paths, itemsByPath, startTime, xAxisVal, xAxisPath);\n          return (\n            <>\n              <PanelToolbar\n                helpContent={helpContent}\n                floating\n                menuContent={\n                  <PlotMenu\n                    minYValue={minYValue}\n                    maxYValue={maxYValue}\n                    saveConfig={saveConfig}\n                    setMinMax={setMinMax}\n                    datasets={datasets}\n                    xAxisVal={xAxisVal}\n                    tooltips={tooltips}\n                  />\n                }\n              />\n              <PlotChart\n                paths={paths}\n                minYValue={parseFloat(minYValue)}\n                maxYValue={parseFloat(maxYValue)}\n                saveCurrentYs={saveCurrentYs}\n                datasets={datasets}\n                tooltips={tooltips}\n                xAxisVal={xAxisVal}\n              />\n            </>\n          );\n        }}\n      </MessageHistoryDEPRECATED>\n      <PlotLegend\n        paths={paths}\n        saveConfig={saveConfig}\n        showLegend={showLegend}\n        xAxisVal={xAxisVal}\n        xAxisPath={xAxisPath}\n      />\n    </Flex>\n  );\n}\nPlot.panelType = \"Plot\";\nPlot.defaultConfig = {\n  paths: [{ value: \"\", enabled: true, timestampMethod: \"receiveTime\" }],\n  minYValue: \"\",\n  maxYValue: \"\",\n  showLegend: true,\n  xAxisVal: \"timestamp\",\n};\n\nexport default hot(Panel<PlotConfig>(Plot));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport MenuDownIcon from \"@mdi/svg/svg/menu-down.svg\";\nimport cx from \"classnames\";\nimport { flatten, partition } from \"lodash\";\nimport * as React from \"react\";\n\nimport type { RosPath, RosPrimitive } from \"./constants\";\nimport styles from \"./MessagePathInput.module.scss\";\nimport {\n  type StructureTraversalResult,\n  traverseStructure,\n  messagePathStructures,\n  messagePathsForDatatype,\n  validTerminatingStructureItem,\n} from \"./messagePathsForDatatype\";\nimport parseRosPath from \"./parseRosPath\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport useGlobalVariables, { type GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { getTopicNames, topicsByTopicName } from \"webviz-core/src/util/selectors\";\nimport type { TimestampMethod } from \"webviz-core/src/util/time\";\n\n// To show an input field with an autocomplete so the user can enter message paths, use:\n//\n//  <MessagePathInput path={this.state.path} onChange={path => this.setState({ path })} />\n//\n// To limit the autocomplete items to only certain types of values, you can use\n//\n//  <MessagePathInput types={[\"message\", \"array\", \"primitives\"]} />\n//\n// Or use actual ROS primitive types:\n//\n//  <MessagePathInput types={[\"uint16\", \"float64\"]} />\n//\n// If you don't use timestamps, you might want to hide the warning icon that we show when selecting\n// a topic that has no header: `<MessagePathInput hideTimestampWarning>`.\n//\n// If you are rendering many input fields, you might want to use `<MessagePathInput index={5}>`,\n// which gets passed down to `<MessagePathInput onChange>` as the second parameter, so you can\n// avoid creating anonymous functions on every render (which will prevent the component from\n// rendering unnecessarily).\n\nfunction topicHasNoHeaderStamp(topic: Topic, datatypes: RosDatatypes): boolean {\n  const structureTraversalResult = traverseStructure(messagePathStructures(datatypes)[topic.datatype], [\n    { type: \"name\", name: \"header\" },\n    { type: \"name\", name: \"stamp\" },\n  ]);\n\n  return (\n    !structureTraversalResult.valid || !validTerminatingStructureItem(structureTraversalResult.structureItem, [\"time\"])\n  );\n}\n\nfunction getFirstInvalidVariableFromRosPath(\n  rosPath: RosPath,\n  globalVariables: GlobalVariables\n): ?{| variableName: string, loc: number |} {\n  const { messagePath } = rosPath;\n  return messagePath\n    .map((path) => {\n      const globalVars = Object.keys(globalVariables);\n      if (path.type === \"filter\" && typeof path.value === \"object\" && !globalVars.includes(path.value.variableName)) {\n        return { variableName: path.value.variableName, loc: path.valueLoc };\n      }\n\n      if (path.type === \"slice\" && typeof path.start === \"object\" && !globalVars.includes(path.start.variableName)) {\n        return { variableName: path.start.variableName, loc: path.start.startLoc };\n      }\n\n      if (path.type === \"slice\" && typeof path.end === \"object\" && !globalVars.includes(path.end.variableName)) {\n        return { variableName: path.end.variableName, loc: path.end.startLoc };\n      }\n      return undefined;\n    })\n    .find(Boolean);\n}\n\nfunction getExamplePrimitive(primitiveType: RosPrimitive) {\n  switch (primitiveType) {\n    case \"string\":\n      return '\"\"';\n    case \"bool\":\n      return \"true\";\n    case \"float32\":\n    case \"float64\":\n    case \"uint8\":\n    case \"uint16\":\n    case \"uint32\":\n    case \"uint64\":\n    case \"int8\":\n    case \"int16\":\n    case \"int32\":\n    case \"int64\":\n      return \"0\";\n    case \"duration\":\n    case \"time\":\n      return \"\";\n    default:\n      (primitiveType: empty);\n      return \"\";\n  }\n}\n\ntype MessagePathInputBaseProps = {\n  path: string, // A path of the form `/topic.some_field[:]{id==42}.x`\n  index?: number, // Optional index field which gets passed to `onChange` (so you don't have to create anonymous functions)\n  onChange: (value: string, index: ?number) => void,\n  validTypes?: string[], // Valid types, like \"message\", \"array\", or \"primitive\", or a ROS primitive like \"float64\"\n  noMultiSlices?: boolean, // Don't suggest slices with multiple values `[:]`, only single values like `[0]`.\n  autoSize?: boolean,\n  placeholder?: string,\n  inputStyle?: any,\n  disableAutocomplete?: boolean, // Treat this as a normal input, with no autocomplete.\n\n  timestampMethod?: TimestampMethod,\n  onTimestampMethodChange?: (TimestampMethod, index: ?number) => void,\n};\ntype MessagePathInputProps = MessagePathInputBaseProps & {\n  topics: $ReadOnlyArray<Topic>,\n  datatypes: RosDatatypes,\n  prioritizedDatatype?: ?string,\n  globalVariables: GlobalVariables,\n};\ntype MessagePathInputState = {| focused: boolean |};\nclass MessagePathInputUnconnected extends React.PureComponent<MessagePathInputProps, MessagePathInputState> {\n  _input: ?HTMLInputElement;\n\n  constructor(props: MessagePathInputProps) {\n    super(props);\n    this.state = { focused: false };\n  }\n\n  _onChange = (event: SyntheticInputEvent<HTMLInputElement>, value: string) => {\n    // When typing a \"{\" character, also  insert a \"}\", so you get an\n    // autocomplete window immediately for selecting a filter name.\n    // $FlowFixMe\n    if (event.nativeEvent.data === \"{\") {\n      const newCursorPosition = event.target.selectionEnd;\n      value = `${value.slice(0, newCursorPosition)}}${value.slice(newCursorPosition)}`;\n\n      const target = event.target;\n      setImmediate(() => target.setSelectionRange(newCursorPosition, newCursorPosition));\n    }\n    this.props.onChange(value, this.props.index);\n  };\n\n  _onTimestampMethodChange = (value: TimestampMethod) => {\n    if (this.props.onTimestampMethodChange) {\n      this.props.onTimestampMethodChange(value, this.props.index);\n    }\n  };\n\n  _onSelect = (\n    value: string,\n    autocomplete: Autocomplete,\n    autocompleteType: ?(\"topicName\" | \"messagePath\" | \"globalVariables\"),\n    autocompleteRange: {| start: number, end: number |}\n  ) => {\n    // If we're dealing with a topic name, and we cannot validly end in a message type,\n    // add a \".\" so the user can keep typing to autocomplete the message path.\n    const keepGoingAfterTopicName =\n      autocompleteType === \"topicName\" && this.props.validTypes && !this.props.validTypes.includes(\"message\");\n    if (keepGoingAfterTopicName) {\n      value += \".\";\n    }\n    this.props.onChange(\n      this.props.path.substr(0, autocompleteRange.start) + value + this.props.path.substr(autocompleteRange.end),\n      this.props.index\n    );\n    // We want to continue typing if we're dealing with a topic name,\n    // or if we just autocompleted something with a filter (because we might want to\n    // edit that filter), or if the autocomplete already has a filter (because we might\n    // have just autocompleted a name inside that filter).\n    if (keepGoingAfterTopicName || value.includes(\"{\") || this.props.path.includes(\"{\")) {\n      const newCursorPosition = autocompleteRange.start + value.length;\n      setImmediate(() => autocomplete.setSelectionRange(newCursorPosition, newCursorPosition));\n    } else {\n      autocomplete.blur();\n    }\n  };\n\n  render() {\n    const {\n      path,\n      topics,\n      datatypes,\n      prioritizedDatatype,\n      validTypes,\n      autoSize,\n      placeholder,\n      noMultiSlices,\n      timestampMethod,\n      inputStyle,\n      disableAutocomplete,\n      globalVariables,\n    } = this.props;\n\n    const rosPath = parseRosPath(path);\n    let autocompleteType: ?(\"topicName\" | \"messagePath\" | \"globalVariables\");\n    let topic: ?Topic;\n    let structureTraversalResult: ?StructureTraversalResult;\n    if (rosPath) {\n      const { topicName } = rosPath;\n      topic = topics.find(({ name }) => name === topicName);\n\n      if (topic) {\n        structureTraversalResult = traverseStructure(\n          messagePathStructures(datatypes)[topic.datatype],\n          rosPath.messagePath\n        );\n      }\n\n      if (!topic) {\n        autocompleteType = \"topicName\";\n      } else if (\n        !structureTraversalResult ||\n        !structureTraversalResult.valid ||\n        !validTerminatingStructureItem(structureTraversalResult.structureItem, validTypes)\n      ) {\n        autocompleteType = \"messagePath\";\n      }\n    } else {\n      autocompleteType = \"topicName\";\n    }\n\n    let autocompleteItems = [];\n    let autocompleteFilterText = \"\";\n    let autocompleteRange = { start: 0, end: Infinity };\n    if (disableAutocomplete) {\n      autocompleteItems = [];\n    } else if (autocompleteType === \"topicName\") {\n      autocompleteItems = getTopicNames(topics);\n      autocompleteFilterText = path;\n    } else if (autocompleteType === \"messagePath\" && topic /*:: && rosPath */) {\n      if (\n        structureTraversalResult &&\n        !structureTraversalResult.valid &&\n        structureTraversalResult.msgPathPart &&\n        structureTraversalResult.msgPathPart.type === \"filter\" &&\n        structureTraversalResult.structureItem &&\n        structureTraversalResult.structureItem.structureType === \"message\"\n      ) {\n        const { msgPathPart } = structureTraversalResult;\n\n        // Provide filter suggestions for primitive values, since they're the only kinds of values\n        // that can be filtered on.\n        // TODO: add support for nested paths to primitives, such as \"/some_topic{foo.bar==3}\".\n        for (const name of Object.keys(structureTraversalResult.structureItem.nextByName)) {\n          const item = structureTraversalResult.structureItem.nextByName[name];\n          if (item.structureType === \"primitive\") {\n            autocompleteItems.push(`${name}==${getExamplePrimitive(item.primitiveType)}`);\n          }\n        }\n\n        autocompleteFilterText = msgPathPart.path.join(\".\");\n        autocompleteRange = {\n          start: msgPathPart.nameLoc,\n          end: msgPathPart.nameLoc + autocompleteFilterText.length,\n        };\n      } else {\n        autocompleteItems = messagePathsForDatatype(topic.datatype, datatypes, validTypes, noMultiSlices).filter(\n          // .header.seq is pretty useless but shows up everryyywhere.\n          (msgPath) => msgPath !== \"\" && !msgPath.endsWith(\".header.seq\")\n        );\n\n        // Exclude any initial filters (\"/topic{foo=='bar'}\") from the range that will be replaced\n        // when the user chooses a new message path.\n        let initialFilterLength = 0;\n        for (const item of rosPath.messagePath) {\n          if (item.type === \"filter\") {\n            initialFilterLength += item.repr.length + 2; // add { and }\n          } else {\n            break;\n          }\n        }\n\n        autocompleteRange = { start: topic.name.length + initialFilterLength, end: Infinity };\n        // Filter out filters (hah!) in a pretty crude way, so autocomplete still works\n        // when already having specified a filter and you want to see what other object\n        // names you can complete it with. Kind of an edge case, and this doesn't work\n        // ideally (because it will remove your existing filter if you actually select\n        // the autocomplete item), but it's easy to do for now, and nice to have.\n        autocompleteFilterText = path.substr(topic.name.length).replace(/\\{[^}]*\\}/g, \"\");\n      }\n    } else if (rosPath) {\n      const invalidGlobalVariablesVariable = getFirstInvalidVariableFromRosPath(rosPath, globalVariables);\n\n      if (invalidGlobalVariablesVariable) {\n        autocompleteType = \"globalVariables\";\n        autocompleteItems = Object.keys(globalVariables).map((key) => `$${key}`);\n        autocompleteRange = {\n          start: invalidGlobalVariablesVariable.loc,\n          end: invalidGlobalVariablesVariable.loc + invalidGlobalVariablesVariable.variableName.length + 1,\n        };\n        autocompleteFilterText = invalidGlobalVariablesVariable.variableName;\n      }\n    }\n\n    const noHeaderStamp = topic && topicHasNoHeaderStamp(topic, datatypes);\n    const orderedAutocompleteItems = prioritizedDatatype\n      ? flatten(\n          partition(autocompleteItems, (item) => topicsByTopicName(topics)[item]?.datatype === prioritizedDatatype)\n        )\n      : autocompleteItems;\n\n    return (\n      <div style={{ display: \"flex\", flex: \"1 1 auto\", minWidth: 0, justifyContent: \"space-between\" }}>\n        <Autocomplete\n          items={orderedAutocompleteItems}\n          filterText={autocompleteFilterText}\n          value={path}\n          onChange={this._onChange}\n          onSelect={(value: string, item: any, autocomplete: Autocomplete) =>\n            this._onSelect(value, autocomplete, autocompleteType, autocompleteRange)\n          }\n          hasError={!!autocompleteType && !disableAutocomplete}\n          autocompleteKey={autocompleteType}\n          placeholder={placeholder || \"/some/topic.msgs[0].field\"}\n          autoSize={autoSize}\n          inputStyle={inputStyle}\n          // Disable autoselect since people often construct complex queries, and it's very annoying\n          // to have the entire input selected whenever you want to make a change to a part it.\n          disableAutoSelect\n        />\n\n        {timestampMethod && (\n          <div className={styles.timestampMethodDropdownContainer}>\n            <Dropdown\n              onChange={this._onTimestampMethodChange}\n              value={timestampMethod}\n              toggleComponent={\n                <Tooltip contents=\"Timestamp used for x-axis\" placement=\"top\">\n                  <div\n                    className={cx({\n                      [styles.timestampMethodDropdown]: true,\n                      [styles.timestampMethodDropdownError]: timestampMethod === \"headerStamp\" && noHeaderStamp,\n                    })}>\n                    {timestampMethod === \"receiveTime\" ? \"(receive time)\" : \"(header.stamp)\"}\n                    <Icon style={{ position: \"relative\", top: 2, marginLeft: 2 }}>\n                      <MenuDownIcon />\n                    </Icon>\n                  </div>\n                </Tooltip>\n              }>\n              {/* $FlowFixMe - \"value\" is needed for <Dropdown>, but it's not part of <Tooltip>. */}\n              <Tooltip\n                value=\"receiveTime\"\n                placement=\"right\"\n                contents=\"ROS-time at which the message was received and recorded\">\n                <span>receive time</span>\n              </Tooltip>\n              {/* $FlowFixMe - \"value\" is needed for <Dropdown>, but it's not part of <Tooltip>. */}\n              <Tooltip\n                value=\"headerStamp\"\n                placement=\"below\"\n                contents={\n                  <div style={{ maxWidth: 200, lineHeight: \"normal\" }}>\n                    Value of the header.stamp field. Can mean different things for different topics. Be sure you know\n                    what this value means before using it.\n                    {noHeaderStamp && (\n                      <div className={styles.timestampItemError}>(header.stamp is not present in this topic)</div>\n                    )}\n                  </div>\n                }>\n                <span\n                  className={cx({\n                    [styles.timestampItemError]: noHeaderStamp,\n                  })}>\n                  header.stamp\n                </span>\n              </Tooltip>\n            </Dropdown>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default React.memo<MessagePathInputBaseProps>(function MessagePathInput(props: MessagePathInputBaseProps) {\n  const { globalVariables } = useGlobalVariables();\n  const { datatypes, topics } = PanelAPI.useDataSourceInfo();\n  return (\n    <MessagePathInputUnconnected {...props} topics={topics} datatypes={datatypes} globalVariables={globalVariables} />\n  );\n});\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { validationErrorToString, type ValidationResult } from \"webviz-core/src/components/validators\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport YAML from \"webviz-core/src/util/yaml\";\n\nconst { useState, useCallback, useRef, useLayoutEffect, useEffect } = React;\n\nexport const EDIT_FORMAT = { JSON: \"json\", YAML: \"yaml\" };\n\nconst SEditBox = styled.div`\n  display: flex;\n  flex-direction: column;\n  min-height: 200px;\n  max-height: 800px;\n`;\n// TODO(Audrey): work with design to update Dropdown UI\nconst STransparentDropdownButton = styled.div`\n  padding-top: 6px;\n  display: inline-flex;\n  button {\n    background: transparent;\n    display: inline-flex;\n  }\n`;\nconst StyledTextarea = styled.textarea`\n  flex: 1 1 auto;\n  resize: none;\n`;\nconst SError = styled.div`\n  color: ${colors.red};\n  padding: 8px 4px;\n`;\n\ntype Value = any;\ntype OnChange = (obj: any) => void;\ntype ParseAndStringifyFn = {\n  stringify: (obj: any) => string,\n  parse: (val: string) => any,\n};\nexport type EditFormat = $Values<typeof EDIT_FORMAT>;\nexport type BaseProps = {\n  dataValidator?: (data: any) => ?ValidationResult,\n  inputStyle?: { [attr: string]: string | number },\n  onChange?: OnChange,\n  onError?: (err: string) => void,\n  value: Value,\n};\ntype Props = BaseProps & {\n  format: EditFormat,\n  children?: React.Node, // addition UI next to the format select\n  onSelectFormat?: (format: EditFormat) => void,\n};\n\n/**\n * The base component for ValidatedInput which handles the value change, data validation\n * and data stringifying/parsing. Any external value change will cause the input string to change\n * and trigger new validations. Only valid internal value change will call onChange. Any data processing\n * and validation error will trigger onError.\n */\nexport function ValidatedInputBase({\n  dataValidator = (data) => {},\n  inputStyle = {},\n  onChange,\n  onError,\n  parse,\n  stringify,\n  value,\n}: BaseProps & ParseAndStringifyFn) {\n  const [error, setError] = useState<string>(\"\");\n  const [inputStr, setInputStr] = useState<string>(\"\");\n  const prevIncomingVal = useRef(\"\");\n  const inputRef = useRef<?HTMLTextAreaElement>(null);\n  const [isEditing, setIsEditing] = useState<boolean>(false);\n\n  // validate the input string, and setError or call onChange if needed\n  const memorizedInputValidation = useCallback(\n    (newInputVal: string, onChangeFcn?: OnChange) => {\n      let newVal;\n      let newError;\n      // parse the empty string directly as empty array or object for validation and onChange callback\n      if (newInputVal.trim() === \"\") {\n        newVal = Array.isArray(value) ? [] : {};\n      } else {\n        try {\n          newVal = parse(newInputVal);\n        } catch (e) {\n          newError = e.message;\n        }\n      }\n\n      if (newError) {\n        setError(newError);\n        return;\n      }\n      setError(\"\"); // clear the previous error\n      const validationResult = dataValidator(newVal);\n      if (validationResult) {\n        setError(validationErrorToString(validationResult));\n        return;\n      }\n      if (onChangeFcn) {\n        onChangeFcn(newVal);\n      }\n    },\n    [dataValidator, parse, value]\n  );\n\n  // when not in editing mode, whenever the incoming value changes, we'll compare the new value with prevIncomingVal, and reset local state values if they are different\n  useLayoutEffect(\n    () => {\n      if (!isEditing && value !== prevIncomingVal.current) {\n        if (isEqual(value, prevIncomingVal.current)) {\n          return;\n        }\n        let newVal = \"\";\n        let newError;\n        try {\n          newVal = stringify(value);\n        } catch (e) {\n          newError = `Error stringifying the new value, using \"\" as default. ${e.message}`;\n        }\n        setInputStr(newVal);\n        prevIncomingVal.current = value;\n        if (newError) {\n          setError(newError);\n          return;\n        }\n        // try to validate if successfully stringified the new value\n        memorizedInputValidation(newVal);\n      }\n    },\n    [value, stringify, memorizedInputValidation, isEditing]\n  );\n\n  const handleChange = useCallback(\n    (e) => {\n      const val = e.currentTarget && e.currentTarget.value;\n      if (!isEditing) {\n        setIsEditing(true);\n      }\n      setInputStr(val);\n      memorizedInputValidation(val, onChange);\n    },\n    [isEditing, memorizedInputValidation, onChange]\n  );\n\n  useEffect(\n    () => {\n      if (onError && error) {\n        onError(error);\n      }\n    },\n    [error, onError]\n  );\n\n  // scroll to the bottom when the text gets too long\n  useLayoutEffect(\n    () => {\n      if (!isEditing) {\n        const inputElem = inputRef.current;\n        if (inputElem) {\n          inputElem.scrollTop = inputElem.scrollHeight;\n        }\n      }\n    },\n    [isEditing, inputStr] // update whenever inputStr changes\n  );\n\n  return (\n    <>\n      <StyledTextarea\n        data-test=\"validated-input\"\n        style={inputStyle}\n        ref={inputRef}\n        value={inputStr}\n        onChange={handleChange}\n      />\n      {error && <SError>{error}</SError>}\n    </>\n  );\n}\n\nfunction JsonInput(props: BaseProps) {\n  function stringify(val) {\n    return JSON.stringify(val, null, 2);\n  }\n  return <ValidatedInputBase parse={JSON.parse} stringify={stringify} {...props} />;\n}\n\nexport function YamlInput(props: BaseProps) {\n  return <ValidatedInputBase parse={YAML.parse} stringify={YAML.stringify} {...props} />;\n}\n\n// An enhanced input component that allows editing values in json or yaml format with custom validations\nexport default function ValidatedInput({ format = EDIT_FORMAT.JSON, onSelectFormat, children, ...rest }: Props) {\n  const InputComponent = format === EDIT_FORMAT.JSON ? JsonInput : YamlInput;\n  return (\n    <Flex col>\n      <Flex row reverse>\n        {children}\n        <STransparentDropdownButton>\n          <Dropdown position=\"right\" value={format} text={format.toUpperCase()} onChange={onSelectFormat}>\n            {Object.keys(EDIT_FORMAT).map((key) => (\n              <option value={EDIT_FORMAT[key]} key={key}>\n                {key}\n              </option>\n            ))}\n          </Dropdown>\n        </STransparentDropdownButton>\n      </Flex>\n      <SEditBox>\n        <InputComponent {...rest} />\n      </SEditBox>\n    </Flex>\n  );\n}\n\n// For component consumers that don't care about maintaining the editFormat state, use this instead\nexport function UncontrolledValidatedInput({ format = EDIT_FORMAT.YAML, ...rest }: Props) {\n  const [editFormat, setEditFormat] = React.useState<EditFormat>(format);\n  return <ValidatedInput {...rest} format={editFormat} onSelectFormat={(newFormat) => setEditFormat(newFormat)} />;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport { useCallback, useMemo, useRef } from \"react\";\n\nimport { type MessagePathFilter } from \"./constants\";\nimport { messagePathStructures } from \"./messagePathsForDatatype\";\nimport type { MessagePathStructureItem, RosPath } from \"webviz-core/src/components/MessagePathSyntax/constants\";\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport parseRosPath from \"webviz-core/src/components/MessagePathSyntax/parseRosPath\";\nimport useGlobalVariables, { type GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message, Topic } from \"webviz-core/src/players/types\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport { useChangeDetector, useDeepMemo, useShallowMemo } from \"webviz-core/src/util/hooks\";\nimport { enumValuesByDatatypeAndField, topicsByTopicName } from \"webviz-core/src/util/selectors\";\n\nexport type MessagePathDataItem = {|\n  value: mixed, // The actual value.\n  // TODO(JP): Maybe this should just be a simple path without nice ids, and then have a separate function\n  // to generate \"nice ids\". Because they might not always be reliable and we might want to use different\n  // kinds of \"nice ids\" for different purposes, e.g. `[10]{id==5}{other_id=123}` for tooltips (more information)\n  // but `[:]{other_id==123}` for line graphs (more likely to match values).\n  path: string, // The path to get to this value. Tries to use \"nice ids\" like `[:]{some_id==123}` wherever possible.\n  constantName?: ?string, // The name of the constant that the value matches up with, if any.\n|};\n\n// Given a set of message paths, this returns a function that you can call to resolve a single path\n// and message to an array of `MessagePathDataItem` objects. The array+objects will be the same by\n// reference, as long as topics/datatypes/global variables haven't changed in the meantime.\nexport function useCachedGetMessagePathDataItems(\n  paths: string[]\n): (path: string, message: Message) => ?(MessagePathDataItem[]) {\n  const { topics: providerTopics, datatypes } = PanelAPI.useDataSourceInfo();\n  const { globalVariables } = useGlobalVariables();\n  const memoizedPaths: string[] = useShallowMemo<string[]>(paths);\n\n  // We first fill in global variables in the paths, so we can later see which paths have really\n  // changed when the global variables have changed.\n  const unmemoizedFilledInPaths: { [string]: RosPath } = useMemo(\n    () => {\n      const filledInPaths = {};\n      for (const path of memoizedPaths) {\n        const rosPath = parseRosPath(path);\n        if (rosPath) {\n          filledInPaths[path] = fillInGlobalVariablesInPath(rosPath, globalVariables);\n        }\n      }\n      return filledInPaths;\n    },\n    [globalVariables, memoizedPaths]\n  );\n  const memoizedFilledInPaths = useDeepMemo<{ [string]: RosPath }>(unmemoizedFilledInPaths);\n\n  // Cache MessagePathDataItem arrays by Message. We need to clear out this cache whenever\n  // the topics or datatypes change, since that's what getMessagePathDataItems\n  // depends on, outside of the message+path.\n  const cachesByPath = useRef<{\n    [string]: {| filledInPath: RosPath, weakMap: WeakMap<Message, ?(MessagePathDataItem[])> |},\n  }>({});\n  if (useChangeDetector([providerTopics, datatypes], true)) {\n    cachesByPath.current = {};\n  }\n  // When the filled in paths changed, then that means that either the path string changed, or a\n  // relevant global variable changed. Delete the caches for where the `filledInPath` doesn't match\n  // any more.\n  if (useChangeDetector([memoizedFilledInPaths], false)) {\n    for (const path of Object.keys(cachesByPath.current)) {\n      const filledInPath = memoizedFilledInPaths[path];\n      if (!filledInPath || !isEqual(cachesByPath.current[path].filledInPath, filledInPath)) {\n        delete cachesByPath.current[path];\n      }\n    }\n  }\n\n  return useCallback(\n    (path: string, message: Message): ?(MessagePathDataItem[]) => {\n      if (!memoizedPaths.includes(path)) {\n        throw new Error(`path (${path}) was not in the list of cached paths`);\n      }\n      const filledInPath = memoizedFilledInPaths[path];\n      if (!filledInPath) {\n        return;\n      }\n      if (!cachesByPath.current[path]) {\n        cachesByPath.current[path] = { filledInPath, weakMap: new WeakMap() };\n      }\n      const { weakMap } = cachesByPath.current[path];\n      if (!weakMap.has(message)) {\n        const messagePathDataItems = getMessagePathDataItems(message, filledInPath, providerTopics, datatypes);\n        weakMap.set(message, messagePathDataItems);\n        return messagePathDataItems;\n      }\n      const messagePathDataItems = weakMap.get(message);\n      return messagePathDataItems;\n    },\n    [datatypes, memoizedFilledInPaths, memoizedPaths, providerTopics]\n  );\n}\n\nfunction filterMatches(filter: MessagePathFilter, value: any) {\n  if (typeof filter.value === \"object\") {\n    throw new Error(\"filterMatches only works on paths where global variables have been filled in\");\n  }\n\n  let currentValue = value;\n  for (const name of filter.path) {\n    currentValue = currentValue[name];\n    if (currentValue == null) {\n      return false;\n    }\n  }\n\n  // Test equality using `==` so we can be forgiving for comparing booleans with integers,\n  // comparing numbers with strings, and so on.\n  // eslint-disable-next-line eqeqeq\n  return currentValue == filter.value;\n}\n\nexport function fillInGlobalVariablesInPath(rosPath: RosPath, globalVariables: GlobalVariables): RosPath {\n  return {\n    ...rosPath,\n    messagePath: rosPath.messagePath.map((messagePathPart) => {\n      if (messagePathPart.type === \"slice\") {\n        const start =\n          typeof messagePathPart.start === \"object\"\n            ? Number(globalVariables[messagePathPart.start.variableName])\n            : messagePathPart.start;\n        const end =\n          typeof messagePathPart.end === \"object\"\n            ? Number(globalVariables[messagePathPart.end.variableName])\n            : messagePathPart.end;\n\n        return {\n          ...messagePathPart,\n          start: isNaN(start) ? 0 : start,\n          end: isNaN(end) ? Infinity : end,\n        };\n      } else if (messagePathPart.type === \"filter\" && typeof messagePathPart.value === \"object\") {\n        let value;\n        const variable = globalVariables[messagePathPart.value.variableName];\n        if (typeof variable === \"number\" || typeof variable === \"string\") {\n          value = variable;\n        }\n        return { ...messagePathPart, value };\n      }\n\n      (messagePathPart.type: \"name\" | \"filter\");\n      return messagePathPart;\n    }),\n  };\n}\n\n// Get a new item that has `queriedData` set to the values and paths as queried by `rosPath`.\n// Exported just for tests.\nexport function getMessagePathDataItems(\n  message: Message,\n  filledInPath: RosPath,\n  providerTopics: $ReadOnlyArray<Topic>,\n  datatypes: RosDatatypes\n): ?(MessagePathDataItem[]) {\n  const structures = messagePathStructures(datatypes);\n  const topic = topicsByTopicName(providerTopics)[filledInPath.topicName];\n\n  // We don't care about messages that don't match the topic we're looking for.\n  if (!topic || message.topic !== filledInPath.topicName) {\n    return;\n  }\n\n  // Apply top-level filters first. If a message matches all top-level filters, then this function\n  // will *always* return a history item, so this is our only chance to return nothing.\n  for (const item of filledInPath.messagePath) {\n    if (item.type === \"filter\") {\n      if (!filterMatches(item, message.message)) {\n        return [];\n      }\n    } else {\n      break;\n    }\n  }\n\n  const queriedData = [];\n  // Traverse the message (via `value`) and the `messagePath` at the same time. Also keep track\n  // of a `path` string that we should show in the tooltip of the point.\n  function traverse(value: any, pathIndex: number, path: string, structureItem: MessagePathStructureItem) {\n    if (value === undefined || structureItem === undefined) {\n      return;\n    }\n    const pathItem = filledInPath.messagePath[pathIndex];\n    const nextPathItem = filledInPath.messagePath[pathIndex + 1];\n    if (!pathItem) {\n      // If we're at the end of the `messagePath`, we're done! Just store the point.\n      let constantName: ?string;\n      const prevPathItem = filledInPath.messagePath[pathIndex - 1];\n      if (prevPathItem && prevPathItem.type === \"name\") {\n        const fieldName = prevPathItem.name;\n        const enumMap = enumValuesByDatatypeAndField(datatypes)[structureItem.datatype];\n        if (enumMap && enumMap[fieldName]) {\n          constantName = enumMap[fieldName][value];\n        }\n      }\n      queriedData.push({ value, path, constantName });\n    } else if (pathItem.type === \"name\" && structureItem.structureType === \"message\") {\n      // If the `pathItem` is a name, we're traversing down using that name.\n      traverse(\n        value[pathItem.name],\n        pathIndex + 1,\n        `${path}.${pathItem.name}`,\n        structureItem.nextByName[pathItem.name]\n      );\n    } else if (pathItem.type === \"slice\" && structureItem.structureType === \"array\") {\n      const { start, end } = pathItem;\n      if (typeof start === \"object\" || typeof end === \"object\") {\n        throw new Error(\"getMessagePathDataItems  only works on paths where global variables have been filled in\");\n      }\n      const startIdx: number = start;\n      const endIdx: number = end;\n      if (isNaN(startIdx) || isNaN(endIdx)) {\n        return;\n      }\n\n      // If the `pathItem` is a slice, iterate over all the relevant elements in the array.\n      for (let i = startIdx; i <= Math.min(endIdx, value.length - 1); i++) {\n        const index = i >= 0 ? i : value.length + i;\n        if (value[index] === undefined) {\n          continue;\n        }\n        // Ideally show something like `/topic.object[:]{some_id=123}` for the path, but fall\n        // back to `/topic.object[10]` if necessary. In any case, make sure that the user can\n        // actually identify where the value came from.\n        let newPath;\n        if (nextPathItem && nextPathItem.type === \"filter\") {\n          // If we have a filter set after this, it will update the path appropriately.\n          newPath = `${path}[:]`;\n        } else {\n          // See if `value[index]` has a property that we typically filter on. If so, show that.\n          const name = Object.keys(value[index]).find((key) => isTypicalFilterName(key));\n          if (name) {\n            newPath = `${path}[:]{${name}==${value[index][name]}}`;\n          } else {\n            // Use `i` here instead of `index`, since it's only different when `i` is negative,\n            // and in that case it's probably more useful to show to the user how many elements\n            // from the end of the array this data is, since they clearly are thinking in that way\n            // (otherwise they wouldn't have chosen a negative slice).\n            newPath = `${path}[${i}]`;\n          }\n        }\n        traverse(value[index], pathIndex + 1, newPath, structureItem.next);\n      }\n    } else if (pathItem.type === \"filter\") {\n      if (filterMatches(pathItem, value)) {\n        traverse(value, pathIndex + 1, `${path}{${pathItem.repr}}`, structureItem);\n      }\n    } else {\n      console.warn(`Unknown pathItem.type ${pathItem.type} for structureType: ${structureItem.structureType}`);\n    }\n  }\n  traverse(message.message, 0, filledInPath.topicName, structures[topic.datatype]);\n  return queriedData;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { memoize } from \"lodash\";\nimport memoizeWeak from \"memoize-weak\";\n\nimport {\n  type MessagePathPart,\n  rosPrimitives,\n  type RosPrimitive,\n  type MessagePathStructureItem,\n  type MessagePathStructureItemMessage,\n} from \"./constants\";\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\n\n// Generate an easily navigable flat structure given some `datatypes`. We cache\n// this loosely as `datatypes` don't change after the player has connected.\n// The structure looks something like this:\n//\n// {\n//   \"/datatype/name\": {\n//     structureType: \"message\",\n//     nextByName: {\n//       \"some-sub-field\": {\n//         structureType: \"primitive\",\n//         primitiveType: \"uint8\",\n//       }\n//       \"some-boolean-array-sub-field\": {\n//         structureType: \"array\",\n//         next: {\n//           structureType: \"primitive\",\n//           primitiveType: \"bool\"\n//         }\n//       }\n//     }\n//   }\n// }\nlet lastDatatypes;\nlet lastStructures;\nexport function messagePathStructures(datatypes: RosDatatypes): { [string]: MessagePathStructureItemMessage } {\n  if (lastDatatypes !== datatypes) {\n    lastDatatypes = undefined;\n    const structureFor = memoize(\n      (datatype: string): MessagePathStructureItemMessage => {\n        const nextByName: { [string]: MessagePathStructureItem } = {};\n        const rosDatatype = datatypes[datatype];\n        if (!rosDatatype) {\n          throw new Error(`datatype not found: \"${datatype}\"`);\n        }\n        rosDatatype.fields.forEach((msgField) => {\n          if (msgField.isConstant) {\n            return;\n          }\n\n          const next = rosPrimitives.includes(msgField.type)\n            ? {\n                structureType: \"primitive\",\n                primitiveType: ((msgField.type: any): RosPrimitive), // Flow doesn't understand includes()\n                datatype,\n              }\n            : structureFor(msgField.type);\n\n          if (msgField.isArray) {\n            nextByName[msgField.name] = { structureType: \"array\", next, datatype };\n          } else {\n            nextByName[msgField.name] = next;\n          }\n        });\n        return { structureType: \"message\", nextByName, datatype };\n      }\n    );\n\n    lastStructures = {};\n    Object.keys(datatypes).forEach((datatype) => {\n      lastStructures[datatype] = structureFor(datatype);\n    });\n    lastDatatypes = datatypes; // Set at the very end, in case there's an error earlier.\n  }\n  return lastStructures;\n}\n\nexport function validTerminatingStructureItem(\n  structureItem: ?MessagePathStructureItem,\n  validTypes: ?(string[])\n): boolean {\n  return (\n    !!structureItem &&\n    (!validTypes ||\n      validTypes.includes(structureItem.structureType) ||\n      (structureItem.structureType === \"primitive\" && validTypes.includes(structureItem.primitiveType)))\n  );\n}\n\n// Given a datatype, the array of datatypes, and a list of valid types,\n// list out all valid strings for the `messagePath` part of the path (sorted).\nexport function messagePathsForDatatype(\n  datatype: string,\n  datatypes: RosDatatypes,\n  validTypes: ?(string[]),\n  noMultiSlices: ?boolean\n): string[] {\n  const messagePaths = [];\n  function traverse(structureItem: MessagePathStructureItem, builtString: string) {\n    if (validTerminatingStructureItem(structureItem, validTypes)) {\n      messagePaths.push(builtString);\n    }\n    if (structureItem.structureType === \"message\") {\n      for (const name of Object.keys(structureItem.nextByName)) {\n        traverse(structureItem.nextByName[name], `${builtString}.${name}`);\n      }\n    } else if (structureItem.structureType === \"array\") {\n      if (structureItem.next.structureType === \"message\") {\n        // When we have an array of messages, you probably want to filter on\n        // some field, like `/topic.object{some_id=123}`. If we can't find a\n        // typical filter name, fall back to `/topic.object[0]`.\n        const typicalFilterName = Object.keys(structureItem.next.nextByName).find((key) => isTypicalFilterName(key));\n        if (typicalFilterName) {\n          traverse(structureItem.next, `${builtString}[:]{${typicalFilterName}==0}`);\n        } else {\n          traverse(structureItem.next, `${builtString}[0]`);\n        }\n      } else if (!noMultiSlices) {\n        // When dealing with an array of primitives, you likely just want a\n        // scatter plot (if we can do multi-slices).\n        traverse(structureItem.next, `${builtString}[:]`);\n      } else {\n        traverse(structureItem.next, `${builtString}[0]`);\n      }\n    }\n  }\n  const structureItem = messagePathStructures(datatypes)[datatype];\n  if (!structureItem) {\n    throw new Error(`datatype not found \"${datatype}\"`);\n  }\n  traverse(structureItem, \"\");\n  return messagePaths.sort(naturalSort());\n}\n\nexport type StructureTraversalResult = {|\n  valid: boolean,\n  msgPathPart: ?MessagePathPart,\n  structureItem: ?MessagePathStructureItem,\n|};\n\n// Traverse down the structure given a `messagePath`. Return if the path\n// is valid, given the structure, `validTypes`, and `noMultiSlices`.\n//\n// We return the `msgPathPart` that was invalid to determine what sort\n// of autocomplete we should show.\n//\n// We use memoizeWeak because it works with multiple arguments (lodash's memoize\n// does not) and does not hold onto objects as strongly (it uses WeakMap).\nexport const traverseStructure = memoizeWeak(\n  (structureItem: ?MessagePathStructureItem, messagePath: MessagePathPart[]): StructureTraversalResult => {\n    if (!structureItem) {\n      return { valid: false, msgPathPart: undefined, structureItem: undefined };\n    }\n    for (const msgPathPart: MessagePathPart of messagePath) {\n      if (!structureItem) {\n        return { valid: false, msgPathPart, structureItem };\n      }\n      if (msgPathPart.type === \"name\") {\n        if (structureItem.structureType !== \"message\") {\n          return { valid: false, msgPathPart, structureItem };\n        }\n        structureItem = structureItem.nextByName[msgPathPart.name];\n      } else if (msgPathPart.type === \"slice\") {\n        if (structureItem.structureType !== \"array\") {\n          return { valid: false, msgPathPart, structureItem };\n        }\n        structureItem = structureItem.next;\n      } else if (msgPathPart.type === \"filter\") {\n        if (structureItem.structureType !== \"message\" || msgPathPart.path.length === 0 || msgPathPart.value == null) {\n          return { valid: false, msgPathPart, structureItem };\n        }\n        let currentItem = structureItem;\n        for (const name of msgPathPart.path) {\n          if (currentItem.structureType !== \"message\") {\n            return { valid: false, msgPathPart, structureItem };\n          }\n          currentItem = currentItem.nextByName[name];\n          if (currentItem == null) {\n            return { valid: false, msgPathPart, structureItem };\n          }\n        }\n      } else {\n        (msgPathPart.type: empty);\n        throw new Error(`Invalid msgPathPart.type: ${msgPathPart.type}`);\n      }\n    }\n    return { valid: true, msgPathPart: undefined, structureItem };\n  }\n);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { memoize } from \"lodash\";\nimport tinycolor from \"tinycolor2\";\n\nimport { toolsColorScheme } from \"webviz-core/src/util/toolsColorScheme\";\n\n// Inspired by the \"light\" scheme from https://personal.sron.nl/~pault/#sec:qualitative\n// but using our standard tools colors.\nexport const lineColors = [\n  toolsColorScheme.blue.medium,\n  toolsColorScheme.orange.medium,\n  toolsColorScheme.yellow.medium,\n  toolsColorScheme.purple.dark,\n  toolsColorScheme.cyan.medium,\n  toolsColorScheme.green.medium,\n  toolsColorScheme.paleGreen.medium,\n  \"#DDDDDD\",\n];\n\nexport const lightColor: (_: string) => string = memoize(\n  (color: string): string =>\n    tinycolor(color)\n      .brighten(15)\n      .toString()\n);\n\nexport const darkColor: (_: string) => string = memoize(\n  (color: string): string =>\n    tinycolor(color)\n      .darken(30)\n      .toString()\n);\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport styled from \"styled-components\";\n\nexport const PanelToolbarLabel = styled.label`\n  display: block;\n  padding-bottom: 5px;\n`;\n\nexport const PanelToolbarInput = styled.input`\n  width: 100%;\n  margin: 0;\n`;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { uniq } from \"lodash\";\nimport * as React from \"react\";\nimport Dimensions from \"react-container-dimensions\";\nimport { hot } from \"react-hot-loader/root\";\nimport stringHash from \"string-hash\";\nimport styled, { css } from \"styled-components\";\nimport tinycolor from \"tinycolor2\";\n\nimport helpContent from \"./index.help.md\";\nimport Button from \"webviz-core/src/components/Button\";\nimport MessageHistoryDEPRECATED, {\n  type MessageHistoryData,\n  type MessageHistoryItem,\n} from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TimeBasedChart, {\n  type TimeBasedChartTooltipData,\n  type DataPoint,\n} from \"webviz-core/src/components/TimeBasedChart\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport mixins from \"webviz-core/src/styles/mixins.module.scss\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { positiveModulo } from \"webviz-core/src/util\";\nimport { darkColor, lineColors } from \"webviz-core/src/util/plotColors\";\nimport type { TimestampMethod } from \"webviz-core/src/util/time\";\nimport { getTimestampForMessage, subtractTimes, toSec } from \"webviz-core/src/util/time\";\nimport { grey } from \"webviz-core/src/util/toolsColorScheme\";\n\nexport const transitionableRosTypes = [\n  \"bool\",\n  \"int8\",\n  \"uint8\",\n  \"int16\",\n  \"uint16\",\n  \"int32\",\n  \"uint32\",\n  \"int64\",\n  \"uint64\",\n  \"string\",\n];\n\nconst fontFamily = \"'Inter UI', -apple-system, sans-serif\";\nconst fontSize = 10;\nconst fontWeight = \"bold\";\n\nconst SRoot = styled.div`\n  display: flex;\n  flex-grow: 1;\n  z-index: 0; // create new stacking context\n  overflow: hidden;\n`;\n\nconst SAddButton = styled.div`\n  position: absolute;\n  top: 30px;\n  right: 5px;\n  opacity: ${(props) => (props.show ? 1 : 0)};\n  transition: opacity 0.1s ease-in-out;\n  z-index: 1;\n`;\n\nconst SChartContainerOuter = styled.div`\n  width: 100%;\n  flex-grow: 1;\n  overflow-x: hidden;\n  overflow-y: auto;\n`;\n\nconst SChartContainerInner = styled.div`\n  position: relative;\n  margin-top: 10px;\n`;\n\nconst inputColor = tinycolor(colors.toolbar)\n  .setAlpha(0.7)\n  .toHexString();\nconst inputColorBright = tinycolor(colors.toolbar)\n  .lighten(8)\n  .toHexString();\nconst inputLeft = 20;\nconst SInputContainer = styled.div`\n  display: flex;\n  position: absolute;\n  padding-left: ${inputLeft}px;\n  margin-top: -2px;\n  height: 20px;\n  padding-right: 4px;\n  max-width: calc(100% - ${inputLeft}px);\n  min-width: min(100%, 150px); // Don't let it get too small.\n  overflow: hidden;\n  line-height: 20px;\n\n  &:hover {\n    background: ${inputColor};\n  }\n\n  // Move over the first input on hover for the toolbar.\n  ${(props) =>\n    props.shrink &&\n    css`\n      max-width: calc(100% - 150px);\n    `}\n`;\n\nconst SInputDelete = styled.div`\n  display: none;\n  position: absolute;\n  left: ${inputLeft}px;\n  transform: translateX(-100%);\n  user-select: none;\n  height: 20px;\n  line-height: 20px;\n  padding: 0 6px;\n  background: ${inputColor};\n  cursor: pointer;\n\n  &:hover {\n    background ${inputColorBright};\n  }\n\n  ${SInputContainer}:hover & {\n    display: block;\n  }\n`;\n\nconst yAxes = [\n  {\n    ticks: {\n      fontFamily: mixins.monospaceFont,\n      fontSize: 10,\n      fontColor: \"#eee\",\n      maxRotation: 0,\n    },\n    type: \"category\",\n    offset: true,\n  },\n];\n\nconst plugins = {\n  datalabels: {\n    anchor: \"center\",\n    align: -45,\n    offset: 6,\n    clip: true,\n    font: {\n      family: fontFamily,\n      size: fontSize,\n      weight: fontWeight,\n    },\n  },\n  multicolorLineYOffset: 6,\n};\n\nconst scaleOptions = {\n  // Hide all y-axis ticks since each bar on the y-axis is just a separate path.\n  yAxisTicks: \"hide\",\n};\n\nexport type StateTransitionPath = { value: string, timestampMethod: TimestampMethod };\nexport type StateTransitionConfig = { paths: StateTransitionPath[] };\n\nexport function openSiblingStateTransitionsPanel(\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n  topicName: string\n) {\n  openSiblingPanel(\"StateTransitions\", (config: StateTransitionConfig) => {\n    return ({\n      ...config,\n      paths: uniq(config.paths.concat([{ value: topicName, enabled: true, timestampMethod: \"receiveTime\" }])),\n    }: StateTransitionConfig);\n  });\n}\n\ntype Props = {\n  config: StateTransitionConfig,\n  saveConfig: ($Shape<StateTransitionConfig>) => void,\n  isHovered: boolean,\n};\n\nclass StateTransitions extends React.PureComponent<Props> {\n  static panelType = \"StateTransitions\";\n  static defaultConfig = { paths: [] };\n\n  _onInputChange = (value: string, index: ?number) => {\n    if (index == null) {\n      throw new Error(\"index not set\");\n    }\n    const newPaths = this.props.config.paths.slice();\n    newPaths[index] = { ...newPaths[index], value: value.trim() };\n    this.props.saveConfig({ paths: newPaths });\n  };\n\n  _onInputTimestampMethodChange = (value: TimestampMethod, index: ?number) => {\n    if (index == null) {\n      throw new Error(\"index not set\");\n    }\n    const newPaths = this.props.config.paths.slice();\n    newPaths[index] = { ...newPaths[index], timestampMethod: value };\n    this.props.saveConfig({ paths: newPaths });\n  };\n\n  render() {\n    const { paths } = this.props.config;\n    const onlyTopicsHeight = paths.length * 55;\n    const heightPerTopic = onlyTopicsHeight / paths.length;\n    const xAxisHeight = 30;\n    const height = Math.max(80, onlyTopicsHeight + xAxisHeight);\n\n    return (\n      <SRoot>\n        <PanelToolbar floating helpContent={helpContent} />\n        <SAddButton show={this.props.isHovered}>\n          <Button\n            onClick={() =>\n              this.props.saveConfig({\n                paths: [...this.props.config.paths, { value: \"\", timestampMethod: \"receiveTime\" }],\n              })\n            }>\n            add\n          </Button>\n        </SAddButton>\n        <MessageHistoryDEPRECATED paths={paths.map(({ value }) => value)}>\n          {({ itemsByPath, startTime }: MessageHistoryData) => {\n            const tooltips = [];\n            const data = {\n              yLabels: paths.map((_path, pathIndex) => pathIndex.toString()),\n              datasets: paths.map(({ value: path, timestampMethod }, pathIndex) => {\n                const dataItem = {\n                  borderWidth: 10,\n                  colors: [undefined], // First should be undefined to make sure we don't color in the bar before the change.\n                  data: [],\n                  fill: false,\n                  label: pathIndex.toString(),\n                  key: pathIndex.toString(),\n                  pointBackgroundColor: [],\n                  pointBorderColor: \"transparent\",\n                  pointHoverRadius: 3,\n                  pointRadius: 1.25,\n                  pointStyle: \"circle\",\n                  showLine: true,\n                  datalabels: {\n                    display: [],\n                  },\n                };\n                const baseColors = getGlobalHooks().perPanelHooks().StateTransitions.customStateTransitionColors[\n                  path\n                ] || [grey, ...lineColors];\n                let previousValue, previousTimestamp;\n                for (let index = 0; index < itemsByPath[path].length; index++) {\n                  const item: MessageHistoryItem = itemsByPath[path][index];\n                  if (item.queriedData.length !== 1) {\n                    continue;\n                  }\n\n                  const timestamp = getTimestampForMessage(item.message, timestampMethod);\n                  if (!timestamp) {\n                    continue;\n                  }\n\n                  const { constantName, value } = item.queriedData[0];\n\n                  // Skip duplicates.\n                  if (\n                    previousTimestamp &&\n                    toSec(subtractTimes(previousTimestamp, timestamp)) === 0 &&\n                    previousValue === value\n                  ) {\n                    continue;\n                  }\n                  previousTimestamp = timestamp;\n\n                  // Skip anything that cannot be cast to a number or is a string.\n                  if (Number.isNaN(value) && typeof value !== \"string\") {\n                    continue;\n                  }\n\n                  if (typeof value !== \"number\" && typeof value !== \"boolean\" && typeof value !== \"string\") {\n                    continue;\n                  }\n\n                  const valueForColor = typeof value === \"string\" ? stringHash(value) : Math.round(Number(value));\n                  const color = baseColors[positiveModulo(valueForColor, Object.values(baseColors).length)];\n                  // We add all points, colors, tooltips, etc to the *beginning* of the list, not the end. When\n                  // datalabels overlap we usually care about the later ones (further right). By putting those points\n                  // first in the list, we prioritize datalabels there when the library does its autoclipping.\n                  dataItem.pointBackgroundColor.unshift(darkColor(color));\n                  dataItem.colors.unshift(color);\n                  const label = constantName ? `${constantName} (${String(value)})` : String(value);\n                  const x = toSec(subtractTimes(timestamp, startTime));\n                  const y = pathIndex.toString();\n                  const tooltip: TimeBasedChartTooltipData = {\n                    x,\n                    y,\n                    item,\n                    path,\n                    value,\n                    constantName,\n                    startTime,\n                  };\n                  tooltips.unshift(tooltip);\n                  const dataPoint: DataPoint = { x, y };\n                  const showDatalabel = previousValue === undefined || previousValue !== value;\n                  // Use \"auto\" here so that the datalabels library can clip datalabels if they overlap.\n                  dataItem.datalabels.display.unshift(showDatalabel ? \"auto\" : false);\n                  if (showDatalabel) {\n                    dataPoint.label = label;\n                    dataPoint.labelColor = color;\n                  }\n                  dataItem.data.unshift(dataPoint);\n                  previousValue = value;\n                }\n                return dataItem;\n              }),\n            };\n\n            const marginRight = 20;\n\n            return (\n              <SChartContainerOuter>\n                <Dimensions>\n                  {({ width }) => (\n                    <SChartContainerInner style={{ width: width - marginRight, height }}>\n                      <TimeBasedChart\n                        zoom\n                        isSynced\n                        width={width - marginRight}\n                        height={height}\n                        data={data}\n                        type=\"multicolorLine\"\n                        yAxes={yAxes}\n                        plugins={plugins}\n                        scaleOptions={scaleOptions}\n                        tooltips={tooltips}\n                      />\n\n                      {paths.map(({ value: path, timestampMethod }, index) => (\n                        <SInputContainer\n                          key={index}\n                          style={{ top: index * heightPerTopic }}\n                          shrink={index === 0 && this.props.isHovered}>\n                          <SInputDelete\n                            onClick={() => {\n                              const newPaths = this.props.config.paths.slice();\n                              newPaths.splice(index, 1);\n                              this.props.saveConfig({ paths: newPaths });\n                            }}>\n                            ✕\n                          </SInputDelete>\n                          <MessagePathInput\n                            path={path}\n                            onChange={this._onInputChange}\n                            index={index}\n                            autoSize\n                            validTypes={transitionableRosTypes}\n                            noMultiSlices\n                            timestampMethod={timestampMethod}\n                            onTimestampMethodChange={this._onInputTimestampMethodChange}\n                          />\n                        </SInputContainer>\n                      ))}\n                    </SChartContainerInner>\n                  )}\n                </Dimensions>\n              </SChartContainerOuter>\n            );\n          }}\n        </MessageHistoryDEPRECATED>\n      </SRoot>\n    );\n  }\n}\n\nexport default hot(Panel<StateTransitionConfig>(StateTransitions));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckIcon from \"@mdi/svg/svg/check.svg\";\nimport DatabaseIcon from \"@mdi/svg/svg/database.svg\";\nimport { uniq } from \"lodash\";\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport styles from \"webviz-core/src/components/PanelToolbar/index.module.scss\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport type TopicGroup = {\n  suffix: string,\n  datatype: string,\n};\n\ntype Props = {\n  onChange: (topic: string) => void,\n  topicToRender: string,\n  topics: $ReadOnlyArray<Topic>,\n  // Use either one of these:\n  // singleTopicDatatype only supports a single datatype (search and select based on datatype)\n  // topicsGroups selects the \"parent\" path of a group of topics (if either of the group topics suffixes+datatypes match)\n  singleTopicDatatype?: string,\n  topicsGroups?: TopicGroup[],\n  defaultTopicToRender: string,\n};\n\nconst SDiv = styled.div`\n  display: flex;\n  cursor: pointer;\n  padding: 8px;\n  height: 32px;\n`;\n\nconst SSpan = styled.span`\n  flex: flex-start;\n  min-width: 150px;\n  height: 17px;\n`;\n\nconst SIconSpan = styled.span`\n  flex: flex-end;\n  svg {\n    fill: white;\n    width: 15px;\n    height: 15px;\n  }\n`;\n\nexport default function TopicToRenderMenu({\n  onChange,\n  topicToRender,\n  topics,\n  topicsGroups,\n  singleTopicDatatype,\n  defaultTopicToRender,\n}: Props) {\n  if (topicsGroups && singleTopicDatatype) {\n    throw new Error(\"Cannot set both topicsGroups and singleTopicDatatype\");\n  }\n  if (!topicsGroups && !singleTopicDatatype) {\n    throw new Error(\"Must set either topicsGroups or singleTopicDatatype\");\n  }\n  const availableTopics: string[] = [];\n  for (const topic of topics) {\n    if (topicsGroups) {\n      for (const topicGroup of topicsGroups) {\n        if (topic.name.endsWith(topicGroup.suffix) && topic.datatype === topicGroup.datatype) {\n          const parentTopic = topic.name.slice(0, topic.name.length - topicGroup.suffix.length);\n          availableTopics.push(parentTopic);\n        }\n      }\n    } else {\n      if (topic.datatype === singleTopicDatatype) {\n        availableTopics.push(topic.name);\n      }\n    }\n  }\n  // Keeps only the first occurrence of each topic.\n  const renderTopics: string[] = uniq([defaultTopicToRender, ...availableTopics, topicToRender]);\n  const parentTopicSpan = (topic: string, available: boolean) => {\n    const topicDiv = topic ? topic : <span style={{ fontStyle: \"italic\" }}>Default</span>;\n    return (\n      <span>\n        {topicDiv}\n        {available ? \"\" : \" (not available)\"}\n      </span>\n    );\n  };\n\n  return (\n    <Dropdown\n      toggleComponent={\n        <Icon\n          fade\n          tooltip={\n            topicsGroups\n              ? `Parent topics selected by topic suffixes:\\n ${topicsGroups.map((group) => group.suffix).join(\"\\n\")}`\n              : `Topics selected by datatype: ${singleTopicDatatype || \"\"}` // add || \"\" is to fix flow here\n          }\n          tooltipProps={{ placement: \"top\" }}\n          style={{ color: topicToRender === defaultTopicToRender ? colors.LIGHT1 : colors.ORANGE }}\n          dataTest={\"topic-set\"}>\n          <DatabaseIcon className={styles.icon} />\n        </Icon>\n      }>\n      {renderTopics.map((topic, idx) => (\n        <SDiv\n          style={topicToRender === topic ? { backgroundColor: \"rgba(59, 46, 118, 0.6)\" } : {}}\n          key={topic}\n          onClick={() => {\n            onChange(topic);\n          }}>\n          <SSpan>{parentTopicSpan(topic, availableTopics.includes(topic))}</SSpan>\n          {topicToRender === topic ? (\n            <SIconSpan>\n              <CheckIcon />\n            </SIconSpan>\n          ) : null}\n        </SDiv>\n      ))}\n    </Dropdown>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CursorDefault from \"@mdi/svg/svg/cursor-default.svg\";\nimport * as React from \"react\";\nimport { type MouseEventObject } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport GeneralInfo from \"./GeneralInfo\";\nimport LinkedGlobalVariableList from \"./LinkedGlobalVariableList\";\nimport ObjectDetails from \"./ObjectDetails\";\nimport PointCloudDetails from \"./PointCloudDetails\";\nimport type { InteractionData } from \"./types\";\nimport useLinkedGlobalVariables from \"./useLinkedGlobalVariables\";\nimport Checkbox from \"webviz-core/src/components/Checkbox\";\nimport ExpandingToolbar, { ToolGroup, ToolGroupFixedSizePane } from \"webviz-core/src/components/ExpandingToolbar\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport { decodeAdditionalFields } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/PointCloudBuilder\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport type { SaveConfig, PanelConfig } from \"webviz-core/src/types/panels\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const SRow = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 0;\n  margin: 4px 0;\n`;\nexport const SLabel = styled.label`\n  width: ${(props) => (props.width ? `${props.width}px` : \"80px\")};\n  margin: 4px 0;\n  font-size: 10px;\n`;\nexport const SValue = styled.div`\n  color: ${colors.HIGHLIGHT};\n  word-break: break-word;\n`;\nexport const SEmptyState = styled.div`\n  color: ${colors.TEXT_MUTED};\n  line-height: 1.4;\n  margin-bottom: 8px;\n`;\n\nexport const OBJECT_TAB_TYPE = \"Clicked object\";\nexport const LINKED_VARIABLES_TAB_TYPE = \"Linked variables\";\nexport type TabType = typeof OBJECT_TAB_TYPE | typeof LINKED_VARIABLES_TAB_TYPE;\n\ntype Props = {\n  defaultSelectedTab?: ?TabType, // for UI testing\n  interactionData: ?InteractionData,\n  isDrawing: boolean,\n  onClearSelectedObject: () => void,\n  selectedObject: ?MouseEventObject,\n};\n\ntype PropsWithConfig = Props & {\n  disableAutoOpenClickedObject: boolean,\n  saveConfig: SaveConfig<PanelConfig>,\n};\n\nconst InteractionsBaseComponent = React.memo<PropsWithConfig>(function InteractionsBaseComponent({\n  selectedObject,\n  interactionData,\n  isDrawing,\n  onClearSelectedObject,\n  defaultSelectedTab,\n  disableAutoOpenClickedObject,\n  saveConfig,\n}: PropsWithConfig) {\n  const [selectedTab, setSelectedTab] = React.useState<?TabType>(defaultSelectedTab);\n  const selectedObjectChanged = useChangeDetector([selectedObject], !!selectedObject);\n  React.useEffect(\n    () => {\n      if (!disableAutoOpenClickedObject && !isDrawing) {\n        // auto open Object tab if the object changed, the tab is not already open, and the user is not drawing\n        if (selectedObjectChanged && selectedTab !== OBJECT_TAB_TYPE) {\n          setSelectedTab(OBJECT_TAB_TYPE);\n        } else if (!selectedObject && selectedTab === OBJECT_TAB_TYPE) {\n          // auto collapse the Object pane when there is no object and auto open is enabled\n          setSelectedTab(null);\n        }\n      }\n    },\n    [disableAutoOpenClickedObject, selectedObjectChanged, selectedTab, selectedObject, isDrawing]\n  );\n\n  const { object } = selectedObject || {};\n  const isPointCloud = object && object.type === 102;\n  const maybeFullyDecodedObject = React.useMemo(\n    () => (isPointCloud ? { ...selectedObject, object: decodeAdditionalFields(object) } : selectedObject),\n    [isPointCloud, object, selectedObject]\n  );\n\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n\n  return (\n    <ExpandingToolbar\n      tooltip=\"Clicked objects and linked variables\"\n      icon={\n        <Icon style={{ color: \"white\" }}>\n          <CursorDefault />\n        </Icon>\n      }\n      className={styles.buttons}\n      selectedTab={selectedTab}\n      onSelectTab={(newSelectedTab) => {\n        if (disableAutoOpenClickedObject && object && !newSelectedTab) {\n          // automatically unselect object if the user force close the tab when disableAutoOpenClickedObject is enabled\n          onClearSelectedObject();\n        }\n        setSelectedTab(newSelectedTab);\n      }}>\n      <ToolGroup name={OBJECT_TAB_TYPE}>\n        <ToolGroupFixedSizePane>\n          {selectedObject ? (\n            <>\n              {interactionData && <GeneralInfo selectedObject={selectedObject} interactionData={interactionData} />}\n              {isPointCloud && (\n                <PointCloudDetails selectedObject={maybeFullyDecodedObject} interactionData={interactionData} />\n              )}\n              <ObjectDetails\n                linkedGlobalVariables={linkedGlobalVariables}\n                selectedObject={maybeFullyDecodedObject}\n                interactionData={interactionData}\n              />\n            </>\n          ) : (\n            <SEmptyState>Click an object in the 3D view to select it.</SEmptyState>\n          )}\n          <Checkbox\n            label=\"Open this panel automatically\"\n            checked={!disableAutoOpenClickedObject}\n            onChange={() => saveConfig({ disableAutoOpenClickedObject: !disableAutoOpenClickedObject })}\n          />\n        </ToolGroupFixedSizePane>\n      </ToolGroup>\n      <ToolGroup name={LINKED_VARIABLES_TAB_TYPE}>\n        <ToolGroupFixedSizePane>\n          <LinkedGlobalVariableList linkedGlobalVariables={linkedGlobalVariables} />\n        </ToolGroupFixedSizePane>\n      </ToolGroup>\n    </ExpandingToolbar>\n  );\n});\n\n// Wrap the Interactions so that we don't rerender every time any part of the PanelContext config changes, but just the\n// one value that we care about.\nexport default function Interactions(props: Props) {\n  const { saveConfig, config: { disableAutoOpenClickedObject } = {} } = React.useContext(PanelContext) || {};\n  return (\n    <InteractionsBaseComponent\n      {...props}\n      saveConfig={saveConfig}\n      disableAutoOpenClickedObject={disableAutoOpenClickedObject}\n    />\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { every, uniq, keyBy, isEmpty } from \"lodash\";\n\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport { jsonTreeTheme } from \"webviz-core/src/util/globalConstants\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const diffArrow = \"->\";\nexport const diffLabels = {\n  ADDED: { labelText: \"WEBVIZ_DIFF___ADDED\", color: colors.DARK6, backgroundColor: \"#182924\", indicator: \"+\" },\n  DELETED: { labelText: \"WEBVIZ_DIFF___DELETED\", color: colors.DARK6, backgroundColor: \"#3d2327\", indicator: \"-\" },\n  CHANGED: { labelText: \"WEBVIZ_DIFF___CHANGED\", color: jsonTreeTheme.base0B },\n  ID: { labelText: \"WEBVIZ_DIFF___ID\" },\n};\n\n// $FlowFixMe - Flow doesn't understand `Object.values`.\nexport const diffLabelsByLabelText = keyBy(Object.values(diffLabels), \"labelText\");\n\nexport default function getDiff(\n  before: mixed,\n  after: mixed,\n  idLabel: ?string = null,\n  showFullMessageForDiff: boolean = false\n) {\n  if (Array.isArray(before) && Array.isArray(after)) {\n    let idToCompareWith: ?string;\n    const allItems = before.concat(after);\n    if (allItems[0] && typeof allItems[0] === \"object\") {\n      let candidateIdsToCompareWith = {};\n      if (allItems[0].id != null) {\n        candidateIdsToCompareWith.id = { before: [], after: [] };\n      }\n      for (const key in allItems[0]) {\n        if (isTypicalFilterName(key)) {\n          candidateIdsToCompareWith[key] = { before: [], after: [] };\n        }\n      }\n      if (!every(allItems, (item) => item && typeof item === \"object\")) {\n        candidateIdsToCompareWith = {};\n      }\n      for (const idKey in candidateIdsToCompareWith) {\n        for (const beforeItem of before) {\n          // $FlowFixMe - we know beforeItem is an object at this point\n          if (beforeItem[idKey] != null) {\n            candidateIdsToCompareWith[idKey].before.push(beforeItem[idKey]);\n          }\n        }\n      }\n      for (const idKey in candidateIdsToCompareWith) {\n        for (const afterItem of after) {\n          // $FlowFixMe - we know afterItem is an object at this point\n          if (afterItem[idKey] != null) {\n            candidateIdsToCompareWith[idKey].after.push(afterItem[idKey]);\n          }\n        }\n      }\n      for (const idKey in candidateIdsToCompareWith) {\n        const { before: candidateIdBefore, after: candidateIdAfter } = candidateIdsToCompareWith[idKey];\n        if (uniq(candidateIdBefore).length === before.length && uniq(candidateIdAfter).length === after.length) {\n          idToCompareWith = idKey;\n          break;\n        }\n      }\n    }\n\n    if (idToCompareWith) {\n      const unmatchedAfterById = keyBy(after, idToCompareWith);\n      const diff = [];\n      for (const beforeItem of before) {\n        if (!beforeItem || typeof beforeItem !== \"object\") {\n          throw new Error(\"beforeItem is invalid; should have checked this earlier\");\n        }\n        const id = beforeItem[idToCompareWith];\n        const innerDiff = getDiff(beforeItem, unmatchedAfterById[id], idToCompareWith, showFullMessageForDiff);\n        delete unmatchedAfterById[id];\n        if (!isEmpty(innerDiff)) {\n          const isDeleted =\n            Object.keys(innerDiff).length === 1 && Object.keys(innerDiff)[0] === diffLabels.DELETED.labelText;\n          diff.push(isDeleted ? innerDiff : { [diffLabels.ID.labelText]: { [idToCompareWith]: id }, ...innerDiff });\n        }\n      }\n      for (const afterItem of Object.values(unmatchedAfterById)) {\n        const innerDiff = getDiff(undefined, afterItem, idToCompareWith, showFullMessageForDiff);\n        if (!isEmpty(innerDiff)) {\n          diff.push(innerDiff);\n        }\n      }\n      return diff;\n    }\n  }\n\n  if (before && after && typeof before === \"object\" && typeof after === \"object\") {\n    const diff = {};\n    const allKeys = Object.keys(before).concat(Object.keys(after));\n    for (const key of uniq(allKeys)) {\n      const innerDiff = getDiff(before[key], after[key], null, showFullMessageForDiff);\n      if (!isEmpty(innerDiff)) {\n        diff[key] = innerDiff;\n      } else if (showFullMessageForDiff) {\n        diff[key] = before[key];\n      }\n    }\n    return diff;\n  }\n\n  if (before === after) {\n    return undefined;\n  }\n  if (before === undefined) {\n    const afterIsNotObj = Array.isArray(after) || typeof after !== \"object\";\n    if (!idLabel || afterIsNotObj) {\n      return { [diffLabels.ADDED.labelText]: after };\n    }\n    const idLabelObj = { [diffLabels.ID.labelText]: { [idLabel]: { ...after }[idLabel] } };\n    return { [diffLabels.ADDED.labelText]: { ...idLabelObj, ...after } };\n  }\n  if (after === undefined) {\n    const beforeIsNotObj = Array.isArray(before) || typeof before !== \"object\";\n    if (!idLabel || beforeIsNotObj) {\n      return { [diffLabels.DELETED.labelText]: before };\n    }\n    const idLabelObj = { [diffLabels.ID.labelText]: { [idLabel]: { ...before }[idLabel] } };\n    return { [diffLabels.DELETED.labelText]: { ...idLabelObj, ...before } };\n  }\n  return {\n    [diffLabels.CHANGED.labelText]: `${JSON.stringify(before) || \"\"} ${diffArrow} ${JSON.stringify(after) || \"\"}`,\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowCollapseIcon from \"@mdi/svg/svg/arrow-collapse.svg\";\nimport cx from \"classnames\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport styles from \"./ExpandingToolbar.module.scss\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\n\nconst PANE_WIDTH = 268;\nconst PANE_HEIGHT = 240;\n\nexport const SToolGroupFixedSizePane = styled.div`\n  overflow-x: hidden;\n  overflow-y: auto;\n  padding: 8px 0;\n`;\n\nexport function ToolGroup<T>({ children }: { name: T, children: React.Node }) {\n  return children;\n}\n\nexport function ToolGroupFixedSizePane({ children }: { children: React.Node }) {\n  return (\n    <SToolGroupFixedSizePane style={{ width: PANE_WIDTH - 28, height: PANE_HEIGHT }}>\n      {children}\n    </SToolGroupFixedSizePane>\n  );\n}\n\ntype Props<T: string> = {|\n  // $FlowFixMe typeof does not work with generics well, getting \"`typeof` can only be used to get the type of variables\"\n  children: React.ChildrenArray<React.Element<typeof ToolGroup<T>>>,\n  className?: ?string,\n  icon: React.Node,\n  onSelectTab: (name: ?T) => void,\n  selectedTab: ?T, // collapse the toolbar if selectedTab is null\n  tooltip: string,\n  style?: StyleObj,\n|};\n\nexport default function ExpandingToolbar<T: string>({\n  children,\n  className,\n  icon,\n  onSelectTab,\n  selectedTab,\n  tooltip,\n  style,\n}: Props<T>) {\n  const expanded = !!selectedTab;\n  if (!expanded) {\n    let selectedTabLocal = selectedTab;\n    if (!selectedTabLocal) {\n      // default to the first child's name if no tab is selected\n      React.Children.forEach(children, (child) => {\n        if (!selectedTabLocal) {\n          selectedTabLocal = child.props.name;\n        }\n      });\n    }\n    return (\n      <div className={className}>\n        <Button tooltip={tooltip} onClick={() => onSelectTab(selectedTabLocal)}>\n          <Icon>{icon}</Icon>\n        </Button>\n      </div>\n    );\n  }\n  let selectedChild;\n  React.Children.forEach(children, (child) => {\n    if (!selectedChild || child.props.name === selectedTab) {\n      selectedChild = child;\n    }\n  });\n  return (\n    <div className={cx(className, styles.expanded)}>\n      <Flex row className={styles.tabBar}>\n        {React.Children.map(children, (child) => {\n          return (\n            <Button\n              className={cx(styles.tab, { [styles.selected]: child === selectedChild })}\n              onClick={() => onSelectTab(child.props.name)}>\n              {child.props.name}\n            </Button>\n          );\n        })}\n        <div className={styles.spaceSeparator} />\n        <Button onClick={() => onSelectTab(null)}>\n          <Icon>\n            <ArrowCollapseIcon />\n          </Icon>\n        </Button>\n      </Flex>\n      <div className={styles.tabBody} style={style}>\n        {selectedChild}\n      </div>\n    </div>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport clamp from \"lodash/clamp\";\n\nimport CameraModel from \"./CameraModel\";\nimport type { Topic, Message } from \"webviz-core/src/players/types\";\nimport type { CameraInfo } from \"webviz-core/src/types/Messages\";\n\n// The OffscreenCanvas type is not yet in Flow. It's similar to, but more restrictive than HTMLCanvasElement.\n// TODO: change this to the Flow definition once it's been added.\nexport type OffscreenCanvas = HTMLCanvasElement;\n\nexport type Dimensions = {| width: number, height: number |};\n\nexport type MarkerOption = {\n  topic: string,\n  name: string,\n};\n\nexport type RawMarkerData = {|\n  markers: Message[],\n  scale: number,\n  transformMarkers: boolean,\n  cameraInfo: ?CameraInfo,\n|};\n\nexport type MarkerData = ?{|\n  markers: Message[],\n  originalWidth: ?number, // null means no scaling is needed (use the image's size)\n  originalHeight: ?number, // null means no scaling is needed (use the image's size)\n  cameraModel: ?CameraModel, // null means no transformation is needed\n|};\n\nexport function getMarkerOptions(\n  imageTopic: string,\n  topics: $ReadOnlyArray<Topic>,\n  allCameraNamespaces: string[],\n  imageMarkerDatatypes: string[]\n): string[] {\n  const results = [];\n  const cameraNamespace = getCameraNamespace(imageTopic);\n  for (const { name, datatype } of topics) {\n    if (\n      cameraNamespace &&\n      (name.startsWith(cameraNamespace) || name.startsWith(`/old${cameraNamespace}`)) &&\n      imageMarkerDatatypes.includes(datatype)\n    ) {\n      results.push(name);\n    }\n  }\n  return results.sort();\n}\n\nexport function getRelatedMarkerTopics(enabledMarkerTopics: string[], availableMarkerTopics: string[]): string[] {\n  return availableMarkerTopics.filter((topic) => {\n    return enabledMarkerTopics.some((enabledTopic) => topic.endsWith(enabledTopic.split(\"/\").pop()));\n  });\n}\n\n// get the sensor_msgs/CameraInfo topic associated with an image topic\nexport function getCameraInfoTopic(imageTopic: string): ?string {\n  const cameraNamespace = getCameraNamespace(imageTopic);\n  if (cameraNamespace) {\n    return `${cameraNamespace}/camera_info`;\n  }\n  return null;\n}\n\nexport function getCameraNamespace(topicName: string): ?string {\n  let splitTopic = topicName.split(\"/\");\n  // Remove the last part of the selected topic to get the camera namespace.\n  splitTopic.pop();\n  splitTopic = splitTopic.filter((topicPart) => topicPart !== \"old\");\n\n  // Since there is a leading slash in the topicName, splitTopic will always have at least one empty string to start.\n  // If we can't find the namespace, return null.\n  return splitTopic.length > 1 ? splitTopic.join(\"/\") : null;\n}\n\n// group topics by the first component of their name\nexport function groupTopics(topics: Topic[]): Map<string, Topic[]> {\n  const imageTopicsByNamespace: Map<string, Topic[]> = new Map();\n  for (const topic of topics) {\n    const key = getCameraNamespace(topic.name) || topic.name;\n    const vals = imageTopicsByNamespace.get(key);\n    if (vals) {\n      vals.push(topic);\n    } else {\n      imageTopicsByNamespace.set(key, [topic]);\n    }\n  }\n  return imageTopicsByNamespace;\n}\n\n// check if we pan out of bounds with the given top, left, right, bottom\n// x, y, scale is the state after we pan\n// if out of bound, return newX and newY satisfying the bounds\n// else, return the original x and y\nexport function checkOutOfBounds(\n  x: number,\n  y: number,\n  outsideWidth: number,\n  outsideHeight: number,\n  insideWidth: number,\n  insideHeight: number\n): number[] {\n  const leftX = 0;\n  const topY = 0;\n  const rightX = outsideWidth - insideWidth;\n  const bottomY = outsideHeight - insideHeight;\n  return [\n    clamp(x, Math.min(leftX, rightX), Math.max(leftX, rightX)),\n    clamp(y, Math.min(topY, bottomY), Math.max(topY, bottomY)),\n  ];\n}\n\nexport function buildMarkerData(rawMarkerData: RawMarkerData): ?MarkerData {\n  const { markers, scale, transformMarkers, cameraInfo } = rawMarkerData;\n  if (markers.length === 0) {\n    return {\n      markers,\n      cameraModel: null,\n      originalHeight: undefined,\n      originalWidth: undefined,\n    };\n  }\n  let cameraModel;\n  if (transformMarkers) {\n    if (!cameraInfo) {\n      return null;\n    }\n    cameraModel = new CameraModel(cameraInfo);\n  }\n\n  // Markers can only be rendered if we know the original size of the image.\n  let originalWidth;\n  let originalHeight;\n  if (cameraInfo && cameraInfo.width && cameraInfo.height) {\n    // Prefer using CameraInfo can be used to determine the image size.\n    originalWidth = cameraInfo.width;\n    originalHeight = cameraInfo.height;\n  } else if (scale === 1) {\n    // Otherwise, if scale === 1, the image was not downsampled, so the size of the bitmap is accurate.\n    originalWidth = undefined;\n    originalHeight = undefined;\n  } else {\n    return null;\n  }\n\n  return {\n    markers,\n    cameraModel,\n    originalWidth,\n    originalHeight,\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { vec3 } from \"gl-matrix\";\nimport { mergeWith, get } from \"lodash\";\nimport { useRef } from \"react\";\nimport {\n  type CameraState,\n  type Vec3,\n  type Vec4,\n  type MouseEventObject,\n  cameraStateSelectors,\n  DEFAULT_CAMERA_STATE,\n} from \"regl-worldview\";\n\nimport { type GlobalVariables } from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { type LinkedGlobalVariables } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport { emptyPose } from \"webviz-core/src/util/Pose\";\n\nexport type TargetPose = { target: Vec3, targetOrientation: Vec4 };\n\nconst ZOOM_LEVEL_URL_PARAM = \"zoom\";\n\nfunction getZoomDistanceFromURLParam(): number | void {\n  const params = new URLSearchParams(location && location.search);\n  if (params.has(ZOOM_LEVEL_URL_PARAM)) {\n    return parseFloat(params.get(ZOOM_LEVEL_URL_PARAM));\n  }\n}\n\n// Get the camera target position and orientation\nexport function getTargetPose(followTf?: string | false, transforms: Transforms) {\n  if (followTf) {\n    let pose = emptyPose();\n    pose = transforms.apply(pose, pose, followTf, transforms.rootOfTransform(followTf).id);\n    if (pose) {\n      const { x: px, y: py, z: pz } = pose.position;\n      const { x: ox, y: oy, z: oz, w: ow } = pose.orientation;\n      return {\n        target: [px, py, pz],\n        targetOrientation: [ox, oy, oz, ow],\n      };\n    }\n  }\n  return null;\n}\n\nexport function useComputedCameraState({\n  currentCameraState,\n  followTf,\n  followOrientation,\n  transforms,\n}: {\n  currentCameraState: $Shape<CameraState>,\n  followTf?: string | false,\n  followOrientation?: boolean,\n  transforms: Transforms,\n}): { cameraState: CameraState, targetPose: ?TargetPose } {\n  let newCameraState = { ...currentCameraState };\n  const targetPose = getTargetPose(followTf, transforms);\n  // Store last seen target pose because the target may become available/unavailable over time as\n  // the player changes, and we want to avoid moving the camera when it disappears.\n  const lastTargetPoseRef = useRef<?TargetPose>(null);\n  const lastTargetPose = lastTargetPoseRef.current;\n  // Recompute cameraState based on the new inputs at each render\n  if (targetPose) {\n    lastTargetPoseRef.current = targetPose;\n    newCameraState.target = targetPose.target;\n    if (followOrientation) {\n      newCameraState.targetOrientation = targetPose.targetOrientation;\n    }\n  } else if (followTf && lastTargetPose) {\n    // If follow is enabled but no target is available (such as when seeking), keep the camera\n    // position the same as it would have been by reusing the last seen target pose.\n    newCameraState.target = lastTargetPose.target;\n    if (followOrientation) {\n      newCameraState.targetOrientation = lastTargetPose.targetOrientation;\n    }\n  }\n  // Read the distance from URL when World is first loaded with empty cameraState distance in savedProps\n  if (currentCameraState.distance == null) {\n    newCameraState.distance = getZoomDistanceFromURLParam();\n  }\n\n  newCameraState = mergeWith(newCameraState, DEFAULT_CAMERA_STATE, (objVal, srcVal) => objVal ?? srcVal);\n\n  return { cameraState: newCameraState, targetPose: targetPose || lastTargetPose };\n}\n\nexport function getUpdatedGlobalVariablesBySelectedObject(\n  selectedObject: MouseEventObject,\n  linkedGlobalVariables: LinkedGlobalVariables\n): ?GlobalVariables {\n  const interactionData = selectedObject && selectedObject.object.interactionData;\n  const objectTopic = interactionData && interactionData.topic;\n  if (!linkedGlobalVariables.length || !objectTopic) {\n    return;\n  }\n  const newGlobalVariables = {};\n  linkedGlobalVariables.forEach(({ topic, markerKeyPath, name }) => {\n    if (objectTopic === topic) {\n      const objectForPath = get(selectedObject.object, [...markerKeyPath].reverse());\n      newGlobalVariables[name] = objectForPath;\n    }\n  });\n  return newGlobalVariables;\n}\n\n// Return targetOffset and thetaOffset that would yield the same camera position as the\n// given offsets if the target were (0,0,0) and targetOrientation were identity.\nfunction getEquivalentOffsetsWithoutTarget(\n  offsets: { +targetOffset: Vec3, +thetaOffset: number },\n  targetPose: { +target: Vec3, +targetOrientation: Vec4 },\n  followOrientation?: boolean\n): { targetOffset: Vec3, thetaOffset: number } {\n  const heading = followOrientation\n    ? cameraStateSelectors.targetHeading({ targetOrientation: targetPose.targetOrientation })\n    : 0;\n  const targetOffset = vec3.rotateZ([0, 0, 0], offsets.targetOffset, [0, 0, 0], -heading);\n  vec3.add(targetOffset, targetOffset, targetPose.target);\n  const thetaOffset = offsets.thetaOffset + heading;\n  return { targetOffset, thetaOffset };\n}\n\nexport function getNewCameraStateOnFollowChange({\n  prevCameraState,\n  prevTargetPose,\n  prevFollowTf,\n  prevFollowOrientation,\n  newFollowTf,\n  newFollowOrientation,\n}: {|\n  prevCameraState: CameraState,\n  prevTargetPose: ?TargetPose,\n  prevFollowTf: ?(string | false),\n  prevFollowOrientation: ?boolean,\n  newFollowTf: ?(string | false),\n  newFollowOrientation: ?boolean,\n|}): CameraState {\n  const newCameraState = { ...prevCameraState };\n  if (newFollowTf) {\n    // When switching to follow orientation, adjust thetaOffset to preserve camera rotation.\n    if (newFollowOrientation && !prevFollowOrientation && prevTargetPose) {\n      const heading = cameraStateSelectors.targetHeading({\n        targetOrientation: prevTargetPose.targetOrientation,\n      });\n      newCameraState.targetOffset = vec3.rotateZ(\n        [0, 0, 0],\n        newCameraState.targetOffset || DEFAULT_CAMERA_STATE.targetOffset,\n        [0, 0, 0],\n        heading\n      );\n      newCameraState.thetaOffset -= heading;\n    }\n    // When following a frame for the first time, snap to the origin.\n    if (!prevFollowTf) {\n      newCameraState.targetOffset = [0, 0, 0];\n    }\n  } else if (prevFollowTf && prevTargetPose) {\n    // When unfollowing, preserve the camera position and orientation.\n    Object.assign(\n      newCameraState,\n      getEquivalentOffsetsWithoutTarget(\n        {\n          targetOffset: prevCameraState.targetOffset || DEFAULT_CAMERA_STATE.targetOffset,\n          thetaOffset: prevCameraState.thetaOffset || DEFAULT_CAMERA_STATE.thetaOffset,\n        },\n        prevTargetPose,\n        !!prevFollowOrientation\n      ),\n      { target: [0, 0, 0] }\n    );\n  }\n\n  return newCameraState;\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { isEqual } from \"lodash\";\n\ntype Rule = (value: any) => ?string;\ntype Rules = {\n  [name: string]: ((value: any) => ?string)[],\n};\n\nfunction isEmpty(value: any) {\n  return value == null;\n}\nexport const isRequired = (value: any): ?string => (value == null ? \"is required\" : undefined);\n\nexport const isNumber = (value: any): ?string =>\n  !isEmpty(value) && typeof value !== \"number\" ? \"must be a number\" : undefined;\n\nexport const isBoolean = (value: any): ?string =>\n  !isEmpty(value) && typeof value !== \"boolean\" ? `must be \"true\" or \"false\"` : undefined;\n\nexport const isNumberArray = (expectArrLen: number = 0) => (value: any): ?string => {\n  if (Array.isArray(value)) {\n    if (value.length !== expectArrLen) {\n      return `must contain ${expectArrLen} array items`;\n    }\n    for (const item of value) {\n      if (typeof item !== \"number\") {\n        return `must contain only numbers in the array. \"${item}\" is not a number.`;\n      }\n    }\n  }\n};\n\nexport const isOrientation = (value: any): ?string => {\n  const isNumberArrayErr = isNumberArray(4)(value);\n  if (isNumberArrayErr) {\n    return isNumberArrayErr;\n  }\n  if (value) {\n    const quaternionSum = value.reduce((memo, item) => memo + item * item, 0);\n    // Very rough validation to make sure the quaternion numbers are not too far off\n    if (Math.abs(quaternionSum - 1) > 0.1) {\n      return \"must be valid quaternion\";\n    }\n  }\n};\n\nexport const isString = (value: any): ?string => (typeof value !== \"string\" ? \"must be string\" : undefined);\n\nexport const minLen = (minLength: number = 0) => (value: any): ?string => {\n  if (Array.isArray(value)) {\n    return value.length < minLength ? `must contain at least ${minLength} array items` : undefined;\n  } else if (typeof value === \"string\") {\n    return value.length < minLength ? `must contain at least ${minLength} characters` : undefined;\n  }\n};\n\nexport const maxLen = (maxLength: number = 0) => (value: any): ?string => {\n  if (Array.isArray(value)) {\n    return value.length > maxLength ? `must contain at most ${maxLength} array items` : undefined;\n  } else if (typeof value === \"string\") {\n    return value.length > maxLength ? `must contain at most ${maxLength} characters` : undefined;\n  }\n};\n\nexport const hasLen = (len: number = 0) => (value: string | any[]): ?string => {\n  if (Array.isArray(value)) {\n    return value.length !== len\n      ? `must contain exact ${len} array items (current item count: ${value.length})`\n      : undefined;\n  } else if (typeof value === \"string\") {\n    return value.length !== len ? `must contain ${len} characters (current count: ${value.length})` : undefined;\n  }\n};\n\nexport const isNotPrivate = (value: any): ?string =>\n  typeof value !== \"string\" && value.startsWith(\"_\") ? \"must not start with _\" : undefined;\n\n// return the first error\nconst join = (rules) => (value) => rules.map((rule) => rule(value)).filter((error) => !!error)[0];\n\nexport const isWebsocketUrl = (value: string): ?string => {\n  const pattern = new RegExp(`wss?://[a-z.-_\\\\d]+(:(d+))?`, \"gi\");\n  if (!pattern.test(value)) {\n    return `${value} is not a valid WebSocket URL`;\n  }\n};\n\nexport const createValidator = (rules: Rules) => {\n  return (data: any = {}): { [field: string]: string } => {\n    const errors = {};\n    Object.keys(rules).forEach((key) => {\n      // concat enables both functions and arrays of functions\n      const rule = join([].concat(rules[key]));\n      const error = rule(data[key]);\n      if (error) {\n        errors[key] = error;\n      }\n    });\n    return errors;\n  };\n};\n\nexport const createPrimitiveValidator = (rules: Rule[]) => {\n  return (data: any): ?string => {\n    for (let i = 0; i < rules.length; i++) {\n      const error = rules[i](data);\n      if (error) {\n        return error;\n      }\n    }\n  };\n};\n\nexport type ValidationResult =\n  | string\n  | {\n      [fieldName: string]: string,\n    };\n\nexport const validationErrorToString = (validationResult: ValidationResult): string =>\n  typeof validationResult === \"string\"\n    ? validationResult\n    : Object.keys(validationResult)\n        .map((key) => `${key}: ${validationResult[key]}`)\n        .join(\", \");\n\nexport const cameraStateValidator = (jsonData: any): ?ValidationResult => {\n  const data = typeof jsonData !== \"object\" ? {} : jsonData;\n  const rules = {\n    distance: [isNumber],\n    perspective: [isBoolean],\n    phi: [isNumber],\n    thetaOffset: [isNumber],\n    target: [isNumberArray(3)],\n    targetOffset: [isNumberArray(3)],\n    targetOrientation: [isOrientation],\n  };\n  const validator = createValidator(rules);\n  const result = validator(data);\n\n  return Object.keys(result).length === 0 ? undefined : result;\n};\n\nconst isXYPointArray = (value: any): ?string => {\n  if (Array.isArray(value)) {\n    for (const item of value) {\n      if (!item || item.x == null || item.y == null) {\n        return `must contain x and y points`;\n      }\n      if (typeof item.x !== \"number\" || typeof item.y !== \"number\") {\n        return `x and y points must be numbers`;\n      }\n    }\n  } else {\n    return \"must be an array of x and y points\";\n  }\n};\n\nconst isPolygons = (value: any): ?string => {\n  if (Array.isArray(value)) {\n    for (const item of value) {\n      const error = isXYPointArray(item);\n      if (error) {\n        return error;\n      }\n    }\n  } else {\n    return \"must be an array of nested x and y points\";\n  }\n};\n\n// validate the polygons must be a nested array of xy points\nexport const polygonPointsValidator = (jsonData: any): ?ValidationResult => {\n  if (!jsonData || isEqual(jsonData, []) || isEqual(jsonData, {})) {\n    return undefined;\n  }\n  const rules = { polygons: [isPolygons] };\n  const validator = createValidator(rules);\n  const result = validator({ polygons: jsonData });\n  return Object.keys(result).length === 0 ? undefined : result.polygons;\n};\n\nexport const point2DValidator = (jsonData: any): ?ValidationResult => {\n  const data = typeof jsonData !== \"object\" ? {} : jsonData;\n  const rules = { x: [isRequired, isNumber], y: [isRequired, isNumber] };\n  const validator = createValidator(rules);\n  const result = validator(data);\n  return Object.keys(result).length === 0 ? undefined : result;\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\nimport { type ReglClickInfo } from \"regl-worldview\";\n\nimport type { Point } from \"webviz-core/src/types/Messages\";\nimport { arrayToPoint } from \"webviz-core/src/util\";\n\nexport type MeasureState = \"idle\" | \"place-start\" | \"place-finish\";\n\nexport type MeasureInfo = {|\n  measureState: MeasureState,\n  measurePoints: { start: ?Point, end: ?Point },\n|};\n\ntype Props = {|\n  onMeasureInfoChange: (MeasureInfo) => void,\n  ...MeasureInfo,\n|};\n\n/* eslint-disable no-restricted-syntax */\n\nexport default class MeasuringTool extends React.Component<Props> {\n  mouseDownCoords: number[] = [-1, -1];\n\n  toggleMeasureState = () => {\n    const newMeasureState = this.props.measureState === \"idle\" ? \"place-start\" : \"idle\";\n    this.props.onMeasureInfoChange({\n      measureState: newMeasureState,\n      measurePoints: { start: undefined, end: undefined },\n    });\n  };\n\n  reset = () => {\n    this.props.onMeasureInfoChange({\n      measureState: \"idle\",\n      measurePoints: { start: undefined, end: undefined },\n    });\n  };\n\n  _canvasMouseDownHandler = (e: MouseEvent, clickInfo: ReglClickInfo) => {\n    this.mouseDownCoords = [e.clientX, e.clientY];\n  };\n\n  _canvasMouseUpHandler = (e: MouseEvent, clickInfo: ReglClickInfo) => {\n    const mouseUpCoords = [e.clientX, e.clientY];\n    const { measureState, measurePoints, onMeasureInfoChange } = this.props;\n\n    if (!isEqual(mouseUpCoords, this.mouseDownCoords)) {\n      return;\n    }\n\n    if (measureState === \"place-start\") {\n      onMeasureInfoChange({ measureState: \"place-finish\", measurePoints });\n    } else if (measureState === \"place-finish\") {\n      // Use setImmediate so there is a tick between resetting the measure state and clicking the 3D canvas.\n      // If we call onMeasureInfoChange right away, the clicked object context menu will show up upon finishing measuring.\n      setImmediate(() => {\n        onMeasureInfoChange({ measurePoints, measureState: \"idle\" });\n      });\n    }\n  };\n\n  _canvasMouseMoveHandler = (e: MouseEvent, clickInfo: ReglClickInfo) => {\n    const { measureState, measurePoints, onMeasureInfoChange } = this.props;\n    switch (measureState) {\n      case \"place-start\":\n        onMeasureInfoChange({\n          measureState,\n          measurePoints: {\n            start: arrayToPoint(clickInfo.ray.planeIntersection([0, 0, 0], [0, 0, 1])),\n            end: undefined,\n          },\n        });\n        break;\n\n      case \"place-finish\":\n        onMeasureInfoChange({\n          measureState,\n          measurePoints: {\n            ...measurePoints,\n            end: arrayToPoint(clickInfo.ray.planeIntersection([0, 0, 0], [0, 0, 1])),\n          },\n        });\n        break;\n    }\n  };\n\n  get onMouseMove(): ?(MouseEvent, ReglClickInfo) => void {\n    if (!this.measureActive) {\n      return null;\n    }\n\n    return this._canvasMouseMoveHandler;\n  }\n\n  get onMouseUp(): ?(MouseEvent, ReglClickInfo) => void {\n    if (!this.measureActive) {\n      return null;\n    }\n\n    return this._canvasMouseUpHandler;\n  }\n\n  get onMouseDown(): ?(MouseEvent, ReglClickInfo) => void {\n    if (!this.measureActive) {\n      return null;\n    }\n\n    return this._canvasMouseDownHandler;\n  }\n\n  get measureActive(): boolean {\n    const { measureState } = this.props;\n    return measureState === \"place-start\" || measureState === \"place-finish\";\n  }\n\n  get measureDistance(): string {\n    const { start, end } = this.props.measurePoints;\n    let dist_string = \"\";\n    if (start && end) {\n      const dist = Math.hypot(end.x - start.x, end.y - start.y, end.z - start.z);\n      dist_string = `${dist.toFixed(2)}m`;\n    }\n\n    return dist_string;\n  }\n\n  render() {\n    return null;\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowDownIcon from \"@mdi/svg/svg/chevron-down.svg\";\nimport ArrowUpIcon from \"@mdi/svg/svg/chevron-up.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport SearchIcon from \"@mdi/svg/svg/magnify.svg\";\nimport { vec3 } from \"gl-matrix\";\nimport { range, throttle } from \"lodash\";\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { type CameraState, cameraStateSelectors } from \"regl-worldview\";\n\nimport Button from \"webviz-core/src/components/Button\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport type { TextMarker, Color } from \"webviz-core/src/types/Messages\";\nimport { useDeepChangeDetector } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const YELLOW = { r: 1, b: 0, g: 1, a: 1 };\nexport const ORANGE = { r: 0.97, g: 0.58, b: 0.02, a: 1 };\n\n// $FlowFixMe - Can't figure this one out.\nexport type GLTextMarker = TextMarker & {\n  highlightedIndices?: number[],\n  highlightColor?: Color,\n};\n\nexport type WorldSearchTextProps = {|\n  searchTextOpen: boolean,\n  searchText: string,\n  setSearchTextMatches: (markers: GLTextMarker[]) => void,\n  searchTextMatches: GLTextMarker[],\n  selectedMatchIndex: number,\n|};\n\nexport type SearchTextProps = {|\n  ...WorldSearchTextProps,\n  toggleSearchTextOpen: (bool: boolean) => void,\n  setSearchText: (searchText: string) => void,\n  setSelectedMatchIndex: (index: number) => void,\n  searchInputRef: {| current: ?HTMLInputElement |},\n|};\n\nexport const getHighlightedIndices = (text?: string, searchText: string): number[] => {\n  const highlightedIndicesSet = new Set();\n  let match;\n  let startingIndex = 0;\n  const lowerCaseSearchText = searchText.toLowerCase();\n  const lowerCaseText = text ? text.toLowerCase() : \"\";\n  while ((match = lowerCaseText.indexOf(lowerCaseSearchText, startingIndex)) !== -1) {\n    range(match, match + searchText.length).forEach((index) => {\n      highlightedIndicesSet.add(index);\n    });\n    startingIndex = match + 1;\n  }\n\n  const highlightedIndices = Array.from(highlightedIndicesSet);\n  return highlightedIndices;\n};\n\nexport const useGLText = ({\n  glTextEnabled,\n  text,\n  searchText,\n  searchTextOpen,\n  selectedMatchIndex,\n  setSearchTextMatches,\n  searchTextMatches,\n}: {|\n  ...WorldSearchTextProps,\n  text: TextMarker[],\n  glTextEnabled: boolean,\n|}): GLTextMarker[] => {\n  // $FlowFixMe - Flow is not understanding the difference between GLText and TextMarker.\n  const glText: GLTextMarker[] = React.useMemo(\n    () => {\n      if (!glTextEnabled) {\n        return text;\n      }\n\n      let numMatches = 0;\n      return text.map((marker, i) => {\n        const scale = {\n          // RViz ignores scale.x/y for text and only uses z\n          x: marker.scale.z,\n          y: marker.scale.z,\n          z: marker.scale.z,\n        };\n\n        if (!searchText || !searchTextOpen) {\n          return { ...marker, scale };\n        }\n\n        const highlightedIndices = getHighlightedIndices(marker.text, searchText);\n\n        if (highlightedIndices.length) {\n          numMatches += 1;\n          const highlightedMarker = {\n            ...marker,\n            scale,\n            highlightColor: selectedMatchIndex + 1 === numMatches ? ORANGE : YELLOW,\n            highlightedIndices,\n          };\n          return highlightedMarker;\n        }\n\n        return { ...marker, scale };\n      });\n    },\n    [glTextEnabled, searchText, searchTextOpen, selectedMatchIndex, text]\n  );\n\n  const throttledSetSearchTextMatches = useCallback(throttle(setSearchTextMatches, 200, { trailing: true }), [\n    setSearchTextMatches,\n  ]);\n\n  useEffect(\n    () => {\n      if (!glTextEnabled || (!searchTextOpen && !searchTextMatches.length)) {\n        return;\n      }\n      const matches = glText.filter((marker) => marker.highlightedIndices && marker.highlightedIndices.length);\n      if (matches.length) {\n        throttledSetSearchTextMatches(matches);\n      } else if (!matches.length && searchTextMatches.length) {\n        throttledSetSearchTextMatches([]);\n      }\n    },\n    [throttledSetSearchTextMatches, glText, glTextEnabled, searchText, searchTextMatches.length, searchTextOpen]\n  );\n\n  return glText;\n};\n\nexport const useSearchText = (): SearchTextProps => {\n  const [searchTextOpen, toggleSearchTextOpen] = useState<boolean>(false);\n  const [searchText, setSearchText] = useState<string>(\"\");\n  const [searchTextMatches, setSearchTextMatches] = useState<GLTextMarker[]>([]);\n  const [selectedMatchIndex, setSelectedMatchIndex] = useState(0);\n  const searchInputRef = useRef<?HTMLInputElement>(null);\n\n  return {\n    searchTextOpen,\n    toggleSearchTextOpen,\n    searchText,\n    setSearchText,\n    setSearchTextMatches,\n    searchTextMatches,\n    selectedMatchIndex,\n    setSelectedMatchIndex,\n    searchInputRef,\n  };\n};\ntype SearchTextComponentProps = {\n  onCameraStateChange: (CameraState) => void,\n  onFollowChange: (newFollowTf?: string | false, newFollowOrientation?: boolean) => void,\n  cameraState: CameraState,\n  rootTf: ?string,\n  transforms: Transforms,\n  ...SearchTextProps,\n};\n\n// Exported for tests.\nexport const useSearchMatches = ({\n  cameraState,\n  currentMatch,\n  onCameraStateChange,\n  rootTf,\n  searchTextOpen,\n  transforms,\n}: {\n  cameraState: CameraState,\n  currentMatch: GLTextMarker,\n  onCameraStateChange: (CameraState) => void,\n  rootTf: ?string,\n  searchTextOpen: boolean,\n  transforms: Transforms,\n}) => {\n  const hasCurrentMatchChanged = useDeepChangeDetector([currentMatch], true);\n  React.useEffect(\n    () => {\n      if (!currentMatch || !searchTextOpen || !rootTf || !hasCurrentMatchChanged) {\n        return;\n      }\n\n      const { header, pose } = currentMatch;\n\n      const output = transforms.apply(\n        { position: { x: 0, y: 0, z: 0 }, orientation: { x: 0, y: 0, z: 0, w: 0 } },\n        pose,\n        header.frame_id,\n        rootTf\n      );\n      if (!output) {\n        return;\n      }\n      const {\n        position: { x, y, z },\n      } = output;\n\n      const targetHeading = cameraStateSelectors.targetHeading(cameraState);\n      const targetOffset = [0, 0, 0];\n      vec3.rotateZ(targetOffset, vec3.subtract(targetOffset, [x, y, z], cameraState.target), [0, 0, 0], targetHeading);\n      onCameraStateChange({ ...cameraState, targetOffset });\n    },\n    [cameraState, currentMatch, hasCurrentMatchChanged, onCameraStateChange, rootTf, searchTextOpen, transforms]\n  );\n};\n\nconst SearchText = React.memo<SearchTextComponentProps>(\n  ({\n    searchTextOpen,\n    toggleSearchTextOpen,\n    searchText,\n    setSearchText,\n    searchInputRef,\n    setSelectedMatchIndex,\n    selectedMatchIndex,\n    searchTextMatches,\n    onCameraStateChange,\n    cameraState,\n    transforms,\n    rootTf,\n    onFollowChange,\n  }: SearchTextComponentProps) => {\n    const currentMatch = searchTextMatches[selectedMatchIndex];\n    const iterateCurrentIndex = useCallback(\n      (iterator: number) => {\n        const newIndex = selectedMatchIndex + iterator;\n        if (newIndex >= searchTextMatches.length) {\n          setSelectedMatchIndex(0);\n        } else if (newIndex < 0) {\n          setSelectedMatchIndex(searchTextMatches.length - 1);\n        } else {\n          setSelectedMatchIndex(newIndex);\n        }\n      },\n      [searchTextMatches, selectedMatchIndex, setSelectedMatchIndex]\n    );\n\n    React.useEffect(\n      () => {\n        if (!searchTextMatches.length) {\n          setSelectedMatchIndex(0);\n        }\n      },\n      [searchTextMatches.length, setSelectedMatchIndex]\n    );\n\n    useSearchMatches({\n      cameraState,\n      currentMatch,\n      onCameraStateChange,\n      rootTf,\n      searchTextOpen,\n      transforms,\n    });\n\n    if (!searchTextOpen) {\n      return (\n        <Button onClick={() => toggleSearchTextOpen(!searchTextOpen)}>\n          <Icon tooltip=\"search text markers\">\n            <SearchIcon />\n          </Icon>\n        </Button>\n      );\n    }\n\n    return (\n      <div\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          flexDirection: \"row\",\n          padding: \"0 4px\",\n          height: \"36px\" /* Hack to match the heights of the other toolbar components */,\n        }}>\n        <div style={{ backgroundColor: \"#1A191F\", padding: \"0px 4px 0px 8px\", borderRadius: \"4px\" }}>\n          <Icon medium>\n            <SearchIcon />\n          </Icon>\n          <input\n            autoFocus\n            ref={searchInputRef}\n            type=\"text\"\n            placeholder=\"Find in scene\"\n            spellCheck={false}\n            value={searchText}\n            style={{ backgroundColor: \"transparent\" }}\n            onChange={(e) => setSearchText(e.target.value)}\n            onKeyDown={(e: KeyboardEvent) => {\n              if (e.key !== \"Enter\") {\n                return;\n              }\n              if (e.shiftKey) {\n                iterateCurrentIndex(-1);\n                return;\n              }\n              iterateCurrentIndex(1);\n            }}\n          />\n          <span style={{ color: colors.TEXT_MUTED, width: \"50px\", display: \"inline-block\" }}>\n            {searchTextMatches.length > 0 ? selectedMatchIndex + 1 : \"0\"} of {searchTextMatches.length}\n          </span>\n        </div>\n        <Icon medium onClick={() => iterateCurrentIndex(-1)}>\n          <ArrowUpIcon />\n        </Icon>\n        <Icon medium onClick={() => iterateCurrentIndex(1)}>\n          <ArrowDownIcon />\n        </Icon>\n        <Icon onClick={() => toggleSearchTextOpen(false)} tooltip=\"[esc]\" medium>\n          <CloseIcon />\n        </Icon>\n      </div>\n    );\n  }\n);\n\nexport default SearchText;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ChevronDownIcon from \"@mdi/svg/svg/chevron-down.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport MagnifyIcon from \"@mdi/svg/svg/magnify.svg\";\nimport LessIcon from \"@mdi/svg/svg/unfold-less-horizontal.svg\";\nimport MoreIcon from \"@mdi/svg/svg/unfold-more-horizontal.svg\";\nimport { Tree } from \"antd\";\nimport React, { useMemo, useRef, useEffect } from \"react\";\nimport styled from \"styled-components\";\n\nimport { type Save3DConfig } from \"../index\";\nimport NoMatchesSvg from \"./noMatches.svg\";\nimport renderTreeNodes, { SWITCHER_WIDTH } from \"./renderTreeNodes\";\nimport TopicTreeSwitcher, { SWITCHER_HEIGHT } from \"./TopicTreeSwitcher\";\nimport TopicViewModeSelector from \"./TopicViewModeSelector\";\nimport { DOT_MENU_WIDTH } from \"./TreeNodeDotMenu\";\nimport { ROW_HEIGHT, ROW_CONTENT_HEIGHT } from \"./TreeNodeRow\";\nimport type {\n  DerivedCustomSettingsByKey,\n  GetIsNamespaceCheckedByDefault,\n  GetIsTreeNodeVisibleInScene,\n  GetIsTreeNodeVisibleInTree,\n  NamespacesByTopic,\n  SceneErrorsByKey,\n  SetCurrentEditingTopic,\n  ToggleNamespaceChecked,\n  ToggleNode,\n  TopicDisplayMode,\n  TreeNode,\n} from \"./types\";\nimport { TOGGLE_WRAPPER_SIZE } from \"./VisibilityToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst CONTAINER_SPACING = 15;\nconst DEFAULT_WIDTH = 360;\nconst DEFAULT_XS_WIDTH = 200;\nconst SEARCH_BAR_HEIGHT = 40;\nconst SWITCHER_ICON_SIZE = 20;\nexport const TREE_SPACING = 8;\nconst MAX_CONTAINER_WIDTH_RATIO = 0.9;\n\nconst MAX_DATA_SOURCE_TOGGLES_WIDTH = TOGGLE_WRAPPER_SIZE;\n\nconst TopicTreeV2Container = styled.div`\n  position: absolute;\n  top: ${CONTAINER_SPACING}px;\n  left: ${CONTAINER_SPACING}px;\n  z-index: 102;\n  max-width: ${MAX_CONTAINER_WIDTH_RATIO * 100}%;\n  .ant-tree {\n    li {\n      ul {\n        padding: 0 0 0 ${SWITCHER_WIDTH}px;\n      }\n    }\n    .ant-tree-node-content-wrapper {\n      cursor: unset;\n    }\n    .ant-tree-switcher {\n      height: ${ROW_HEIGHT}px;\n    }\n    .ant-tree-treenode {\n      padding: 0 ${({ isXSWidth }) => (isXSWidth ? 0 : TREE_SPACING)}px;\n      &:hover {\n        background: ${colors.DARK4};\n      }\n      &.ant-tree-treenode-disabled {\n        color: ${colors.DISABLED};\n        cursor: unset;\n        .ant-tree-node-content-wrapper {\n          cursor: unset;\n        }\n      }\n    }\n    .ant-tree-treenode-switcher-close,\n    .ant-tree-treenode-switcher-open {\n      .ant-tree-node-content-wrapper {\n        padding: 0;\n      }\n    }\n  }\n`;\n\nconst STopicTreeV2 = styled.div`\n  position: relative;\n  color: ${colors.TEXTL1};\n  border-radius: 6px;\n  background-color: ${colors.TOOLBAR};\n  padding-bottom: 6px;\n  max-width: 100%;\n  overflow: auto;\n`;\n\nconst STopicTreeHeader = styled.div`\n  position: sticky;\n  top: 0;\n  z-index: 1;\n  display: flex;\n  padding-left: 8px;\n  align-items: center;\n  background-color: ${colors.DARK5};\n  border-top-left-radius: 6px;\n  border-top-right-radius: 6px;\n`;\n\nconst SFilter = styled.div`\n  display: flex;\n  padding: 8px 4px;\n  align-items: center;\n  flex: 1;\n`;\n\nconst SInput = styled.input`\n  background: transparent;\n  flex: 1;\n  overflow: auto;\n  font-size: 14px;\n  margin-left: 4px;\n  padding: 4px 8px;\n  min-width: 80px;\n  border: none;\n  :focus,\n  :hover {\n    outline: none;\n    background: transparent;\n  }\n`;\n\nconst SSwitcherIcon = styled.span`\n  width: ${SWITCHER_WIDTH}px;\n  height: ${ROW_CONTENT_HEIGHT}px;\n  padding-top: 6px;\n  transition: transform 0.2s ease-in-out;\n  & .ant-tree-switcher_close {\n    transform: rotate(-90deg);\n  }\n  & .ant-tree-switcher_open {\n    transform: rotate(0deg);\n  }\n`;\n\nconst SNoMatches = styled.div`\n  margin-top: 57px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: 74px;\n`;\n\nconst SNoMatchesText = styled.div`\n  margin-top: 25px;\n  font-size: 16px;\n  width: 205px;\n  text-align: center;\n  line-height: 130%;\n`;\n\ntype Props = {|\n  allKeys: string[],\n  availableNamespacesByTopic: NamespacesByTopic,\n  checkedKeys: string[],\n  containerHeight: number,\n  containerWidth: number,\n  derivedCustomSettingsByKey: DerivedCustomSettingsByKey,\n  expandedKeys: string[],\n  filterText: string,\n  getIsNamespaceCheckedByDefault: GetIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene: GetIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree: GetIsTreeNodeVisibleInTree,\n  onExitTopicTreeFocus: () => void,\n  pinTopics: boolean,\n  rootTreeNode: TreeNode,\n  saveConfig: Save3DConfig,\n  sceneErrorsByKey: SceneErrorsByKey,\n  setCurrentEditingTopic: SetCurrentEditingTopic,\n  setFilterText: (string) => void,\n  setShowTopicTree: (boolean) => void,\n  shouldExpandAllKeys: boolean,\n  showTopicTree: boolean,\n  toggleCheckAllAncestors: ToggleNode,\n  toggleCheckAllDescendants: ToggleNode,\n  toggleNamespaceChecked: ToggleNamespaceChecked,\n  toggleNodeChecked: ToggleNode,\n  toggleNodeExpanded: ToggleNode,\n  topicDisplayMode: TopicDisplayMode,\n|};\n\nfunction TopicTreeV2({\n  allKeys,\n  availableNamespacesByTopic,\n  checkedKeys,\n  containerHeight,\n  containerWidth,\n  derivedCustomSettingsByKey,\n  expandedKeys,\n  filterText,\n  getIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree,\n  pinTopics,\n  rootTreeNode,\n  saveConfig,\n  sceneErrorsByKey,\n  setCurrentEditingTopic,\n  setFilterText,\n  setShowTopicTree,\n  shouldExpandAllKeys,\n  showTopicTree,\n  toggleCheckAllAncestors,\n  toggleCheckAllDescendants,\n  toggleNamespaceChecked,\n  toggleNodeChecked,\n  toggleNodeExpanded,\n  topicDisplayMode,\n}: Props) {\n  const renderTopicTree = pinTopics || showTopicTree;\n  const scrollContainerRef = useRef<?HTMLDivElement>();\n  const checkedKeysSet = useMemo(() => new Set(checkedKeys), [checkedKeys]);\n  const treeContainerHeight = containerHeight - CONTAINER_SPACING * 2;\n  const treeHeight = treeContainerHeight - SEARCH_BAR_HEIGHT - SWITCHER_HEIGHT;\n\n  const maxAvailableContainerWidth = Math.floor(containerWidth * MAX_CONTAINER_WIDTH_RATIO);\n  let treeWidth = Math.max(Math.min(maxAvailableContainerWidth, DEFAULT_WIDTH), DEFAULT_XS_WIDTH);\n  const isXSWidth = treeWidth >= maxAvailableContainerWidth;\n  if (!rootTreeNode.providerAvailable) {\n    treeWidth -= MAX_DATA_SOURCE_TOGGLES_WIDTH + DOT_MENU_WIDTH;\n  }\n\n  const filterTextFieldRef = useRef();\n\n  // HACK: Ant Tree does not auto expand dynamic tree nodes. Create a copy of expandedNodes\n  // to ensure newly added nodes such as `uncategorized` are properly expanded:\n  // https://github.com/ant-design/ant-design/issues/18012\n  const expandedKeysRef = useRef(expandedKeys);\n  const hasRootNodeChanged = useChangeDetector([rootTreeNode], false);\n  expandedKeysRef.current = hasRootNodeChanged ? [...expandedKeys] : expandedKeys;\n\n  useEffect(\n    () => {\n      // auto focus whenever first rendering the topic tree\n      if (renderTopicTree && filterTextFieldRef.current) {\n        filterTextFieldRef.current.focus();\n      }\n    },\n    [renderTopicTree]\n  );\n\n  const topLevelNodesCollapsed = useMemo(\n    () => {\n      const topLevelChildren = rootTreeNode.type === \"group\" ? rootTreeNode.children : [];\n      const topLevelKeys = topLevelChildren.map(({ key }) => key);\n      return topLevelKeys.every((key) => !expandedKeys.includes(key));\n    },\n    [expandedKeys, rootTreeNode]\n  );\n\n  const showNoMatchesState = !getIsTreeNodeVisibleInTree(rootTreeNode.key);\n  const headerRightIconStyle = { margin: `4px ${(isXSWidth ? 0 : TREE_SPACING) + 2}px 4px 8px` };\n\n  return (\n    <TopicTreeV2Container\n      isXSWidth={isXSWidth}\n      className=\"ant-component\"\n      style={{ maxHeight: containerHeight - CONTAINER_SPACING * 3 }}>\n      <TopicTreeSwitcher\n        showErrorBadge={!renderTopicTree && Object.keys(sceneErrorsByKey).length > 0}\n        pinTopics={pinTopics}\n        renderTopicTree={renderTopicTree}\n        saveConfig={saveConfig}\n        setShowTopicTree={setShowTopicTree}\n        showTopicTree={showTopicTree}\n      />\n      {renderTopicTree && (\n        <STopicTreeV2 onClick={(e) => e.stopPropagation()}>\n          <div style={{ width: treeWidth }}>\n            <STopicTreeHeader>\n              <SFilter>\n                <Icon style={{ color: \"rgba(255,255,255, 0.3)\" }}>\n                  <MagnifyIcon style={{ width: 16, height: 16 }} />\n                </Icon>\n                <SInput\n                  size={3}\n                  data-test=\"topic-tree-filter-input\"\n                  value={filterText}\n                  placeholder=\"Type to filter\"\n                  onChange={(event) => setFilterText(event.target.value)}\n                  ref={filterTextFieldRef}\n                />\n              </SFilter>\n              {rootTreeNode.providerAvailable && (\n                <TopicViewModeSelector\n                  isXSWidth={isXSWidth}\n                  saveConfig={saveConfig}\n                  topicDisplayMode={topicDisplayMode}\n                />\n              )}\n              {!filterText && (\n                <Icon\n                  dataTest=\"expand-all-icon\"\n                  tooltip={topLevelNodesCollapsed ? \"Expand all\" : \"Collapse all\"}\n                  small\n                  fade\n                  onClick={() => {\n                    saveConfig({ expandedKeys: topLevelNodesCollapsed ? allKeys : [] }, { keepLayoutInUrl: true });\n                  }}\n                  style={headerRightIconStyle}>\n                  {topLevelNodesCollapsed ? <MoreIcon /> : <LessIcon />}\n                </Icon>\n              )}\n              {filterText && (\n                <Icon\n                  dataTest=\"clear-filter-icon\"\n                  small\n                  fade\n                  style={headerRightIconStyle}\n                  onClick={() => setFilterText(\"\")}>\n                  <CloseIcon />\n                </Icon>\n              )}\n            </STopicTreeHeader>\n            <div ref={scrollContainerRef} style={{ overflow: \"auto\", width: treeWidth }}>\n              {showNoMatchesState ? (\n                <SNoMatches>\n                  <NoMatchesSvg />\n                  <SNoMatchesText>No results found. Try searching a different term.</SNoMatchesText>\n                </SNoMatches>\n              ) : (\n                <Tree\n                  treeData={renderTreeNodes({\n                    availableNamespacesByTopic,\n                    checkedKeysSet,\n                    children: rootTreeNode.children || [],\n                    getIsTreeNodeVisibleInScene,\n                    getIsTreeNodeVisibleInTree,\n                    getIsNamespaceCheckedByDefault,\n                    isXSWidth,\n                    sceneErrorsByKey,\n                    setCurrentEditingTopic,\n                    derivedCustomSettingsByKey,\n                    toggleCheckAllAncestors,\n                    toggleCheckAllDescendants,\n                    toggleNamespaceChecked,\n                    toggleNodeChecked,\n                    toggleNodeExpanded,\n                    topicDisplayMode,\n                    width: treeWidth,\n                    filterText,\n                  })}\n                  height={treeHeight}\n                  itemHeight={ROW_HEIGHT}\n                  // Disable motion because it seems to cause a bug in the `rc-tree` (used under the hood by `antd` for\n                  // the tree). This bug would result in nodes no longer being rendered after a search.\n                  motion={null}\n                  selectable={false}\n                  onExpand={(newExpandedKeys) => {\n                    if (!shouldExpandAllKeys) {\n                      saveConfig({ expandedKeys: newExpandedKeys }, { keepLayoutInUrl: true });\n                    }\n                  }}\n                  expandedKeys={shouldExpandAllKeys ? allKeys : expandedKeysRef.current}\n                  autoExpandParent={false /* Set autoExpandParent to true when filtering */}\n                  switcherIcon={\n                    <SSwitcherIcon style={filterText ? { width: 0, height: 0, overflow: \"hidden\" } : {}}>\n                      <ChevronDownIcon\n                        fill=\"currentColor\"\n                        style={{ width: SWITCHER_ICON_SIZE, height: SWITCHER_ICON_SIZE }}\n                      />\n                    </SSwitcherIcon>\n                  }\n                />\n              )}\n            </div>\n          </div>\n        </STopicTreeV2>\n      )}\n    </TopicTreeV2Container>\n  );\n}\n\nexport default React.memo<Props>(TopicTreeV2);\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport AlertCircleIcon from \"@mdi/svg/svg/alert-circle.svg\";\nimport BlockHelperIcon from \"@mdi/svg/svg/block-helper.svg\";\nimport LeadPencilIcon from \"@mdi/svg/svg/lead-pencil.svg\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport NodeName from \"./NodeName\";\nimport { TREE_SPACING } from \"./TopicTreeV2\";\nimport TreeNodeDotMenu, { DOT_MENU_WIDTH } from \"./TreeNodeDotMenu\";\nimport type { TreeNode, ToggleNode, DerivedCustomSettings, SetCurrentEditingTopic } from \"./types\";\nimport VisibilityToggle, { TOGGLE_WRAPPER_SIZE, TOPIC_ROW_PADDING } from \"./VisibilityToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { canEditDatatype } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const ICON_SIZE = 22;\nconst MAX_GROUP_ERROR_WIDTH = 64;\nexport const ROW_CONTENT_HEIGHT = 24;\n\nexport const ROW_HEIGHT = 30;\n\nexport const STreeNodeRow = styled.div`\n  color: ${(props: { visibleInScene: boolean }) => (props.visibleInScene ? \"unset\" : colors.DISABLED)};\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\nexport const SLeft = styled.div`\n  display: flex;\n  align-items: center;\n  flex: 1;\n  min-height: ${TOGGLE_WRAPPER_SIZE}px;\n  padding: ${TOPIC_ROW_PADDING}px 0px;\n`;\n\nconst SErrorCount = styled.small`\n  color: ${colors.RED};\n  width: ${MAX_GROUP_ERROR_WIDTH}px;\n`;\n\nconst SIconWrapper = styled.div`\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: ${ICON_SIZE}px;\n  height: ${ICON_SIZE}px;\n`;\n\nconst SErrorList = styled.ul`\n  max-width: 240px;\n  word-wrap: break-word;\n  padding-left: 16px;\n`;\n\nconst SErrorItem = styled.li`\n  list-style: outside;\n`;\n\nexport const SRightActions = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n`;\n\nexport const SToggles = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\nexport const SDotMenuPlaceholder = styled.span`\n  width: ${DOT_MENU_WIDTH}px;\n  height: ${ROW_HEIGHT}px;\n`;\n\ntype Props = {|\n  checkedKeysSet: Set<string>,\n  hasChildren: boolean,\n  isXSWidth: boolean,\n  node: TreeNode,\n  nodeVisibleInScene: boolean,\n  toggleCheckAllAncestors: ToggleNode,\n  toggleCheckAllDescendants: ToggleNode,\n  toggleNodeChecked: ToggleNode,\n  toggleNodeExpanded: ToggleNode,\n  sceneErrors: ?(string[]),\n  setCurrentEditingTopic: SetCurrentEditingTopic,\n  derivedCustomSettings: ?DerivedCustomSettings,\n  width: number,\n  filterText: string,\n  tooltips?: React.Node[],\n|};\n\nexport default function TreeNodeRow({\n  checkedKeysSet,\n  hasChildren,\n  isXSWidth,\n  node,\n  node: { available, providerAvailable, name, key },\n  nodeVisibleInScene,\n  toggleCheckAllAncestors,\n  toggleCheckAllDescendants,\n  toggleNodeChecked,\n  toggleNodeExpanded,\n  sceneErrors,\n  setCurrentEditingTopic,\n  derivedCustomSettings,\n  width,\n  filterText,\n  tooltips,\n}: Props) {\n  const topicName = node.type === \"topic\" ? node.topicName : \"\";\n  const datatype = node.type === \"topic\" ? node.datatype : undefined;\n  const nodeChecked = checkedKeysSet.has(key);\n\n  const isDefaultSettings = derivedCustomSettings?.isDefaultSettings || !derivedCustomSettings;\n  const showTopicSettings = topicName && datatype && canEditDatatype(datatype);\n  const showTopicSettingsChanged = showTopicSettings && !isDefaultSettings;\n\n  const showTopicError = node.type === \"topic\" && sceneErrors && sceneErrors.length > 0;\n  const showGroupError = node.type === \"group\" && sceneErrors && sceneErrors.length > 0;\n\n  const rowWidth = width - (isXSWidth ? 0 : TREE_SPACING * 2);\n\n  const rightActionWidth = providerAvailable ? TOGGLE_WRAPPER_SIZE + DOT_MENU_WIDTH : DOT_MENU_WIDTH;\n  // -8px to add some spacing between the name and right action area.\n  let maxNodeNameWidth = rowWidth - rightActionWidth - 8;\n\n  if (showTopicSettingsChanged) {\n    maxNodeNameWidth -= ICON_SIZE;\n  }\n  if (showGroupError) {\n    maxNodeNameWidth -= MAX_GROUP_ERROR_WIDTH;\n  }\n  if (showTopicError) {\n    maxNodeNameWidth -= ICON_SIZE;\n  }\n\n  const errorTooltip = sceneErrors && (\n    <SErrorList>\n      {sceneErrors.map((errStr) => (\n        <SErrorItem key={errStr}>{errStr}</SErrorItem>\n      ))}\n    </SErrorList>\n  );\n\n  return (\n    <STreeNodeRow visibleInScene={nodeVisibleInScene} style={{ width: rowWidth }}>\n      <SLeft\n        style={{ cursor: hasChildren && !filterText ? \"pointer\" : \"default\" }}\n        data-test={`name~${key}`}\n        onClick={hasChildren ? () => toggleNodeExpanded(key) : undefined}>\n        <NodeName\n          isXSWidth={isXSWidth}\n          maxWidth={maxNodeNameWidth}\n          displayName={name || topicName}\n          tooltips={tooltips}\n          topicName={topicName}\n          searchText={filterText}\n        />\n        {showTopicSettingsChanged && datatype && (\n          <Icon\n            style={{ padding: \"0 4px\", color: colors.HIGHLIGHT }}\n            fade\n            tooltip=\"Topic settings edited\"\n            onClick={() => setCurrentEditingTopic({ name: topicName, datatype })}>\n            <LeadPencilIcon />\n          </Icon>\n        )}\n        {showGroupError && errorTooltip && sceneErrors && (\n          <Tooltip contents={errorTooltip} placement=\"top\">\n            <SErrorCount>{`${sceneErrors.length} ${sceneErrors.length === 1 ? \"error\" : \"errors\"}`}</SErrorCount>\n          </Tooltip>\n        )}\n        {showTopicError && errorTooltip && (\n          <SIconWrapper>\n            <Icon\n              style={{ color: colors.RED, fontSize: 14, display: \"inline-flex\", alignItems: \"center\" }}\n              small\n              tooltipProps={{ placement: \"top\" }}\n              tooltip={errorTooltip}\n              onClick={(e) => e.stopPropagation()}>\n              <AlertCircleIcon />\n            </Icon>\n          </SIconWrapper>\n        )}\n      </SLeft>\n\n      <SRightActions>\n        {providerAvailable && (\n          <SToggles>\n            {available ? (\n              <VisibilityToggle\n                dataTest={`visibility-toggle~${key}`}\n                overrideColor={derivedCustomSettings?.overrideColor}\n                checked={nodeChecked}\n                onToggle={() => toggleNodeChecked(key)}\n                onShiftToggle={() => toggleCheckAllDescendants(key)}\n                onAltToggle={() => toggleCheckAllAncestors(key)}\n                visibleInScene={nodeVisibleInScene}\n              />\n            ) : (\n              <Icon\n                tooltipProps={{ placement: \"top\" }}\n                tooltip={\n                  node.type === \"group\" ? \"None of the topics in this group are currently available\" : \"Unavailable\"\n                }\n                fade\n                small\n                clickable={false}\n                style={{\n                  fontSize: 12,\n                  cursor: \"not-allowed\",\n                  height: ROW_HEIGHT,\n                  width: TOGGLE_WRAPPER_SIZE,\n                  padding: \"4px 6px\",\n                }}>\n                <BlockHelperIcon />\n              </Icon>\n            )}\n          </SToggles>\n        )}\n        <TreeNodeDotMenu\n          datatype={showTopicSettings ? datatype : undefined}\n          nodeKey={key}\n          setCurrentEditingTopic={setCurrentEditingTopic}\n          toggleCheckAllAncestors={toggleCheckAllAncestors}\n          toggleCheckAllDescendants={toggleCheckAllDescendants}\n          topicName={topicName}\n        />\n      </SRightActions>\n    </STreeNodeRow>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useCallback } from \"react\";\nimport styled from \"styled-components\";\nimport tinyColor from \"tinycolor2\";\n\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const TOPIC_ROW_PADDING = 3;\n\nconst DEFAULT_COLOR = colors.LIGHT1;\nexport const DISABLED_COLOR = colors.DISABLED;\nexport const TOGGLE_WRAPPER_SIZE = 24;\n\nexport const TOGGLE_SIZE_CONFIG = {\n  NORMAL: { name: \"NORMAL\", size: 12 },\n  SMALL: { name: \"SMALL\", size: 8 },\n};\n\nconst SToggle = styled.label`\n  width: ${TOGGLE_WRAPPER_SIZE}px;\n  height: ${TOPIC_ROW_PADDING * 2 + TOGGLE_WRAPPER_SIZE}px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  cursor: pointer;\n  :focus {\n    span {\n      border: 1px solid ${colors.BLUE} !important;\n    }\n  }\n`;\n\nconst SSpan = styled.span`\n  :hover {\n    transform: scale(1.2);\n  }\n`;\n\nexport type Size = $Keys<typeof TOGGLE_SIZE_CONFIG>;\ntype Props = {|\n  checked: boolean,\n  dataTest?: string,\n  onToggle: () => void,\n  onAltToggle?: () => void,\n  onShiftToggle?: () => void,\n  overrideColor?: ?string,\n  size?: ?Size,\n  visibleInScene: boolean,\n|};\n\nfunction getStyles({\n  checked,\n  visibleInScene,\n  overrideColor,\n  size,\n}: {\n  checked: boolean,\n  visibleInScene: boolean,\n  overrideColor: ?string,\n  size: ?Size,\n}): any {\n  const sizeInNumber =\n    size === TOGGLE_SIZE_CONFIG.SMALL.name ? TOGGLE_SIZE_CONFIG.SMALL.size : TOGGLE_SIZE_CONFIG.NORMAL.size;\n  let styles = { width: sizeInNumber, height: sizeInNumber, borderRadius: sizeInNumber / 2 };\n\n  const { enabledColor, disabledColor } = overrideColor\n    ? {\n        enabledColor: overrideColor,\n        disabledColor: tinyColor(overrideColor)\n          .setAlpha(0.5)\n          .toRgbString(),\n      }\n    : { enabledColor: DEFAULT_COLOR, disabledColor: DISABLED_COLOR };\n\n  const color = visibleInScene ? enabledColor : disabledColor;\n  if (checked) {\n    styles = { ...styles, background: color };\n  } else {\n    styles = { ...styles, border: `1px solid ${color}` };\n  }\n\n  return styles;\n}\n\n// A toggle component that supports using tab key to focus and using space key to check/uncheck.\nexport default function VisibilityToggle({\n  dataTest,\n  onToggle,\n  onAltToggle,\n  onShiftToggle,\n  checked,\n  visibleInScene,\n  overrideColor,\n  size,\n}: Props) {\n  // Handle shift + click/enter, option + click/enter, and click/enter.\n  const onChange = useCallback(\n    (e: MouseEvent | KeyboardEvent) => {\n      if (onShiftToggle && e.shiftKey) {\n        onShiftToggle();\n      } else if (onAltToggle && e.altKey) {\n        onAltToggle();\n      } else {\n        onToggle();\n      }\n    },\n    [onAltToggle, onShiftToggle, onToggle]\n  );\n  return (\n    <SToggle\n      data-test={dataTest}\n      tabIndex={0}\n      onKeyDown={(e: KeyboardEvent) => {\n        if (e.key === \"Enter\") {\n          onChange(e);\n        }\n      }}\n      onClick={(e: MouseEvent) => onChange(e)}>\n      <SSpan style={getStyles({ checked, visibleInScene, size, overrideColor })} />\n    </SToggle>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { sortedIndexBy } from \"lodash\";\nimport { type Node } from \"react\";\n\nimport {\n  type DiagnosticStatusArray,\n  type DiagnosticsById,\n  type DiagnosticId,\n  type DiagnosticsByLevel,\n  LEVELS,\n  computeDiagnosticInfo,\n} from \"./util\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message } from \"webviz-core/src/players/types\";\n\nexport type DiagnosticAutocompleteEntry = {|\n  name: string,\n  hardware_id: string,\n  id: DiagnosticId,\n  displayName: string,\n  sortKey: string,\n|};\n\nexport type DiagnosticsBuffer = {|\n  diagnosticsById: DiagnosticsById,\n  sortedAutocompleteEntries: DiagnosticAutocompleteEntry[],\n  diagnosticsByLevel: DiagnosticsByLevel,\n|};\n\ntype Props = {|\n  children: (DiagnosticsBuffer) => Node,\n  topic: string,\n|};\n\n// Exported for tests\nexport function addMessage(buffer: DiagnosticsBuffer, message: Message): DiagnosticsBuffer {\n  const statusArray: DiagnosticStatusArray = message.message;\n  if (statusArray.status.length === 0) {\n    return buffer;\n  }\n  for (const status of statusArray.status) {\n    const info = computeDiagnosticInfo(status, statusArray.header.stamp);\n\n    const oldInfo = buffer.diagnosticsById.get(info.id);\n\n    // update diagnosticsByLevel\n    if (status.level in buffer.diagnosticsByLevel) {\n      buffer.diagnosticsByLevel[status.level].set(info.id, info);\n      // Remove it from the old map if its level has changed.\n      if (oldInfo && oldInfo.status.level !== status.level) {\n        buffer.diagnosticsByLevel[oldInfo.status.level].delete(info.id);\n      }\n    } else {\n      console.warn(\"unrecognized status level\", status);\n    }\n\n    // add to sortedAutocompleteEntries if we haven't seen this id before\n    if (oldInfo === undefined) {\n      const newEntry = {\n        hardware_id: info.status.hardware_id,\n        name: info.status.name,\n        id: info.id,\n        displayName: info.displayName,\n        sortKey: info.displayName.replace(/^\\//, \"\").toLowerCase(),\n      };\n      const index = sortedIndexBy(buffer.sortedAutocompleteEntries, newEntry, \"displayName\");\n      buffer.sortedAutocompleteEntries.splice(index, 0, newEntry);\n    }\n\n    // update diagnosticsById\n    buffer.diagnosticsById.set(info.id, info);\n  }\n  return { ...buffer };\n}\n\n// Exported for tests\nexport function defaultDiagnosticsBuffer(): DiagnosticsBuffer {\n  return {\n    diagnosticsById: new Map(),\n    sortedAutocompleteEntries: [],\n    diagnosticsByLevel: {\n      [LEVELS.OK]: new Map(),\n      [LEVELS.WARN]: new Map(),\n      [LEVELS.ERROR]: new Map(),\n      [LEVELS.STALE]: new Map(),\n    },\n  };\n}\n\nexport function useDiagnostics(topic: string): DiagnosticsBuffer {\n  return PanelAPI.useMessageReducer<DiagnosticsBuffer>({\n    topics: [topic],\n    restore: defaultDiagnosticsBuffer,\n    addMessage,\n  });\n}\n\nexport default function DiagnosticsHistory({ children, topic }: Props) {\n  const diagnostics = useDiagnostics(topic);\n  return children(diagnostics);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { max, min, flatten } from \"lodash\";\nimport React, { memo, useEffect, useCallback, useState, useRef } from \"react\";\nimport DocumentEvents from \"react-document-events\";\nimport ReactDOM from \"react-dom\";\nimport type { Time } from \"rosbag\";\nimport styled from \"styled-components\";\n\nimport TimeBasedChartTooltip from \"./TimeBasedChartTooltip\";\nimport Button from \"webviz-core/src/components/Button\";\nimport createSyncingComponent from \"webviz-core/src/components/createSyncingComponent\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport type { MessageHistoryItem } from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport ChartComponent, { type HoveredElement, type ScaleOptions } from \"webviz-core/src/components/ReactChartjs\";\nimport TimeBasedChartLegend from \"webviz-core/src/components/TimeBasedChart/TimeBasedChartLegend\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport mixins from \"webviz-core/src/styles/mixins.module.scss\";\n\ntype Bounds = {| minX: ?number, maxX: ?number |};\nconst SyncTimeAxis = createSyncingComponent<Bounds, Bounds>(\"SyncTimeAxis\", (dataItems: Bounds[]) => ({\n  minX: min(dataItems.map(({ minX }) => (minX == null ? undefined : minX))),\n  maxX: max(dataItems.map(({ maxX }) => (maxX == null ? undefined : maxX))),\n}));\n\nexport type TimeBasedChartTooltipData = {|\n  x: number,\n  y: number | string,\n  datasetKey?: string,\n  item: MessageHistoryItem,\n  path: string,\n  value: number | boolean | string,\n  constantName?: ?string,\n  startTime: Time,\n|};\n\nexport type DataPoint = {|\n  x: number,\n  y: number | string,\n  label?: string,\n  labelColor?: string,\n|};\n\nconst SRoot = styled.div`\n  position: relative;\n`;\n\nconst SResetZoom = styled.div`\n  position: absolute;\n  bottom: 33px;\n  right: 10px;\n`;\n\nconst SBar = styled.div`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 2px;\n  margin-left: -1px;\n  background: yellow;\n  pointer-events: none;\n  opacity: 0.7;\n  display: none;\n  // \"display\" and \"left\" are set by JS, but outside of React.\n`;\n\nconst SLegend = styled.div`\n  display: flex;\n  width: 10%;\n  min-width: 90px;\n  overflow-y: auto;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: start;\n  padding: 30px 0px 10px 0px;\n`;\n\nconst MemoizedTooltips = memo<{}>(function Tooltips() {\n  return (\n    <React.Fragment>\n      <Tooltip contents={<div>Hold v to only scroll vertically</div>} delay={0}>\n        <div style={{ position: \"absolute\", left: 0, top: 0, width: 30, bottom: 0 }} />\n      </Tooltip>\n      <Tooltip placement=\"top\" contents={<div>Hold h to only scroll horizontally</div>} delay={0}>\n        <div style={{ position: \"absolute\", left: 0, right: 0, height: 30, bottom: 0 }} />\n      </Tooltip>\n    </React.Fragment>\n  );\n});\n\ntype Props = {|\n  type: \"scatter\" | \"multicolorLine\",\n  width: number,\n  height: number,\n  zoom: boolean,\n  data: any,\n  tooltips?: TimeBasedChartTooltipData[],\n  xAxes?: any,\n  yAxes: any,\n  annotations?: any[],\n  drawLegend?: boolean,\n  isSynced?: boolean,\n  canToggleLines?: boolean,\n  toggleLine?: (datasetId: string | typeof undefined, lineToHide: string) => void,\n  linesToHide?: { [string]: boolean },\n  datasetId?: string,\n  onClick?: (SyntheticMouseEvent<HTMLCanvasElement>, datalabel: ?any) => void,\n  saveCurrentYs?: (minY: number, maxY: number) => void,\n  xAxisVal?: \"timestamp\" | \"index\" | \"custom\",\n  plugins?: any,\n  scaleOptions?: ?ScaleOptions,\n|};\n\n// Create a chart with any y-axis but with an x-axis that shows time since the\n// start of the bag, and which is kept in sync with other instances of this\n// component. Uses chart.js internally, with a zoom/pan plugin, and with our\n// standard tooltips.\nexport default memo<Props>(function TimeBasedChart(props: Props) {\n  const chartComponent = useRef<?ChartComponent>(null);\n  const tooltip = useRef<?HTMLDivElement>(null);\n  const hasUnmounted = useRef<boolean>(false);\n  const bar = useRef<?HTMLDivElement>(null);\n\n  const [hasUserPanOrZoomed, setHasUserPannedOrZoomed] = useState(false);\n  const [, forceUpdate] = useState();\n\n  const onVisibilityChange = useCallback(\n    () => {\n      if (document.visibilityState === \"visible\") {\n        // HACK: There is a Chrome bug that causes 2d canvas elements to get cleared when the page\n        // becomes hidden on certain hardware:\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=588434\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=591374\n        // We can hack around this by forcing a re-render when the page becomes visible again.\n        // There may be other canvases that this affects, but these seemed like the most important.\n        // Ideally we can find a global workaround but we're not sure there is one — can't just\n        // twiddle the width/height attribute of the canvas as suggested in one of the comments on\n        // a chrome bug; it seems like you really have to redraw the frame from scratch.\n        forceUpdate();\n      }\n    },\n    [forceUpdate]\n  );\n  useEffect(\n    () => {\n      document.addEventListener(\"visibilitychange\", onVisibilityChange);\n      return () => {\n        document.removeEventListener(\"visibilitychange\", onVisibilityChange);\n      };\n    },\n    [onVisibilityChange]\n  );\n\n  const pauseFrame = useMessagePipeline(useCallback((messagePipeline) => messagePipeline.pauseFrame, []));\n\n  const onChartUpdate = useCallback(\n    () => {\n      const resumeFrame = pauseFrame(\"TimeBasedChart\");\n      return () => {\n        resumeFrame();\n      };\n    },\n    [pauseFrame]\n  );\n\n  const { saveCurrentYs, yAxes } = props;\n  const yAxisScaleId = yAxes[0]?.id;\n  const onScaleBoundsUpdate = useCallback(\n    (scales) => {\n      const firstYScale = scales.find(({ id }) => id === yAxisScaleId);\n      if (firstYScale && saveCurrentYs && typeof firstYScale.min === \"number\" && typeof firstYScale.max === \"number\") {\n        saveCurrentYs(firstYScale.min, firstYScale.max);\n      }\n    },\n    [yAxisScaleId, saveCurrentYs]\n  );\n\n  const onPanZoom = useCallback(\n    () => {\n      if (!hasUserPanOrZoomed) {\n        setHasUserPannedOrZoomed(true);\n      }\n    },\n    [hasUserPanOrZoomed, setHasUserPannedOrZoomed]\n  );\n\n  const onResetZoom = useCallback(\n    () => {\n      if (chartComponent.current) {\n        chartComponent.current.resetZoom();\n        setHasUserPannedOrZoomed(false);\n      }\n    },\n    [setHasUserPannedOrZoomed]\n  );\n\n  const [hasVerticalExclusiveZoom, setHasVerticalExclusiveZoom] = useState<boolean>(false);\n  const [hasHorizontalExclusiveZoom, setHasHorizontalExclusiveZoom] = useState<boolean>(false);\n  let zoomMode = \"xy\";\n  if (hasVerticalExclusiveZoom && hasHorizontalExclusiveZoom) {\n    zoomMode = \"xy\";\n  } else if (hasVerticalExclusiveZoom) {\n    zoomMode = \"y\";\n  } else if (hasHorizontalExclusiveZoom) {\n    zoomMode = \"x\";\n  }\n  const keyDownHandlers = React.useMemo(\n    () => ({\n      v: () => setHasVerticalExclusiveZoom(true),\n      h: () => setHasHorizontalExclusiveZoom(true),\n    }),\n    [setHasVerticalExclusiveZoom, setHasHorizontalExclusiveZoom]\n  );\n  const keyUphandlers = React.useMemo(\n    () => ({\n      v: () => setHasVerticalExclusiveZoom(false),\n      h: () => setHasHorizontalExclusiveZoom(false),\n    }),\n    [setHasVerticalExclusiveZoom, setHasHorizontalExclusiveZoom]\n  );\n\n  const removeTooltip = useCallback(() => {\n    if (tooltip.current) {\n      ReactDOM.unmountComponentAtNode(tooltip.current);\n    }\n    if (tooltip.current && tooltip.current.parentNode) {\n      // Satisfy flow.\n      tooltip.current.parentNode.removeChild(tooltip.current);\n      tooltip.current = null;\n    }\n  }, []);\n  // Always clean up tooltips when unmounting.\n  useEffect(\n    () => {\n      return () => {\n        hasUnmounted.current = true;\n        removeTooltip();\n      };\n    },\n    [removeTooltip]\n  );\n\n  const tooltips = props.tooltips || [];\n  // We use a custom tooltip so we can style it more nicely, and so that it can break\n  // out of the bounds of the canvas, in case the panel is small.\n  const updateTooltip = useCallback(\n    (currentChartComponent: ChartComponent, canvas: HTMLCanvasElement, tooltipItem: ?HoveredElement) => {\n      // This is an async callback, so it can fire after this component is unmounted. Make sure that we remove the\n      // tooltip if this fires after unmount.\n      if (!tooltipItem || hasUnmounted.current) {\n        return removeTooltip();\n      }\n\n      // We have to iterate through all of the tooltips every time the user hovers over a point. However, the cost of\n      // running this search is small (< 10ms even with many tooltips) compared to the cost of indexing tooltips by\n      // coordinates and we care more about render time than tooltip responsiveness.\n      const tooltipData = tooltips.find(\n        (_tooltip) => _tooltip.x === tooltipItem.data.x && String(_tooltip.y) === String(tooltipItem.data.y)\n      );\n      if (!tooltipData) {\n        return removeTooltip();\n      }\n\n      if (!tooltip.current) {\n        tooltip.current = document.createElement(\"div\");\n        if (canvas.parentNode) {\n          canvas.parentNode.appendChild(tooltip.current);\n        }\n      }\n\n      if (tooltip.current) {\n        ReactDOM.render(\n          <TimeBasedChartTooltip tooltip={tooltipData}>\n            <div style={{ position: \"absolute\", left: tooltipItem.view.x, top: tooltipItem.view.y }} />\n          </TimeBasedChartTooltip>,\n          tooltip.current\n        );\n      }\n    },\n    [removeTooltip, tooltips]\n  );\n\n  const onMouseMove = useCallback(\n    async (event: MouseEvent) => {\n      const currentChartComponent = chartComponent.current;\n      if (!currentChartComponent || !currentChartComponent.canvas) {\n        removeTooltip();\n        if (bar.current && bar.current.style) {\n          bar.current.style.display = \"none\";\n        }\n        return;\n      }\n      const { canvas } = currentChartComponent;\n      const canvasRect = canvas.getBoundingClientRect();\n      if (\n        event.pageX < canvasRect.left ||\n        event.pageX > canvasRect.right ||\n        event.pageY < canvasRect.top ||\n        event.pageY > canvasRect.bottom\n      ) {\n        removeTooltip();\n        if (bar.current && bar.current.style) {\n          bar.current.style.display = \"none\";\n        }\n        return;\n      }\n\n      const xMousePosition = event.pageX - canvasRect.left;\n      if (bar.current && bar.current.style) {\n        bar.current.style.display = \"block\";\n        bar.current.style.left = `${xMousePosition}px`;\n      }\n\n      const isTargetingCanvas = event.target === canvas;\n      if (!isTargetingCanvas) {\n        removeTooltip();\n        return;\n      }\n\n      if (tooltips && tooltips.length) {\n        const tooltipElement = await currentChartComponent.getElementAtXAxis(event);\n        updateTooltip(currentChartComponent, canvas, tooltipElement);\n      } else {\n        removeTooltip();\n      }\n    },\n    [updateTooltip, removeTooltip, tooltips]\n  );\n\n  const getChartjsOptions = (minX: ?number, maxX: ?number) => {\n    const { xAxes } = props;\n    const plugins = props.plugins || {};\n    const annotations = props.annotations || [];\n\n    // We create these objects every time so that they can be modified.\n    const defaultXTicksSettings = {\n      fontFamily: mixins.monospaceFont,\n      fontSize: 10,\n      fontColor: \"#eee\",\n      maxRotation: 0,\n    };\n    const defaultYTicksSettings = {\n      fontFamily: mixins.monospaceFont,\n      fontSize: 10,\n      fontColor: \"#eee\",\n      padding: 0,\n    };\n    const defaultXAxis = {\n      ticks: defaultXTicksSettings,\n      gridLines: { color: \"rgba(255, 255, 255, 0.2)\", zeroLineColor: \"rgba(255, 255, 255, 0.2)\" },\n    };\n\n    const options = {\n      maintainAspectRatio: false,\n      animation: { duration: 0 },\n      responsiveAnimationDuration: 0,\n      legend: { display: false },\n      // Disable splines, they seem to cause weird rendering artifacts:\n      elements: { line: { tension: 0 } },\n      hover: {\n        intersect: false,\n        mode: \"x\",\n      },\n      tooltips: {\n        intersect: false,\n        mode: \"x\",\n        enabled: false, // Disable native tooltips since we use custom ones.\n      },\n      scales: {\n        xAxes: xAxes\n          ? xAxes.map((xAxis) => {\n              const axis = {\n                ...defaultXAxis,\n                ...xAxis,\n                ticks: {\n                  ...defaultXTicksSettings,\n                  ...xAxis.ticks,\n                },\n              };\n              return axis;\n            })\n          : [defaultXAxis],\n        yAxes: yAxes.map((yAxis) => {\n          const ticks = {\n            ...defaultYTicksSettings,\n            ...yAxis.ticks,\n          };\n          // If the user is manually panning or zooming, don't constrain the y-axis\n          if (hasUserPanOrZoomed) {\n            delete ticks.min;\n            delete ticks.max;\n          }\n\n          return {\n            ...yAxis,\n            ticks,\n          };\n        }),\n      },\n      plugins,\n      annotation: { annotations },\n    };\n    if (!hasUserPanOrZoomed) {\n      // $FlowFixMe\n      options.scales.xAxes[0].ticks.min = minX;\n      // $FlowFixMe\n      options.scales.xAxes[0].ticks.max = maxX;\n    }\n    return options;\n  };\n\n  const {\n    datasetId,\n    type,\n    width,\n    height,\n    drawLegend,\n    canToggleLines,\n    toggleLine,\n    data,\n    isSynced,\n    onClick,\n    linesToHide = {},\n    scaleOptions,\n  } = props;\n  const xAxisVal = props.xAxisVal || \"timestamp\";\n  const xVals = flatten(data.datasets.map(({ data: pts }) => (pts.length > 1 ? pts.map(({ x }) => x) : undefined)));\n  const [minX, maxX] = [min(xVals), max(xVals)];\n\n  const chartProps = {\n    type,\n    width,\n    height,\n    key: `${width}x${height}`,\n    ref: chartComponent,\n    data: { ...data, datasets: data.datasets.filter((dataset) => !linesToHide[dataset.label]) },\n    onScaleBoundsUpdate,\n    onPanZoom,\n    onClick,\n    zoomOptions: {\n      ...ChartComponent.defaultProps.zoomOptions,\n      enabled: props.zoom,\n      mode: zoomMode,\n    },\n    scaleOptions,\n    onChartUpdate,\n  };\n\n  const hasData = chartProps.data.datasets.some((dataset) => dataset.data.length);\n\n  return (\n    <div style={{ display: \"flex\", width: \"100%\" }}>\n      <div style={{ display: \"flex\", width }}>\n        <SRoot onDoubleClick={onResetZoom}>\n          <SBar ref={bar} />\n\n          {/* only sync when using x-axis timestamp and actually plotting data. */}\n          {isSynced && xAxisVal === \"timestamp\" && hasData ? (\n            <SyncTimeAxis data={{ minX, maxX }}>\n              {(syncedMinMax) => {\n                const syncedMinX = syncedMinMax.minX != null ? min([minX, syncedMinMax.minX]) : minX;\n                const syncedMaxX = syncedMinMax.maxX != null ? max([maxX, syncedMinMax.maxX]) : maxX;\n                return <ChartComponent {...chartProps} options={getChartjsOptions(syncedMinX, syncedMaxX)} />;\n              }}\n            </SyncTimeAxis>\n          ) : (\n            <ChartComponent {...chartProps} options={getChartjsOptions(minX, maxX)} />\n          )}\n\n          {hasUserPanOrZoomed && (\n            <SResetZoom>\n              <Button tooltip=\"(shortcut: double-click)\" onClick={onResetZoom}>\n                reset view\n              </Button>\n            </SResetZoom>\n          )}\n\n          {/* Handle tooltips while dragging by checking all document events. */}\n          <DocumentEvents capture onMouseDown={onMouseMove} onMouseUp={onMouseMove} onMouseMove={onMouseMove} />\n          <KeyListener global keyDownHandlers={keyDownHandlers} keyUpHandlers={keyUphandlers} />\n        </SRoot>\n      </div>\n      {props.zoom && <MemoizedTooltips />}\n      {drawLegend && (\n        <SLegend>\n          <TimeBasedChartLegend\n            datasetId={datasetId}\n            canToggleLines={canToggleLines}\n            datasets={data.datasets}\n            linesToHide={linesToHide}\n            toggleLine={toggleLine || (() => {})}\n          />\n        </SLegend>\n      )}\n    </div>\n  );\n});\n","// @flow\n\n/* eslint-disable header/header */\n\n// This file is forked from https://github.com/jerairrest/react-chartjs-2/tree/111f3590a008b8211217e613b5531fb00c3a431b.\n// We are upgrading this wrapper of Chart.js to handle rendering Chart.js within a worker.\n\n// The follow license applies to this file only:\n\n// The MIT License (MIT)\n\n// Copyright (c) 2017 Jeremy Ayerst\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n// documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the\n// Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE\n// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n// COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nimport Hammer from \"hammerjs\";\nimport React from \"react\";\nimport uuid from \"uuid\";\n\nimport { type ScaleOptions as ManagerScaleOptions } from \"./ChartJSManager\";\nimport MainThreadChartJSWorker from \"./ChartJSWorker\";\nimport ChartJSWorker from \"./ChartJSWorker.worker\";\nimport { type ScaleBounds, type ZoomOptions, type PanOptions, wheelZoomHandler } from \"./zoomAndPanHelpers\";\nimport { getFakeRpcs, type RpcLike } from \"webviz-core/src/util/FakeRpc\";\nimport supportsOffscreenCanvas from \"webviz-core/src/util/supportsOffscreenCanvas\";\nimport WebWorkerManager from \"webviz-core/src/util/WebWorkerManager\";\n\nexport type HoveredElement = any;\nexport type ScaleOptions = ManagerScaleOptions;\ntype OnEndChartUpdate = () => void;\n\ntype Props = {|\n  id?: string,\n  data: any,\n  height: number,\n  width: number,\n  legend?: any,\n  options: any,\n  type: string,\n  zoomOptions: ZoomOptions,\n  panOptions: PanOptions,\n  onScaleBoundsUpdate?: (ScaleBounds[]) => void,\n  onPanZoom?: () => void,\n  onClick?: (SyntheticMouseEvent<HTMLCanvasElement>, datalabel: ?any) => void,\n  forceDisableWorkerRendering?: ?boolean,\n  scaleOptions?: ?ScaleOptions,\n  onChartUpdate?: () => OnEndChartUpdate,\n|};\n\nconst devicePixelRatio = window.devicePixelRatio || 1;\n\nconst webWorkerManager = new WebWorkerManager(ChartJSWorker, 8);\n\nclass ChartComponent extends React.PureComponent<Props> {\n  canvas: ?HTMLCanvasElement;\n  _chartRpc: ?RpcLike;\n  // $FlowFixMe\n  _node: OffscreenCanvas;\n  _id = uuid.v4();\n  _scaleBoundsByScaleId = {};\n  _usingWebWorker = false;\n  _onEndChartUpdateCallbacks = {};\n\n  constructor(props: Props) {\n    super(props);\n    this._getRpc();\n  }\n\n  static defaultProps = {\n    legend: {\n      display: true,\n      position: \"bottom\",\n    },\n    type: \"doughnut\",\n    height: 150,\n    width: 300,\n    options: {},\n    zoomOptions: { mode: \"xy\", enabled: true, sensitivity: 3, speed: 0.1 },\n    panOptions: { mode: \"xy\", enabled: true, speed: 20, threshold: 10 },\n  };\n\n  _getRpc = (): RpcLike => {\n    if (this._chartRpc) {\n      return this._chartRpc;\n    }\n\n    if (!this.props.forceDisableWorkerRendering && supportsOffscreenCanvas()) {\n      // Only use a real chart worker if we support offscreenCanvas.\n      this._chartRpc = webWorkerManager.registerWorkerListener(this._id);\n      this._usingWebWorker = true;\n    } else {\n      // Otherwise use a fake RPC so that we don't have to maintain two separate APIs.\n      const { mainThreadRpc, workerRpc } = getFakeRpcs();\n      new MainThreadChartJSWorker(workerRpc);\n      this._chartRpc = mainThreadRpc;\n      this._usingWebWorker = false;\n    }\n    return this._chartRpc;\n  };\n\n  componentDidMount() {\n    const { type, data, options, scaleOptions, width, height } = this.props;\n    // $FlowFixMe\n    if (!this.canvas.transferControlToOffscreen) {\n      // TODO add fallback.\n      throw new Error(\"ReactChartJS currently only works with browsers with offscreen canvas support\");\n    }\n\n    this._setupPanAndPinchHandlers();\n\n    let node = this.canvas;\n    if (!this.props.forceDisableWorkerRendering && supportsOffscreenCanvas()) {\n      // $FlowFixMe\n      node = this.canvas.transferControlToOffscreen();\n    }\n    this._node = node;\n    this._getRpc()\n      .send(\n        \"initialize\",\n        {\n          node,\n          id: this._id,\n          type,\n          data,\n          options,\n          scaleOptions,\n          devicePixelRatio,\n          width,\n          height,\n        },\n        [node]\n      )\n      .then((scaleBoundsUpdate) => this._onUpdateScaleBounds(scaleBoundsUpdate));\n  }\n\n  componentDidUpdate() {\n    const { data, options, scaleOptions, width, height, onChartUpdate } = this.props;\n    let chartUpdateId;\n    if (onChartUpdate) {\n      const onEndChartUpdate = onChartUpdate();\n      chartUpdateId = uuid.v4();\n      this._onEndChartUpdateCallbacks[chartUpdateId] = onEndChartUpdate;\n    }\n    this._getRpc()\n      .send(\"update\", {\n        id: this._id,\n        data,\n        options,\n        scaleOptions,\n        width,\n        height,\n      })\n      .then((scaleBoundsUpdate) => {\n        this._onUpdateScaleBounds(scaleBoundsUpdate);\n      })\n      .finally(() => {\n        if (this._onEndChartUpdateCallbacks[chartUpdateId]) {\n          this._onEndChartUpdateCallbacks[chartUpdateId]();\n          delete this._onEndChartUpdateCallbacks[chartUpdateId];\n        }\n      });\n  }\n\n  componentWillUnmount() {\n    // If this component will unmount, resolve any pending update callbacks.\n    // $FlowFixMe\n    Object.values(this._onEndChartUpdateCallbacks).forEach((callback) => callback());\n    this._onEndChartUpdateCallbacks = {};\n\n    if (this._chartRpc) {\n      this._chartRpc.send(\"destroy\", { id: this._id });\n      this._chartRpc = null;\n\n      if (this._usingWebWorker) {\n        webWorkerManager.unregisterWorkerListener(this._id);\n      }\n    }\n  }\n\n  _ref = (element: ?HTMLCanvasElement) => {\n    this.canvas = element;\n  };\n\n  getElementAtXAxis = async (event: SyntheticMouseEvent<any> | MouseEvent): Promise<?HoveredElement> => {\n    if (!this.canvas) {\n      return Promise.resolve(undefined);\n    }\n\n    const boundingRect = this.canvas.getBoundingClientRect();\n    if (\n      event.clientX < boundingRect.left ||\n      event.clientX > boundingRect.right ||\n      event.clientY < boundingRect.top ||\n      event.clientY > boundingRect.bottom\n    ) {\n      return Promise.resolve(undefined);\n    }\n\n    const newEvent = {\n      native: true,\n      x: event.clientX - boundingRect.left,\n      y: event.clientY - boundingRect.top,\n    };\n    return this._getRpc().send(\"getElementAtXAxis\", { id: this._id, event: newEvent });\n  };\n\n  // Pan/zoom section\n\n  resetZoom = async () => {\n    const scaleBoundsUpdate = await this._getRpc().send(\"resetZoom\", { id: this._id });\n    this._onUpdateScaleBounds(scaleBoundsUpdate);\n  };\n\n  _panning = false;\n  _currentDeltaX = null;\n  _currentDeltaY = null;\n  _currentPinchScaling = 1;\n\n  _setupPanAndPinchHandlers() {\n    const { threshold } = this.props.panOptions;\n    const hammerManager = new Hammer.Manager(this.canvas);\n    hammerManager.add(new Hammer.Pinch());\n    hammerManager.add(new Hammer.Pan({ threshold }));\n\n    const hammerPanHandler = async (event: any) => {\n      if (!this.props.panOptions.enabled) {\n        return;\n      }\n      if (this._currentDeltaX != null && this._currentDeltaY != null) {\n        const deltaX = event.deltaX - this._currentDeltaX;\n        const deltaY = event.deltaY - this._currentDeltaY;\n        this._currentDeltaX = event.deltaX;\n        this._currentDeltaY = event.deltaY;\n        const scaleBoundsUpdate = await this._getRpc().send(\"doPan\", {\n          id: this._id,\n          panOptions: this.props.panOptions,\n          deltaX,\n          deltaY,\n        });\n        this._onPanZoom();\n        this._onUpdateScaleBounds(scaleBoundsUpdate);\n      }\n    };\n\n    hammerManager.on(\"panstart\", (event) => {\n      this._panning = true;\n      this._currentDeltaX = 0;\n      this._currentDeltaY = 0;\n      hammerPanHandler(event);\n    });\n    hammerManager.on(\"panmove\", hammerPanHandler);\n    hammerManager.on(\"panend\", () => {\n      this._currentDeltaX = null;\n      this._currentDeltaY = null;\n      this._getRpc().send(\"resetPanDelta\", this._id);\n      setTimeout(() => {\n        this._panning = false;\n      }, 500);\n    });\n\n    // TODO: pinch gestures only kind of work right now - the built-in browser pinch zoom takes over if pinch is too\n    // aggressive. Figure out why this is happening and fix it. This is almost identical to the original plugin that\n    // does not have this problem.\n    const handlePinch = async (e) => {\n      if (!this.props.panOptions.enabled) {\n        return;\n      }\n      const diff = (1 / this._currentPinchScaling) * e.scale;\n      const rect = e.target.getBoundingClientRect();\n      const offsetX = e.center.x - rect.left;\n      const offsetY = e.center.y - rect.top;\n      const center = {\n        x: offsetX,\n        y: offsetY,\n      };\n\n      // fingers position difference\n      const x = Math.abs(e.pointers[0].clientX - e.pointers[1].clientX);\n      const y = Math.abs(e.pointers[0].clientY - e.pointers[1].clientY);\n\n      // diagonal fingers will change both (xy) axes\n      const p = x / y;\n      let xy;\n      if (p > 0.3 && p < 1.7) {\n        xy = \"xy\";\n      } else if (x > y) {\n        xy = \"x\"; // x axis\n      } else {\n        xy = \"y\"; // y axis\n      }\n\n      // Keep track of overall scale\n      this._currentPinchScaling = e.scale;\n\n      const scaleBoundsUpdate = await this._getRpc().send(\"doZoom\", {\n        id: this._id,\n        zoomOptions: this.props.zoomOptions,\n        percentZoomX: diff,\n        percentZoomY: diff,\n        focalPoint: center,\n        whichAxesParam: xy,\n      });\n      this._onPanZoom();\n      this._onUpdateScaleBounds(scaleBoundsUpdate);\n    };\n\n    hammerManager.on(\"pinchstart\", () => {\n      this._currentPinchScaling = 1; // reset tracker\n    });\n    hammerManager.on(\"pinch\", handlePinch);\n    hammerManager.on(\"pinchend\", (e) => {\n      handlePinch(e);\n      this._currentPinchScaling = 1; // reset\n      this._getRpc().send(\"resetZoomDelta\", { id: this._id });\n    });\n  }\n\n  _onWheel = async (event: SyntheticWheelEvent<HTMLCanvasElement>) => {\n    if (!this.props.zoomOptions.enabled) {\n      return;\n    }\n    const { percentZoomX, percentZoomY, focalPoint } = wheelZoomHandler(event, this.props.zoomOptions);\n    const scaleBoundsUpdate = await this._getRpc().send(\"doZoom\", {\n      id: this._id,\n      zoomOptions: this.props.zoomOptions,\n      percentZoomX,\n      percentZoomY,\n      focalPoint,\n      whichAxesParam: \"xy\",\n    });\n    this._onPanZoom();\n    this._onUpdateScaleBounds(scaleBoundsUpdate);\n  };\n\n  _onPanZoom = () => {\n    if (this.props.onPanZoom) {\n      this.props.onPanZoom();\n    }\n  };\n\n  _onUpdateScaleBounds = (scaleBoundsUpdate: ScaleBounds[]) => {\n    if (this.props.onScaleBoundsUpdate && scaleBoundsUpdate) {\n      this.props.onScaleBoundsUpdate(scaleBoundsUpdate);\n    }\n  };\n\n  _onClick = async (event: SyntheticMouseEvent<HTMLCanvasElement>) => {\n    const { onClick } = this.props;\n    if (!this._panning && onClick && this.canvas) {\n      const rect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      const newEvent = { x, y };\n      // Since our next call is asynchronous, we have to persist the event so that React doesn't clear it.\n      event.persist();\n      const datalabel = await this._getRpc().send(\"getDatalabelAtEvent\", { id: this._id, event: newEvent });\n      onClick(event, datalabel);\n    }\n  };\n\n  render() {\n    const { height, width, id } = this.props;\n\n    return (\n      <canvas\n        ref={this._ref}\n        height={height / devicePixelRatio}\n        width={width / devicePixelRatio}\n        id={id}\n        onWheel={this._onWheel}\n        onClick={this._onClick}\n        style={{ width, height }}\n      />\n    );\n  }\n}\n\nexport default ChartComponent;\n","// @flow\n\n// This code is mostly forked from chartjs-plugin-zoom, with the goal of splitting the DOM access and the chart access\n// so that we can move Chart.js behind a web worker.\n// Link: https://github.com/chartjs/chartjs-plugin-zoom/tree/6a97a22b99e0325597b7bd7b38b083dde4949a60\n\n// The MIT License (MIT)\n// Copyright (c) 2013-2016 Nick Downie\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n// documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the\n// Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE\n// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n// COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n/* eslint-disable header/header */\n\nimport cloneDeep from \"lodash/cloneDeep\";\n\nexport type ZoomOptions = $ReadOnly<{\n  mode: \"xy\" | \"x\" | \"y\",\n  enabled: boolean,\n  speed: number,\n  sensitivity: number,\n}>;\nexport type PanOptions = $ReadOnly<{\n  mode: \"xy\" | \"x\" | \"y\",\n  enabled: boolean,\n  speed: number,\n  threshold: number,\n}>;\nexport type ScaleBounds = {| id: string, min: ?number, max: ?number |};\n\ntype ChartInstance = any;\n\n// ZOOM FUNCTIONS\n\nconst zoomCumulativeDeltaByChartId = {};\n\nfunction zoomCategoryScale(scale, zoom, center, zoomOptions, chartId) {\n  const labels = scale.chart.data.labels;\n  let minIndex = scale.minIndex;\n  const lastLabelIndex = labels.length - 1;\n  let maxIndex = scale.maxIndex;\n  const sensitivity = zoomOptions.sensitivity;\n  const chartCenter = scale.isHorizontal() ? scale.left + scale.width / 2 : scale.top + scale.height / 2;\n  const centerPointer = scale.isHorizontal() ? center.x : center.y;\n\n  zoomCumulativeDeltaByChartId[chartId] = zoomCumulativeDeltaByChartId[chartId] || 0;\n  zoomCumulativeDeltaByChartId[chartId] =\n    zoom > 1 ? zoomCumulativeDeltaByChartId[chartId] + 1 : zoomCumulativeDeltaByChartId[chartId] - 1;\n\n  if (Math.abs(zoomCumulativeDeltaByChartId[chartId]) > sensitivity) {\n    if (zoomCumulativeDeltaByChartId[chartId] < 0) {\n      if (centerPointer >= chartCenter) {\n        if (minIndex <= 0) {\n          maxIndex = Math.min(lastLabelIndex, maxIndex + 1);\n        } else {\n          minIndex = Math.max(0, minIndex - 1);\n        }\n      } else if (centerPointer < chartCenter) {\n        if (maxIndex >= lastLabelIndex) {\n          minIndex = Math.max(0, minIndex - 1);\n        } else {\n          maxIndex = Math.min(lastLabelIndex, maxIndex + 1);\n        }\n      }\n      zoomCumulativeDeltaByChartId[chartId] = 0;\n    } else if (zoomCumulativeDeltaByChartId[chartId] > 0) {\n      if (centerPointer >= chartCenter) {\n        minIndex = minIndex < maxIndex ? (minIndex = Math.min(maxIndex, minIndex + 1)) : minIndex;\n      } else if (centerPointer < chartCenter) {\n        maxIndex = maxIndex > minIndex ? (maxIndex = Math.max(minIndex, maxIndex - 1)) : maxIndex;\n      }\n      zoomCumulativeDeltaByChartId[chartId] = 0;\n    }\n    scale.options.ticks.min = labels[minIndex];\n    scale.options.ticks.max = labels[maxIndex];\n  }\n}\n\nfunction zoomNumericalScale(scale, zoom, center, zoomOptions) {\n  const range = scale.max - scale.min;\n  const newDiff = range * (zoom - 1);\n\n  const centerPoint = scale.isHorizontal() ? center.x : center.y;\n  const minPercent = (scale.getValueForPixel(centerPoint) - scale.min) / range;\n  const maxPercent = 1 - minPercent;\n\n  const minDelta = newDiff * minPercent;\n  const maxDelta = newDiff * maxPercent;\n\n  scale.options.ticks.min = scale.min + minDelta;\n  scale.options.ticks.max = scale.max - maxDelta;\n}\n\nfunction zoomTimeScale(scale, zoom, center, zoomOptions) {\n  zoomNumericalScale(scale, zoom, center, zoomOptions);\n\n  const options = scale.options;\n  if (options.time) {\n    if (options.time.min) {\n      options.time.min = options.ticks.min;\n    }\n    if (options.time.max) {\n      options.time.max = options.ticks.max;\n    }\n  }\n}\n\nconst zoomFunctions = {\n  category: zoomCategoryScale,\n  time: zoomTimeScale,\n  linear: zoomNumericalScale,\n  logarithmic: zoomNumericalScale,\n};\n\nfunction zoomScale(scale, zoom, center, zoomOptions, chartId) {\n  const fn = zoomFunctions[scale.type];\n  if (fn) {\n    fn(scale, zoom, center, zoomOptions, chartId);\n  }\n}\n\nconst originalOptionsByChartId = {};\n\nfunction storeOriginalOptions(chartId: string, chart: ChartInstance) {\n  originalOptionsByChartId[chartId] = originalOptionsByChartId[chartId] || {};\n  Object.keys(chart.scales).forEach((scaleKey) => {\n    const scale = chart.scales[scaleKey];\n    if (!originalOptionsByChartId[chartId][scale.id]) {\n      originalOptionsByChartId[chartId][scale.id] = cloneDeep(scale.options);\n    }\n  });\n  Object.keys(originalOptionsByChartId[chartId]).forEach((key) => {\n    if (!chart.scales[key]) {\n      delete originalOptionsByChartId[chartId][key];\n    }\n  });\n}\n\nfunction directionEnabled(mode, dir) {\n  if (mode === undefined) {\n    return true;\n  } else if (typeof mode === \"string\") {\n    return mode.indexOf(dir) !== -1;\n  }\n\n  return false;\n}\n\nexport function doZoom(\n  chartId: string,\n  chartInstance: ChartInstance,\n  zoomOptions: ZoomOptions,\n  percentZoomX: number,\n  percentZoomY: number,\n  focalPoint?: { x: number, y: number },\n  whichAxesParam?: string\n) {\n  const ca = chartInstance.chartArea;\n\n  if (!focalPoint) {\n    focalPoint = {\n      x: (ca.left + ca.right) / 2,\n      y: (ca.top + ca.bottom) / 2,\n    };\n  }\n\n  if (zoomOptions.enabled) {\n    storeOriginalOptions(chartId, chartInstance);\n    // Do the zoom here\n    const zoomMode = zoomOptions.mode;\n\n    // Which axe should be modified when fingers were used.\n    let whichAxes;\n    if (zoomOptions.mode === \"xy\" && whichAxes !== undefined) {\n      // based on fingers positions\n      whichAxes = whichAxesParam;\n    } else {\n      // no effect\n      whichAxes = \"xy\";\n    }\n\n    Object.keys(chartInstance.scales).forEach((scaleKey) => {\n      const scale = chartInstance.scales[scaleKey];\n      if (scale.isHorizontal() && directionEnabled(zoomMode, \"x\") && directionEnabled(whichAxes, \"x\")) {\n        zoomScale(scale, percentZoomX, focalPoint, zoomOptions, chartId);\n      } else if (!scale.isHorizontal() && directionEnabled(zoomMode, \"y\") && directionEnabled(whichAxes, \"y\")) {\n        zoomScale(scale, percentZoomY, focalPoint, zoomOptions, chartId);\n      }\n    });\n\n    chartInstance.update(0);\n  }\n}\n\nexport function resetZoomDelta(chartId: string) {\n  zoomCumulativeDeltaByChartId[chartId] = 0;\n}\n\n// PAN OPTIONS\n\nconst panCumulativeDeltaByChartId = {};\n\nfunction panCategoryScale(scale, delta, panOptions, chartId) {\n  const labels = scale.chart.data.labels;\n  const lastLabelIndex = labels.length - 1;\n  const offsetAmt = Math.max(scale.ticks.length, 1);\n  const panSpeed = panOptions.speed;\n  let minIndex = scale.minIndex;\n  const step = Math.round(scale.width / (offsetAmt * panSpeed));\n\n  panCumulativeDeltaByChartId[chartId] = panCumulativeDeltaByChartId[chartId] || 0;\n  panCumulativeDeltaByChartId[chartId] += delta;\n\n  minIndex =\n    panCumulativeDeltaByChartId[chartId] > step\n      ? Math.max(0, minIndex - 1)\n      : panCumulativeDeltaByChartId[chartId] < -step\n      ? Math.min(lastLabelIndex - offsetAmt + 1, minIndex + 1)\n      : minIndex;\n  panCumulativeDeltaByChartId[chartId] = minIndex !== scale.minIndex ? 0 : panCumulativeDeltaByChartId[chartId];\n\n  const maxIndex = Math.min(lastLabelIndex, minIndex + offsetAmt - 1);\n\n  scale.options.ticks.min = labels[minIndex];\n  scale.options.ticks.max = labels[maxIndex];\n}\n\nfunction panNumericalScale(scale, delta, panOptions) {\n  const tickOpts = scale.options.ticks;\n  const prevStart = scale.min;\n  const prevEnd = scale.max;\n  let newMin = scale.getValueForPixel(scale.getPixelForValue(prevStart) - delta);\n  let newMax = scale.getValueForPixel(scale.getPixelForValue(prevEnd) - delta);\n  // The time scale returns date objects so convert to numbers. Can remove at Chart.js v3\n  newMin = newMin.valueOf ? newMin.valueOf() : newMin;\n  newMax = newMax.valueOf ? newMax.valueOf() : newMax;\n  tickOpts.min = newMin;\n  tickOpts.max = newMax;\n}\n\nfunction panTimeScale(scale, delta, panOptions) {\n  panNumericalScale(scale, delta, panOptions);\n\n  const options = scale.options;\n  if (options.time) {\n    if (options.time.min) {\n      options.time.min = options.ticks.min;\n    }\n    if (options.time.max) {\n      options.time.max = options.ticks.max;\n    }\n  }\n}\n\nconst panFunctions = {\n  category: panCategoryScale,\n  time: panTimeScale,\n  linear: panNumericalScale,\n  logarithmic: panNumericalScale,\n};\n\nfunction panScale(scale, delta, panOptions, chartId) {\n  const fn = panFunctions[scale.type];\n  if (fn) {\n    fn(scale, delta, panOptions, chartId);\n  }\n}\n\nexport function doPan(\n  chartId: string,\n  chartInstance: ChartInstance,\n  panOptions: PanOptions,\n  deltaX: number,\n  deltaY: number\n) {\n  storeOriginalOptions(chartId, chartInstance);\n  if (panOptions.enabled) {\n    const panMode = panOptions.mode;\n\n    Object.keys(chartInstance.scales).forEach((scaleKey) => {\n      const scale = chartInstance.scales[scaleKey];\n      if (scale.isHorizontal() && directionEnabled(panMode, \"x\") && deltaX !== 0) {\n        panScale(scale, deltaX, panOptions, chartId);\n      } else if (!scale.isHorizontal() && directionEnabled(panMode, \"y\") && deltaY !== 0) {\n        panScale(scale, deltaY, panOptions, chartId);\n      }\n    });\n\n    chartInstance.update(0);\n  }\n}\n\nexport function resetPanDelta(chartId: string) {\n  panCumulativeDeltaByChartId[chartId] = 0;\n}\n\nexport function resetZoom(chartId: string, chartInstance: ChartInstance) {\n  storeOriginalOptions(chartId, chartInstance);\n  const originalOptions = originalOptionsByChartId[chartId];\n  Object.keys(chartInstance.scales).forEach((scaleKey) => {\n    const scale = chartInstance.scales[scaleKey];\n    const timeOptions = scale.options.time;\n    const tickOptions = scale.options.ticks;\n\n    if (originalOptions[scale.id]) {\n      if (timeOptions) {\n        timeOptions.min = originalOptions[scale.id].time.min;\n        timeOptions.max = originalOptions[scale.id].time.max;\n      }\n\n      if (tickOptions) {\n        tickOptions.min = originalOptions[scale.id].ticks.min;\n        tickOptions.max = originalOptions[scale.id].ticks.max;\n      }\n    } else {\n      if (timeOptions) {\n        delete timeOptions.min;\n        delete timeOptions.max;\n      }\n\n      if (tickOptions) {\n        delete tickOptions.min;\n        delete tickOptions.max;\n      }\n    }\n  });\n\n  chartInstance.update();\n}\n\n// MISC\n\nexport function wheelZoomHandler(event: SyntheticWheelEvent<HTMLCanvasElement>, zoomOptions: ZoomOptions) {\n  const rect = event.currentTarget.getBoundingClientRect();\n  const offsetX = event.clientX - rect.left;\n  const offsetY = event.clientY - rect.top;\n\n  const center = { x: offsetX, y: offsetY };\n\n  let speedPercent = zoomOptions.speed;\n\n  if (event.deltaY >= 0) {\n    speedPercent = -speedPercent;\n  }\n\n  // Prevent the event from triggering the default behavior (eg. Content scrolling).\n  if (event.cancelable) {\n    event.preventDefault();\n  }\n\n  return {\n    percentZoomX: 1 + speedPercent,\n    percentZoomY: 1 + speedPercent,\n    focalPoint: center,\n  };\n}\n\nexport function getScaleBounds(chartInstance: ChartInstance): ScaleBounds[] {\n  return Object.keys(chartInstance.scales).map((scaleKey) => {\n    const scale = chartInstance.scales[scaleKey];\n    let min, max;\n\n    const timeOptions = scale.options.time;\n    const tickOptions = scale.options.ticks;\n    if (timeOptions) {\n      min = timeOptions.min;\n      max = timeOptions.max;\n    }\n    if (tickOptions) {\n      min = tickOptions.min;\n      max = tickOptions.max;\n    }\n\n    return { id: scale.id, min, max };\n  });\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport memoize from \"lodash/memoize\";\n\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\n\nconst supportsOffscreenCanvas: () => boolean = memoize(\n  (): boolean => {\n    try {\n      // $FlowFixMe This is a function that is not yet in Flow.\n      document.createElement(\"canvas\").transferControlToOffscreen();\n    } catch (error) {\n      sendNotification(\n        \"Rendering to a canvas in a worker is unsupported in this browser, falling back to rendering using the main thread\",\n        \"\",\n        \"app\",\n        \"warn\"\n      );\n      return false;\n    }\n    return true;\n  }\n);\n\nexport default supportsOffscreenCanvas;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport findIndex from \"lodash/findIndex\";\nimport sortBy from \"lodash/sortBy\";\n\nimport Rpc from \"webviz-core/src/util/Rpc\";\nimport { setupReceiveReportErrorHandler } from \"webviz-core/src/util/RpcUtils\";\n\n// This file provides a convenient way to set up and tear down workers as needed. It will create only a single worker\n// of each class, and terminate the worker when all listeners are unregistered.\n\ntype WorkerListenerState = {| rpc: Rpc, worker: any, listenerIds: string[] |};\n\nexport default class WebWorkerManager {\n  _classType: any;\n  _maxWorkerCount: number;\n  _workerStates: (?WorkerListenerState)[];\n  _allListeners: Set<string>;\n\n  constructor(classType: any, maxWorkerCount: number) {\n    this._classType = classType;\n    this._maxWorkerCount = maxWorkerCount;\n    this._workerStates = new Array(maxWorkerCount);\n    this._allListeners = new Set();\n  }\n\n  testing_getWorkerState(id: string): ?WorkerListenerState {\n    return this._workerStates.find((workerState) => workerState && workerState.listenerIds.includes(id));\n  }\n\n  registerWorkerListener(id: string): Rpc {\n    if (this._allListeners.has(id)) {\n      throw new Error(\"cannot register the same listener id twice\");\n    }\n    this._allListeners.add(id);\n\n    const currentWorkerCount = this._workerStates.filter(Boolean).length;\n    if (currentWorkerCount < this._maxWorkerCount) {\n      const worker = new this._classType();\n      const rpc = new Rpc(worker);\n      setupReceiveReportErrorHandler(rpc);\n\n      const emptyIndex = findIndex(this._workerStates, (x) => !x);\n      this._workerStates[emptyIndex] = { worker, rpc, listenerIds: [id] };\n      return rpc;\n    }\n    const workerStateByListenerCount = sortBy(\n      this._workerStates.filter(Boolean),\n      (workerState) => workerState && workerState.listenerIds.length\n    );\n    const workerState = workerStateByListenerCount[0];\n    workerState.listenerIds.push(id);\n    return workerState.rpc;\n  }\n\n  unregisterWorkerListener(id: string) {\n    if (!this._allListeners.has(id)) {\n      throw new Error(\"Cannot find listener to unregister\");\n    }\n    this._allListeners.delete(id);\n\n    const workerStateIndex = findIndex(\n      this._workerStates,\n      (workerState) => workerState && workerState.listenerIds.includes(id)\n    );\n    const workerState = this._workerStates[workerStateIndex];\n    if (workerStateIndex >= 0 && workerState) {\n      workerState.listenerIds = workerState.listenerIds.filter((_id) => _id !== id);\n      if (workerState.listenerIds.length === 0) {\n        this._workerStates[workerStateIndex] = undefined;\n        workerState.worker.terminate();\n      }\n    }\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { TimestampMethod } from \"webviz-core/src/util/time\";\n\nexport type BasePlotPath = {\n  value: string,\n  enabled: boolean,\n};\n\nexport type PlotPath = BasePlotPath & {\n  timestampMethod: TimestampMethod,\n};\n\n// A \"reference line\" plot path is a numeric value. It creates a horizontal line on the plot at the specified value.\nexport function isReferenceLinePlotPathType(path: BasePlotPath): boolean {\n  return !isNaN(Number.parseFloat(path.value));\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport tinycolor from \"tinycolor2\";\n\nexport const toolsColorScheme = {\n  base: {\n    dark: \"#1F1E27\",\n    medium: \"#8B8B8D\",\n    light: \"#F7F7F3\",\n  },\n  red: {\n    dark: \"#F24366\",\n    medium: \"#ff7c96\",\n    light: \"#FFAABB\",\n  },\n  blue: {\n    dark: \"#1b83ec\",\n    medium: \"#4e98e2\",\n    light: \"#77AADD\",\n  },\n  paleGreen: {\n    dark: \"#B4CC00\",\n    medium: \"#cad660\",\n    light: \"#CDD67E\",\n  },\n  orange: {\n    dark: \"#ea531f\",\n    medium: \"#f5774d\",\n    light: \"#faa487\",\n  },\n  cyan: {\n    dark: \"#22b5ff\",\n    medium: \"#61cbff\",\n    light: \"#99DDFF\",\n  },\n  green: {\n    dark: \"#05d27d\",\n    medium: \"#5cd6a9\",\n    light: \"#8de0c9\",\n  },\n  purple: {\n    dark: \"#6E51EE\",\n    medium: \"#a395e2\",\n    light: \"#c7c0e7\",\n  },\n  yellow: {\n    dark: \"#EDCC28\",\n    medium: \"#f7df71\",\n    light: \"#f1e4a\",\n  },\n};\n\nexport const grey = tinycolor(`hsv(0, 0%, 75%)`).toHexString();\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { reject } from \"lodash\";\n\n// toggles an item in an array based on reference equality\n// or an optional predicate to determine if the item should be toggled in/out\n// this function is pure - it always returns a new array\nexport default function toggle<T>(array: T[], item: T, predicate: (T) => boolean = (el) => el === item): T[] {\n  const newArray = reject(array, predicate);\n  if (newArray.length === array.length) {\n    newArray.push(item);\n  }\n  return newArray;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { getPath, memoizedGetLinkedGlobalVariablesKeyByName } from \"../interactionUtils\";\nimport useLinkedGlobalVariables, { type LinkedGlobalVariable } from \"../useLinkedGlobalVariables\";\nimport { SGlobalVariableLink, SPath, GlobalVariableName } from \"./index\";\nimport UnlinkWrapper from \"./UnlinkWrapper\";\nimport Button from \"webviz-core/src/components/Button\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\nconst SForm = styled.form`\n  background-color: ${colors.toolbar};\n  margin-left: 8px;\n  width: 320px;\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\n  pointer-events: auto;\n  flex: 0 0 auto;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst SExistingLinks = styled.div`\n  margin-bottom: 8px;\n`;\n\nconst SList = styled.ul`\n  margin: 12px 6px;\n`;\n\nconst SListItem = styled.li`\n  display: flex;\n  align-items: center;\n  margin: 6px;\n  width: 100%;\n  overflow: hidden;\n`;\n\nconst STopicWithPath = styled.span`\n  margin-left: 12px;\n  margin-right: 12px;\n  flex: 1 1 0;\n  overflow-wrap: break-word;\n  overflow: hidden;\n`;\n\ntype Props = {\n  name: string,\n  showList?: boolean,\n};\n\nexport default function UnlinkGlobalVariables({ name, showList }: Props) {\n  const { linkedGlobalVariables, setLinkedGlobalVariables } = useLinkedGlobalVariables();\n  const linkedGlobalVariablesKeyByName = memoizedGetLinkedGlobalVariablesKeyByName(linkedGlobalVariables);\n  const links: LinkedGlobalVariable[] = linkedGlobalVariablesKeyByName[name] || [];\n\n  if (links.length === 0) {\n    return null;\n  }\n\n  const listStyle = showList ? { marginLeft: 0, marginRight: 0 } : {};\n\n  // the list UI is shared between 3D panel and Global Variables panel\n  const listHtml = (\n    <SList style={listStyle}>\n      {links.map(({ topic, markerKeyPath, name: linkedGlobalVariableName }, idx) => {\n        return (\n          <SListItem key={idx} style={listStyle}>\n            <Button\n              danger\n              small\n              style={{ flexShrink: 0 }}\n              onClick={() => {\n                const newLinkedGlobalVariables = linkedGlobalVariables.filter(\n                  (linkedGlobalVariable) =>\n                    !(\n                      linkedGlobalVariable.topic === topic &&\n                      isEqual(linkedGlobalVariable.markerKeyPath, markerKeyPath) &&\n                      linkedGlobalVariable.name === linkedGlobalVariableName\n                    )\n                );\n                setLinkedGlobalVariables(newLinkedGlobalVariables);\n              }}>\n              Unlink\n            </Button>\n            <STopicWithPath>\n              {topic}.<SPath>{getPath(markerKeyPath)}</SPath>\n            </STopicWithPath>\n          </SListItem>\n        );\n      })}\n    </SList>\n  );\n  if (showList) {\n    return (\n      <SExistingLinks>\n        <p style={{ marginTop: 0, lineHeight: \"1.4\" }}>\n          Some links already exist for this variable. The variable’s value will be taken from the most recently clicked\n          linked topic.\n        </p>\n        {listHtml}\n      </SExistingLinks>\n    );\n  }\n\n  return (\n    <SGlobalVariableLink>\n      <UnlinkWrapper\n        tooltip={\n          <span>\n            Unlink <GlobalVariableName name={name} />\n          </span>\n        }\n        linkedGlobalVariable={links[0]}>\n        {() => <SForm data-test=\"unlink-form\">{listHtml}</SForm>}\n      </UnlinkWrapper>\n    </SGlobalVariableLink>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport LinkVariantOffIcon from \"@mdi/svg/svg/link-variant-off.svg\";\nimport LinkVariantIcon from \"@mdi/svg/svg/link-variant.svg\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { type LinkedGlobalVariable } from \"../useLinkedGlobalVariables\";\nimport { GlobalVariableName } from \"./index\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\n\nconst SUnlinkWrapper = styled.span`\n  flex-direction: row;\n  display: inline-flex;\n  align-items: center;\n`;\n\nconst SIconWrapper = styled.span`\n  .icon {\n    /* TODO(Audrey): remove the hard-coded icon style once we clean up 3D panel styles   */\n    width: 15px !important;\n    height: 15px !important;\n    font-size: 15px !important;\n  }\n  .linked-icon {\n    opacity: 1;\n    display: inline-block;\n  }\n  .link-off-icon {\n    opacity: 0;\n    display: none;\n  }\n  &:hover {\n    .linked-icon {\n      opacity: 0;\n      display: none;\n    }\n    .link-off-icon {\n      opacity: 1;\n      display: inline-block;\n    }\n  }\n`;\n\ntype Props = {\n  linkedGlobalVariable: LinkedGlobalVariable,\n  style?: any,\n  children: ({\n    setIsOpen: (boolean) => void,\n    linkedGlobalVariable: LinkedGlobalVariable,\n  }) => React.Node,\n  tooltip?: React.Node,\n};\n\nexport default function UnlinkWrapper({ style, children, linkedGlobalVariable, tooltip }: Props) {\n  const [isOpen, setIsOpen] = React.useState<boolean>(false);\n  return (\n    <>\n      <SUnlinkWrapper>\n        <ChildToggle\n          dataTest={`unlink-${linkedGlobalVariable.name}`}\n          position=\"above\"\n          onToggle={() => setIsOpen(!isOpen)}\n          isOpen={isOpen}>\n          <SIconWrapper>\n            <Icon\n              fade\n              tooltipProps={{\n                contents: tooltip || (\n                  <span>\n                    Unlink this field from <GlobalVariableName name={linkedGlobalVariable.name} />\n                  </span>\n                ),\n              }}>\n              <LinkVariantOffIcon className=\"link-off-icon\" />\n              <LinkVariantIcon className=\"linked-icon\" />\n            </Icon>\n          </SIconWrapper>\n          <span>{children({ setIsOpen, linkedGlobalVariable })}</span>\n        </ChildToggle>\n      </SUnlinkWrapper>\n      <GlobalVariableName name={linkedGlobalVariable.name} leftPadding />\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport ConsoleLineIcon from \"@mdi/svg/svg/console-line.svg\";\nimport PlusMinusIcon from \"@mdi/svg/svg/plus-minus.svg\";\nimport LessIcon from \"@mdi/svg/svg/unfold-less-horizontal.svg\";\nimport MoreIcon from \"@mdi/svg/svg/unfold-more-horizontal.svg\";\nimport { first, get, isEqual, last } from \"lodash\";\nimport React, { useState, useCallback, useMemo } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport ReactHoverObserver from \"react-hover-observer\";\nimport Tree from \"react-json-tree\";\n\nimport { HighlightedValue, SDiffSpan } from \"./Diff\";\nimport { type ValueAction, getValueActionForValue, getStructureItemForPath } from \"./getValueActionForValue\";\nimport helpContent from \"./index.help.md\";\nimport styles from \"./index.module.scss\";\nimport Metadata from \"./Metadata\";\nimport RawMessagesIcons from \"./RawMessagesIcons\";\nimport { DATA_ARRAY_PREVIEW_LIMIT, getMessageDocumentationLink, getItemString, getItemStringForDiff } from \"./utils\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport type { RosPath, MessagePathStructureItem } from \"webviz-core/src/components/MessagePathSyntax/constants\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport {\n  messagePathStructures,\n  traverseStructure,\n} from \"webviz-core/src/components/MessagePathSyntax/messagePathsForDatatype\";\nimport parseRosPath from \"webviz-core/src/components/MessagePathSyntax/parseRosPath\";\nimport {\n  useCachedGetMessagePathDataItems,\n  type MessagePathDataItem,\n} from \"webviz-core/src/components/MessagePathSyntax/useCachedGetMessagePathDataItems\";\nimport { useLatestMessageDataItem } from \"webviz-core/src/components/MessagePathSyntax/useLatestMessageDataItem\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { useDataSourceInfo, useMessagesByTopic } from \"webviz-core/src/PanelAPI\";\nimport getDiff, { diffLabels, diffLabelsByLabelText } from \"webviz-core/src/panels/RawMessages/getDiff\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { jsonTreeTheme } from \"webviz-core/src/util/globalConstants\";\nimport { enumValuesByDatatypeAndField } from \"webviz-core/src/util/selectors\";\n\nexport const PREV_MSG_METHOD = \"previous message\";\nexport type RawMessagesConfig = {|\n  topicPath: string,\n  diffMethod: \"custom\" | \"previous message\",\n  diffTopicPath: string,\n  diffEnabled: boolean,\n  showFullMessageForDiff: boolean,\n|};\n\ntype Props = {\n  config: RawMessagesConfig,\n  saveConfig: ($Shape<RawMessagesConfig>) => void,\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n};\n\nconst isSingleElemArray = (obj) => Array.isArray(obj) && obj.filter((a) => a != null).length === 1;\nconst dataWithoutWrappingArray = (data) => {\n  return isSingleElemArray(data) && typeof data[0] === \"object\" ? data[0] : data;\n};\n\nfunction RawMessages(props: Props) {\n  const { config, saveConfig, openSiblingPanel } = props;\n  const { topicPath, diffMethod, diffTopicPath, diffEnabled, showFullMessageForDiff } = config;\n  const { topics, datatypes } = useDataSourceInfo();\n\n  const topicRosPath: ?RosPath = useMemo(() => parseRosPath(topicPath), [topicPath]);\n  const topic: ?Topic = useMemo(() => topicRosPath && topics.find(({ name }) => name === topicRosPath.topicName), [\n    topicRosPath,\n    topics,\n  ]);\n  const rootStructureItem: ?MessagePathStructureItem = useMemo(\n    () => {\n      if (!topic || !topicRosPath) {\n        return;\n      }\n      return traverseStructure(messagePathStructures(datatypes)[topic.datatype], topicRosPath.messagePath)\n        .structureItem;\n    },\n    [datatypes, topic, topicRosPath]\n  );\n\n  // When expandAll is unset, we'll use expandedFields to get expanded info\n  const [expandAll, setExpandAll] = useState(false);\n  const [expandedFields, setExpandedFields] = useState(() => new Set());\n\n  const topicName = topicRosPath?.topicName || \"\";\n  const consecutiveMsgs = useMessagesByTopic({ topics: [topicName], historySize: 2 })[topicName];\n  const cachedGetMessagePathDataItems = useCachedGetMessagePathDataItems([topicPath]);\n  const prevTickMsg = consecutiveMsgs[consecutiveMsgs.length - 2];\n  const [prevTickObj, currTickObj] = [\n    prevTickMsg && { message: prevTickMsg, queriedData: cachedGetMessagePathDataItems(topicPath, prevTickMsg) || [] },\n    useLatestMessageDataItem(topicPath),\n  ];\n  const diffTopicObj = useLatestMessageDataItem(diffEnabled ? diffTopicPath : \"\");\n\n  const inTimetickDiffMode = diffEnabled && diffMethod === PREV_MSG_METHOD;\n  const baseItem = inTimetickDiffMode ? prevTickObj : currTickObj;\n  const diffItem = inTimetickDiffMode ? currTickObj : diffTopicObj;\n\n  const onTopicPathChange = useCallback(\n    (newTopicPath: string) => {\n      saveConfig({ topicPath: newTopicPath });\n    },\n    [saveConfig]\n  );\n\n  const onDiffTopicPathChange = useCallback(\n    (newDiffTopicPath: string) => {\n      saveConfig({ diffTopicPath: newDiffTopicPath });\n    },\n    [saveConfig]\n  );\n\n  const onToggleDiff = useCallback(\n    () => {\n      saveConfig({ diffEnabled: !diffEnabled });\n    },\n    [diffEnabled, saveConfig]\n  );\n\n  const onToggleExpandAll = useCallback(\n    () => {\n      setExpandedFields(new Set());\n      setExpandAll(!expandAll);\n    },\n    [expandAll]\n  );\n\n  const onLabelClick = useCallback(\n    (keypath: string[]) => {\n      // Create a unique key according to the keypath / raw\n      const key = keypath.join(\"~\");\n      const expandedFieldsCopy = new Set(expandedFields);\n      if (expandedFieldsCopy.has(key)) {\n        expandedFieldsCopy.delete(key);\n        setExpandedFields(expandedFieldsCopy);\n      } else {\n        expandedFieldsCopy.add(key);\n        setExpandedFields(expandedFieldsCopy);\n      }\n      setExpandAll(null);\n    },\n    [expandedFields]\n  );\n\n  const valueRenderer = useCallback(\n    (\n      structureItem: ?MessagePathStructureItem,\n      data: mixed[],\n      queriedData: MessagePathDataItem[],\n      label: string,\n      itemValue: mixed,\n      ...keyPath: (number | string)[]\n    ) => (\n      <ReactHoverObserver className={styles.iconWrapper}>\n        {({ isHovering }) => {\n          // $FlowFixMe: We make sure to always pass in a number at the end, but that's hard to express in Flow.\n          const lastKeyPath: number = last(keyPath);\n          let valueAction: ?ValueAction;\n          if (isHovering && structureItem) {\n            valueAction = getValueActionForValue(data[lastKeyPath], structureItem, keyPath.slice(0, -1).reverse());\n          }\n\n          let constantName: ?string;\n          if (structureItem) {\n            const childStructureItem = getStructureItemForPath(\n              structureItem,\n              keyPath\n                .slice(0, -1)\n                .reverse()\n                .join(\",\")\n            );\n            if (childStructureItem) {\n              const field = keyPath[0];\n              if (typeof field === \"string\") {\n                const enumMapping = enumValuesByDatatypeAndField(datatypes);\n                const datatype = childStructureItem.datatype;\n                if (enumMapping[datatype] && enumMapping[datatype][field] && enumMapping[datatype][field][itemValue]) {\n                  constantName = enumMapping[datatype][field][itemValue];\n                }\n              }\n            }\n          }\n          const basePath: string = queriedData[lastKeyPath].path;\n          let itemLabel = label;\n          // output preview for the first x items if the data is in binary format\n          // sample output: Int8Array(331776) [-4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, ...]\n          let smallNumberArrayStr = \"\";\n          if (ArrayBuffer.isView(itemValue)) {\n            // $FlowFixMe flow doesn't know itemValue is an array\n            smallNumberArrayStr = `(${itemValue.length}) [${itemValue.slice(0, DATA_ARRAY_PREVIEW_LIMIT).join(\", \")}${\n              // $FlowFixMe\n              itemValue.length >= DATA_ARRAY_PREVIEW_LIMIT ? \", ...\" : \"\"\n            }] `;\n            // $FlowFixMe\n            itemLabel = itemValue.constructor.name;\n          }\n          if (constantName) {\n            itemLabel = `${itemLabel} (${constantName})`;\n          }\n          return (\n            <span>\n              <HighlightedValue itemLabel={itemLabel} keyPath={keyPath} />\n              {smallNumberArrayStr && (\n                <>\n                  {smallNumberArrayStr}\n                  <Icon\n                    fade\n                    className={styles.icon}\n                    onClick={() => console.log(itemValue)}\n                    tooltip=\"Log data to browser console\">\n                    <ConsoleLineIcon />\n                  </Icon>\n                </>\n              )}\n              <span className={styles.iconBox}>\n                {valueAction && (\n                  <RawMessagesIcons\n                    valueAction={valueAction}\n                    basePath={basePath}\n                    onTopicPathChange={onTopicPathChange}\n                    openSiblingPanel={openSiblingPanel}\n                  />\n                )}\n              </span>\n            </span>\n          );\n        }}\n      </ReactHoverObserver>\n    ),\n    [datatypes, onTopicPathChange, openSiblingPanel]\n  );\n\n  const renderSingleTopicOrDiffOutput = useCallback(\n    () => {\n      let shouldExpandNode;\n      if (expandAll !== null) {\n        shouldExpandNode = () => expandAll;\n      } else {\n        shouldExpandNode = (keypath, data, level) => {\n          return expandedFields.has(keypath.join(\"~\"));\n        };\n      }\n\n      if (!topicPath) {\n        return <EmptyState>No topic selected</EmptyState>;\n      }\n      if (diffEnabled && diffMethod === \"custom\" && (!baseItem || !diffItem)) {\n        return <EmptyState>{`Waiting to diff next messages from \"${topicPath}\" and \"${diffTopicPath}\"`}</EmptyState>;\n      }\n      if (!baseItem) {\n        return <EmptyState>Waiting for next message</EmptyState>;\n      }\n\n      const data = dataWithoutWrappingArray(baseItem.queriedData.map(({ value }) => (value: any)));\n      const hideWrappingArray = baseItem.queriedData.length === 1 && typeof baseItem.queriedData[0].value === \"object\";\n      const link = getMessageDocumentationLink(baseItem.message.datatype);\n      const shouldDisplaySingleVal =\n        (data !== undefined && typeof data !== \"object\") ||\n        (isSingleElemArray(data) && data[0] !== undefined && typeof data[0] !== \"object\");\n      const singleVal = isSingleElemArray(data) ? data[0] : data;\n\n      const diffData = diffItem && dataWithoutWrappingArray(diffItem.queriedData.map(({ value }) => (value: any)));\n      const diff = diffEnabled && getDiff(data, diffData, null, showFullMessageForDiff);\n      const diffLabelTexts = Object.keys(diffLabels).map((key) => diffLabels[key].labelText);\n\n      const CheckboxComponent = showFullMessageForDiff ? CheckboxMarkedIcon : CheckboxBlankOutlineIcon;\n      return (\n        <Flex col clip scroll className={styles.container}>\n          <Metadata\n            data={data}\n            diffData={diffData}\n            diff={diff}\n            link={link}\n            message={baseItem.message}\n            diffMessage={diffItem?.message}\n          />\n          {shouldDisplaySingleVal ? (\n            <div className={styles.singleVal}>{String(singleVal)}</div>\n          ) : diffEnabled && isEqual({}, diff) ? (\n            <EmptyState>No difference found</EmptyState>\n          ) : (\n            <>\n              {diffEnabled && (\n                <div\n                  style={{ cursor: \"pointer\", fontSize: \"11px\" }}\n                  onClick={() => saveConfig({ showFullMessageForDiff: !showFullMessageForDiff })}>\n                  <Icon style={{ verticalAlign: \"middle\" }}>\n                    <CheckboxComponent />\n                  </Icon>{\" \"}\n                  Show full msg\n                </div>\n              )}\n              <Tree\n                labelRenderer={(raw) => <SDiffSpan onClick={() => onLabelClick(raw)}>{first(raw)}</SDiffSpan>}\n                shouldExpandNode={shouldExpandNode}\n                hideRoot\n                invertTheme={false}\n                getItemString={diffEnabled ? getItemStringForDiff : getItemString}\n                valueRenderer={(...args) => {\n                  if (diffEnabled) {\n                    return valueRenderer(null, diff, diff, ...args);\n                  }\n                  if (hideWrappingArray) {\n                    // When the wrapping array is hidden, put it back here.\n                    return valueRenderer(rootStructureItem, [data], baseItem.queriedData, ...args, 0);\n                  }\n                  return valueRenderer(rootStructureItem, data, baseItem.queriedData, ...args);\n                }}\n                postprocessValue={(val: mixed) => {\n                  if (\n                    val != null &&\n                    typeof val === \"object\" &&\n                    Object.keys(val).length === 1 &&\n                    diffLabelTexts.includes(Object.keys(val)[0])\n                  ) {\n                    if (Object.keys(val)[0] !== diffLabels.ID.labelText) {\n                      return val[Object.keys(val)[0]];\n                    }\n                  }\n                  return val;\n                }}\n                theme={{\n                  ...jsonTreeTheme,\n                  tree: { margin: 0 },\n                  nestedNode: ({ style }, keyPath, nodeType, expanded) => {\n                    const baseStyle = {\n                      ...style,\n                      padding: \"2px 0 2px 5px\",\n                      marginTop: 2,\n                      textDecoration: \"inherit\",\n                    };\n                    if (!diffEnabled) {\n                      return { style: baseStyle };\n                    }\n                    let backgroundColor;\n                    let textDecoration;\n                    if (diffLabelsByLabelText[keyPath[0]]) {\n                      backgroundColor = diffLabelsByLabelText[keyPath[0]].backgroundColor;\n                      textDecoration = keyPath[0] === diffLabels.DELETED.labelText ? \"line-through\" : \"none\";\n                    }\n                    const nestedObj = get(diff, keyPath.slice().reverse(), {});\n                    const nestedObjKey = Object.keys(nestedObj)[0];\n                    if (diffLabelsByLabelText[nestedObjKey]) {\n                      backgroundColor = diffLabelsByLabelText[nestedObjKey].backgroundColor;\n                      textDecoration = nestedObjKey === diffLabels.DELETED.labelText ? \"line-through\" : \"none\";\n                    }\n                    return {\n                      style: { ...baseStyle, backgroundColor, textDecoration: textDecoration || \"inherit\" },\n                    };\n                  },\n                  nestedNodeLabel: ({ style }, keyPath, nodeType, expanded) => ({\n                    style: { ...style, textDecoration: \"inherit\" },\n                  }),\n                  nestedNodeChildren: ({ style }, nodeType, expanded) => ({\n                    style: { ...style, textDecoration: \"inherit\" },\n                  }),\n                  value: ({ style }, nodeType, keyPath) => {\n                    const baseStyle = { ...style, textDecoration: \"inherit\" };\n                    if (!diffEnabled) {\n                      return { style: baseStyle };\n                    }\n                    let backgroundColor;\n                    let textDecoration;\n                    const nestedObj = get(diff, keyPath.slice().reverse(), {});\n                    const nestedObjKey = Object.keys(nestedObj)[0];\n                    if (diffLabelsByLabelText[nestedObjKey]) {\n                      backgroundColor = diffLabelsByLabelText[nestedObjKey].backgroundColor;\n                      textDecoration = nestedObjKey === diffLabels.DELETED.labelText ? \"line-through\" : \"none\";\n                    }\n                    return {\n                      style: { ...baseStyle, backgroundColor, textDecoration: textDecoration || \"inherit\" },\n                    };\n                  },\n                  label: { textDecoration: \"inherit\" },\n                }}\n                data={diffEnabled ? diff : data}\n              />\n            </>\n          )}\n        </Flex>\n      );\n    },\n    [\n      baseItem,\n      diffEnabled,\n      diffItem,\n      diffMethod,\n      diffTopicPath,\n      expandAll,\n      expandedFields,\n      onLabelClick,\n      rootStructureItem,\n      saveConfig,\n      showFullMessageForDiff,\n      topicPath,\n      valueRenderer,\n    ]\n  );\n\n  return (\n    <Flex col clip style={{ position: \"relative\" }}>\n      <PanelToolbar helpContent={helpContent}>\n        <Icon tooltip=\"Toggle diff\" medium fade onClick={onToggleDiff} active={diffEnabled}>\n          <PlusMinusIcon />\n        </Icon>\n        <Icon\n          tooltip={expandAll ? \"Collapse all\" : \"Expand all\"}\n          medium\n          fade\n          onClick={onToggleExpandAll}\n          style={{ position: \"relative\", top: 1 }}>\n          {expandAll ? <LessIcon /> : <MoreIcon />}\n        </Icon>\n        <div className={styles.topicInputs}>\n          <MessagePathInput index={0} path={topicPath} onChange={onTopicPathChange} inputStyle={{ height: \"100%\" }} />\n          {diffEnabled && (\n            <Flex>\n              <Tooltip contents=\"Diff method\" placement=\"top\">\n                <>\n                  <Dropdown\n                    value={diffMethod}\n                    onChange={(newDiffMethod) => saveConfig({ diffMethod: newDiffMethod })}\n                    noPortal>\n                    <span value={PREV_MSG_METHOD}>{PREV_MSG_METHOD}</span>\n                    <span value=\"custom\">custom</span>\n                  </Dropdown>\n                </>\n              </Tooltip>\n              {diffMethod === \"custom\" ? (\n                <MessagePathInput\n                  index={1}\n                  path={diffTopicPath}\n                  onChange={onDiffTopicPathChange}\n                  inputStyle={{ height: \"100%\" }}\n                  prioritizedDatatype={topic?.datatype}\n                />\n              ) : null}\n            </Flex>\n          )}\n        </div>\n      </PanelToolbar>\n      {renderSingleTopicOrDiffOutput()}\n    </Flex>\n  );\n}\n\nRawMessages.defaultConfig = {\n  topicPath: \"\",\n  diffTopicPath: \"\",\n  diffMethod: \"custom\",\n  diffEnabled: false,\n  showFullMessageForDiff: false,\n};\nRawMessages.panelType = \"RawMessages\";\n\nexport default hot(Panel<RawMessagesConfig>(RawMessages));\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { useCallback, useMemo } from \"react\";\n\nimport parseRosPath from \"./parseRosPath\";\nimport { useCachedGetMessagePathDataItems, type MessagePathDataItem } from \"./useCachedGetMessagePathDataItems\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message } from \"webviz-core/src/players/types\";\n\ntype MessageAndData = {| message: Message, queriedData: MessagePathDataItem[] |};\n\n// Get the last message for a path, but *after* applying filters. In other words, we'll keep the\n// last message that matched.\nexport function useLatestMessageDataItem(path: string): ?MessageAndData {\n  const rosPath = useMemo(() => parseRosPath(path), [path]);\n  const topics = useMemo(() => (rosPath ? [rosPath.topicName] : []), [rosPath]);\n  const cachedGetMessagePathDataItems = useCachedGetMessagePathDataItems([path]);\n\n  const addMessage: (?MessageAndData, Message) => ?MessageAndData = useCallback(\n    (prevMessageAndData: ?MessageAndData, message: Message) => {\n      const queriedData = cachedGetMessagePathDataItems(path, message);\n      if (!queriedData) {\n        return;\n      }\n      if (queriedData.length > 0) {\n        return { message, queriedData };\n      }\n      return prevMessageAndData;\n    },\n    [cachedGetMessagePathDataItems, path]\n  );\n\n  const restore = useCallback(\n    (prevMessageAndData: ?MessageAndData): ?MessageAndData => {\n      if (prevMessageAndData) {\n        const queriedData = cachedGetMessagePathDataItems(path, prevMessageAndData.message);\n        if (queriedData && queriedData.length > 0) {\n          return { message: prevMessageAndData.message, queriedData };\n        }\n      }\n    },\n    [cachedGetMessagePathDataItems, path]\n  );\n\n  const messageAndData = PanelAPI.useMessageReducer({ topics, addMessage, restore });\n  return rosPath ? messageAndData : undefined;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport interface FieldReader {\n  read(data: number[] | Uint8Array, index: number): number;\n}\n\nexport class Float32Reader implements FieldReader {\n  offset: number;\n  view: DataView;\n  constructor(offset: number) {\n    this.offset = offset;\n    const buffer = new ArrayBuffer(4);\n    this.view = new DataView(buffer);\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    this.view.setUint8(0, data[index + this.offset]);\n    this.view.setUint8(1, data[index + this.offset + 1]);\n    this.view.setUint8(2, data[index + this.offset + 2]);\n    this.view.setUint8(3, data[index + this.offset + 3]);\n    return this.view.getFloat32(0, true);\n  }\n}\n\nexport class Int32Reader implements FieldReader {\n  offset: number;\n  view: DataView;\n  constructor(offset: number) {\n    this.offset = offset;\n    const buffer = new ArrayBuffer(4);\n    this.view = new DataView(buffer);\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    this.view.setUint8(0, data[index + this.offset]);\n    this.view.setUint8(1, data[index + this.offset + 1]);\n    this.view.setUint8(2, data[index + this.offset + 2]);\n    this.view.setUint8(3, data[index + this.offset + 3]);\n    return this.view.getInt32(0, true);\n  }\n}\n\nexport class Uint16Reader implements FieldReader {\n  offset: number;\n  view: DataView;\n  constructor(offset: number) {\n    this.offset = offset;\n    const buffer = new ArrayBuffer(2);\n    this.view = new DataView(buffer);\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    this.view.setUint8(0, data[index + this.offset]);\n    this.view.setUint8(1, data[index + this.offset + 1]);\n    return this.view.getUint16(0, true);\n  }\n}\nexport class Int16Reader implements FieldReader {\n  offset: number;\n  view: DataView;\n  constructor(offset: number) {\n    this.offset = offset;\n    const buffer = new ArrayBuffer(2);\n    this.view = new DataView(buffer);\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    this.view.setUint8(0, data[index + this.offset]);\n    this.view.setUint8(1, data[index + this.offset + 1]);\n    return this.view.getInt16(0, true);\n  }\n}\n\nexport class Uint8Reader implements FieldReader {\n  offset: number;\n  constructor(offset: number) {\n    this.offset = offset;\n  }\n\n  read(data: number[] | Uint8Array, index: number): number {\n    return data[index + this.offset];\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./ImageCanvas.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./ImageCanvas.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./ImageCanvas.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Point, CameraInfo } from \"webviz-core/src/types/Messages\";\n\nconst DISTORTION_STATE = {\n  NONE: \"NONE\",\n  CALIBRATED: \"CALIBRATED\",\n};\n\ntype DistortionState = $Values<typeof DISTORTION_STATE>;\n\n// Essentially a copy of ROSPinholeCameraModel\n// but only the relevant methods, i.e.\n// fromCameraInfo() and unrectifyPoint()\n// http://docs.ros.org/diamondback/api/image_geometry/html/c++/pinhole__camera__model_8cpp_source.html\nexport default class PinholeCameraModel {\n  _distortionState: DistortionState = DISTORTION_STATE.NONE;\n  D: $ReadOnlyArray<number> = [];\n  K: $ReadOnlyArray<number> = [];\n  P: $ReadOnlyArray<number> = [];\n  R: $ReadOnlyArray<number> = [];\n\n  // Mostly copied from `fromCameraInfo`\n  // http://docs.ros.org/diamondback/api/image_geometry/html/c++/pinhole__camera__model_8cpp_source.html#l00062\n  constructor(info: CameraInfo) {\n    const { binning_x, binning_y, roi, distortion_model, D, K, P, R } = info;\n\n    if (distortion_model === \"\") {\n      // Allow CameraInfo with no model to indicate no distortion\n      this._distortionState = DISTORTION_STATE.NONE;\n      return;\n    }\n\n    // Binning = 0 is considered the same as binning = 1 (no binning).\n    const binningX = binning_x ? binning_x : 1;\n    const binningY = binning_y ? binning_y : 1;\n\n    const adjustBinning = binningX > 1 || binningY > 1;\n    const adjustRoi = roi.x_offset !== 0 || roi.y_offset !== 0;\n\n    if (adjustBinning || adjustRoi) {\n      throw new Error(\n        \"Failed to initialize camera model: unable to handle adjusted binning and adjusted roi camera models.\"\n      );\n    }\n\n    // See comments about Tx = 0, Ty = 0 in\n    // http://docs.ros.org/melodic/api/sensor_msgs/html/msg/CameraInfo.html\n    if (P[3] !== 0 || P[7] !== 0) {\n      throw new Error(\n        \"Failed to initialize camera model: projection matrix implies non monocular camera - cannot handle at this time.\"\n      );\n    }\n\n    // Figure out how to handle the distortion\n    if (distortion_model === \"plumb_bob\" || distortion_model === \"rational_polynomial\") {\n      this._distortionState = D[0] === 0.0 ? DISTORTION_STATE.NONE : DISTORTION_STATE.CALIBRATED;\n    } else {\n      throw new Error(\n        \"Failed to initialize camera model: distortion_model is unknown, only plumb_bob and rational_polynomial are supported.\"\n      );\n    }\n    this.D = D;\n    this.P = P;\n    this.R = R;\n    this.K = K;\n  }\n\n  unrectifyPoint({ x: rectX, y: rectY }: Point): { x: number, y: number } {\n    if (this._distortionState === DISTORTION_STATE.NONE) {\n      return { x: rectX, y: rectY };\n    }\n\n    const { P, R, D, K } = this;\n    const fx = P[0];\n    const fy = P[5];\n    const cx = P[2];\n    const cy = P[6];\n    const tx = P[3];\n    const ty = P[7];\n\n    // Formulae from docs for cv::initUndistortRectifyMap,\n    // http://opencv.willowgarage.com/documentation/cpp/camera_calibration_and_3d_reconstruction.html\n\n    // x <- (u - c'x) / f'x\n    // y <- (v - c'y) / f'y\n    // c'x, f'x, etc. (primed) come from \"new camera matrix\" P[0:3, 0:3].\n    const x1 = (rectX - cx - tx) / fx;\n    const y1 = (rectY - cy - ty) / fy;\n    // [X Y W]^T <- R^-1 * [x y 1]^T\n    const X = R[0] * x1 + R[1] * y1 + R[2];\n    const Y = R[3] * x1 + R[4] * y1 + R[5];\n    const W = R[6] * x1 + R[7] * y1 + R[8];\n    const xp = X / W;\n    const yp = Y / W;\n\n    // x'' <- x'(1+k1*r^2+k2*r^4+k3*r^6) + 2p1*x'*y' + p2(r^2+2x'^2)\n    // y'' <- y'(1+k1*r^2+k2*r^4+k3*r^6) + p1(r^2+2y'^2) + 2p2*x'*y'\n    // where r^2 = x'^2 + y'^2\n    const r2 = xp * xp + yp * yp;\n    const r4 = r2 * r2;\n    const r6 = r4 * r2;\n    const a1 = 2 * xp * yp;\n    const k1 = D[0];\n    const k2 = D[1];\n    const p1 = D[2];\n    const p2 = D[3];\n    const k3 = D[4];\n    let barrel_correction = 1 + k1 * r2 + k2 * r4 + k3 * r6;\n    if (D.length === 8) {\n      barrel_correction /= 1.0 + D[5] * r2 + D[6] * r4 + D[7] * r6;\n    }\n    const xpp = xp * barrel_correction + p1 * a1 + p2 * (r2 + 2 * (xp * xp));\n    const ypp = yp * barrel_correction + p1 * (r2 + 2 * (yp * yp)) + p2 * a1;\n\n    // map_x(u,v) <- x''fx + cx\n    // map_y(u,v) <- y''fy + cy\n    // cx, fx, etc. come from original camera matrix K.\n    return { x: xpp * K[0] + K[2], y: ypp * K[4] + K[5] };\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport const KNOWN_LOG_LEVELS: Array<number> = [1, 2, 4, 8, 16];\n\n// map a numeric level to a string\nexport default function LevelToString(level: number): string {\n  switch (level) {\n    case 1:\n      return \"DEBUG\";\n    case 2:\n      return \"INFO\";\n    case 4:\n      return \"WARN\";\n    case 8:\n      return \"ERROR\";\n    case 16:\n      return \"FATAL\";\n    default:\n      return \"?????\";\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./LogMessage.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./LogMessage.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./LogMessage.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport hoistNonReactStatics from \"hoist-non-react-statics\";\nimport { omit } from \"lodash\";\nimport React, { type Node, useCallback } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { useSelector } from \"react-redux\";\nimport { type CameraState } from \"regl-worldview\";\n\nimport { FrameCompatibilityDEPRECATED } from \"./FrameCompatibility\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport helpContent from \"webviz-core/src/panels/ThreeDimensionalViz/index.help.md\";\nimport type { TopicSettingsCollection } from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder\";\nimport {\n  useComputedCameraState,\n  getNewCameraStateOnFollowChange,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport type { TopicGroupConfig } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicGroups/types\";\nimport { type TopicDisplayMode } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSelector/TopicDisplayModeSelector\";\nimport LayoutForTopicTreeV2 from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/LayoutForTopicTreeV2\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport withTransforms from \"webviz-core/src/panels/ThreeDimensionalViz/withTransforms\";\nimport type { Frame, Topic } from \"webviz-core/src/players/types\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\nimport { TRANSFORM_TOPIC, TRANSFORM_STATIC_TOPIC } from \"webviz-core/src/util/globalConstants\";\n\nexport type ThreeDimensionalVizConfig = {\n  enableShortDisplayNames?: boolean,\n  autoTextBackgroundColor?: boolean,\n  cameraState: $Shape<CameraState>,\n  followTf?: string | false,\n  followOrientation?: boolean,\n  modifiedNamespaceTopics?: string[],\n  pinTopics: boolean,\n  savedPropsVersion?: ?number, // eslint-disable-line react/no-unused-prop-types\n  topicDisplayMode?: TopicDisplayMode,\n  flattenMarkers?: boolean,\n  selectedPolygonEditFormat?: \"json\" | \"yaml\",\n  showCrosshair?: boolean,\n\n  expandedKeys: string[],\n  checkedKeys: string[],\n  topicSettings: TopicSettingsCollection,\n  autoSyncCameraState?: boolean,\n\n  // legacy props\n  hideMap?: ?boolean, // eslint-disable-line react/no-unused-prop-types\n  useHeightMap?: ?boolean, // eslint-disable-line react/no-unused-prop-types\n  follow?: boolean,\n  topicGroups?: TopicGroupConfig[],\n  checkedNodes?: string[],\n  expandedNodes?: string[],\n};\nexport type Save3DConfig = SaveConfig<ThreeDimensionalVizConfig>;\n\nexport type Props = {\n  cleared?: boolean,\n  config: ThreeDimensionalVizConfig,\n  frame: Frame,\n  helpContent: Node | string,\n  saveConfig: Save3DConfig,\n  setSubscriptions: (subscriptions: string[]) => void,\n  topics: Topic[],\n  transforms: Transforms,\n};\n\nconst BaseRenderer = (props: Props, ref) => {\n  const {\n    cleared,\n    config,\n    frame,\n    saveConfig,\n    setSubscriptions,\n    topics,\n    transforms,\n    config: { autoSyncCameraState, followOrientation, followTf },\n  } = props;\n  const extensions = useSelector((state) => state.extensions);\n  const { updatePanelConfig } = React.useContext(PanelContext) || {};\n\n  const currentTime = useMessagePipeline(\n    useCallback(({ playerState: { activeData } }) => (activeData && activeData.currentTime) || { sec: 0, nsec: 0 }, [])\n  );\n  const isPlaying = useMessagePipeline(\n    useCallback(({ playerState: { activeData } }) => !!(activeData && activeData.isPlaying), [])\n  );\n\n  const { cameraState, targetPose } = useComputedCameraState({\n    currentCameraState: config.cameraState,\n    followTf,\n    followOrientation,\n    transforms,\n  });\n\n  const onSetSubscriptions = useCallback(\n    (subscriptions: string[]) => {\n      setSubscriptions([\n        ...getGlobalHooks().perPanelHooks().ThreeDimensionalViz.topics,\n        TRANSFORM_TOPIC,\n        TRANSFORM_STATIC_TOPIC,\n        ...subscriptions,\n      ]);\n    },\n    [setSubscriptions]\n  );\n\n  // use callbackInputsRef to make sure the input changes don't trigger `onFollowChange` or `onAlignXYAxis` to change\n  const callbackInputsRef = React.useRef({\n    cameraState,\n    configCameraState: config.cameraState,\n    targetPose,\n    configFollowOrientation: config.followOrientation,\n    configFollowTf: config.followTf,\n  });\n  callbackInputsRef.current = {\n    cameraState,\n    configCameraState: config.cameraState,\n    targetPose,\n    configFollowOrientation: config.followOrientation,\n    configFollowTf: config.followTf,\n  };\n  const onFollowChange = useCallback(\n    (newFollowTf?: string | false, newFollowOrientation?: boolean) => {\n      const {\n        configCameraState: prevCameraState,\n        configFollowOrientation: prevFollowOrientation,\n        configFollowTf: prevFollowTf,\n        targetPose: prevTargetPose,\n      } = callbackInputsRef.current;\n      const newCameraState = getNewCameraStateOnFollowChange({\n        prevCameraState,\n        prevTargetPose,\n        prevFollowTf,\n        prevFollowOrientation,\n        newFollowTf,\n        newFollowOrientation,\n      });\n      saveConfig({ followTf: newFollowTf, followOrientation: newFollowOrientation, cameraState: newCameraState });\n    },\n    [saveConfig]\n  );\n\n  const onAlignXYAxis = useCallback(\n    () =>\n      saveConfig({\n        followOrientation: false,\n        cameraState: {\n          ...omit(callbackInputsRef.current.cameraState, [\"target\", \"targetOrientation\"]),\n          thetaOffset: 0,\n        },\n      }),\n    [saveConfig]\n  );\n\n  const onCameraStateChange = useCallback(\n    (newCameraState) => {\n      const newCameraStateObj = omit(newCameraState, [\"target\", \"targetOrientation\"]);\n      if (autoSyncCameraState) {\n        updatePanelConfig(\"3D Panel\", (oldConfig) => ({ ...oldConfig, cameraState: newCameraStateObj }));\n      } else {\n        saveConfig({ cameraState: newCameraStateObj }, { keepLayoutInUrl: true });\n      }\n    },\n    [autoSyncCameraState, saveConfig, updatePanelConfig]\n  );\n\n  // useImperativeHandle so consumer component (e.g.Follow stories) can call onFollowChange directly.\n  React.useImperativeHandle(ref, (): any => ({ onFollowChange }));\n\n  return (\n    <LayoutForTopicTreeV2\n      cameraState={cameraState}\n      config={config}\n      cleared={cleared}\n      currentTime={currentTime}\n      extensions={extensions}\n      followOrientation={!!followOrientation}\n      followTf={followTf}\n      frame={frame}\n      helpContent={helpContent}\n      isPlaying={isPlaying}\n      onAlignXYAxis={onAlignXYAxis}\n      onCameraStateChange={onCameraStateChange}\n      onFollowChange={onFollowChange}\n      saveConfig={saveConfig}\n      topics={topics}\n      targetPose={targetPose}\n      transforms={transforms}\n      setSubscriptions={onSetSubscriptions}\n    />\n  );\n};\n\nBaseRenderer.displayName = \"ThreeDimensionalViz\";\nBaseRenderer.panelType = \"3D Panel\";\nBaseRenderer.defaultConfig = getGlobalHooks().perPanelHooks().ThreeDimensionalViz.defaultConfig;\n\nexport const Renderer = hoistNonReactStatics(React.forwardRef<Props, typeof BaseRenderer>(BaseRenderer), BaseRenderer);\n\nexport default hot(Panel<ThreeDimensionalVizConfig>(FrameCompatibilityDEPRECATED(withTransforms(Renderer), [])));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { MutablePose, Orientation, Point } from \"webviz-core/src/types/Messages\";\n\n// contains backing classes for point, orientation, and pose\n// because we create them a _lot_\nclass PointClass {\n  x: number;\n  y: number;\n  z: number;\n\n  static empty() {\n    // $FlowFixMe: Classes are inexact in flow.\n    const point = new PointClass();\n    point.x = 0;\n    point.y = 0;\n    point.z = 0;\n    return point;\n  }\n}\n\nclass OrientationClass {\n  x: number;\n  y: number;\n  z: number;\n  w: number;\n\n  static empty() {\n    // $FlowFixMe: Classes are inexact in flow.\n    const orientation = new OrientationClass();\n    orientation.x = 0;\n    orientation.y = 0;\n    orientation.z = 0;\n    orientation.w = 1;\n    return orientation;\n  }\n}\n\nclass PoseClass {\n  position: Point;\n  orientation: Orientation;\n}\n\n// create a new empty pose object\nexport function emptyPose(): MutablePose {\n  // $FlowFixMe: Classes are inexact in flow.\n  const pose = new PoseClass();\n  pose.position = PointClass.empty();\n  pose.orientation = OrientationClass.empty();\n  return pose;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport PencilIcon from \"@mdi/svg/svg/pencil.svg\";\nimport * as React from \"react\";\nimport { PolygonBuilder, Polygon } from \"regl-worldview\";\n\nimport Polygons from \"./Polygons\";\nimport ExpandingToolbar, { ToolGroup } from \"webviz-core/src/components/ExpandingToolbar\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { EDIT_FORMAT, type EditFormat } from \"webviz-core/src/components/ValidatedInput\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\nexport const POLYGON_TAB_TYPE = \"Polygons\";\nexport type DrawingTabType = typeof POLYGON_TAB_TYPE;\nexport type Point2D = {| x: number, y: number |};\ntype Props = {\n  onSetPolygons: (polygons: Polygon[]) => void,\n  polygonBuilder: PolygonBuilder,\n  selectedPolygonEditFormat: EditFormat,\n  onSetDrawingTabType: (?DrawingTabType) => void,\n  defaultSelectedTab?: DrawingTabType, // for UI testing\n};\n\n// add more drawing shapes later, e.g. Grid, Axes, Crosshairs\nfunction DrawingTools({\n  defaultSelectedTab,\n  onSetDrawingTabType,\n  onSetPolygons,\n  polygonBuilder,\n  selectedPolygonEditFormat,\n}: Props) {\n  const [selectedTab, setSelectedTab] = React.useState<?DrawingTabType>(defaultSelectedTab);\n\n  return (\n    <ExpandingToolbar\n      tooltip=\"Drawing tools\"\n      icon={\n        <Icon style={{ color: selectedTab ? colors.accent : \"white\" }}>\n          <PencilIcon />\n        </Icon>\n      }\n      className={styles.buttons}\n      selectedTab={selectedTab}\n      onSelectTab={(newSelectedTab) => {\n        onSetDrawingTabType(newSelectedTab);\n        setSelectedTab(newSelectedTab);\n      }}>\n      <ToolGroup name={POLYGON_TAB_TYPE}>\n        <Polygons\n          onSetPolygons={onSetPolygons}\n          polygonBuilder={polygonBuilder}\n          selectedPolygonEditFormat={selectedPolygonEditFormat}\n        />\n      </ToolGroup>\n    </ExpandingToolbar>\n  );\n}\n\nDrawingTools.defaultProps = {\n  selectedPolygonEditFormat: EDIT_FORMAT.YAML,\n};\n\nexport default React.memo<Props>(DrawingTools);\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport yaml from \"js-yaml/dist/js-yaml\";\n\nexport default {\n  parse<T>(str: string): T {\n    return yaml.safeLoad(str);\n  },\n  stringify(obj: any, options: any = {}): string {\n    // do not quote 'y' and 'yes' for older yaml versions\n    return yaml\n      .safeDump(obj, { noCompatMode: true, ...options })\n      .replace(/^- - /gm, \"\\n- - \")\n      .trim();\n  },\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport FileTreeIcon from \"@mdi/svg/svg/file-tree.svg\";\nimport React, { useState } from \"react\";\n\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Menu from \"webviz-core/src/components/Menu\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\n\nimport type { Save3DConfig } from \"..\";\n\nexport const TOPIC_DISPLAY_MODES = {\n  SHOW_TREE: {\n    value: \"SHOW_TREE\",\n    label: \"Tree (default)\",\n    filterInputPlaceholder: \"Type to filter\",\n  },\n  SHOW_SELECTED: {\n    value: \"SHOW_SELECTED\",\n    label: \"Flat (checked topics)\",\n    filterInputPlaceholder: \"Filter visible topics\",\n  },\n  SHOW_AVAILABLE: {\n    value: \"SHOW_AVAILABLE\",\n    label: \"Flat (available topics)\",\n    filterInputPlaceholder: \"Filter available topics\",\n  },\n  SHOW_ALL: {\n    value: \"SHOW_ALL\",\n    label: \"Flat (all topics)\",\n    filterInputPlaceholder: \"Filter all topics\",\n  },\n};\n\nexport type TopicDisplayMode = $Keys<typeof TOPIC_DISPLAY_MODES>;\n\ntype Props = {\n  menuTooltip: string,\n  saveConfig: Save3DConfig,\n  topicDisplayMode: TopicDisplayMode,\n};\nexport default function TopicDisplayModeSelector({ menuTooltip, saveConfig, topicDisplayMode }: Props) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  return (\n    <ChildToggle position=\"below\" onToggle={() => setIsOpen(!isOpen)} isOpen={isOpen}>\n      <Icon small fade active={isOpen} tooltip={menuTooltip}>\n        <FileTreeIcon />\n      </Icon>\n      <Menu>\n        {/* $FlowFixMe */}\n        {Object.values(TOPIC_DISPLAY_MODES).map(({ value, label }) => (\n          <Item\n            checked={value === topicDisplayMode}\n            value={value}\n            key={value}\n            onClick={() => saveConfig({ topicDisplayMode: value })}>\n            {label}\n          </Item>\n        ))}\n      </Menu>\n    </ChildToggle>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport TextHighlight from \"./TextHighlight\";\nimport TextMiddleTruncate, { DEFAULT_END_TEXT_LENGTH } from \"./TextMiddleTruncate\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\n\nexport const STopicNameDisplay = styled.div`\n  display: inline-block;\n`;\n\nexport const SDisplayName = styled.div`\n  font-size: 13px;\n  line-height: 1.4;\n  margin-right: 4px;\n  word-break: break-word;\n  /* disallow selection to prevent shift + click from accidentally select */\n  user-select: none;\n  width: 100%;\n`;\n\nexport const SName = styled.div`\n  /* disallow selection to prevent shift + click from accidentally select */\n  user-select: none;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\ntype Props = {|\n  displayName: string,\n  isXSWidth: boolean,\n  maxWidth: number,\n  topicName: string,\n  searchText?: string,\n  style?: { [attr: string]: string | number },\n  tooltips?: React.Node[],\n|};\n\nexport default function NodeName({\n  displayName,\n  isXSWidth,\n  maxWidth,\n  topicName,\n  searchText,\n  style = {},\n  tooltips,\n}: Props) {\n  let targetStr = displayName || topicName;\n  if (searchText) {\n    if (displayName && topicName && displayName !== topicName) {\n      targetStr = `${displayName} (${topicName})`;\n    }\n  }\n  const xsWidthElem =\n    isXSWidth &&\n    (tooltips ? (\n      <Tooltip contents={tooltips} placement=\"bottom\">\n        <SName>{targetStr}</SName>\n      </Tooltip>\n    ) : (\n      <SName>{targetStr}</SName>\n    ));\n\n  return (\n    <STopicNameDisplay style={style}>\n      <SDisplayName style={{ maxWidth }}>\n        {searchText ? (\n          <TextHighlight targetStr={targetStr} searchText={searchText} />\n        ) : (\n          <>\n            {isXSWidth ? (\n              xsWidthElem\n            ) : (\n              <TextMiddleTruncate\n                text={targetStr}\n                endTextLength={topicName ? topicName.split(\"/\").pop().length + 1 : DEFAULT_END_TEXT_LENGTH}\n                tooltips={tooltips}\n              />\n            )}\n          </>\n        )}\n      </SDisplayName>\n    </STopicNameDisplay>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport DotsVerticalIcon from \"@mdi/svg/svg/dots-vertical.svg\";\nimport React, { useCallback, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport type { SetCurrentEditingTopic, ToggleNode } from \"./types\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport KeyboardShortcut from \"webviz-core/src/components/KeyboardShortcut\";\nimport Menu, { Item } from \"webviz-core/src/components/Menu\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\n\nconst SItemContent = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\ntype Props = {|\n  datatype?: string,\n  nodeKey: string,\n  setCurrentEditingTopic: SetCurrentEditingTopic,\n  toggleCheckAllAncestors: ToggleNode,\n  toggleCheckAllDescendants: ToggleNode,\n  topicName: string,\n|};\n\nexport const DOT_MENU_WIDTH = 18; // The width of the small icon.\n\nexport default function TreeNodeDotMenu({\n  datatype,\n  nodeKey,\n  setCurrentEditingTopic,\n  toggleCheckAllAncestors,\n  toggleCheckAllDescendants,\n  topicName,\n}: Props) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const onToggle = useCallback((ev) => {\n    setIsOpen((prevIsOpen) => !prevIsOpen);\n  }, []);\n\n  return (\n    <ChildToggle position=\"below\" isOpen={isOpen} onToggle={onToggle} dataTest={`topic-row-menu-${topicName}`}>\n      <Icon small fade onClick={onToggle} style={{ padding: \"4px 0px\" }}>\n        <DotsVerticalIcon />\n      </Icon>\n      <Menu>\n        <Item\n          style={{ padding: \"0 12px\" }}\n          onClick={() => {\n            toggleCheckAllAncestors(nodeKey);\n            setIsOpen(false);\n          }}>\n          <SItemContent>\n            <span style={{ paddingRight: 8 }}>Toggle ancestors</span>\n            <KeyboardShortcut keys={[\"Alt\", \"Enter\"]} />\n          </SItemContent>\n        </Item>\n        <Item\n          style={{ padding: \"0 12px\" }}\n          onClick={() => {\n            toggleCheckAllDescendants(nodeKey);\n            setIsOpen(false);\n          }}>\n          <SItemContent>\n            <span style={{ paddingRight: 8 }}>Toggle descendants</span>\n            <KeyboardShortcut keys={[\"Shift\", \"Enter\"]} />\n          </SItemContent>\n        </Item>\n        {topicName && (\n          <Item\n            onClick={() => {\n              clipboard.copy(topicName);\n              setIsOpen(false);\n            }}>\n            Copy topic name\n          </Item>\n        )}\n        {datatype && (\n          <Item\n            dataTest={`topic-row-menu-edit-settings-${topicName}`}\n            onClick={() => {\n              setCurrentEditingTopic({ name: topicName, datatype });\n              setIsOpen(false);\n            }}>\n            Edit topic settings\n          </Item>\n        )}\n      </Menu>\n    </ChildToggle>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { type Node } from \"react\";\nimport styled from \"styled-components\";\n\nimport { colors, textSize, rounded } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SKeyboardShortcut = styled.div`\n  padding: 4px 0;\n  max-width: 400px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nconst SDescription = styled.div`\n  margin-right: 16px;\n`;\n\nconst SKeyWrapper = styled.div`\n  display: inline-flex;\n  flex: none;\n  color: ${colors.GRAY};\n  border: 1px solid ${colors.DARK9};\n  border-radius: ${rounded.SMALL};\n  font-size: ${textSize.SMALL};\n  font-weight: 500;\n  min-width: 20px;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst SKey = styled.kbd`\n  color: ${colors.GRAY};\n  padding: 0 3px;\n  font-size: 12px;\n  line-height: 1.5;\n  :not(:last-child) {\n    border-right: 1px solid ${colors.DARK9};\n  }\n`;\n\ntype Props = {\n  keys: Node[],\n  description?: string,\n  descriptionMaxWidth?: number,\n};\n\nexport default function KeyboardShortcut({ keys, description, descriptionMaxWidth }: Props) {\n  return (\n    <SKeyboardShortcut>\n      {description && (\n        <SDescription style={descriptionMaxWidth ? { width: descriptionMaxWidth } : {}}>{description}</SDescription>\n      )}\n      <span>\n        {keys.map((key, idx) => (\n          <SKeyWrapper key={idx} style={idx < keys.length - 1 ? { marginRight: 4 } : {}}>\n            <SKey>{key}</SKey>\n          </SKeyWrapper>\n        ))}\n      </span>\n    </SKeyboardShortcut>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport tinycolor from \"tinycolor2\";\n\nimport type { OccupancyGridMessage } from \"webviz-core/src/types/Messages\";\n\nexport const COLORS = {\n  BLACK: tinycolor(\"black\"),\n  RED: tinycolor(\"red\"),\n  PINK: tinycolor(\"pink\"),\n  LIME: tinycolor(\"lime\"),\n  CYAN: tinycolor(\"cyan\"),\n  WHITE: tinycolor(\"white\"),\n  AQUA: tinycolor(\"aqua\"),\n  BLUE: tinycolor(\"blue\"),\n  ORANGE: tinycolor(\"orange\"),\n  MAGENTA: tinycolor(\"magenta\"),\n  YELLOW: tinycolor(\"yellow\"),\n  GRAY: tinycolor(\"darkgray\"), // gray and darkgray are named reversed for some reason\n  DARKGRAY: tinycolor(\"gray\"), // gray and darkgray are named reversed for some reason\n  PURPLE: tinycolor(\"purple\"),\n};\n\nexport function setRgba(buffer: Uint8Array, index: number, color: tinycolor) {\n  const rgba255 = color.toRgb();\n  rgba255.a *= 255;\n  buffer[index] = rgba255.r;\n  buffer[index + 1] = rgba255.g;\n  buffer[index + 2] = rgba255.b;\n  buffer[index + 3] = rgba255.a;\n}\n\nexport const defaultMapPalette = (() => {\n  const buff = new Uint8Array(256 * 4);\n\n  // standard gray map palette values\n  for (let i = 0; i <= 100; i++) {\n    const t = 1 - i / 100;\n    const idx = i * 4;\n    setRgba(buff, idx, tinycolor.fromRatio({ r: t, g: t, b: t }));\n  }\n\n  // illegal positive values in green\n  for (let i = 101; i <= 127; i++) {\n    const idx = i * 4;\n    setRgba(buff, idx, tinycolor(\"lime\"));\n  }\n\n  // illegal negative (char) values\n  for (let i = 128; i <= 248; i++) {\n    const idx = i * 4;\n    const t = (i - 128) / (254 - 128);\n    setRgba(buff, idx, tinycolor.fromRatio({ r: t, g: 0.2, b: 0.6, a: Math.max(1 - t, 0.2) }));\n  }\n\n  // legal negative values\n  setRgba(buff, 255 * 4, COLORS.GRAY.setAlpha(0.5)); // -1 UNKNOWN\n  setRgba(buff, 254 * 4, COLORS.ORANGE.setAlpha(0.5)); // -2 UNDRIVEABLE\n  setRgba(buff, 253 * 4, COLORS.CYAN.setAlpha(0.5)); // -3 SIDEWALK\n  setRgba(buff, 252 * 4, COLORS.YELLOW.setAlpha(0.5)); // -4 UNOBSERVED\n  setRgba(buff, 101 * 4, COLORS.PURPLE.setAlpha(0.5)); // 101 UNOCCUPIED_NULL\n  setRgba(buff, 110 * 4, COLORS.PINK.setAlpha(0.5)); // 110 TRACKED_UNKNOWN_TO_UNOCCUPIED\n  setRgba(buff, 111 * 4, COLORS.LIME.setAlpha(0.5)); // 111 TRACKED_OCCUPIED_TO_UNOCCUPIED\n  setRgba(buff, 112 * 4, COLORS.AQUA.setAlpha(0.5)); // 112 TRACKED_OCCUPIED_TO_UNKNOWN\n\n  return buff;\n})();\n\n// convert a number array to a typed array\n// passing a typed array to regl is orders of magnitude\n// faster than passing a number[] and letting regl do the conversion\nfunction toTypedArray(data: $ReadOnlyArray<number> | Int8Array): Uint8Array {\n  if (data instanceof Int8Array) {\n    return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n  }\n  const result = new Uint8Array(data.length);\n  for (let i = 0; i < data.length; i++) {\n    result[i] = data[i];\n  }\n  return result;\n}\n\nclass TextureCacheEntry {\n  marker: OccupancyGridMessage;\n  texture: any;\n  // regl context\n  regl: any;\n\n  constructor(regl: any, marker: OccupancyGridMessage) {\n    this.marker = marker;\n    this.regl = regl;\n    const { info, data } = marker;\n\n    this.texture = regl.texture({\n      format: \"alpha\",\n      mipmap: false,\n      data: toTypedArray(data),\n      width: info.width,\n      height: info.height,\n    });\n  }\n\n  // get the texture for a marker\n  // if the marker is not the same reference\n  // generate a new texture, otherwise keep the old one\n  // uploading new texture data to the gpu is something\n  // you only want to do when required - it takes several milliseconds\n  getTexture(marker: OccupancyGridMessage) {\n    if (this.marker === marker) {\n      return this.texture;\n    }\n    this.marker = marker;\n    const { info, data } = marker;\n    this.texture = this.texture({\n      format: \"alpha\",\n      mipmap: false,\n      data: toTypedArray(data),\n      width: info.width,\n      height: info.height,\n    });\n    return this.texture;\n  }\n}\n\nexport class TextureCache {\n  store: { [string]: TextureCacheEntry } = {};\n  // regl context\n  regl: any;\n\n  constructor(regl: any) {\n    this.regl = regl;\n  }\n\n  // returns a regl texture for a given marker\n  get(marker: OccupancyGridMessage) {\n    const { name } = marker;\n    const item = this.store[name];\n    if (!item) {\n      // if the item is missing initialize a new entry\n      const entry = new TextureCacheEntry(this.regl, marker);\n      this.store[name] = entry;\n      return entry.texture;\n    }\n    return item.getTexture(marker);\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { VertexBuffer } from \"./types\";\nimport {\n  DATATYPE,\n  type FieldOffsetsAndReaders,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/PointCloudBuilder\";\nimport { type FieldReader, Uint8Reader } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/Readers\";\nimport { type ColorMode } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/PointCloudSettingsEditor\";\n\nexport const FLOAT_SIZE = Float32Array.BYTES_PER_ELEMENT;\n\n// Reinterpret a buffer of bytes as a buffer of float values\nexport function reinterpretBufferToFloat(buffer: Uint8Array): Float32Array {\n  return new Float32Array(new Uint8Array(buffer).buffer, 0, buffer.length / Float32Array.BYTES_PER_ELEMENT);\n}\n\n// Expand a buffer of byte values, transforming each value into a float\nexport function expandBufferToFloat(buffer: Uint8Array): Float32Array {\n  return new Float32Array(buffer);\n}\n\n// Utility function to get values from vertex buffers.\n// Since data is stored as floats, we need to divide both offset and stride\n// to get the actual values within the buffer\nexport function getVertexValue(buffer: VertexBuffer, index: number): number {\n  const data = buffer.buffer;\n  const offset = buffer.offset;\n  const stride = buffer.stride;\n  return data[index * stride + offset];\n}\n\n// The number of points in a buffer is equal to the length of the buffer\n// divided by the number of float values in each vertex\nexport function getVertexCount(buffer: VertexBuffer): number {\n  return buffer.buffer.length / buffer.stride;\n}\n\n// Utility function to check if the size of each vertex in a buffer is\n// supported by WebGL 1.0. The maximum stride size is 255 bytes.\n// Also, stride must be a multiple of sizeof(float) in order for us\n// to reinterpret the data buffer\nfunction hasValidStride(stride: number): boolean {\n  return stride <= 255 && stride % FLOAT_SIZE === 0;\n}\n\n// This is a fallback function to extract values from data buffers\n// It's used on some cases where we cannot send the data as is to the GPU,\n// either because we ended up with an unsupported vertex size (see hasValidStride())\n// or because the color field has a datatype that is not easy to work with in shaders\n// This function always returns a Float32Array with three values for each point\n// in the cloud since it might be used for both colors and/or positions.\nfunction extractValues({\n  data,\n  readers,\n  pointCount,\n  stride,\n}: {\n  data: Uint8Array,\n  readers: (?FieldReader)[],\n  pointCount: number,\n  stride: number,\n}): VertexBuffer {\n  const COMPONENT_COUNT = 3;\n  const buffer = new Float32Array(COMPONENT_COUNT * pointCount);\n  for (let i = 0; i < pointCount; i++) {\n    const pointStart = i * stride;\n    for (let j = 0; j < readers.length; j++) {\n      const reader = readers[j];\n      let value = Number.NaN;\n      if (reader != null) {\n        value = reader.read(data, pointStart);\n      }\n      buffer[i * COMPONENT_COUNT + j] = value;\n    }\n  }\n  return {\n    buffer,\n    offset: 0,\n    stride: COMPONENT_COUNT,\n  };\n}\n\nexport function createPositionBuffer({\n  data,\n  fields,\n  pointCount,\n  stride,\n}: {|\n  data: Uint8Array,\n  fields: FieldOffsetsAndReaders,\n  pointCount: number,\n  stride: number,\n|}): VertexBuffer {\n  // Check if all position components are stored next to each other\n  const positionIsValid =\n    fields.y.offset - fields.x.offset === FLOAT_SIZE && fields.z.offset - fields.y.offset === FLOAT_SIZE;\n  if (positionIsValid && hasValidStride(stride)) {\n    // Create a VBO for positions by recasting the data array into a float array\n    // This will give us the correct values for (x,y,z) tuples.\n    // This way we don't need to traverse the array in order to get the [x, y, z] values\n    // We're paying a memory cost in order to achieve the best performance.\n    return {\n      buffer: reinterpretBufferToFloat(data),\n      // Divide by sizeof(float) since offset and stride are defined based on number of\n      // float values, not bytes\n      offset: fields.x.offset / FLOAT_SIZE,\n      stride: stride / FLOAT_SIZE,\n    };\n  }\n\n  // We cannot use positions as is from data buffer. Extract them.\n  console.info(`Vertex buffer stride will be too big (${stride}). Extracting positions from data in CPU`);\n  return extractValues({\n    data,\n    readers: [fields.x.reader, fields.y.reader, fields.z.reader],\n    pointCount,\n    stride,\n  });\n}\n\nexport function createColorBuffer({\n  data,\n  fields,\n  colorMode,\n  pointCount,\n  stride,\n}: {|\n  data: Uint8Array,\n  fields: FieldOffsetsAndReaders,\n  colorMode: ColorMode,\n  pointCount: number,\n  stride: number,\n|}): ?VertexBuffer {\n  if (colorMode.mode === \"flat\") {\n    // If color mode is \"flat\", we don't need a color buffer since\n    // we'll be using a constant value\n    return null;\n  }\n\n  if (colorMode.mode === \"rgb\") {\n    const rgbOffset = fields.rgb.offset || 0;\n    if (hasValidStride(FLOAT_SIZE * stride)) {\n      return {\n        // RGB colors are encoded in a single 4-byte tuple and unfortunately we cannot extract\n        // them in shaders by just reinterpreting the data buffer.\n        // In addition, the supported WebGL implementation constraints VBOs to be of type float,\n        // so we cannot send the data as is. Then, we're converting the data array into a float\n        // array, transforming each byte value into a float.\n        // We're definitely paying a memory cost here\n        buffer: expandBufferToFloat(data),\n        // No need to divide/multiply by sizeof(float) here since now every byte value\n        // in data array is transformed to a float value.\n        offset: rgbOffset, //< float values from the start of each vertex\n        stride, //< float values between vertices\n      };\n    }\n    // stride is too big. Extract colors from data\n    console.info(`Vertex buffer stride will be too big (${4 * stride}). Extracting RGB colors from data in CPU`);\n    return extractValues({\n      data,\n      readers: [new Uint8Reader(rgbOffset + 0), new Uint8Reader(rgbOffset + 1), new Uint8Reader(rgbOffset + 2)],\n      stride,\n      pointCount,\n    });\n  }\n\n  const colorField = fields[colorMode.colorField || \"rgb\"];\n\n  // If the color is computed from any of the other float fields (i.e. x positions)\n  // we can do the same trick as for positions, with just a different offset\n  // based on the selected color field. We also need to make sure the offset\n  // memory alignment is correct (that is, it's divisible by sizeof(float)). There\n  // might be other values previous to this one that have different memory alignments.\n  if (colorField.datatype === DATATYPE.float32 && colorField.offset % FLOAT_SIZE === 0 && hasValidStride(stride)) {\n    return {\n      buffer: reinterpretBufferToFloat(data),\n      // Divide by sizeof(float) since offset and stride are defined based on number of\n      // float values, not bytes\n      offset: colorField.offset / FLOAT_SIZE, //< float values from the start of each vertex\n      stride: stride / FLOAT_SIZE, //< float values between vertices\n    };\n  }\n\n  // Color datatype is not float or stride is too big\n  // Just extract color data from buffer using CPU\n  console.info(\"Cannot reinterpret data. Extracting color buffer using CPU\");\n  return extractValues({\n    data,\n    readers: [colorField.reader],\n    stride,\n    pointCount,\n  });\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport DiagnosticsHistory, { type DiagnosticAutocompleteEntry } from \"./DiagnosticsHistory\";\nimport DiagnosticStatus from \"./DiagnosticStatus\";\nimport helpContent from \"./DiagnosticStatusPanel.help.md\";\nimport { getDiagnosticId, getDisplayName } from \"./util\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TopicToRenderMenu from \"webviz-core/src/components/TopicToRenderMenu\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { DIAGNOSTIC_TOPIC } from \"webviz-core/src/util/globalConstants\";\n\nexport type Config = {\n  selectedHardwareId?: ?string,\n  selectedName?: ?string,\n  splitFraction?: number,\n  topicToRender: string,\n};\n\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n  topics: Topic[],\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n};\n// component to display a single diagnostic status from list\nclass DiagnosticStatusPanel extends React.Component<Props> {\n  static panelType = \"DiagnosticStatusPanel\";\n  static defaultConfig: Config = { topicToRender: DIAGNOSTIC_TOPIC };\n\n  _onSelect = (value: string, entry: DiagnosticAutocompleteEntry, autocomplete: Autocomplete) => {\n    this.props.saveConfig({\n      selectedHardwareId: entry.hardware_id,\n      selectedName: entry.name,\n    });\n    autocomplete.blur();\n  };\n\n  renderTopicToRenderMenu = (topics) => {\n    const {\n      config: { topicToRender },\n      saveConfig,\n    } = this.props;\n    return (\n      <TopicToRenderMenu\n        topicToRender={topicToRender}\n        onChange={(newTopicToRender) => saveConfig({ topicToRender: newTopicToRender })}\n        topics={topics}\n        singleTopicDatatype={\"diagnostic_msgs/DiagnosticArray\"}\n        defaultTopicToRender={DIAGNOSTIC_TOPIC}\n      />\n    );\n  };\n\n  render() {\n    const { openSiblingPanel, config } = this.props;\n    const { selectedHardwareId, selectedName, splitFraction, topicToRender } = config;\n\n    let hasSelection = false;\n    let selectedId, selectedDisplayName;\n    if (selectedHardwareId != null && selectedName != null) {\n      hasSelection = true;\n      selectedId = getDiagnosticId({ hardware_id: selectedHardwareId, name: selectedName, level: 0, message: \"\" });\n      selectedDisplayName = hasSelection ? getDisplayName(selectedHardwareId, selectedName) : null;\n    }\n\n    return (\n      <Flex scroll scrollX col>\n        <DiagnosticsHistory topic={topicToRender}>\n          {(buffer) => {\n            const selectedItem = selectedId ? buffer.diagnosticsById.get(selectedId) : null;\n\n            return (\n              <>\n                <PanelToolbar\n                  floating\n                  helpContent={helpContent}\n                  additionalIcons={this.renderTopicToRenderMenu(this.props.topics)}>\n                  <Autocomplete\n                    placeholder={hasSelection ? selectedDisplayName : \"Select a diagnostic\"}\n                    items={buffer.sortedAutocompleteEntries}\n                    getItemText={(entry) => entry.displayName}\n                    getItemValue={(entry) => entry.id}\n                    onSelect={this._onSelect}\n                    selectedItem={selectedItem}\n                    inputStyle={{ height: \"100%\" }}\n                  />\n                </PanelToolbar>\n                {selectedItem ? (\n                  <DiagnosticStatus\n                    info={selectedItem}\n                    splitFraction={splitFraction}\n                    onChangeSplitFraction={(newSplitFraction) =>\n                      this.props.saveConfig({ splitFraction: newSplitFraction })\n                    }\n                    topicToRender={topicToRender}\n                    openSiblingPanel={openSiblingPanel}\n                  />\n                ) : selectedId ? (\n                  <EmptyState>\n                    Waiting for diagnostics from <code>{selectedDisplayName}</code>\n                  </EmptyState>\n                ) : (\n                  <EmptyState>No diagnostic node selected</EmptyState>\n                )}\n              </>\n            );\n          }}\n        </DiagnosticsHistory>\n      </Flex>\n    );\n  }\n}\n\nexport default hot(Panel<Config>(DiagnosticStatusPanel));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ChartLineVariantIcon from \"@mdi/svg/svg/chart-line-variant.svg\";\nimport DotsHorizontalIcon from \"@mdi/svg/svg/dots-horizontal.svg\";\nimport cx from \"classnames\";\nimport { clamp } from \"lodash\";\nimport * as React from \"react\";\nimport { createSelector } from \"reselect\";\nimport sanitizeHtml from \"sanitize-html\";\nimport styled from \"styled-components\";\n\nimport style from \"./DiagnosticStatus.module.scss\";\nimport { LEVEL_NAMES, type DiagnosticInfo, type KeyValue, type DiagnosticStatusMessage } from \"./util\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { openSiblingPlotPanel } from \"webviz-core/src/panels/Plot\";\nimport { openSiblingStateTransitionsPanel } from \"webviz-core/src/panels/StateTransitions\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\n\nconst MIN_SPLIT_FRACTION = 0.1;\n\ntype Props = {|\n  info: DiagnosticInfo,\n  splitFraction: number,\n  onChangeSplitFraction: ?(number) => void,\n  topicToRender: string,\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n|};\n\nconst ResizeHandle = styled.div.attrs(({ splitFraction }) => ({\n  style: { left: `${100 * splitFraction}%` },\n}))`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 12px;\n  margin-left: -6px;\n  cursor: col-resize;\n  :hover,\n  :active,\n  :focus {\n    outline: none;\n    ::after {\n      content: \"\";\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      left: 6px;\n      margin-left: -2px;\n      width: 4px;\n      background-color: ${colors.divider};\n    }\n  }\n`;\n\nconst KeyValueTable = styled.table`\n  table-layout: fixed;\n  width: 100%;\n  line-height: 1.3em;\n  white-space: pre-line;\n  overflow-wrap: break-word;\n  text-align: left;\n  tr:nth-child(odd) {\n    background-color: #222;\n  }\n  td {\n    border: none;\n    padding: 1px 3px;\n  }\n  /* nested table styles */\n  table {\n    th {\n      font-weight: bold;\n    }\n  }\n`;\n\ntype FormattedKeyValue = {|\n  key: string,\n  keyHtml: ?{ __html: string },\n  value: string,\n  valueHtml: ?{ __html: string },\n|};\n\nconst allowedTags = [\n  // this comment forces the array onto multiple lines :)\n  \"b\",\n  \"br\",\n  \"center\",\n  \"code\",\n  \"em\",\n  \"font\",\n  \"i\",\n  \"strong\",\n  \"table\",\n  \"td\",\n  \"th\",\n  \"tr\",\n  \"tt\",\n  \"u\",\n];\n\nfunction sanitize(value: string): { __html: string } {\n  return {\n    __html: sanitizeHtml(value, {\n      allowedTags,\n      allowedAttributes: {\n        font: [\"color\", \"size\"],\n        td: [\"colspan\"],\n        th: [\"colspan\"],\n      },\n    }),\n  };\n}\n\n// preliminary check to avoid expensive operations when there is no html\nconst HAS_ANY_HTML = new RegExp(`<(${allowedTags.join(\"|\")})`);\n\nconst getFormattedKeyValues = createSelector(\n  (message: DiagnosticStatusMessage) => message,\n  (message: DiagnosticStatusMessage): FormattedKeyValue[] => {\n    return (message.values || []).map((kv: KeyValue) => {\n      return {\n        key: kv.key,\n        keyHtml: HAS_ANY_HTML.test(kv.key) ? sanitize(kv.key) : undefined,\n        value: kv.value,\n        valueHtml: HAS_ANY_HTML.test(kv.value) ? sanitize(kv.value) : undefined,\n      };\n    });\n  }\n);\n\n// component to display a single diagnostic status\nclass DiagnosticStatus extends React.Component<Props, *> {\n  state = {\n    collapsedSections: (new Set(): Set<string>),\n  };\n\n  _tableRef = React.createRef<HTMLTableElement>();\n\n  static defaultProps = {\n    splitFraction: 0.5,\n  };\n\n  onClickSection(name: string) {\n    const collapsedSections = new Set(this.state.collapsedSections);\n    if (collapsedSections.has(name)) {\n      collapsedSections.delete(name);\n    } else {\n      collapsedSections.add(name);\n    }\n    this.setState({ collapsedSections });\n  }\n\n  _resizeMouseDown = (event: SyntheticMouseEvent<Element>) => {\n    event.preventDefault();\n    window.addEventListener(\"mousemove\", this._resizeMouseMove);\n    window.addEventListener(\"mouseup\", this._resizeMouseUp);\n  };\n\n  _resizeMouseUp = () => {\n    window.removeEventListener(\"mousemove\", this._resizeMouseMove);\n  };\n\n  _resizeMouseMove = (event: SyntheticMouseEvent<Element>) => {\n    const {\n      _tableRef,\n      props: { onChangeSplitFraction },\n    } = this;\n\n    if (!_tableRef.current || !onChangeSplitFraction) {\n      return;\n    }\n\n    const { left, right } = _tableRef.current.getBoundingClientRect();\n    const splitFraction = clamp((event.clientX - left) / (right - left), MIN_SPLIT_FRACTION, 1 - MIN_SPLIT_FRACTION);\n    onChangeSplitFraction(splitFraction);\n  };\n\n  componentWillUnmount() {\n    window.removeEventListener(\"mousemove\", this._resizeMouseMove);\n    window.removeEventListener(\"mouseup\", this._resizeMouseUp);\n  }\n\n  _renderKeyValueCell(cls: string, html: ?{ __html: string }, str: string, openPlotPanelIconElem?: React.Node) {\n    if (html) {\n      return <td className={style.valueCell} dangerouslySetInnerHTML={html} />;\n    }\n    return (\n      <td className={style.valueCell}>\n        {str || \"\\xa0\"}\n        {openPlotPanelIconElem}\n      </td>\n    );\n  }\n\n  _renderKeyValueSections = (values: FormattedKeyValue[]): React.Node => {\n    const { info, topicToRender, openSiblingPanel } = this.props;\n    let inCollapsedSection = false;\n    let ellipsisShown = false;\n    return values.map((kv, idx) => {\n      const keyIsSection = !kv.value && (kv.key.startsWith(\"==\") || kv.key.startsWith(\"--\"));\n      const valIsSection = !kv.key && (kv.value.startsWith(\"==\") || kv.value.startsWith(\"--\"));\n      if (keyIsSection || valIsSection) {\n        const name = kv.key + kv.value;\n        inCollapsedSection = this.state.collapsedSections.has(name);\n        ellipsisShown = false;\n        return (\n          <tr key={idx} className={style.section} onClick={() => this.onClickSection(name)}>\n            <th colSpan={2}>{name}</th>\n          </tr>\n        );\n      } else if (inCollapsedSection) {\n        if (ellipsisShown) {\n          return null;\n        }\n        ellipsisShown = true;\n        return (\n          <tr key={idx}>\n            <td colSpan={2} className={style.collapsedSection}>\n              &hellip;\n            </td>\n          </tr>\n        );\n      }\n      // We need both `hardware_id` and `name`; one of them is not enough. That's also how we identify\n      // what to show in this very panel; see `selectedHardwareId` AND `selectedName` in the config.\n      const valuePath = `${topicToRender}.status[:]{hardware_id==\"${info.status.hardware_id}\"}{name==\"${\n        info.status.name\n      }\"}.values[:]{key==\"${kv.key}\"}.value`;\n      let openPlotPanelIconElem = null;\n      if (kv.value && kv.value.length > 0) {\n        openPlotPanelIconElem = !isNaN(Number(kv.value)) ? (\n          <Icon\n            fade\n            dataTest=\"open-plot-icon\"\n            className={style.plotIcon}\n            onClick={() => openSiblingPlotPanel(openSiblingPanel, valuePath)}\n            tooltip=\"Line chart\">\n            <ChartLineVariantIcon />\n          </Icon>\n        ) : (\n          <Icon\n            fade\n            className={style.stateTransitionsIcon}\n            onClick={() => openSiblingStateTransitionsPanel(openSiblingPanel, valuePath)}\n            tooltip=\"State Transitions\">\n            <DotsHorizontalIcon />\n          </Icon>\n        );\n      }\n      return (\n        <tr key={idx} className={style.row}>\n          {this._renderKeyValueCell(style.keyCell, kv.keyHtml, kv.key)}\n          {this._renderKeyValueCell(style.valueCell, kv.valueHtml, kv.value, openPlotPanelIconElem)}\n        </tr>\n      );\n    });\n  };\n\n  render() {\n    const {\n      info: { status, displayName },\n      splitFraction,\n      openSiblingPanel,\n      topicToRender,\n    } = this.props;\n    const statusClass = style[`status-${LEVEL_NAMES[status.level] || \"unknown\"}`];\n\n    return (\n      <Flex scroll>\n        {/* Additional container div allows the resize handle height to stretch to match the table height */}\n        <div style={{ position: \"relative\", height: \"100%\" }}>\n          {/* use data attribute as a hook for use in screenshot tests */}\n          <ResizeHandle data-test-resizehandle splitFraction={splitFraction} onMouseDown={this._resizeMouseDown} />\n          <KeyValueTable ref={this._tableRef}>\n            <tbody>\n              {/* Use a dummy row to fix the column widths */}\n              <tr style={{ height: 0 }}>\n                <td style={{ padding: 0, width: `${100 * splitFraction}%`, borderRight: \"none\" }} />\n                <td style={{ padding: 0, borderLeft: \"none\" }} />\n              </tr>\n              <tr className={cx(style.section, statusClass)}>\n                <Tooltip\n                  placement=\"below\"\n                  contents={\n                    <div>\n                      Hardware ID: <code>{status.hardware_id}</code>\n                      <br />\n                      Name: <code>{status.name}</code>\n                    </div>\n                  }>\n                  <th colSpan={2}>{displayName}</th>\n                </Tooltip>\n              </tr>\n              <tr className={cx(style.row, statusClass)}>\n                <td colSpan={2}>\n                  {status.message}{\" \"}\n                  <Icon\n                    fade\n                    className={style.stateTransitionsIcon}\n                    onClick={() =>\n                      openSiblingStateTransitionsPanel(\n                        openSiblingPanel,\n                        `${topicToRender}.status[:]{hardware_id==\"${status.hardware_id}\"}{name==\"${\n                          status.name\n                        }\"}.message`\n                      )\n                    }\n                    tooltip=\"State Transitions\">\n                    <DotsHorizontalIcon />\n                  </Icon>\n                </td>\n              </tr>\n              {this._renderKeyValueSections(getFormattedKeyValues(status))}\n            </tbody>\n          </KeyValueTable>\n        </div>\n      </Flex>\n    );\n  }\n}\n\nexport default DiagnosticStatus;\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./DiagnosticStatus.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./DiagnosticStatus.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./DiagnosticStatus.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3f8jg--name {\\n  font-weight: bold; }\\n\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th {\\n  color: #29bee7;\\n  text-align: center;\\n  font-size: 1.2em;\\n  padding: 4px;\\n  cursor: pointer;\\n  border: none; }\\n\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-8eud5--status-ok.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-8eud5--status-ok td {\\n  color: #05d27d; }\\n\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-24pnd--status-warn.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-24pnd--status-warn td {\\n  color: #ccb862; }\\n\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-321rk--status-error.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-321rk--status-error td {\\n  color: #ff7c96; }\\n\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4zzfk--status-stale.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4zzfk--status-stale td {\\n  color: rgba(247, 247, 243, 0.3); }\\n\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3tyzc--status-unknown.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section th,\\ntr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3tyzc--status-unknown td {\\n  color: #ff7c96; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3cmpn--keyCell {\\n  padding-right: 5px; }\\n\\ntd.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4mnj9--collapsedSection {\\n  text-align: center;\\n  color: #ff7c96; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2hxg7--plotIcon,\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-28kqt--stateTransitionsIcon {\\n  color: white;\\n  margin-left: 4px;\\n  visibility: hidden; }\\n  tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2dcvn--row:hover .packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2hxg7--plotIcon, tr.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2dcvn--row:hover\\n  .packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-28kqt--stateTransitionsIcon {\\n    visibility: visible; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2hxg7--plotIcon > svg {\\n  vertical-align: -1px; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-28kqt--stateTransitionsIcon > svg {\\n  vertical-align: -2px; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticStatus.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA;EACE,kBAAiB,EAClB;;AAED;EACE,eCUiB;EDTjB,mBAAkB;EAClB,iBAAgB;EAChB,aAAY;EACZ,gBAAe;EACf,aAAY,EACb;;AAED;;EAGI,eCMW,EDLZ;;AAEH;;EAGI,eCSY,EDRb;;AAEH;;EAGI,eCIS,EDHV;;AAEH;;EAGI,gCC1BiC,ED2BlC;;AAEH;;EAGI,eCRS,EDSV;;AAGH;EACE,mBAAkB,EACnB;;AAED;EACE,mBAAkB;EAClB,eClBW,EDmBZ;;AAED;;EAEE,aAAY;EACZ,iBAAgB;EAChB,mBAAkB,EAKnB;EAHC;;IACE,oBAAmB,EACpB;;AAGH;EACE,qBAAoB,EACrB;;AAED;EACE,qBAAoB,EACrB\",\"file\":\"DiagnosticStatus.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.name {\\n  font-weight: bold;\\n}\\n\\ntr.section th {\\n  color: $highlight;\\n  text-align: center;\\n  font-size: 1.2em;\\n  padding: 4px;\\n  cursor: pointer;\\n  border: none;\\n}\\n\\ntr.status-ok {\\n  &.section th,\\n  td {\\n    color: $green;\\n  }\\n}\\ntr.status-warn {\\n  &.section th,\\n  td {\\n    color: $orange;\\n  }\\n}\\ntr.status-error {\\n  &.section th,\\n  td {\\n    color: $red;\\n  }\\n}\\ntr.status-stale {\\n  &.section th,\\n  td {\\n    color: $text-muted;\\n  }\\n}\\ntr.status-unknown {\\n  &.section th,\\n  td {\\n    color: $red;\\n  }\\n}\\n\\n.keyCell {\\n  padding-right: 5px;\\n}\\n\\ntd.collapsedSection {\\n  text-align: center;\\n  color: $red;\\n}\\n\\n.plotIcon,\\n.stateTransitionsIcon {\\n  color: white;\\n  margin-left: 4px;\\n  visibility: hidden;\\n\\n  tr.row:hover & {\\n    visibility: visible;\\n  }\\n}\\n\\n.plotIcon > svg {\\n  vertical-align: -1px;\\n}\\n\\n.stateTransitionsIcon > svg {\\n  vertical-align: -2px;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"name\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3f8jg--name\",\n\t\"section\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2xgqc--section\",\n\t\"status-ok\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-8eud5--status-ok\",\n\t\"status-warn\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-24pnd--status-warn\",\n\t\"status-error\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-321rk--status-error\",\n\t\"status-stale\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4zzfk--status-stale\",\n\t\"status-unknown\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3tyzc--status-unknown\",\n\t\"keyCell\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-3cmpn--keyCell\",\n\t\"collapsedSection\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-4mnj9--collapsedSection\",\n\t\"plotIcon\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2hxg7--plotIcon\",\n\t\"stateTransitionsIcon\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-28kqt--stateTransitionsIcon\",\n\t\"row\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticStatus-module-2dcvn--row\"\n};","module.exports = \"# Plot\\n\\nPlots arbitrary values from topics, similar to [rqt_plot](http://wiki.ros.org/rqt_plot).\\n\\nThe values plotted are specified through Webviz's [message path syntax](/help/message-path-syntax).\\n\\nIn the options menu, you can set a minimum and maximum Y-value. By default, the plot will use those bounds unless the data you're looking at extends above the max Y-value or below the min Y-value; in those cases it will automatically expand. If you want to disable this behavior and force the plot to use the exact minimum and maximum Y-values entered, you can \\\"lock\\\" the y-axis in the options menu as well.\\n\\nThere are 2 possible values for the x-axis - by the message's timestamp or by the message values' respective array indices.\\n\\n## Timestamp as X-Axis\\n\\nWhen you select to plot against a timestamp x-axis (default), you can specify whether the timestamp is taken from either the time the message was received, or the `message.header.stamp` field of the topic, in the dropdown displayed next to each line topic. All Plot panels' timestamped x-axes are kept in sync for easy comparison.\\n\\nWhen you select multiple values (by using a slice) the plot turns into a scatter plot at each timestamp tick.\\n\\nYou can also enter an arbitrary number, which will add a horizontal line at that y-value.\\n\\nTo take the derivative of a value (change per second), use the special `.@derivative` modifier. This does not work with scatter plots (when using slices).\\n\\n## Array Index as X-Axis\\n\\nGo into the Plot panel's settings to change your x-axis from being the messages' timestamps to being the message values' array indices. In this mode, if you add message path `/some_topic.some_array` as a new line in the plot, the plot will chart that array's values against their indices. For example, if `/some_topic.some_array` contained the values `[5, 10, 15]`, the resulting points on the chart would be `[0, 5]`, `[1, 10]`, and `[2, 15]`.\\n\\n## User Interactions\\n\\nYou can zoom by scrolling, and pan by dragging. Double-click to reset. To scroll in only the vertical direction (no horizontal scrolling), you can hold the `v` key while scrolling, and to scroll in only the horizontal direction you can hold the `h` key while scrolling.\\n\"","// Generated automatically by nearley, version unknown\n// http://github.com/Hardmath123/nearley\n(function () {\nfunction id(x) { return x[0]; }\nvar grammar = {\n    Lexer: undefined,\n    ParserRules: [\n    {\"name\": \"main$ebnf$1\", \"symbols\": [\"messagePath\"], \"postprocess\": id},\n    {\"name\": \"main$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"main$ebnf$2\", \"symbols\": [\"modifier\"], \"postprocess\": id},\n    {\"name\": \"main$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"main\", \"symbols\": [\"topicName\", \"main$ebnf$1\", \"main$ebnf$2\"], \"postprocess\": (d) => ({ topicName: d[0], messagePath: d[1] || [], modifier: d[2] })},\n    {\"name\": \"id$ebnf$1\", \"symbols\": [/[a-zA-Z0-9_]/]},\n    {\"name\": \"id$ebnf$1\", \"symbols\": [\"id$ebnf$1\", /[a-zA-Z0-9_]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"id\", \"symbols\": [\"id$ebnf$1\"], \"postprocess\": (d) => d[0].join(\"\")},\n    {\"name\": \"integer$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"integer$ebnf$1\", \"symbols\": [\"integer$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"integer\", \"symbols\": [\"integer$ebnf$1\"], \"postprocess\": (d) => ({ value: parseInt(d[0].join(\"\")), repr: d[0].join(\"\") })},\n    {\"name\": \"integer$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"integer$ebnf$2\", \"symbols\": [\"integer$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"integer\", \"symbols\": [{\"literal\":\"-\"}, \"integer$ebnf$2\"], \"postprocess\": (d) => ({ value: -parseInt(d[1].join(\"\")), repr: `-${d[1].join(\"\")}` })},\n    {\"name\": \"string$ebnf$1\", \"symbols\": []},\n    {\"name\": \"string$ebnf$1\", \"symbols\": [\"string$ebnf$1\", /[^']/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"string\", \"symbols\": [{\"literal\":\"'\"}, \"string$ebnf$1\", {\"literal\":\"'\"}], \"postprocess\": (d) => ({ value: d[1].join(\"\"), repr: `'${d[1].join(\"\")}'` })},\n    {\"name\": \"string$ebnf$2\", \"symbols\": []},\n    {\"name\": \"string$ebnf$2\", \"symbols\": [\"string$ebnf$2\", /[^\"]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"string\", \"symbols\": [{\"literal\":\"\\\"\"}, \"string$ebnf$2\", {\"literal\":\"\\\"\"}], \"postprocess\": (d) => ({ value: d[1].join(\"\"), repr: `\"${d[1].join(\"\")}\"` })},\n    {\"name\": \"variable$ebnf$1\", \"symbols\": [\"id\"], \"postprocess\": id},\n    {\"name\": \"variable$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"variable\", \"symbols\": [{\"literal\":\"$\"}, \"variable$ebnf$1\"], \"postprocess\": (d, loc) => ({ value: {variableName: d[1] || \"\", startLoc: loc }, repr: `$${d[1] || \"\"}` })},\n    {\"name\": \"value\", \"symbols\": [\"integer\"], \"postprocess\": (d) => d[0]},\n    {\"name\": \"value\", \"symbols\": [\"string\"], \"postprocess\": (d) => d[0]},\n    {\"name\": \"value$string$1\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"r\"}, {\"literal\":\"u\"}, {\"literal\":\"e\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"value\", \"symbols\": [\"value$string$1\"], \"postprocess\": (d) => ({ value: true, repr: \"true\" })},\n    {\"name\": \"value$string$2\", \"symbols\": [{\"literal\":\"f\"}, {\"literal\":\"a\"}, {\"literal\":\"l\"}, {\"literal\":\"s\"}, {\"literal\":\"e\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"value\", \"symbols\": [\"value$string$2\"], \"postprocess\": (d) => ({ value: false, repr: \"false\" })},\n    {\"name\": \"value\", \"symbols\": [\"variable\"], \"postprocess\": (d) => d[0]},\n    {\"name\": \"topicName$ebnf$1\", \"symbols\": [\"slashID\"]},\n    {\"name\": \"topicName$ebnf$1\", \"symbols\": [\"topicName$ebnf$1\", \"slashID\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"topicName\", \"symbols\": [\"topicName$ebnf$1\"], \"postprocess\": (d) => d[0].join(\"\")},\n    {\"name\": \"slashID$ebnf$1\", \"symbols\": [\"id\"], \"postprocess\": id},\n    {\"name\": \"slashID$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"slashID\", \"symbols\": [{\"literal\":\"/\"}, \"slashID$ebnf$1\"], \"postprocess\": (d) => d.join(\"\")},\n    {\"name\": \"messagePath$ebnf$1\", \"symbols\": []},\n    {\"name\": \"messagePath$ebnf$1\", \"symbols\": [\"messagePath$ebnf$1\", \"messagePathElement\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"messagePath$ebnf$2\", \"symbols\": [{\"literal\":\".\"}], \"postprocess\": id},\n    {\"name\": \"messagePath$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"messagePath\", \"symbols\": [\"messagePath$ebnf$1\", \"messagePath$ebnf$2\"], \"postprocess\": (d) => d[0].reduce((acc, arr) => acc.concat(arr), []).concat(d[1] ? [{ type: \"name\", name: \"\" }] : [])},\n    {\"name\": \"messagePathElement$ebnf$1\", \"symbols\": [\"slice\"], \"postprocess\": id},\n    {\"name\": \"messagePathElement$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"messagePathElement$ebnf$2\", \"symbols\": [\"filter\"], \"postprocess\": id},\n    {\"name\": \"messagePathElement$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"messagePathElement\", \"symbols\": [{\"literal\":\".\"}, \"name\", \"messagePathElement$ebnf$1\", \"messagePathElement$ebnf$2\"], \"postprocess\": (d) => [d[1], d[2], d[3]].filter(x => x !== null)},\n    {\"name\": \"messagePathElement\", \"symbols\": [\"filter\"], \"postprocess\": id},\n    {\"name\": \"name\", \"symbols\": [\"id\"], \"postprocess\": (d) => ({ type: \"name\", name: d[0] })},\n    {\"name\": \"sliceVal\", \"symbols\": [\"integer\"], \"postprocess\": (d) => (d[0].value)},\n    {\"name\": \"sliceVal\", \"symbols\": [\"variable\"], \"postprocess\": (d) => (d[0].value)},\n    {\"name\": \"slice\", \"symbols\": [{\"literal\":\"[\"}, \"sliceVal\", {\"literal\":\"]\"}], \"postprocess\": (d) => ({ type: \"slice\", start: d[1], end: d[1] })},\n    {\"name\": \"slice$ebnf$1\", \"symbols\": [\"sliceVal\"], \"postprocess\": id},\n    {\"name\": \"slice$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"slice$ebnf$2\", \"symbols\": [\"sliceVal\"], \"postprocess\": id},\n    {\"name\": \"slice$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"slice\", \"symbols\": [{\"literal\":\"[\"}, \"slice$ebnf$1\", {\"literal\":\":\"}, \"slice$ebnf$2\", {\"literal\":\"]\"}], \"postprocess\": (d) => ({ type: \"slice\", start: d[1] === null ? 0 : d[1], end: d[3] === null ? Infinity : d[3] })},\n    {\"name\": \"simplePath$ebnf$1\", \"symbols\": []},\n    {\"name\": \"simplePath$ebnf$1$subexpression$1\", \"symbols\": [{\"literal\":\".\"}, \"id\"]},\n    {\"name\": \"simplePath$ebnf$1\", \"symbols\": [\"simplePath$ebnf$1\", \"simplePath$ebnf$1$subexpression$1\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"simplePath\", \"symbols\": [\"id\", \"simplePath$ebnf$1\"], \"postprocess\": (d) => [d[0]].concat(d[1].map((d) => d[1]))},\n    {\"name\": \"filter$ebnf$1\", \"symbols\": [\"simplePath\"], \"postprocess\": id},\n    {\"name\": \"filter$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"filter\", \"symbols\": [{\"literal\":\"{\"}, \"filter$ebnf$1\", {\"literal\":\"}\"}], \"postprocess\": \n        (d, loc) => ({\n          type: \"filter\",\n          path: d[1] || [],\n          value: undefined,\n          nameLoc: loc+1,\n          valueLoc: loc+1,\n          repr: (d[1] || []).join(\".\"),\n        })\n                    },\n    {\"name\": \"filter$ebnf$2\", \"symbols\": [\"simplePath\"], \"postprocess\": id},\n    {\"name\": \"filter$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"filter$string$1\", \"symbols\": [{\"literal\":\"=\"}, {\"literal\":\"=\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"filter\", \"symbols\": [{\"literal\":\"{\"}, \"filter$ebnf$2\", \"filter$string$1\", \"value\", {\"literal\":\"}\"}], \"postprocess\": \n        (d, loc) => ({\n          type: \"filter\",\n          path: d[1] || [],\n          value: d[3].value,\n          nameLoc: loc+1,\n          valueLoc: loc+1+(d[1] || []).join(\".\").length+d[2].length,\n          repr: `${(d[1] || []).join(\".\")}==${d[3].repr}`,\n        })\n                    },\n    {\"name\": \"modifier$string$1\", \"symbols\": [{\"literal\":\".\"}, {\"literal\":\"@\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"modifier$ebnf$1\", \"symbols\": [\"id\"], \"postprocess\": id},\n    {\"name\": \"modifier$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"modifier\", \"symbols\": [\"modifier$string$1\", \"modifier$ebnf$1\"], \"postprocess\": (d) => d[1] || \"\"}\n]\n  , ParserStart: \"main\"\n}\nif (typeof module !== 'undefined'&& typeof module.exports !== 'undefined') {\n   module.exports = grammar;\n} else {\n   window.grammar = grammar;\n}\n})();\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nconst RosPrimitives = {\n  bool: null,\n  int8: null,\n  uint8: null,\n  int16: null,\n  uint16: null,\n  int32: null,\n  uint32: null,\n  int64: null,\n  uint64: null,\n  float32: null,\n  float64: null,\n  string: null,\n  time: null,\n  duration: null,\n};\n\nexport type RosPrimitive = $Keys<typeof RosPrimitives>;\nexport const rosPrimitives: RosPrimitive[] = Object.keys(RosPrimitives);\n\nexport type MessagePathFilter = {|\n  type: \"filter\",\n  path: string[],\n  value: void | number | string | {| variableName: string, startLoc: number |},\n  nameLoc: number,\n  valueLoc: number,\n  repr: string, // the original string representation of the filter\n|};\n\n// A parsed version of paths.\nexport type MessagePathPart =\n  | {| type: \"name\", name: string |}\n  | {|\n      type: \"slice\",\n      start: number | {| variableName: string, startLoc: number |},\n      end: number | {| variableName: string, startLoc: number |},\n    |}\n  | MessagePathFilter;\n\nexport type RosPath = {|\n  topicName: string,\n  messagePath: MessagePathPart[],\n  modifier: ?string,\n|};\n\n// \"Structure items\" are a more useful version of `datatypes`. They can be\n// easily traversed to either validate message paths or generate message paths.\nexport type MessagePathStructureItemMessage = {|\n  structureType: \"message\",\n  nextByName: { [string]: MessagePathStructureItem }, // eslint-disable-line no-use-before-define\n  datatype: string,\n|};\ntype MessagePathStructureItemArray = {|\n  structureType: \"array\",\n  next: MessagePathStructureItem, // eslint-disable-line no-use-before-define\n  datatype: string,\n|};\ntype MessagePathStructureItemPrimitive = {|\n  structureType: \"primitive\",\n  primitiveType: RosPrimitive,\n  datatype: string,\n|};\nexport type MessagePathStructureItem =\n  | MessagePathStructureItemMessage\n  | MessagePathStructureItemArray\n  | MessagePathStructureItemPrimitive;\n","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Panel.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Panel.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Panel.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-Panel-module-32r84--root {\\n  z-index: 1;\\n  background-color: #1a1a1f;\\n  position: relative; }\\n\\n.packages-webviz-core-src-components-Panel-module-4c19m--rootFullScreen {\\n  position: fixed;\\n  z-index: 100;\\n  border: 4px solid rgba(110, 81, 238, 0.3);\\n  top: 36px;\\n  left: 0;\\n  right: 0;\\n  bottom: 44px; }\\n\\n.packages-webviz-core-src-components-Panel-module-psm4f--notClickable {\\n  position: fixed;\\n  z-index: 100;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  height: 36px;\\n  opacity: 0;\\n  cursor: not-allowed; }\\n\\n.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay,\\n.packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay,\\n.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection {\\n  cursor: pointer;\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  z-index: 100000;\\n  display: none;\\n  -ms-flex-direction: column;\\n      flex-direction: column;\\n  -ms-flex-pack: start;\\n      justify-content: flex-start;\\n  -ms-flex-align: end;\\n      align-items: flex-end;\\n  font-size: 14px;\\n  padding-top: 24px; }\\n  .packages-webviz-core-src-components-Panel-module-32r84--root:hover > .packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay, .packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay.hoverForScreenshot, .packages-webviz-core-src-components-Panel-module-32r84--root:hover >\\n  .packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay,\\n  .packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay.hoverForScreenshot, .packages-webviz-core-src-components-Panel-module-32r84--root:hover >\\n  .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection,\\n  .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection.hoverForScreenshot {\\n    background-color: rgba(110, 81, 238, 0.15);\\n    display: -ms-flexbox;\\n    display: flex;\\n    -ms-flex-align: center;\\n        align-items: center;\\n    -ms-flex-pack: center;\\n        justify-content: center;\\n    -ms-flex-wrap: wrap;\\n        flex-wrap: wrap; }\\n  .packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay div,\\n  .packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay div,\\n  .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection div {\\n    width: 100%;\\n    padding: 6px 0;\\n    display: -ms-flexbox;\\n    display: flex;\\n    -ms-flex-align: center;\\n        align-items: center;\\n    -ms-flex-pack: center;\\n        justify-content: center;\\n    -ms-flex-wrap: wrap;\\n        flex-wrap: wrap; }\\n  .packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay svg,\\n  .packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay svg,\\n  .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection svg {\\n    margin-right: 4px;\\n    width: 24px;\\n    height: 24px;\\n    fill: white; }\\n  .packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay button,\\n  .packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay button,\\n  .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection button {\\n    width: 72px;\\n    height: 72px;\\n    margin: 4px;\\n    -ms-flex: none;\\n        flex: none;\\n    font-size: 14px;\\n    display: -ms-flexbox;\\n    display: flex;\\n    -ms-flex-direction: column;\\n        flex-direction: column;\\n    -ms-flex-align: center;\\n        align-items: center;\\n    -ms-flex-pack: center;\\n        justify-content: center;\\n    background: rgba(110, 81, 238, 0.5); }\\n    .packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay button svg,\\n    .packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay button svg,\\n    .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection button svg {\\n      margin: 0 0 6px; }\\n    .packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay button:not(.disabled):hover,\\n    .packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay button:not(.disabled):hover,\\n    .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection button:not(.disabled):hover {\\n      background: rgba(110, 81, 238, 0.8); }\\n  .packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay p,\\n  .packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay p,\\n  .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection p {\\n    font-size: 12px;\\n    color: rgba(247, 247, 243, 0.3); }\\n\\n.packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection {\\n  padding: 10px; }\\n  .packages-webviz-core-src-components-Panel-module-32r84--root:hover .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection, .packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection.hoverForScreenshot {\\n    background-color: rgba(45, 45, 51, 0.7); }\\n\\n.packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay button {\\n  width: 145px;\\n  height: 40px;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-direction: row;\\n      flex-direction: row;\\n  -ms-flex-pack: justify;\\n      justify-content: space-between; }\\n\\n.packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen {\\n  position: fixed;\\n  top: 75px;\\n  right: 8px;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: #2d2c33;\\n  display: none; }\\n  .packages-webviz-core-src-components-Panel-module-32r84--root:hover .packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen {\\n    display: block; }\\n  .packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen.hoverForScreenshot {\\n    display: block; }\\n  .packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen svg {\\n    width: 16px;\\n    height: 16px;\\n    fill: white;\\n    float: left; }\\n  .packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen span {\\n    float: right;\\n    padding-left: 3px; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/components/Panel.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/variables.scss\"],\"names\":[],\"mappings\":\"AAGA;EACE,WAAU;EACV,0BC8BwB;ED7BxB,mBAAkB,EACnB;;AAED;EACE,gBAAe;EACf,aAAY;EACZ,0CAAyC;EACzC,UEbiB;EFcjB,QAAO;EACP,SAAQ;EACR,aEf0B,EFgB3B;;AAED;EACE,gBAAe;EACf,aAAY;EACZ,OAAM;EACN,QAAO;EACP,SAAQ;EACR,aEzBiB;EF0BjB,WAAU;EACV,oBAAmB,EACpB;;AAED;;;EAGE,gBAAe;EACf,mBAAkB;EAClB,OAAM;EACN,QAAO;EACP,SAAQ;EACR,UAAS;EACT,gBAAe;EACf,cAAa;EAYb,2BAAsB;MAAtB,uBAAsB;EACtB,qBAA2B;MAA3B,4BAA2B;EAC3B,oBAAqB;MAArB,sBAAqB;EACrB,gBAAe;EACf,kBAAiB,EA0ClB;EAxDC;;;;;IAGE,2CAA0C;IAC1C,qBAAa;IAAb,cAAa;IACb,uBAAmB;QAAnB,oBAAmB;IACnB,sBAAuB;QAAvB,wBAAuB;IACvB,oBAAe;QAAf,gBAAe,EAChB;EApBH;;;IA6BI,YAAW;IACX,eAAc;IACd,qBAAa;IAAb,cAAa;IACb,uBAAmB;QAAnB,oBAAmB;IACnB,sBAAuB;QAAvB,wBAAuB;IACvB,oBAAe;QAAf,gBAAe,EAChB;EAnCH;;;IAsCI,kBAAiB;IACjB,YAAW;IACX,aAAY;IACZ,YAAW,EACZ;EA1CH;;;IA6CI,YAAW;IACX,aAAY;IACZ,YAAW;IACX,eAAU;QAAV,WAAU;IACV,gBAAe;IACf,qBAAa;IAAb,cAAa;IACb,2BAAsB;QAAtB,uBAAsB;IACtB,uBAAmB;QAAnB,oBAAmB;IACnB,sBAAuB;QAAvB,wBAAuB;IACvB,oCAAmC,EAQpC;IA9DH;;;MAwDM,gBAAe,EAChB;IAzDL;;;MA4DM,oCAAmC,EACpC;EA7DL;;;IAiEI,gBAAe;IACf,gCChFiC,EDiFlC;;AAGH;EACE,cAAa,EAOd;EALC;IAGE,wCAAuC,EACxC;;AAGH;EACE,aAAY;EACZ,aAAY;EACZ,qBAAa;EAAb,cAAa;EACb,wBAAmB;MAAnB,oBAAmB;EACnB,uBAA8B;MAA9B,+BAA8B,EAC/B;;AAED;EACE,gBAAe;EACf,UAAS;EACT,WAAU;EACV,aAAY;EACZ,WAAU;EACV,0BCvFe;EDwFf,cAAa,EAiBd;EAhBC;IACE,eAAc,EACf;EAVH;IAYI,eAAc,EACf;EAbH;IAeI,YAAW;IACX,aAAY;IACZ,YAAW;IACX,YAAW,EACZ;EAnBH;IAqBI,aAAY;IACZ,kBAAiB,EAClB\",\"file\":\"Panel.module.scss\",\"sourcesContent\":[\"@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/variables.scss\\\";\\n\\n.root {\\n  z-index: 1;\\n  background-color: $panel-background;\\n  position: relative;\\n}\\n\\n.rootFullScreen {\\n  position: fixed;\\n  z-index: 100;\\n  border: 4px solid rgba(110, 81, 238, 0.3);\\n  top: $topBarHeight;\\n  left: 0;\\n  right: 0;\\n  bottom: $playbackControlHeight;\\n}\\n\\n.notClickable {\\n  position: fixed;\\n  z-index: 100;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  height: $topBarHeight;\\n  opacity: 0;\\n  cursor: not-allowed;\\n}\\n\\n.tabActionsOverlay,\\n.quickActionsOverlay,\\n.prohibitedSelection {\\n  cursor: pointer;\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  z-index: 100000; // highest level within panel\\n  display: none;\\n\\n  .root:hover > &,\\n  // for screenshot tests\\n  &:global(.hoverForScreenshot) {\\n    background-color: rgba(110, 81, 238, 0.15);\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    flex-wrap: wrap;\\n  }\\n\\n  flex-direction: column;\\n  justify-content: flex-start;\\n  align-items: flex-end;\\n  font-size: 14px;\\n  padding-top: 24px;\\n\\n  div {\\n    width: 100%;\\n    padding: 6px 0;\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    flex-wrap: wrap;\\n  }\\n\\n  svg {\\n    margin-right: 4px;\\n    width: 24px;\\n    height: 24px;\\n    fill: white;\\n  }\\n\\n  button {\\n    width: 72px;\\n    height: 72px;\\n    margin: 4px;\\n    flex: none;\\n    font-size: 14px;\\n    display: flex;\\n    flex-direction: column;\\n    align-items: center;\\n    justify-content: center;\\n    background: rgba(110, 81, 238, 0.5);\\n    svg {\\n      margin: 0 0 6px;\\n    }\\n\\n    &:not(:global(.disabled)):hover {\\n      background: rgba(110, 81, 238, 0.8);\\n    }\\n  }\\n\\n  p {\\n    font-size: 12px;\\n    color: $text-muted;\\n  }\\n}\\n\\n.prohibitedSelection {\\n  padding: 10px;\\n\\n  .root:hover &,\\n  // for screenshot tests\\n  &:global(.hoverForScreenshot) {\\n    background-color: rgba(45, 45, 51, 0.7);\\n  }\\n}\\n\\n.tabActionsOverlay button {\\n  width: 145px;\\n  height: 40px;\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n}\\n\\n.exitFullScreen {\\n  position: fixed;\\n  top: 75px;\\n  right: 8px;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: $toolbar;\\n  display: none;\\n  .root:hover & {\\n    display: block;\\n  }\\n  &:global(.hoverForScreenshot) {\\n    display: block;\\n  }\\n  svg {\\n    width: 16px;\\n    height: 16px;\\n    fill: white;\\n    float: left;\\n  }\\n  span {\\n    float: right;\\n    padding-left: 3px;\\n  }\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\",\"$topBarHeight: 36px;\\n$playbackControlHeight: 44px;\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"root\": \"packages-webviz-core-src-components-Panel-module-32r84--root\",\n\t\"rootFullScreen\": \"packages-webviz-core-src-components-Panel-module-4c19m--rootFullScreen\",\n\t\"notClickable\": \"packages-webviz-core-src-components-Panel-module-psm4f--notClickable\",\n\t\"tabActionsOverlay\": \"packages-webviz-core-src-components-Panel-module-3ucfg--tabActionsOverlay\",\n\t\"quickActionsOverlay\": \"packages-webviz-core-src-components-Panel-module-4jxeb--quickActionsOverlay\",\n\t\"prohibitedSelection\": \"packages-webviz-core-src-components-Panel-module-3cuq9--prohibitedSelection\",\n\t\"exitFullScreen\": \"packages-webviz-core-src-components-Panel-module-8yy8w--exitFullScreen\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport flatten from \"lodash/flatten\";\nimport React, { memo } from \"react\";\nimport Dimensions from \"react-container-dimensions\";\nimport { createSelector } from \"reselect\";\nimport { Time } from \"rosbag\";\nimport uuid from \"uuid\";\n\nimport styles from \"./PlotChart.module.scss\";\nimport { type MessageHistoryItemsByPath } from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport TimeBasedChart, { type TimeBasedChartTooltipData } from \"webviz-core/src/components/TimeBasedChart\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport derivative from \"webviz-core/src/panels/Plot/derivative\";\nimport {\n  type PlotPath,\n  type BasePlotPath,\n  isReferenceLinePlotPathType,\n} from \"webviz-core/src/panels/Plot/internalTypes\";\nimport { lightColor, lineColors } from \"webviz-core/src/util/plotColors\";\nimport { format, formatTimeRaw, getTimestampForMessage, isTime, subtractTimes, toSec } from \"webviz-core/src/util/time\";\n\nexport type PlotChartPoint = {|\n  x: number,\n  y: number,\n  tooltip?: TimeBasedChartTooltipData,\n|};\n\nexport type DataSet = {|\n  borderColor: string,\n  borderWidth: number,\n  data: Array<PlotChartPoint>,\n  fill: boolean,\n  key: string,\n  label: string,\n  pointBackgroundColor: string,\n  pointBorderColor: string,\n  pointHoverRadius: number,\n  pointRadius: number,\n  showLine: boolean,\n|};\n\nconst Y_AXIS_ID = \"Y_AXIS_ID\";\n\nfunction getXForPoint(xAxisVal, timestamp, innerIdx, itemsByPath, xAxisPath, outerIdx): number {\n  if (xAxisVal === \"custom\" && xAxisPath) {\n    if (isReferenceLinePlotPathType(xAxisPath)) {\n      return Number.parseFloat(xAxisPath.value);\n    }\n    if (itemsByPath[xAxisPath.value]) {\n      const item = itemsByPath[xAxisPath.value][outerIdx];\n      return item ? Number(item.queriedData[innerIdx]?.value) : NaN;\n    }\n  }\n  return xAxisVal === \"timestamp\" ? timestamp : innerIdx;\n}\n\nconst scaleOptions = {\n  fixedYAxisWidth: 48,\n  yAxisTicks: \"hideFirstAndLast\",\n};\n\nfunction getDatasetAndTooltipsFromMessagePlotPath(\n  path: PlotPath,\n  itemsByPath: MessageHistoryItemsByPath,\n  index: number,\n  startTime: Time,\n  xAxisVal: \"timestamp\" | \"index\" | \"custom\",\n  xAxisPath?: BasePlotPath\n): { dataset: DataSet, tooltips: TimeBasedChartTooltipData[] } {\n  let tooltips: TimeBasedChartTooltipData[] = [];\n  let points: PlotChartPoint[] = [];\n  let showLine = true;\n  const datasetKey = index.toString();\n\n  for (const [outerIdx, item] of itemsByPath[path.value].entries()) {\n    const timestamp = getTimestampForMessage(item.message, path.timestampMethod);\n    if (!timestamp) {\n      continue;\n    }\n    const elapsedTime = toSec(subtractTimes(timestamp, startTime));\n    for (const [innerIdx, { value, path: queriedPath, constantName }] of item.queriedData.entries()) {\n      if (typeof value === \"number\" || typeof value === \"boolean\" || typeof value === \"string\") {\n        const valueNum = Number(value);\n        if (!isNaN(valueNum)) {\n          const x = getXForPoint(xAxisVal, elapsedTime, innerIdx, itemsByPath, xAxisPath, outerIdx);\n          const y = valueNum;\n          const tooltip = { x, y, datasetKey, item, path: queriedPath, value, constantName, startTime };\n          points.push({ x, y });\n          tooltips.push(tooltip);\n        }\n      } else if (isTime(value)) {\n        // $FlowFixMe - %checks on isTime can't convince Flow that the object is actually a Time. Related: https://github.com/facebook/flow/issues/3614\n        const timeValue = (value: Time);\n        const x = getXForPoint(xAxisVal, elapsedTime, innerIdx, itemsByPath, xAxisPath, outerIdx);\n        const y = toSec(timeValue);\n        const tooltip = {\n          x,\n          y,\n          datasetKey,\n          item,\n          path: queriedPath,\n          value: `${format(timeValue)} (${formatTimeRaw(timeValue)})`,\n          constantName,\n          startTime,\n        };\n        points.push({ x, y });\n        tooltips.push(tooltip);\n      }\n    }\n    // If we have added more than one point for this message, make it a scatter plot.\n    if (item.queriedData.length > 1 && xAxisVal !== \"index\") {\n      showLine = false;\n    }\n  }\n\n  if (path.value.includes(\".@derivative\")) {\n    if (showLine) {\n      const { points: derivativePoints, tooltips: derivativeTooltips } = derivative(points, tooltips);\n      points = derivativePoints;\n      tooltips = derivativeTooltips;\n    } else {\n      // If we have a scatter plot, we can't take the derivative, so instead show nothing\n      // (nothing is better than incorrect data).\n      points = [];\n    }\n  }\n\n  const dataset = {\n    borderColor: lineColors[index % lineColors.length],\n    label: path.value || uuid.v4(),\n    key: datasetKey,\n    showLine,\n    fill: false,\n    borderWidth: 1,\n    pointRadius: 1.5,\n    pointHoverRadius: 3,\n    pointBackgroundColor: lightColor(lineColors[index % lineColors.length]),\n    pointBorderColor: \"transparent\",\n    data: points,\n  };\n  return { dataset, tooltips };\n}\n\n// A \"reference line\" plot path is a numeric value. It creates a horizontal line on the plot at the specified value.\nfunction getAnnotationFromReferenceLine(path: PlotPath, index: number) {\n  return {\n    type: \"line\",\n    drawTime: \"beforeDatasetsDraw\",\n    scaleID: Y_AXIS_ID,\n    label: path.value,\n    borderColor: lineColors[index % lineColors.length],\n    borderDash: [5, 5],\n    borderWidth: 1,\n    mode: \"horizontal\",\n    value: Number.parseFloat(path.value),\n  };\n}\n\nexport function getDatasetsAndTooltips(\n  paths: PlotPath[],\n  itemsByPath: MessageHistoryItemsByPath,\n  startTime: Time,\n  xAxisVal: \"timestamp\" | \"index\" | \"custom\",\n  xAxisPath?: BasePlotPath\n): { datasets: DataSet[], tooltips: TimeBasedChartTooltipData[] } {\n  const datasetsAndTooltips = filterMap(paths, (path: PlotPath, index: number) => {\n    if (!path.enabled) {\n      return null;\n    } else if (!isReferenceLinePlotPathType(path)) {\n      return getDatasetAndTooltipsFromMessagePlotPath(path, itemsByPath, index, startTime, xAxisVal, xAxisPath);\n    }\n    return null;\n  });\n\n  return {\n    datasets: datasetsAndTooltips.map(({ dataset }) => dataset),\n    tooltips: flatten(datasetsAndTooltips.map(({ tooltips }) => tooltips)),\n  };\n}\n\nfunction getAnnotations(paths: PlotPath[]) {\n  return filterMap(paths, (path: PlotPath, index: number) => {\n    if (!path.enabled) {\n      return null;\n    } else if (isReferenceLinePlotPathType(path)) {\n      return getAnnotationFromReferenceLine(path, index);\n    }\n    return null;\n  });\n}\n\ntype YAxesInterface = {| minY: number, maxY: number, scaleId: string |};\n// min/maxYValue is NaN when it's unset, and an actual number otherwise.\nconst yAxes = createSelector<YAxesInterface, _, _, _>(\n  (params) => params,\n  ({ minY, maxY, scaleId }: YAxesInterface) => {\n    const min = isNaN(minY) ? undefined : minY;\n    const max = isNaN(maxY) ? undefined : maxY;\n    return [\n      {\n        id: scaleId,\n        ticks: {\n          min,\n          max,\n          precision: 3,\n        },\n        gridLines: {\n          color: \"rgba(255, 255, 255, 0.2)\",\n          zeroLineColor: \"rgba(255, 255, 255, 0.2)\",\n        },\n      },\n    ];\n  }\n);\n\ntype PlotChartProps = {|\n  paths: PlotPath[],\n  minYValue: number,\n  maxYValue: number,\n  saveCurrentYs: (minY: number, maxY: number) => void,\n  datasets: DataSet[],\n  tooltips: TimeBasedChartTooltipData[],\n  xAxisVal: \"timestamp\" | \"index\" | \"custom\",\n|};\nexport default memo<PlotChartProps>(function PlotChart(props: PlotChartProps) {\n  const { paths, minYValue, maxYValue, saveCurrentYs, datasets, tooltips, xAxisVal } = props;\n  const annotations = getAnnotations(paths);\n\n  return (\n    <div className={styles.root}>\n      <Dimensions>\n        {({ width, height }) => (\n          <TimeBasedChart\n            // Force a redraw every time the x-axis value changes.\n            key={xAxisVal}\n            isSynced\n            zoom\n            width={width}\n            height={height}\n            data={{ datasets }}\n            tooltips={tooltips}\n            annotations={annotations}\n            type=\"scatter\"\n            yAxes={yAxes({ minY: minYValue, maxY: maxYValue, scaleId: Y_AXIS_ID })}\n            saveCurrentYs={saveCurrentYs}\n            xAxisVal={xAxisVal}\n            scaleOptions={scaleOptions}\n          />\n        )}\n      </Dimensions>\n    </div>\n  );\n});\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotChart.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotChart.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotChart.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Plot-PlotChart-module-2gjxk--root {\\n  width: 100%;\\n  -ms-flex-positive: 1;\\n      flex-grow: 1;\\n  overflow: hidden; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotChart.module.scss\"],\"names\":[],\"mappings\":\"AASA;EACE,YAAW;EACX,qBAAY;MAAZ,aAAY;EACZ,iBAAgB,EACjB\",\"file\":\"PlotChart.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.root {\\n  width: 100%;\\n  flex-grow: 1;\\n  overflow: hidden;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"root\": \"packages-webviz-core-src-panels-Plot-PlotChart-module-2gjxk--root\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\n\nimport type { TimeBasedChartTooltipData } from \"./index\";\nimport styles from \"./TimeBasedChartTooltip.module.scss\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { formatTime, formatTimeRaw, getTimestampForMessage, subtractTimes, toSec } from \"webviz-core/src/util/time\";\n\ntype Props = {|\n  children: React.Element<any>,\n  tooltip: TimeBasedChartTooltipData,\n|};\nexport default class TimeBasedChartTooltip extends React.PureComponent<Props> {\n  render() {\n    const { tooltip } = this.props;\n    const value = typeof tooltip.value === \"string\" ? tooltip.value : JSON.stringify(tooltip.value);\n    const timestampReceiveTime = getTimestampForMessage(tooltip.item.message, \"receiveTime\");\n    const timestampHeaderStamp = getTimestampForMessage(tooltip.item.message, \"headerStamp\");\n    const content = (\n      <div className={styles.root}>\n        <div>\n          <span className={styles.title}>Value:&nbsp;</span>\n          {tooltip.constantName ? `${tooltip.constantName} (${value})` : value}\n        </div>\n        <div>\n          <span className={styles.title}>Path:&nbsp;</span>\n          {tooltip.path}\n        </div>\n        {timestampReceiveTime && timestampHeaderStamp && (\n          <table>\n            <tbody>\n              <tr>\n                <th />\n                {timestampReceiveTime && <th>receive time</th>}\n                {timestampHeaderStamp && <th>header.stamp</th>}\n              </tr>\n              <tr>\n                <th>ROS</th>\n                {timestampReceiveTime && <td>{formatTimeRaw(timestampReceiveTime)}</td>}\n                {timestampHeaderStamp && <td>{formatTimeRaw(timestampHeaderStamp)}</td>}\n              </tr>\n              <tr>\n                <th>Time</th>\n                {timestampReceiveTime && <td>{formatTime(timestampReceiveTime)}</td>}\n                {timestampHeaderStamp && <td>{formatTime(timestampHeaderStamp)}</td>}\n              </tr>\n              <tr>\n                <th>Elapsed</th>\n                {timestampReceiveTime && (\n                  <td>{toSec(subtractTimes(timestampReceiveTime, tooltip.startTime)).toFixed(9)} sec</td>\n                )}\n                {timestampHeaderStamp && (\n                  <td>{toSec(subtractTimes(timestampHeaderStamp, tooltip.startTime)).toFixed(9)} sec</td>\n                )}\n              </tr>\n            </tbody>\n          </table>\n        )}\n      </div>\n    );\n\n    return (\n      <Tooltip defaultShown placement=\"top\" contents={content}>\n        {this.props.children}\n      </Tooltip>\n    );\n  }\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./TimeBasedChartTooltip.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./TimeBasedChartTooltip.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./TimeBasedChartTooltip.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root {\\n  font-family: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n  font-size: 11px;\\n  line-height: 1.4;\\n  max-width: 350px;\\n  overflow-wrap: break-word; }\\n  .packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root th,\\n  .packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root td {\\n    border: none; }\\n  .packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root th {\\n    color: rgba(247, 247, 243, 0.3); }\\n    .packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root th:first-child {\\n      text-align: left; }\\n\\n.packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-3tnu1--title {\\n  color: rgba(247, 247, 243, 0.3); }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/components/TimeBasedChart/TimeBasedChartTooltip.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/mixins.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AASA;EC6EE,kFAFmF;EDzEnF,gBAAe;EACf,iBAAgB;EAChB,iBAAgB;EAChB,0BAAyB,EAc1B;EAnBD;;IASI,aAAY,EACb;EAVH;IAaI,gCENiC,EFWlC;IAlBH;MAgBM,iBAAgB,EACjB;;AAIL;EACE,gCEfmC,EFgBpC\",\"file\":\"TimeBasedChartTooltip.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.root {\\n  @include monospace;\\n  font-size: 11px;\\n  line-height: 1.4;\\n  max-width: 350px;\\n  overflow-wrap: break-word;\\n\\n  th,\\n  td {\\n    border: none;\\n  }\\n\\n  th {\\n    color: $text-muted;\\n\\n    &:first-child {\\n      text-align: left;\\n    }\\n  }\\n}\\n\\n.title {\\n  color: $text-muted;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: $padding ($padding + 4px);\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $toolbar;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: $control-padding;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active {\\n  color: $text-normal;\\n  // @extend %bold;\\n  background-color: $background-control-selected;\\n}\\n\\n%menu-item-hover {\\n  background-color: $menu-item-hover;\\n  color: $text-normal;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"root\": \"packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-4ruaa--root\",\n\t\"title\": \"packages-webviz-core-src-components-TimeBasedChart-TimeBasedChartTooltip-module-3tnu1--title\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { throttle } from \"lodash\";\nimport * as React from \"react\";\nimport shallowequal from \"shallowequal\";\nimport uuid from \"uuid\";\n\n// Creates a new component class that tries to keep various instances\n// of itself synchronized with each other.\n//\n// The way this works is that each component instance gets some `data`,\n// and all `data` are passed to the `reducer function`. Whenever some\n// `data` for any component instance changes, *all* instances are\n// rerendered with the output of the `reducer` function\n//\n// For example, if you want to find the maximum value of all the\n// values pass to `data`, you would create a component like this:\n//\n// const MaxSync = createSyncingComponent(\"MaxSync\", (dataItems) => max(dataItems));\n//\n// Now you can have multiple instances of this component:\n//\n// <div>\n//   <MaxSync data={10}>{(maximum) => <div>maximum is {maximum}</div>}</MaxSync>\n//   <MaxSync data={20}>{(maximum) => <div>maximum is {maximum}</div>}</MaxSync>\n//   <MaxSync data={30}>{(maximum) => <div>maximum is {maximum}</div>}</MaxSync>\n// </div>\n//\n// This will render:\n// <div>\n//   <div>maximum is 30</div>\n//   <div>maximum is 30</div>\n//   <div>maximum is 30</div>\n// </div>\nexport default function createSyncingComponent<ComponentData, ReducerOutput>(\n  displayName: string,\n  reducer: (ComponentData[]) => ReducerOutput\n): React.ComponentType<{| data: ComponentData, children: (ReducerOutput) => React.Node |}> {\n  type Props = {| data: ComponentData, children: (ReducerOutput) => React.Node |};\n\n  const dataById: { [string]: ComponentData } = {};\n  const componentsById: { [string]: React.Component<Props> } = {};\n  // Has the component already rendered with the most recent data available.\n  let hasRenderedIds = new Set();\n  let reducedData: ReducerOutput;\n\n  const THROTTLE_TIME_MS = 500;\n\n  return class SyncingComponent extends React.Component<Props> {\n    static displayName = displayName;\n    _id: string;\n\n    constructor(props: Props) {\n      super(props);\n      this._id = uuid.v4();\n      componentsById[this._id] = this;\n      dataById[this._id] = props.data;\n      this._recompute();\n    }\n\n    shouldComponentUpdate(nextProps: Props) {\n      if (!shallowequal(this.props.data, nextProps.data)) {\n        dataById[this._id] = nextProps.data;\n        this._recompute();\n      }\n\n      return true;\n    }\n\n    componentWillUnmount() {\n      delete componentsById[this._id];\n      delete dataById[this._id];\n      this._recompute();\n    }\n\n    _recompute() {\n      const newReducedData: ReducerOutput = reducer(Object.keys(dataById).map((id) => dataById[id]));\n      if (!shallowequal(reducedData, newReducedData)) {\n        reducedData = newReducedData;\n        hasRenderedIds = new Set();\n        this._throttledForceUpdate();\n      }\n    }\n\n    // This updating must be done asynchronously because forceUpdate being called during React reconciliation may not\n    // actually cause the child to re-render.\n    _throttledForceUpdate = throttle(\n      () => {\n        // Throttle updates because it's not imporant that components update immediately and calling `forceUpdate` often\n        // lead to suboptimal performance. Most of the time, synced plots will update within THROTTLE_TIME_MS anyways,\n        // making a forceUpdate unncessary.\n        Object.keys(componentsById).forEach((id) => {\n          if (id !== this._id && !hasRenderedIds.has(id)) {\n            componentsById[id].forceUpdate();\n          }\n        });\n      },\n      THROTTLE_TIME_MS,\n      { leading: false, trailing: true }\n    );\n\n    render() {\n      hasRenderedIds.add(this._id);\n      return this.props.children(reducedData);\n    }\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ChartJSManager from \"./ChartJSManager\";\nimport type { RpcLike } from \"webviz-core/src/util/FakeRpc\";\nimport Rpc from \"webviz-core/src/util/Rpc\";\nimport { setupWorker } from \"webviz-core/src/util/RpcUtils\";\n\nconst inWorkerEnvironment = global.postMessage && !global.onmessage;\n\nexport default class ChartJSWorker {\n  _rpc: RpcLike;\n  _managersById: { [string]: ChartJSManager };\n\n  constructor(rpc: RpcLike) {\n    this._managersById = {};\n\n    if (process.env.NODE_ENV !== \"test\" && inWorkerEnvironment && this._rpc instanceof Rpc) {\n      setupWorker(this._rpc);\n    }\n\n    rpc.receive(\"initialize\", (args) => {\n      const manager = new ChartJSManager(args);\n      this._managersById[args.id] = manager;\n      return this._managersById[args.id].getScaleBounds();\n    });\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    rpc.receive(\"doZoom\", (args) => this._managersById[args.id]?.doZoom(args));\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    rpc.receive(\"resetZoomDelta\", (args) => this._managersById[args.id]?.resetZoomDelta(args));\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    rpc.receive(\"doPan\", (args) => this._managersById[args.id]?.doPan(args));\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    rpc.receive(\"resetPanDelta\", (args) => this._managersById[args.id]?.resetPanDelta(args));\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    rpc.receive(\"update\", (args) => this._managersById[args.id]?.update(args));\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    rpc.receive(\"resetZoom\", (args) => this._managersById[args.id]?.resetZoom(args));\n    rpc.receive(\"destroy\", (args) => {\n      const manager = this._managersById[args.id];\n      if (manager) {\n        const result = manager.destroy(args);\n        delete this._managersById[args.id];\n        return result;\n      }\n    });\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    rpc.receive(\"getElementAtXAxis\", (args) => this._managersById[args.id]?.getElementAtXAxis(args));\n    // $FlowFixMe flow doesn't like function calls in optional chains\n    rpc.receive(\"getDatalabelAtEvent\", (args) => this._managersById[args.id]?.getDatalabelAtEvent(args));\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport Chart from \"chart.js\";\nimport keyBy from \"lodash/keyBy\";\nimport omit from \"lodash/omit\";\n\nimport {\n  type ZoomOptions,\n  type PanOptions,\n  doZoom,\n  doPan,\n  resetPanDelta,\n  resetZoomDelta,\n  resetZoom,\n  getScaleBounds,\n} from \"./zoomAndPanHelpers\";\n\n// These are options that we pass our worker. We have to pass this as a separate object instead of as part of the\n// config because they can only be set using a callback function, which we can't pass across worker boundaries.\nexport type ScaleOptions = {|\n  // Sets y-axis labels to a fixed width, so that vertically-aligned charts can be directly compared.\n  fixedYAxisWidth?: ?number,\n  // We might want to hide just the first and last because they can overlap with other labels or have long decimal\n  // points.\n  yAxisTicks?: \"show\" | \"hide\" | \"hideFirstAndLast\",\n  // Display the x-axes with a seconds unit, eg \"1 s\"\n  displayXAxesTicksInSeconds?: ?boolean,\n|};\n\nfunction hideAllTicksScaleCallback() {\n  return \"\";\n}\n\nfunction hideFirstAndLastTicksScaleCallback(value: number, index: number, values: number[]) {\n  if (index === 0 || index === values.length - 1) {\n    // First and last labels sometimes get super long rounding errors when zooming.\n    // This fixes that.\n    return \"\";\n  }\n  // Also round the scale value.\n  return `${Math.round(value * 1000) / 1000}`;\n}\n\nfunction displayTicksInSecondsCallback(value: number) {\n  return `${Math.round(value * 1000) / 1000} s`;\n}\n\nfunction mapChartElementToEventElement(chartInstance, item) {\n  return {\n    // It's annoying to have to rely on internal APIs like this, but there's literally no other way and the help\n    // documents themselves say to do this: https://www.chartjs.org/docs/latest/developers/api.html#getelementatevente\n    // eslint-disable-next-line no-underscore-dangle\n    data: chartInstance.data.datasets[item._datasetIndex]?.data[item._index],\n    // eslint-disable-next-line no-underscore-dangle\n    view: item._view,\n  };\n}\n\nconst datasetKeyProvider = (d) => d.label;\n\ntype ChartInstance = any;\n// This type is not yet in Flow, so temporarily type it this way.\ntype OffscreenCanvas = HTMLCanvasElement;\n\nexport { Chart };\n\nexport default class ChartJSManager {\n  id: string;\n  _node: OffscreenCanvas;\n  _chartInstance: ?ChartInstance;\n\n  constructor({\n    id,\n    node,\n    type,\n    data,\n    options,\n    scaleOptions,\n    devicePixelRatio,\n  }: {\n    id: string,\n    node: OffscreenCanvas,\n    type: any,\n    data: any,\n    options: any,\n    scaleOptions: ?ScaleOptions,\n    devicePixelRatio: number,\n  }) {\n    this.id = id;\n    this._node = node;\n    const plugins = {};\n    const chartInstance = new Chart(node, {\n      type,\n      data,\n      options: { ...this._addFunctionsToConfig(options, scaleOptions), devicePixelRatio },\n      plugins,\n    });\n    this._chartInstance = chartInstance;\n  }\n\n  getScaleBounds() {\n    const chartInstance = this._chartInstance;\n    if (!chartInstance) {\n      return;\n    }\n\n    return getScaleBounds(chartInstance);\n  }\n\n  doZoom({\n    zoomOptions,\n    percentZoomX,\n    percentZoomY,\n    focalPoint,\n    whichAxesParam,\n  }: {\n    zoomOptions: ZoomOptions,\n    percentZoomX: number,\n    percentZoomY: number,\n    focalPoint?: { x: number, y: number },\n    whichAxesParam?: string,\n  }) {\n    const chartInstance = this._chartInstance;\n    if (!chartInstance) {\n      return;\n    }\n\n    doZoom(this.id, chartInstance, zoomOptions, percentZoomX, percentZoomY, focalPoint, whichAxesParam);\n    return getScaleBounds(chartInstance);\n  }\n\n  resetZoomDelta() {\n    const chartInstance = this._chartInstance;\n    if (!chartInstance) {\n      return;\n    }\n\n    resetZoomDelta(this.id);\n  }\n\n  doPan({ panOptions, deltaX, deltaY }: { panOptions: PanOptions, deltaX: number, deltaY: number }) {\n    const chartInstance = this._chartInstance;\n    if (!chartInstance) {\n      return;\n    }\n\n    doPan(this.id, chartInstance, panOptions, deltaX, deltaY);\n    return getScaleBounds(chartInstance);\n  }\n\n  resetPanDelta() {\n    resetPanDelta(this.id);\n  }\n\n  update({ data, options, scaleOptions }: { data: any, options: any, scaleOptions: ?ScaleOptions }) {\n    const chartInstance = this._chartInstance;\n\n    if (!chartInstance) {\n      return;\n    }\n\n    if (options) {\n      options = this._addFunctionsToConfig(options, scaleOptions);\n      chartInstance.options = Chart.helpers.configMerge(chartInstance.options, options);\n    }\n\n    // Pipe datasets to chart instance datasets enabling\n    // seamless transitions\n    const currentDatasets = this._getCurrentDatasets();\n    const nextDatasets = (data && data.datasets) || [];\n    this._checkDatasets(currentDatasets);\n\n    const currentDatasetsIndexed = keyBy(currentDatasets, datasetKeyProvider);\n\n    // We can safely replace the dataset array, as long as we retain the _meta property\n    // on each dataset.\n    chartInstance.config.data.datasets = nextDatasets.map((next) => {\n      const current = currentDatasetsIndexed[datasetKeyProvider(next)];\n\n      if (current && current.type === next.type && next.data) {\n        // Be robust to no data. Relevant for other update mechanisms as in chartjs-plugin-streaming.\n        // The data array must be edited in place. As chart.js adds listeners to it.\n        current.data.splice(next.data.length);\n        next.data.forEach((point, pid) => {\n          current.data[pid] = next.data[pid];\n        });\n        const otherDatasetProps = omit(next, \"data\");\n        // Merge properties. Notice a weakness here. If a property is removed\n        // from next, it will be retained by current and never disappears.\n        // Workaround is to set value to null or undefined in next.\n        return {\n          ...current,\n          ...otherDatasetProps,\n        };\n      }\n      return next;\n    });\n\n    const otherDataProps = omit(data, \"datasets\");\n\n    chartInstance.config.data = {\n      ...chartInstance.config.data,\n      ...otherDataProps,\n    };\n\n    chartInstance.update();\n\n    return getScaleBounds(chartInstance);\n  }\n\n  resetZoom() {\n    const chartInstance = this._chartInstance;\n    if (chartInstance) {\n      resetZoom(this.id, chartInstance);\n    }\n\n    return getScaleBounds(chartInstance);\n  }\n\n  destroy() {\n    const chartInstance = this._chartInstance;\n    if (chartInstance) {\n      chartInstance.destroy();\n    }\n    this._chartInstance = null;\n  }\n\n  // Get the closest element at the same x-axis value as the cursor.\n  // This is a somewhat complex function because we attempt to copy the same behavior that the built-in tooltips have\n  // for Chart.js without a direct API for it.\n  getElementAtXAxis({ event }: { event: Event }) {\n    const chartInstance = this._chartInstance;\n    if (chartInstance) {\n      // Elements directly under the cursor.\n      const pointElements = chartInstance.getElementsAtEventForMode(event, \"point\");\n\n      if (pointElements.length) {\n        // If we have an element directly under the cursor, return it.\n        return mapChartElementToEventElement(chartInstance, pointElements[0]);\n      }\n\n      // Elements near the x-axis position of the cursor.\n      const xAxisElements = chartInstance.getElementsAtEventForMode(event, \"x\", { intersect: false });\n      if (xAxisElements.length) {\n        // The nearest elements to the cursor, regardless of how close they are.\n        const nearestElements = chartInstance.getElementsAtEventForMode(event, \"nearest\", { intersect: false });\n        const nearestXAxisElement = nearestElements.find((item) =>\n          // eslint-disable-next-line no-underscore-dangle\n          xAxisElements.some((item2) => item._index === item2._index && item._datasetIndex === item2._datasetIndex)\n        );\n        // If we have elements on the x-axis, return the nearest element if we can find it.\n        if (nearestXAxisElement) {\n          return mapChartElementToEventElement(chartInstance, nearestXAxisElement);\n        }\n        // Otherwise just return the first element on the x-axis.\n        return mapChartElementToEventElement(chartInstance, xAxisElements[0]);\n      }\n    }\n  }\n\n  getDatalabelAtEvent({ event }: { event: Event }) {\n    const chartInstance = this._chartInstance;\n    if (chartInstance) {\n      const chartDatalabel = chartInstance.$datalabels.getLabelAtEvent(event);\n      if (chartDatalabel) {\n        const context = chartDatalabel.$context;\n        return context.dataset.data[context.dataIndex];\n      }\n    }\n  }\n\n  _addFunctionsToConfig(config: any, scaleOptions: ?ScaleOptions) {\n    if (config && config.plugins.datalabels) {\n      // This controls which datalabels are displayed. Only display labels for datapoints that include a \"label\"\n      // property.\n      config.plugins.datalabels.formatter = (value: any, context: any) => {\n        const label = value?.label;\n        // We have to return \"null\" if we don't want this label to be displayed. Returning \"undefined\" falls back to the\n        // default formatting.\n        return label != null ? label : null;\n      };\n      // Override color so that it can be set per-dataset.\n      const staticColor = config.plugins.datalabels.color || \"white\";\n      config.plugins.datalabels.color = (context: any) => {\n        const value = context.dataset.data[context.dataIndex];\n        return value?.labelColor || staticColor;\n      };\n    }\n\n    if (scaleOptions) {\n      for (const scale of config.scales.yAxes) {\n        if (scaleOptions.fixedYAxisWidth != null) {\n          scale.afterFit = (scaleInstance: any) => {\n            scaleInstance.width = scaleOptions.fixedYAxisWidth;\n          };\n        }\n        scale.ticks = scale.ticks || {};\n        if (scaleOptions.yAxisTicks === \"hide\") {\n          scale.ticks.callback = hideAllTicksScaleCallback;\n        } else if (scaleOptions.yAxisTicks === \"hideFirstAndLast\") {\n          scale.ticks.callback = hideFirstAndLastTicksScaleCallback;\n        }\n      }\n\n      for (const scale of config.scales.xAxes) {\n        scale.ticks = scale.ticks || {};\n        if (scaleOptions.displayXAxesTicksInSeconds) {\n          scale.ticks.callback = displayTicksInSecondsCallback;\n        }\n      }\n    }\n\n    return config;\n  }\n\n  _checkDatasets(datasets: any[]) {\n    const isDev = process.env.NODE_ENV !== \"production\" && process.env.NODE_ENV !== \"prod\";\n    const multipleDatasets = datasets.length > 1;\n\n    if (isDev && multipleDatasets) {\n      let shouldWarn = false;\n      datasets.forEach((dataset) => {\n        if (!dataset.label) {\n          shouldWarn = true;\n        }\n      });\n\n      if (shouldWarn) {\n        console.error(\n          '[ChartJSManager] Warning: Each dataset needs a unique key. By default, the \"label\" property on each dataset is used.'\n        );\n      }\n    }\n  }\n\n  _getCurrentDatasets() {\n    return (this._chartInstance && this._chartInstance.config.data && this._chartInstance.config.data.datasets) || [];\n  }\n}\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"ChartJSWorker.worker.js?d6e6c262068577885d1d\");\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type Rpc from \"webviz-core/src/util/Rpc\";\n\nclass FakeRpc {\n  proxiedWorker: FakeRpc;\n  handlers: { [string]: (any) => any } = {};\n\n  async send<TResult>(topic: string, data: any, transfer?: any[]): Promise<TResult> {\n    return this.proxiedWorker.handlers[topic](data);\n  }\n\n  async receive<T, TOut>(topic: string, handler: (T) => TOut) {\n    if (this.handlers[topic]) {\n      throw new Error(`Cannot call receive twice for topic: ${topic}`);\n    }\n    this.handlers[topic] = handler;\n  }\n}\n\nexport function getFakeRpcs() {\n  const workerRpc = new FakeRpc();\n  const mainThreadRpc = new FakeRpc();\n  workerRpc.proxiedWorker = mainThreadRpc;\n  mainThreadRpc.proxiedWorker = workerRpc;\n  return { workerRpc, mainThreadRpc };\n}\n\nexport type RpcLike = Rpc | FakeRpc;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport React from \"react\";\n\nimport { PLOT_DASHED_STYLE, PLOT_DOT_DASHED_STYLE } from \"webviz-core/src/components/TimeBasedChart/constants\";\n\ntype Dataset = { label: string, color: string, borderDash: string };\n\ntype Props = {\n  canToggleLines?: boolean,\n  datasets: Dataset[],\n  linesToHide: { [string]: boolean },\n  toggleLine: (datasetId: string | typeof undefined, lineToHide: string) => void,\n  datasetId?: string,\n};\n\nconst checkboxStyle = { height: 12, marginBottom: -2 };\n\nexport default class TimeBasedChartLegend extends React.PureComponent<Props> {\n  _toggleLine = (label: string) => () => {\n    const { datasetId, toggleLine } = this.props;\n    toggleLine(datasetId, label);\n  };\n\n  render() {\n    const { canToggleLines, linesToHide } = this.props;\n    return (\n      <div>\n        {this.props.datasets.map((dataset, i) => {\n          const { label, color, borderDash } = dataset;\n          let pointSvg;\n          if (borderDash === PLOT_DOT_DASHED_STYLE) {\n            pointSvg = (\n              <svg width=\"11\" height=\"10\">\n                <line\n                  stroke={color}\n                  strokeWidth=\"2\"\n                  strokeDasharray={PLOT_DOT_DASHED_STYLE.join(\", \")}\n                  x1=\"0\"\n                  x2=\"18\"\n                  y1=\"6\"\n                  y2=\"6\"\n                />\n              </svg>\n            );\n          } else if (borderDash === PLOT_DASHED_STYLE) {\n            pointSvg = <span style={{ fontSize: \"12px\", fontWeight: \"bold\" }}>- -</span>;\n          } else {\n            pointSvg = <span style={{ fontSize: \"12px\", fontWeight: \"bold\" }}>––</span>;\n          }\n          const CheckboxComponent = linesToHide[label] ? CheckboxBlankOutlineIcon : CheckboxMarkedIcon;\n          return (\n            <div key={i} style={{ color, fill: \"white\", whiteSpace: \"nowrap\" }}>\n              {canToggleLines && <CheckboxComponent style={checkboxStyle} onClick={this._toggleLine(label)} />}\n              {pointSvg} <span style={{ fontSize: \"10px\" }}>{label}</span>\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nexport const PLOT_DASHED_STYLE = [5, 5];\nexport const PLOT_DOT_DASHED_STYLE = [3, 2, 1, 2];\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { type TimeBasedChartTooltipData } from \"webviz-core/src/components/TimeBasedChart\";\nimport type { PlotChartPoint } from \"webviz-core/src/panels/Plot/PlotChart\";\n\nexport default function derivative(\n  data: PlotChartPoint[],\n  tooltips: TimeBasedChartTooltipData[]\n): { points: PlotChartPoint[], tooltips: TimeBasedChartTooltipData[] } {\n  const points = [];\n  const newTooltips = [];\n  for (let i = 1; i < data.length; i++) {\n    const secondsDifference = data[i].x - data[i - 1].x;\n    const value = (data[i].y - data[i - 1].y) / secondsDifference;\n    const previousTooltip = tooltips[i];\n    const point: PlotChartPoint = { x: data[i].x, y: value };\n    const tooltip = {\n      x: point.x,\n      y: point.y,\n      item: previousTooltip.item,\n      path: `${previousTooltip.path}.@derivative`,\n      datasetKey: previousTooltip.datasetKey,\n      value,\n      constantName: undefined,\n      startTime: previousTooltip.startTime,\n    };\n    newTooltips.push(tooltip);\n    points.push(point);\n  }\n  return { points, tooltips: newTooltips };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport MenuIcon from \"@mdi/svg/svg/menu.svg\";\nimport cx from \"classnames\";\nimport { last } from \"lodash\";\nimport React, { useCallback, useMemo } from \"react\";\n\nimport { plotableRosTypes, type PlotConfig } from \"./index\";\nimport styles from \"./PlotLegend.module.scss\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport {\n  type PlotPath,\n  type BasePlotPath,\n  isReferenceLinePlotPathType,\n} from \"webviz-core/src/panels/Plot/internalTypes\";\nimport { lineColors } from \"webviz-core/src/util/plotColors\";\nimport type { TimestampMethod } from \"webviz-core/src/util/time\";\n\ntype PlotLegendProps = {|\n  paths: PlotPath[],\n  saveConfig: ($Shape<PlotConfig>) => void,\n  showLegend: boolean,\n  xAxisVal: \"timestamp\" | \"index\" | \"custom\",\n  xAxisPath?: BasePlotPath,\n|};\n\nexport default function PlotLegend(props: PlotLegendProps) {\n  const { paths, saveConfig, showLegend, xAxisVal, xAxisPath } = props;\n  const lastPath = last(paths);\n\n  const onInputChange = useCallback(\n    (value: string, index: ?number) => {\n      if (index == null) {\n        throw new Error(\"index not set\");\n      }\n      const newPaths = paths.slice();\n      newPaths[index] = { ...newPaths[index], value: value.trim() };\n      saveConfig({ paths: newPaths });\n    },\n    [paths, saveConfig]\n  );\n\n  const onInputTimestampMethodChange = useCallback(\n    (value: TimestampMethod, index: ?number) => {\n      if (index == null) {\n        throw new Error(\"index not set\");\n      }\n      const newPaths = paths.slice();\n      newPaths[index] = { ...newPaths[index], timestampMethod: value };\n      saveConfig({ paths: newPaths });\n    },\n    [paths, saveConfig]\n  );\n\n  const { toggleToHideLegend, toggleToShowLegend } = useMemo(\n    () => ({\n      toggleToHideLegend: () => saveConfig({ showLegend: false }),\n      toggleToShowLegend: () => saveConfig({ showLegend: true }),\n    }),\n    [saveConfig]\n  );\n\n  if (!showLegend) {\n    return (\n      <div className={styles.root}>\n        <Icon className={styles.legendToggle} onClick={toggleToShowLegend}>\n          <MenuIcon />\n        </Icon>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.root}>\n      <Icon className={styles.legendToggle} onClick={toggleToHideLegend}>\n        <MenuIcon />\n      </Icon>\n      <div className={styles.item}>\n        x:\n        <div className={styles.itemIconContainer} style={{ width: \"auto\", lineHeight: \"normal\", zIndex: 2 }}>\n          <Dropdown\n            dataTest=\"plot-legend-x-axis-menu\"\n            value={xAxisVal}\n            btnStyle={{ backgroundColor: \"transparent\", padding: 3 }}\n            onChange={(newXAxisVal) => saveConfig({ xAxisVal: newXAxisVal })}\n            noPortal>\n            <span value=\"timestamp\">timestamp</span>\n            <span value=\"index\">index</span>\n            <span value=\"custom\">custom</span>\n          </Dropdown>\n        </div>\n        <div\n          className={cx({\n            [styles.itemInput]: true,\n            [styles.itemInputDisabled]: !xAxisPath?.enabled,\n          })}\n          style={{ display: \"flex\" }}>\n          {xAxisVal === \"custom\" ? (\n            <MessagePathInput\n              path={xAxisPath?.value || \"/\"}\n              onChange={(newXAxisVal) =>\n                saveConfig({ xAxisPath: { value: newXAxisVal, enabled: xAxisPath ? xAxisPath.enabled : true } })\n              }\n              validTypes={plotableRosTypes}\n              placeholder=\"Enter a topic name or a number\"\n              disableAutocomplete={xAxisPath && isReferenceLinePlotPathType(xAxisPath)}\n              autoSize\n            />\n          ) : null}\n        </div>\n      </div>\n      {paths.map((path: PlotPath, index: number) => {\n        const isReferenceLinePlotPath = isReferenceLinePlotPathType(path);\n        let timestampMethod;\n        // Only allow chosing the timestamp method if it is applicable (not a reference line) and there is at least\n        // one character typed.\n        if (!isReferenceLinePlotPath && path.value.length > 0) {\n          timestampMethod = path.timestampMethod;\n        }\n        return (\n          <React.Fragment key={index}>\n            <div className={styles.item}>\n              y:\n              <div\n                className={styles.itemIconContainer}\n                style={{ zIndex: 1 }}\n                onClick={() => {\n                  const newPaths = paths.slice();\n                  newPaths[index] = { ...newPaths[index], enabled: !newPaths[index].enabled };\n                  saveConfig({ paths: newPaths });\n                }}>\n                <div\n                  className={styles.itemIcon}\n                  style={{ color: path.enabled ? lineColors[index % lineColors.length] : \"#777\" }}\n                />\n              </div>\n              <div\n                className={cx({\n                  [styles.itemInput]: true,\n                  [styles.itemInputDisabled]: !path.enabled,\n                })}>\n                <MessagePathInput\n                  path={path.value}\n                  onChange={onInputChange}\n                  onTimestampMethodChange={onInputTimestampMethodChange}\n                  validTypes={plotableRosTypes}\n                  placeholder=\"Enter a topic name or a number\"\n                  index={index}\n                  autoSize\n                  disableAutocomplete={isReferenceLinePlotPath}\n                  {...(xAxisVal === \"timestamp\" ? { timestampMethod } : null)}\n                />\n              </div>\n              <div\n                className={styles.itemRemove}\n                onClick={() => {\n                  const newPaths = paths.slice();\n                  newPaths.splice(index, 1);\n                  saveConfig({ paths: newPaths });\n                }}>\n                ✕\n              </div>\n            </div>\n          </React.Fragment>\n        );\n      })}\n      <div\n        className={styles.addLine}\n        onClick={() =>\n          saveConfig({\n            paths: [\n              ...paths,\n              {\n                value: \"\",\n                enabled: true,\n                // For convenience, default to the `timestampMethod` of the last path.\n                timestampMethod: lastPath ? lastPath.timestampMethod : \"receiveTime\",\n              },\n            ],\n          })\n        }>\n        + add line\n      </div>\n    </div>\n  );\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotLegend.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotLegend.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotLegend.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Plot-PlotLegend-module-hqdgr--root {\\n  position: absolute;\\n  left: 65px;\\n  top: 25px;\\n  background: rgba(45, 44, 51, 0.7);\\n  color: #eee;\\n  max-width: calc(100% - 65px - 25px); }\\n  .packages-webviz-core-src-panels-Plot-PlotLegend-module-hqdgr--root:hover {\\n    background: rgba(45, 44, 51, 0.7); }\\n\\n.packages-webviz-core-src-panels-Plot-PlotLegend-module-35sea--addLine {\\n  display: none;\\n  content: \\\"+ add line\\\";\\n  position: absolute;\\n  background: rgba(45, 44, 51, 0.7);\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  -webkit-transform: translateY(100%);\\n      -ms-transform: translateY(100%);\\n          transform: translateY(100%);\\n  padding: 6px;\\n  cursor: pointer;\\n  text-align: center; }\\n  .packages-webviz-core-src-panels-Plot-PlotLegend-module-35sea--addLine:hover {\\n    background: #403f49; }\\n  .packages-webviz-core-src-panels-Plot-PlotLegend-module-hqdgr--root:hover .packages-webviz-core-src-panels-Plot-PlotLegend-module-35sea--addLine {\\n    display: block; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotLegend-module-gxp3j--item {\\n  display: -ms-flexbox;\\n  display: flex;\\n  padding: 0 5px;\\n  height: 20px;\\n  line-height: 20px;\\n  position: relative; }\\n  .packages-webviz-core-src-panels-Plot-PlotLegend-module-gxp3j--item:hover {\\n    background: #403f49; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotLegend-module-3zckg--itemIconContainer {\\n  display: inline-block;\\n  width: 22px;\\n  height: 20px;\\n  line-height: 0;\\n  cursor: pointer;\\n  text-align: center;\\n  -ms-flex-negative: 0;\\n      flex-shrink: 0; }\\n  .packages-webviz-core-src-panels-Plot-PlotLegend-module-3zckg--itemIconContainer:hover {\\n    background: #565462; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotLegend-module-4k2d2--itemIcon {\\n  display: inline-block;\\n  width: 15px;\\n  border-bottom: 2px solid currentColor;\\n  height: 0px;\\n  vertical-align: middle;\\n  position: relative;\\n  top: calc(50% - 1px); }\\n\\n.packages-webviz-core-src-panels-Plot-PlotLegend-module-2x85m--legendToggle {\\n  visibility: hidden;\\n  padding: 6px;\\n  cursor: pointer;\\n  position: absolute;\\n  top: 0;\\n  left: -30px;\\n  height: 25px;\\n  border-radius: 5px;\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n      -ms-user-select: none;\\n          user-select: none;\\n  background: #403f49; }\\n  .packages-webviz-core-src-panels-Plot-PlotLegend-module-2x85m--legendToggle:hover {\\n    background: #403f49; }\\n  .mosaic-window:hover .packages-webviz-core-src-panels-Plot-PlotLegend-module-2x85m--legendToggle {\\n    visibility: initial; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotLegend-module-2cz1t--itemRemove {\\n  visibility: hidden;\\n  padding: 0 6px;\\n  cursor: pointer;\\n  position: absolute;\\n  right: -21px;\\n  background: transparent;\\n  height: 20px;\\n  line-height: 20px;\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n      -ms-user-select: none;\\n          user-select: none; }\\n  .packages-webviz-core-src-panels-Plot-PlotLegend-module-2cz1t--itemRemove:hover {\\n    background: #403f49; }\\n  .packages-webviz-core-src-panels-Plot-PlotLegend-module-gxp3j--item:hover .packages-webviz-core-src-panels-Plot-PlotLegend-module-2cz1t--itemRemove {\\n    visibility: initial; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotLegend-module-22dxt--itemInput {\\n  overflow: hidden;\\n  width: 100%; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotLegend-module-3fhwe--itemInputDisabled input {\\n  text-decoration: line-through; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotLegend.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAaA;EAEE,mBAAkB;EAClB,WAFuB;EAGvB,UAAS;EACT,kCCmBe;EDlBf,YAAW;EACX,oCAAmD,EAKpD;EAZD;IAUI,kCCca,EDbd;;AAGH;EACE,cAAa;EACb,sBAAqB;EACrB,mBAAkB;EAClB,kCCMe;EDLf,QAAO;EACP,SAAQ;EACR,UAAS;EACT,oCAA2B;MAA3B,gCAA2B;UAA3B,4BAA2B;EAC3B,aAAY;EACZ,gBAAe;EACf,mBAAkB,EASnB;EApBD;IAcI,oBAhCyE,EAiC1E;EAED;IACE,eAAc,EACf;;AAGH;EACE,qBAAa;EAAb,cAAa;EACb,eAAc;EACd,aAzCuB;EA0CvB,kBA1CuB;EA2CvB,mBAAkB,EAKnB;EAVD;IAQI,oBAhDyE,EAiD1E;;AAGH;EACE,sBAAqB;EACrB,YAAW;EACX,aArDuB;EAsDvB,eAAc;EACd,gBAAe;EACf,mBAAkB;EAClB,qBAAc;MAAd,eAAc,EAKf;EAZD;IAUI,oBA7D4E,EA8D7E;;AAGH;EACE,sBAAqB;EACrB,YAAW;EACX,sCAAqC;EACrC,YAAW;EACX,uBAAsB;EACtB,mBAAkB;EAClB,qBAAoB,EACrB;;AAED;EACE,mBAAkB;EAClB,aAAY;EACZ,gBAAe;EACf,mBAAkB;EAClB,OAAM;EACN,YAAW;EACX,aAAY;EACZ,mBAAkB;EAClB,0BAAiB;KAAjB,uBAAiB;MAAjB,sBAAiB;UAAjB,kBAAiB;EACjB,oBAtF2E,EA+F5E;EAnBD;IAaI,oBAzFyE,EA0F1E;EAED;IACE,oBAAmB,EACpB;;AAGH;EACE,mBAAkB;EAClB,eAAc;EACd,gBAAe;EACf,mBAAkB;EAClB,aAAY;EACZ,wBAAuB;EACvB,aAtGuB;EAuGvB,kBAvGuB;EAwGvB,0BAAiB;KAAjB,uBAAiB;MAAjB,sBAAiB;UAAjB,kBAAiB,EASlB;EAlBD;IAYI,oBA7GyE,EA8G1E;EAED;IACE,oBAAmB,EACpB;;AAGH;EACE,iBAAgB;EAChB,YAAW,EACZ;;AAID;EACE,8BAA6B,EAC9B\",\"file\":\"PlotLegend.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n$legend-highlight-color: rgba($toolbar, 0.7);\\n$legend-highlight-color-bright: lighten(rgba($legend-highlight-color, 1), 8%);\\n$legend-highlight-color-brighter: lighten(rgba($legend-highlight-color, 1), 17%);\\n$legend-item-height: 20px;\\n\\n.root {\\n  $legend-root-left: 65px;\\n  position: absolute;\\n  left: $legend-root-left;\\n  top: 25px;\\n  background: $legend-highlight-color;\\n  color: #eee;\\n  max-width: calc(100% - #{$legend-root-left} - 25px); // Leave some space at the end for the \\\"X\\\".\\n\\n  &:hover {\\n    background: $legend-highlight-color;\\n  }\\n}\\n\\n.addLine {\\n  display: none;\\n  content: \\\"+ add line\\\";\\n  position: absolute;\\n  background: $legend-highlight-color;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  transform: translateY(100%);\\n  padding: 6px;\\n  cursor: pointer;\\n  text-align: center;\\n\\n  &:hover {\\n    background: $legend-highlight-color-bright;\\n  }\\n\\n  .root:hover & {\\n    display: block;\\n  }\\n}\\n\\n.item {\\n  display: flex;\\n  padding: 0 5px;\\n  height: $legend-item-height;\\n  line-height: $legend-item-height;\\n  position: relative;\\n\\n  &:hover {\\n    background: $legend-highlight-color-bright;\\n  }\\n}\\n\\n.itemIconContainer {\\n  display: inline-block;\\n  width: 22px;\\n  height: $legend-item-height;\\n  line-height: 0;\\n  cursor: pointer;\\n  text-align: center;\\n  flex-shrink: 0;\\n\\n  &:hover {\\n    background: $legend-highlight-color-brighter;\\n  }\\n}\\n\\n.itemIcon {\\n  display: inline-block;\\n  width: 15px;\\n  border-bottom: 2px solid currentColor;\\n  height: 0px;\\n  vertical-align: middle;\\n  position: relative;\\n  top: calc(50% - 1px);\\n}\\n\\n.legendToggle {\\n  visibility: hidden;\\n  padding: 6px;\\n  cursor: pointer;\\n  position: absolute;\\n  top: 0;\\n  left: -30px;\\n  height: 25px;\\n  border-radius: 5px;\\n  user-select: none;\\n  background: $legend-highlight-color-bright;\\n\\n  &:hover {\\n    background: $legend-highlight-color-bright;\\n  }\\n\\n  :global(.mosaic-window):hover & {\\n    visibility: initial;\\n  }\\n}\\n\\n.itemRemove {\\n  visibility: hidden;\\n  padding: 0 6px;\\n  cursor: pointer;\\n  position: absolute;\\n  right: -21px;\\n  background: transparent;\\n  height: $legend-item-height;\\n  line-height: $legend-item-height;\\n  user-select: none;\\n\\n  &:hover {\\n    background: $legend-highlight-color-bright;\\n  }\\n\\n  .item:hover & {\\n    visibility: initial;\\n  }\\n}\\n\\n.itemInput {\\n  overflow: hidden;\\n  width: 100%;\\n}\\n\\n// <input> is several levels deeper, and there's not too much chance\\n// of leaking stuff here, so not using `>`.\\n.itemInputDisabled input {\\n  text-decoration: line-through;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"root\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-hqdgr--root\",\n\t\"addLine\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-35sea--addLine\",\n\t\"item\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-gxp3j--item\",\n\t\"itemIconContainer\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-3zckg--itemIconContainer\",\n\t\"itemIcon\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-4k2d2--itemIcon\",\n\t\"legendToggle\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-2x85m--legendToggle\",\n\t\"itemRemove\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-2cz1t--itemRemove\",\n\t\"itemInput\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-22dxt--itemInput\",\n\t\"itemInputDisabled\": \"packages-webviz-core-src-panels-Plot-PlotLegend-module-3fhwe--itemInputDisabled\"\n};","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./MessagePathInput.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./MessagePathInput.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./MessagePathInput.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3verb--timestampMethodDropdownContainer {\\n  -ms-flex-negative: 100;\\n      flex-shrink: 100;\\n  min-width: 20px;\\n  white-space: nowrap; }\\n\\n.packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3cepp--timestampMethodDropdown {\\n  cursor: pointer;\\n  padding-left: 2px;\\n  color: rgba(247, 247, 243, 0.3); }\\n  .packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3cepp--timestampMethodDropdown.packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3v61x--timestampMethodDropdownError {\\n    color: #ff7c96; }\\n  .packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3cepp--timestampMethodDropdown:hover {\\n    color: rgba(247, 247, 243, 0.77); }\\n\\n.packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3nvnu--timestampItemError {\\n  color: #ff7c96; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/components/MessagePathSyntax/MessagePathInput.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA;EACE,uBAAgB;MAAhB,iBAAgB;EAChB,gBAAe;EACf,oBAAmB,EACpB;;AAED;EACE,gBAAe;EACf,kBAAiB;EACjB,gCCDmC,EDUpC;EAZD;IAMI,eCoBS,EDnBV;EAPH;IAUI,iCCVmC,EDWpC;;AAGH;EACE,eCWW,EDVZ\",\"file\":\"MessagePathInput.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.timestampMethodDropdownContainer {\\n  flex-shrink: 100;\\n  min-width: 20px;\\n  white-space: nowrap;\\n}\\n\\n.timestampMethodDropdown {\\n  cursor: pointer;\\n  padding-left: 2px;\\n  color: $text-muted;\\n\\n  &.timestampMethodDropdownError {\\n    color: $red;\\n  }\\n\\n  &:hover {\\n    color: $text-normal;\\n  }\\n}\\n\\n.timestampItemError {\\n  color: $red;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"timestampMethodDropdownContainer\": \"packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3verb--timestampMethodDropdownContainer\",\n\t\"timestampMethodDropdown\": \"packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3cepp--timestampMethodDropdown\",\n\t\"timestampMethodDropdownError\": \"packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3v61x--timestampMethodDropdownError\",\n\t\"timestampItemError\": \"packages-webviz-core-src-components-MessagePathSyntax-MessagePathInput-module-3nvnu--timestampItemError\"\n};","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Autocomplete.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Autocomplete.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./Autocomplete.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-Autocomplete-module-4nh6c--root {\\n  border-radius: 3px;\\n  border-top-left-radius: 0;\\n  -webkit-box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\\n          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\\n  position: fixed;\\n  overflow: auto;\\n  background: #2d2c33;\\n  z-index: 1;\\n  margin-left: -6px; }\\n\\n.packages-webviz-core-src-components-Autocomplete-module-4p3nz--input {\\n  -ms-flex-positive: 1;\\n      flex-grow: 1;\\n  margin: 0;\\n  padding: 0;\\n  background: transparent !important;\\n  color: inherit;\\n  border-radius: 0; }\\n  .packages-webviz-core-src-components-Autocomplete-module-4p3nz--input::-webkit-input-placeholder {\\n    color: rgba(247, 247, 243, 0.3); }\\n  .packages-webviz-core-src-components-Autocomplete-module-4p3nz--input:-ms-input-placeholder {\\n    color: rgba(247, 247, 243, 0.3); }\\n  .packages-webviz-core-src-components-Autocomplete-module-4p3nz--input::-ms-input-placeholder {\\n    color: rgba(247, 247, 243, 0.3); }\\n  .packages-webviz-core-src-components-Autocomplete-module-4p3nz--input::placeholder {\\n    color: rgba(247, 247, 243, 0.3); }\\n  .packages-webviz-core-src-components-Autocomplete-module-4p3nz--input.packages-webviz-core-src-components-Autocomplete-module-ucccr--inputError {\\n    color: #ff7c96; }\\n\\n.packages-webviz-core-src-components-Autocomplete-module-2jjcu--autocompleteItem {\\n  padding: 6px;\\n  cursor: pointer;\\n  min-height: 24px;\\n  line-height: 14px;\\n  overflow-wrap: break-word;\\n  color: rgba(247, 247, 243, 0.77); }\\n\\n.packages-webviz-core-src-components-Autocomplete-module-teqbe--selected {\\n  background-color: rgba(59, 46, 118, 0.6); }\\n\\n.packages-webviz-core-src-components-Autocomplete-module-3m69w--highlighted {\\n  background-color: #3b2e76; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/components/Autocomplete.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAUA;EACE,mBAAkB;EAClB,0BAAyB;EACzB,kDAAyC;UAAzC,0CAAyC;EACzC,gBAAe;EACf,eAAc;EACd,oBCqBe;EDpBf,WAAU;EACV,kBAAiB,EAClB;;AAED;EACE,qBAAY;MAAZ,aAAY;EACZ,UAAS;EACT,WAAU;EACV,mCAAkC;EAClC,eAAc;EACd,iBAAgB,EASjB;EAfD;IASI,gCCdiC,EDelC;EAVH;IASI,gCCdiC,EDelC;EAVH;IASI,gCCdiC,EDelC;EAVH;IASI,gCCdiC,EDelC;EAVH;IAaI,eCMS,EDLV;;AAGH;EACE,aAAY;EACZ,gBAAe;EACf,iBAjCe;EAkCf,kBAA+B;EAC/B,0BAAyB;EACzB,iCC9BqC,ED+BtC;;AAED;EACE,yCCxCkD,EDyCnD;;AACD;EACE,0BCzBuB,ED0BxB\",\"file\":\"Autocomplete.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n$row-height: 24px;\\n\\n.root {\\n  border-radius: 3px;\\n  border-top-left-radius: 0;\\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\\n  position: fixed;\\n  overflow: auto;\\n  background: $toolbar;\\n  z-index: 1;\\n  margin-left: -6px;\\n}\\n\\n.input {\\n  flex-grow: 1;\\n  margin: 0;\\n  padding: 0;\\n  background: transparent !important;\\n  color: inherit;\\n  border-radius: 0;\\n\\n  &::placeholder {\\n    color: $text-muted;\\n  }\\n\\n  &.inputError {\\n    color: $red;\\n  }\\n}\\n\\n.autocompleteItem {\\n  padding: 6px;\\n  cursor: pointer;\\n  min-height: $row-height;\\n  line-height: $row-height - 10px;\\n  overflow-wrap: break-word;\\n  color: $text-normal;\\n}\\n\\n.selected {\\n  background-color: $background-control-selected;\\n}\\n.highlighted {\\n  background-color: $menu-item-hover;\\n}\\n\\n:export {\\n  rowHeight: $row-height / 1px;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"rowHeight\": \"24\",\n\t\"root\": \"packages-webviz-core-src-components-Autocomplete-module-4nh6c--root\",\n\t\"input\": \"packages-webviz-core-src-components-Autocomplete-module-4p3nz--input\",\n\t\"inputError\": \"packages-webviz-core-src-components-Autocomplete-module-ucccr--inputError\",\n\t\"autocompleteItem\": \"packages-webviz-core-src-components-Autocomplete-module-2jjcu--autocompleteItem\",\n\t\"selected\": \"packages-webviz-core-src-components-Autocomplete-module-teqbe--selected\",\n\t\"highlighted\": \"packages-webviz-core-src-components-Autocomplete-module-3m69w--highlighted\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n// Fuzzy matching: allow filter \"fzmg\" to match \"fuzzy/matching\".\n// Score by how early in the string matches appear.\nexport default function fuzzyFilter<T>(\n  options: T[],\n  filter: ?string,\n  getText: (T) => string = (x: any) => x,\n  sort: boolean = true\n): T[] {\n  if (!filter) {\n    return options;\n  }\n  const needle = filter.toLowerCase().replace(/[^a-z0-9]/g, \"\");\n  if (needle.length === 0) {\n    return options;\n  }\n\n  type Result = {| option: T, score: number |};\n  const results: Result[] = [];\n\n  for (const option of options) {\n    const haystack = getText(option).toLowerCase();\n    let charPos = -1;\n    let score = 0;\n    for (const char of needle) {\n      charPos = haystack.indexOf(char, charPos + 1);\n      if (charPos === -1) {\n        break;\n      }\n      score += charPos;\n    }\n    if (charPos !== -1) {\n      results.push({\n        option,\n        score: score * haystack.length,\n      });\n    }\n  }\n\n  if (sort) {\n    results.sort((a, b) => a.score - b.score);\n  }\n  return results.map((result: Result): T => result.option);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport cx from \"classnames\";\nimport React from \"react\";\n\nimport styles from \"./PlotMenu.module.scss\";\nimport { PanelToolbarInput } from \"webviz-core/shared/panelToolbarStyles\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport { type TimeBasedChartTooltipData } from \"webviz-core/src/components/TimeBasedChart\";\nimport type { PlotConfig } from \"webviz-core/src/panels/Plot\";\nimport { type DataSet, type PlotChartPoint } from \"webviz-core/src/panels/Plot/PlotChart\";\nimport { downloadFiles } from \"webviz-core/src/util\";\nimport { formatTimeRaw } from \"webviz-core/src/util/time\";\n\nfunction isValidInput(value: string) {\n  return value === \"\" || !isNaN(parseFloat(value));\n}\n\nexport function getHeader(message: any) {\n  let header = null;\n  for (const key in message) {\n    if (key.includes(\"header\")) {\n      header = message[key];\n    }\n  }\n  return header;\n}\n\nfunction formatData(\n  data: PlotChartPoint,\n  dataIndex: number,\n  label: string,\n  datasetKey: string,\n  tooltips: TimeBasedChartTooltipData[]\n) {\n  const { x, y } = data;\n  const tooltip = tooltips.find((_tooltip) => _tooltip.datasetKey === datasetKey);\n  if (!tooltip) {\n    throw new Error(\"Cannot find tooltip for dataset: this should never happen\");\n  }\n  const { receiveTime, message } = tooltip.item.message;\n  const receiveTimeFloat = formatTimeRaw(receiveTime);\n  const header = getHeader(message);\n  const stampTime = header ? formatTimeRaw(header.stamp) : \"\";\n  return [x, receiveTimeFloat, stampTime, label, y];\n}\n\nexport function getCSVData(datasets: DataSet[], tooltips: TimeBasedChartTooltipData[]): string {\n  const headLine = [\"elapsed time\", \"receive time\", \"header.stamp\", \"topic\", \"value\"];\n  const combinedLines = [];\n  combinedLines.push(headLine);\n  datasets.forEach((dataset, idx) => {\n    dataset.data.forEach((data, dataIndex) => {\n      combinedLines.push(formatData(data, dataIndex, dataset.label, dataset.key, tooltips));\n    });\n  });\n  return combinedLines.join(\"\\n\");\n}\n\nfunction downloadCsvFile(datasets: DataSet[], tooltips: TimeBasedChartTooltipData[]) {\n  const csv = getCSVData(datasets, tooltips);\n  const blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\n  downloadFiles([{ blob, fileName: `plot_data_export.csv` }]);\n}\n\nexport default function PlotMenu({\n  minYValue,\n  maxYValue,\n  saveConfig,\n  setMinMax,\n  datasets,\n  xAxisVal = \"timestamp\",\n  tooltips,\n}: {\n  minYValue: string,\n  maxYValue: string,\n  saveConfig: ($Shape<PlotConfig>) => void,\n  setMinMax: ($Shape<PlotConfig>) => void,\n  datasets: DataSet[],\n  xAxisVal?: \"timestamp\" | \"index\" | \"custom\",\n  tooltips: TimeBasedChartTooltipData[],\n}) {\n  return (\n    <>\n      <Item onClick={() => saveConfig({ maxYValue: maxYValue === \"\" ? \"10\" : \"\" })} tooltip=\"Maximum y-axis value\">\n        <div className={styles.label}>Maximum</div>\n        <PanelToolbarInput\n          type=\"number\"\n          className={cx(styles.input, { [styles.inputError]: !isValidInput(maxYValue) })}\n          value={maxYValue}\n          onChange={(event) => {\n            saveConfig({ maxYValue: event.target.value });\n          }}\n          onClick={(event) => event.stopPropagation()}\n          placeholder=\"auto\"\n        />\n      </Item>\n      <Item onClick={() => saveConfig({ minYValue: minYValue === \"\" ? \"-10\" : \"\" })} tooltip=\"Maximum y-axis value\">\n        <div className={styles.label}>Minimum</div>\n        <PanelToolbarInput\n          type=\"number\"\n          className={cx(styles.input, { [styles.inputError]: !isValidInput(minYValue) })}\n          value={minYValue}\n          onChange={(event) => {\n            saveConfig({ minYValue: event.target.value });\n          }}\n          onClick={(event) => event.stopPropagation()}\n          placeholder=\"auto\"\n        />\n      </Item>\n      <Item>\n        <button onClick={setMinMax}>Set min/max to current</button>\n      </Item>\n      <Item>\n        <button onClick={() => downloadCsvFile(datasets, tooltips)}>Download plot data (csv)</button>\n      </Item>\n    </>\n  );\n}\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotMenu.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotMenu.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./PlotMenu.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Plot-PlotMenu-module-24fmd--label {\\n  display: inline-block;\\n  width: 65px; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotMenu-module-9hz5y--input {\\n  width: 70px;\\n  height: 22px; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotMenu-module-2hqz8--inputError {\\n  color: #ff7c96; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotMenu-module-427rj--lockItem {\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-align: center;\\n      align-items: center;\\n  -ms-flex-pack: justify;\\n      justify-content: space-between; }\\n\\n.packages-webviz-core-src-panels-Plot-PlotMenu-module-264qh--lockIcon {\\n  fill: currentColor; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/Plot/PlotMenu.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA;EACE,sBAAqB;EACrB,YAAW,EACZ;;AAED;EACE,YAAW;EACX,aAAY,EACb;;AAED;EACE,eCqBW,EDpBZ;;AAED;EACE,qBAAa;EAAb,cAAa;EACb,uBAAmB;MAAnB,oBAAmB;EACnB,uBAA8B;MAA9B,+BAA8B,EAC/B;;AAED;EACE,mBAAkB,EACnB\",\"file\":\"PlotMenu.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.label {\\n  display: inline-block;\\n  width: 65px;\\n}\\n\\n.input {\\n  width: 70px;\\n  height: 22px;\\n}\\n\\n.inputError {\\n  color: $red;\\n}\\n\\n.lockItem {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n}\\n\\n.lockIcon {\\n  fill: currentColor;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"label\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-24fmd--label\",\n\t\"input\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-9hz5y--input\",\n\t\"inputError\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-2hqz8--inputError\",\n\t\"lockItem\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-427rj--lockItem\",\n\t\"lockIcon\": \"packages-webviz-core-src-panels-Plot-PlotMenu-module-264qh--lockIcon\"\n};","module.exports = \"# State Transitions\\n\\nShows when values change. Can be used for any primitive value, but is most useful for \\\"enums\\\" (even though ROS does not have that as a formal concept). If you put constants in your ROS message definition, those constant names will be shown. You can only have one \\\"enum\\\" per message definition, otherwise we don't know which constant name to show (if there are multiple matches).\\n\\nThe values plotted are specified through Webviz's [message path syntax](/help/message-path-syntax).\\n\\nYou can zoom by scrolling, and pan by dragging. Double-click to reset.\\n\\nColors are hard-coded for the default paths. If you use a different path, you get some default colors. Please contact the Webviz team if you want more custom colors.\\n\"","module.exports = \"# Diagnostics - Detail\\n\\nDisplays diagnostics data for a given diagnostic name/hardware_id.  Select a diagnostic from the dropdown and the values will be displayed and updated in the panel below.\\n\\nDiagnostic keys and values support rich formatting with some basic HTML tags, such as `<b>`, `<i>`, `<u>`, `<tt>`, `<table>`, and more.\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport PinIcon from \"@mdi/svg/svg/pin.svg\";\nimport cx from \"classnames\";\nimport { sortBy, compact } from \"lodash\";\nimport * as React from \"react\"; // eslint-disable-line import/no-duplicates\nimport { hot } from \"react-hot-loader/root\";\nimport { List, AutoSizer } from \"react-virtualized\";\n\nimport type { Config as DiagnosticStatusConfig } from \"./DiagnosticStatusPanel\";\nimport helpContent from \"./DiagnosticSummary.help.md\";\nimport styles from \"./DiagnosticSummary.module.scss\";\nimport { LEVELS, type DiagnosticId, type DiagnosticInfo, getNodesByLevel } from \"./util\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TopicToRenderMenu from \"webviz-core/src/components/TopicToRenderMenu\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport DiagnosticsHistory from \"webviz-core/src/panels/diagnostics/DiagnosticsHistory\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\nimport { DIAGNOSTIC_TOPIC } from \"webviz-core/src/util/globalConstants\";\nimport toggle from \"webviz-core/src/util/toggle\";\n\nconst LevelClasses = {\n  [LEVELS.OK]: styles.ok,\n  [LEVELS.WARN]: styles.warn,\n  [LEVELS.ERROR]: styles.error,\n  [LEVELS.STALE]: styles.stale,\n};\n\ntype NodeRowProps = {\n  info: DiagnosticInfo,\n  isPinned: boolean,\n  onClick: (info: DiagnosticInfo) => void,\n  onClickPin: (info: DiagnosticInfo) => void,\n};\nclass NodeRow extends React.PureComponent<NodeRowProps> {\n  onClick = () => {\n    const { info, onClick } = this.props;\n    onClick(info);\n  };\n  onClickPin = () => {\n    const { info, onClickPin } = this.props;\n    onClickPin(info);\n  };\n\n  render() {\n    const { info, isPinned } = this.props;\n\n    return (\n      <div\n        className={cx(LevelClasses[info.status.level], styles.nodeRow)}\n        onClick={this.onClick}\n        data-test-diagnostic-row>\n        <Icon fade={!isPinned} onClick={this.onClickPin} className={cx(styles.pinIcon, { [styles.pinned]: isPinned })}>\n          <PinIcon />\n        </Icon>\n        <span>{info.displayName}</span> &ndash; <span className={styles.message}>{info.status.message}</span>\n      </div>\n    );\n  }\n}\n\ntype Config = {| pinnedIds: DiagnosticId[], topicToRender: string, hardwareIdFilter: string |};\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n  topics: Topic[],\n};\n\nconst getSortedNodes = (nodes: DiagnosticInfo[], pinnedIds: DiagnosticId[]): DiagnosticInfo[] => {\n  return sortBy(nodes.filter((info) => pinnedIds.indexOf(info.id) === -1), (info) =>\n    info.displayName.replace(/^\\//, \"\")\n  );\n};\n\nclass DiagnosticSummary extends React.Component<Props> {\n  static panelType = \"DiagnosticSummary\";\n  static defaultConfig = { ...getGlobalHooks().perPanelHooks().DiagnosticSummary.defaultConfig };\n\n  togglePinned = (info: DiagnosticInfo) => {\n    this.props.saveConfig({ pinnedIds: toggle(this.props.config.pinnedIds, info.id) });\n  };\n\n  showDetails = (info: DiagnosticInfo) => {\n    this.props.openSiblingPanel(\n      \"DiagnosticStatusPanel\",\n      () =>\n        ({\n          selectedHardwareId: info.status.hardware_id,\n          selectedName: info.status.name,\n          topicToRender: this.props.config.topicToRender,\n        }: DiagnosticStatusConfig)\n    );\n  };\n\n  renderRow = ({ item, style, key, index }) => {\n    return (\n      <div key={key} style={style}>\n        <NodeRow\n          info={item}\n          isPinned={this.props.config.pinnedIds.indexOf(item.id) !== -1}\n          onClick={this.showDetails}\n          onClickPin={this.togglePinned}\n        />\n      </div>\n    );\n  };\n\n  renderHardwareFilter() {\n    const {\n      config: { hardwareIdFilter },\n      saveConfig,\n    } = this.props;\n    return (\n      <input\n        style={{ width: \"100%\", padding: \"0\", background: \"transparent\", opacity: \"0.5\" }}\n        value={hardwareIdFilter}\n        placeholder={\"Filter hardware id\"}\n        onChange={(e) => saveConfig({ hardwareIdFilter: e.target.value })}\n      />\n    );\n  }\n\n  renderTopicToRenderMenu = (topics) => {\n    const {\n      config: { topicToRender },\n      saveConfig,\n    } = this.props;\n    return (\n      <TopicToRenderMenu\n        topicToRender={topicToRender}\n        onChange={(newTopicToRender) => saveConfig({ topicToRender: newTopicToRender })}\n        topics={topics}\n        singleTopicDatatype={\"diagnostic_msgs/DiagnosticArray\"}\n        defaultTopicToRender={DIAGNOSTIC_TOPIC}\n      />\n    );\n  };\n\n  render() {\n    const {\n      config: { topicToRender },\n      topics,\n    } = this.props;\n    return (\n      <Flex col className={styles.panel}>\n        <PanelToolbar helpContent={helpContent} additionalIcons={this.renderTopicToRenderMenu(topics)}>\n          {this.renderHardwareFilter()}\n        </PanelToolbar>\n        <Flex col>\n          <DiagnosticsHistory topic={topicToRender}>\n            {(buffer) => {\n              if (buffer.diagnosticsById.size === 0) {\n                return (\n                  <EmptyState>\n                    Waiting for <code>{topicToRender}</code> messages\n                  </EmptyState>\n                );\n              }\n              const { pinnedIds, hardwareIdFilter } = this.props.config;\n              const pinnedNodes = pinnedIds.map((id) => buffer.diagnosticsById.get(id));\n\n              const nodes: DiagnosticInfo[] = [\n                ...compact(pinnedNodes),\n                ...getSortedNodes(getNodesByLevel(buffer, hardwareIdFilter, LEVELS.STALE), pinnedIds),\n                ...getSortedNodes(getNodesByLevel(buffer, hardwareIdFilter, LEVELS.ERROR), pinnedIds),\n                ...getSortedNodes(getNodesByLevel(buffer, hardwareIdFilter, LEVELS.WARN), pinnedIds),\n                ...getSortedNodes(getNodesByLevel(buffer, hardwareIdFilter, LEVELS.OK), pinnedIds),\n              ];\n              return nodes.length === 0 ? null : (\n                <AutoSizer>\n                  {({ height, width }) => (\n                    <List\n                      width={width}\n                      height={height}\n                      style={{ outline: \"none\" }}\n                      rowHeight={25}\n                      rowRenderer={(rowProps) => this.renderRow({ ...rowProps, item: nodes[rowProps.index] })}\n                      rowCount={nodes.length}\n                      overscanRowCount={10}\n                    />\n                  )}\n                </AutoSizer>\n              );\n            }}\n          </DiagnosticsHistory>\n        </Flex>\n      </Flex>\n    );\n  }\n}\n\nexport default hot(Panel<Config>(DiagnosticSummary));\n","module.exports = \"# Diagnostics - Summary\\n\\nDisplays the status of all the nodes it has seen in groups from:\\n\\n- Pinned nodes\\n- Stale\\n- Error\\n- Warn\\n- Ok\\n\\nYou can pin a specific node you are interested in by clicking the pin icon next to it (appears on hover).\\n\\nYou can also click a key to see it show up in the Runtime Monitor Details Panel.\\n\"","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./DiagnosticSummary.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./DiagnosticSummary.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./DiagnosticSummary.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow {\\n  text-decoration: none;\\n  padding: 8px 12px;\\n  cursor: pointer;\\n  color: rgba(247, 247, 243, 0.77);\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n      -ms-user-select: none;\\n          user-select: none;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-align: center;\\n      align-items: center; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow:hover {\\n  background-color: #3b2e76;\\n  color: rgba(247, 247, 243, 0.77); }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon {\\n  margin-right: 4px; }\\n  .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2w6bg--panel {\\n  background-color: #121217; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-3x32j--ok .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message {\\n  color: #05d27d; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-42j44--warn .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message {\\n  color: #ccb862; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2jahw--error .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message {\\n  color: #ff7c96; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-w8nc9--stale .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message {\\n  color: rgba(247, 247, 243, 0.3); }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon {\\n  margin-left: 4px;\\n  vertical-align: middle;\\n  visibility: hidden; }\\n  .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-4pagz--pinned,\\n  .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow:hover .packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon {\\n    visibility: visible; }\\n\\n.packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow {\\n  padding: 0;\\n  line-height: 24px;\\n  overflow: hidden;\\n  white-space: nowrap;\\n  -o-text-overflow: ellipsis;\\n     text-overflow: ellipsis; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/diagnostics/DiagnosticSummary.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/mixins.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAoCA;ECCE,sBAAqB;EACrB,kBA5ByC;EA6BzC,gBAAe;EACf,iCC1BqC;ED2BrC,0BAAiB;KAAjB,uBAAiB;MAAjB,sBAAiB;UAAjB,kBAAiB;EACjB,qBAAa;EAAb,cAAa;EACb,uBAAmB;MAAnB,oBAAmB,EAKpB;;ADZD;ECqCE,0BC/CuB;EDgDvB,iCC5DqC,ED6DtC;;ADlDD;ECiEE,kBAAiB,EAMlB;EDvED;ICmEI,gBAAe;IACf,mBAAkB;IAClB,UAAS,EACV;;ADtFH;EACE,0BEJkB,EFKnB;;AACD;EACE,eEiBa,EFhBd;;AACD;EACE,eEuBc,EFtBf;;AACD;EACE,eEqBW,EFpBZ;;AACD;EACE,gCENmC,EFOpC;;AAED;EAEE,iBAAgB;EAChB,uBAAsB;EACtB,mBAAkB,EAKnB;EATD;;IAOI,oBAAmB,EACpB;;AAGH;EAEE,WAAU;EACV,kBAAiB;EAEjB,iBAAgB;EAChB,oBAAmB;EACnB,2BAAuB;KAAvB,wBAAuB,EACxB\",\"file\":\"DiagnosticSummary.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.panel {\\n  background-color: $background;\\n}\\n.ok .message {\\n  color: $green;\\n}\\n.warn .message {\\n  color: $orange;\\n}\\n.error .message {\\n  color: $red;\\n}\\n.stale .message {\\n  color: $text-muted;\\n}\\n\\n.pinIcon {\\n  @extend %list-item-icon;\\n  margin-left: 4px;\\n  vertical-align: middle;\\n  visibility: hidden;\\n  &.pinned,\\n  .nodeRow:hover & {\\n    visibility: visible;\\n  }\\n}\\n\\n.nodeRow {\\n  @extend %menu-item;\\n  padding: 0;\\n  line-height: 24px;\\n\\n  overflow: hidden;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: $padding ($padding + 4px);\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $toolbar;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: $control-padding;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active {\\n  color: $text-normal;\\n  // @extend %bold;\\n  background-color: $background-control-selected;\\n}\\n\\n%menu-item-hover {\\n  background-color: $menu-item-hover;\\n  color: $text-normal;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"nodeRow\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-22q15--nodeRow\",\n\t\"pinIcon\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2qy3f--pinIcon\",\n\t\"panel\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2w6bg--panel\",\n\t\"ok\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-3x32j--ok\",\n\t\"message\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2dfc7--message\",\n\t\"warn\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-42j44--warn\",\n\t\"error\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-2jahw--error\",\n\t\"stale\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-w8nc9--stale\",\n\t\"pinned\": \"packages-webviz-core-src-panels-diagnostics-DiagnosticSummary-module-4pagz--pinned\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { partition, pick, without } from \"lodash\";\nimport React, { type Node, useState, useMemo, useRef } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport ReactInputAutosize from \"react-input-autosize\";\nimport styled from \"styled-components\";\n\nimport helpContent from \"./index.help.md\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { UnlinkGlobalVariables } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions\";\nimport { memoizedGetLinkedGlobalVariablesKeyByName } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/interactionUtils\";\nimport useLinkedGlobalVariables from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { GLOBAL_VARIABLES_QUERY_KEY } from \"webviz-core/src/util/globalConstants\";\n\nconst SDeleteIcon = styled.span`\n  display: inline-block;\n  visibility: hidden;\n  font-size: 12px;\n  width: 19px;\n  cursor: pointer;\n  padding-left: 1px;\n\n  &:hover {\n    color: white;\n  }\n`;\n\nconst SGlobalVariables = styled.div`\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  padding: 8px 0;\n  white-space: nowrap;\n\n  table {\n    width: 99%;\n  }\n\n  tr:nth-child(odd) {\n    background-color: #222;\n  }\n\n  tr:hover ${SDeleteIcon} {\n    visibility: visible;\n  }\n\n  td {\n    border: none;\n    padding: 0 8px;\n\n    input {\n      background: none !important;\n      color: inherit;\n      width: 100%;\n      padding-left: 0;\n      padding-right: 0;\n      min-width: 40px;\n    }\n  }\n`;\n\nconst parseJson = (val: string): ?mixed => {\n  try {\n    return JSON.parse(val);\n  } catch (e) {\n    return undefined;\n  }\n};\n\nconst keyValMap = { ArrowDown: -1, ArrowUp: 1 };\nfunction JSONInput(props: {| value: string, onChange: (mixed) => void |}) {\n  const [internalValue, setInternalValue] = useState<string>(props.value);\n  const lastPropsValue = useRef<string>(props.value);\n  if (lastPropsValue.current !== props.value) {\n    lastPropsValue.current = props.value;\n    setInternalValue(props.value);\n  }\n  const parsedValue = parseJson(internalValue);\n  const isValid = parsedValue !== undefined;\n  return (\n    <input\n      style={{ color: isValid ? \"white\" : colors.red }}\n      data-test=\"json-input\"\n      type=\"text\"\n      value={internalValue}\n      onChange={(e) => {\n        setInternalValue(e.target.value);\n        const newParsedValue = parseJson(e.target.value);\n        if (newParsedValue !== undefined) {\n          props.onChange(newParsedValue);\n        }\n      }}\n      onKeyDown={(e) => {\n        if (typeof parsedValue === \"number\" && keyValMap[e.key]) {\n          const newParsedValue = parsedValue + keyValMap[e.key];\n          setInternalValue(`${newParsedValue}`);\n          props.onChange(newParsedValue);\n        }\n      }}\n    />\n  );\n}\n\nfunction ValidatedResizingInput(props: {| value: string, onChange: (string) => void, invalidInputs: string[] |}) {\n  const [internalValue, setInternalValue] = useState<string>(props.value);\n  const lastPropsValue = useRef<string>(props.value);\n  if (lastPropsValue.current !== props.value) {\n    lastPropsValue.current = props.value;\n    setInternalValue(props.value);\n  }\n  return (\n    <ReactInputAutosize\n      style={{ color: !props.invalidInputs.includes(internalValue) ? \"white\" : colors.red }}\n      value={`$${internalValue}`}\n      onChange={(event) => {\n        const value = event.target.value.slice(1);\n        setInternalValue(value);\n        if (!props.invalidInputs.includes(value)) {\n          props.onChange(value);\n        }\n      }}\n    />\n  );\n}\n\nconst changeGlobalKey = (newKey, oldKey, globalVariables, idx, overwriteGlobalVariables) => {\n  const keys = Object.keys(globalVariables);\n  overwriteGlobalVariables({\n    ...pick(globalVariables, keys.slice(0, idx)),\n    [newKey]: globalVariables[oldKey],\n    ...pick(globalVariables, keys.slice(idx + 1)),\n  });\n};\n\nfunction GlobalVariables(props: {}): Node {\n  const [btnMessage, setBtnMessage] = useState<string>(\"Copy\");\n  const { globalVariables, setGlobalVariables, overwriteGlobalVariables } = useGlobalVariables();\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n  const globalVariableNames = Object.keys(globalVariables);\n  const linkedGlobalVariablesKeyByName = memoizedGetLinkedGlobalVariablesKeyByName(linkedGlobalVariables);\n  const [linked, unlinked] = partition(globalVariableNames, (name) => !!linkedGlobalVariablesKeyByName[name]);\n\n  const url = useMemo(\n    () => {\n      const queryParams = new URLSearchParams(window.location.search);\n      queryParams.set(GLOBAL_VARIABLES_QUERY_KEY, JSON.stringify(globalVariables));\n      if (inScreenshotTests()) {\n        return `http://localhost:3000/?${queryParams.toString()}`;\n      }\n      return `${window.location.host}/?${queryParams.toString()}`;\n    },\n    [globalVariables]\n  );\n\n  return (\n    <SGlobalVariables>\n      <PanelToolbar helpContent={helpContent} floating />\n      <table>\n        <tbody>\n          {linked.map((name, idx) => {\n            return (\n              <tr key={`linked-${idx}`}>\n                <td>\n                  <UnlinkGlobalVariables name={name} />\n                </td>\n                <td width=\"100%\">\n                  <JSONInput\n                    value={JSON.stringify(globalVariables[name] ?? \"\")}\n                    onChange={(newVal) => setGlobalVariables({ [name]: newVal })}\n                  />\n                </td>\n              </tr>\n            );\n          })}\n          {unlinked.map((name, idx) => (\n            <tr key={`unlinked-${idx}`}>\n              <td data-test=\"global-variable-key\">\n                <SDeleteIcon onClick={() => setGlobalVariables({ [name]: undefined })}>✕</SDeleteIcon>\n                <ValidatedResizingInput\n                  value={name}\n                  onChange={(newKey) =>\n                    changeGlobalKey(newKey, name, globalVariables, linked.length + idx, overwriteGlobalVariables)\n                  }\n                  invalidInputs={without(globalVariableNames, name).concat(\"\")}\n                />\n              </td>\n              <td width=\"100%\">\n                <JSONInput\n                  value={JSON.stringify(globalVariables[name] ?? \"\")}\n                  onChange={(newVal) => setGlobalVariables({ [name]: newVal })}\n                />\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n\n      <Flex style={{ margin: 8 }}>\n        <button data-test=\"add-variable-btn\" onClick={() => setGlobalVariables({ \"\": \"\" })}>\n          + Add variable\n        </button>\n        <input readOnly style={{ width: \"100%\" }} type=\"text\" value={url} />\n        {document.queryCommandSupported(\"copy\") && (\n          <button\n            onClick={() => {\n              clipboard.copy(url).then(() => {\n                setBtnMessage(\"Copied!\");\n                setTimeout(() => {\n                  setBtnMessage(\"Copy\");\n                }, 2000);\n              });\n            }}>\n            {btnMessage}\n          </button>\n        )}\n      </Flex>\n    </SGlobalVariables>\n  );\n}\n\nGlobalVariables.panelType = \"Global\";\nGlobalVariables.defaultConfig = {};\n\nexport default hot(Panel<{}>(GlobalVariables));\n","module.exports = \"# Global Variables\\n\\nAllows you to read and set global variables for any panel that uses the [message path syntax](/help/message-path-syntax) (e.g. Plot, State Transitions, Raw Messages, etc.).\\n\\nFor example, instead of having to change a particular object ID that you want to see visualizations for across panels, you can:\\n\\n- Set a `$my_object_ID` variable in the Global Variables panel\\n- Type `/my_objects.objects[:]{id==$my_object_ID}.some_field` in your Plot Panel to plot a particular field in your specified object\\n- Type `/my_objects.objects[:]{id==$my_object_ID}` in your Raw Messages Panel to see all the info for your specified object\\n\\nFor numeric global variable values, use the up and down arrow keys to increment and decrement the values, respectively.\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { type MouseEventObject } from \"regl-worldview\";\n\nimport GlobalVariableLink, { GlobalVariableName, SP } from \"./GlobalVariableLink/index\";\nimport { SRow, SValue, type InteractionData } from \"./index\";\nimport TopicLink from \"./TopicLink\";\n\ntype Props = {\n  selectedObject: MouseEventObject,\n  interactionData: InteractionData,\n};\n\nexport default function GeneralInfo({ selectedObject, interactionData }: Props) {\n  return (\n    <SRow>\n      <SValue>\n        <TopicLink topic={interactionData.topic} />\n      </SValue>\n      {selectedObject.object.id != null && (\n        <SValue>\n          <GlobalVariableLink\n            highlight\n            onlyRenderAddLink\n            markerKeyPath={[\"id\"]}\n            topic={interactionData.topic}\n            variableValue={selectedObject.object.id}\n            addLinkTooltip={\n              <SP style={{ marginTop: 0 }}>\n                Link <code>id</code> with global variable <GlobalVariableName name=\"id\" />\n              </SP>\n            }\n          />\n        </SValue>\n      )}\n    </SRow>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nconst SGlobalVariableName = styled.span`\n  color: #ccb862;\n  font-weight: bold;\n  max-width: 100px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  padding-left: ${(props) => (props.leftPadding ? \"6px\" : 0)};\n`;\n\nexport default function GlobalVariableName({ name, leftPadding }: {| name: string, leftPadding?: boolean |}) {\n  return (\n    <SGlobalVariableName title={name} leftPadding={leftPadding}>\n      ${name}\n    </SGlobalVariableName>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport LinkPlusIcon from \"@mdi/svg/svg/link-plus.svg\";\nimport classNames from \"classnames\";\nimport * as React from \"react\";\n\nimport useLinkedGlobalVariables from \"../useLinkedGlobalVariables\";\nimport { SGlobalVariableForm, GlobalVariableName } from \"./index\";\nimport UnlinkGlobalVariables from \"./UnlinkGlobalVariables\";\nimport Button from \"webviz-core/src/components/Button\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\ntype AddToLinkedGlobalVariable = {\n  topic: string,\n  markerKeyPath: string[],\n  variableValue: any,\n};\n\ntype Props = {\n  highlight?: boolean,\n  addToLinkedGlobalVariable: AddToLinkedGlobalVariable,\n  style?: any,\n  tooltip?: React.Node,\n};\n\nfunction getInitialName(markerKeyPath: string[]) {\n  return markerKeyPath\n    .slice(0, 2)\n    .reverse()\n    .join(\"_\");\n}\n\nexport default function LinkToGlobalVariable({\n  style = {},\n  addToLinkedGlobalVariable: { topic, variableValue, markerKeyPath },\n  tooltip,\n  highlight,\n}: Props) {\n  const [isOpen, _setIsOpen] = React.useState<boolean>(false);\n  const [name, setName] = React.useState(() => getInitialName(markerKeyPath));\n\n  const setIsOpen = React.useCallback(\n    (newValue: boolean) => {\n      _setIsOpen(newValue);\n      if (newValue) {\n        setName(getInitialName(markerKeyPath));\n      }\n    },\n    [markerKeyPath]\n  );\n\n  const { setGlobalVariables } = useGlobalVariables();\n  const { linkedGlobalVariables, setLinkedGlobalVariables } = useLinkedGlobalVariables();\n\n  const addLink = (ev) => {\n    ev.preventDefault();\n    setGlobalVariables({ [name]: variableValue });\n    const newLinkedGlobalVariables = [...linkedGlobalVariables, { topic, markerKeyPath, name }];\n    setLinkedGlobalVariables(newLinkedGlobalVariables);\n    setIsOpen(false);\n  };\n\n  const highlightIconStyle = highlight ? { color: colors.highlight } : {};\n\n  return (\n    <ChildToggle\n      dataTest={`link-${name}`}\n      position=\"above\"\n      onToggle={() => setIsOpen(!isOpen)}\n      isOpen={isOpen}\n      style={style}>\n      <Icon\n        className={classNames(\"link-icon\", { highlight })}\n        style={highlightIconStyle}\n        fade={!highlight}\n        tooltip={tooltip || \"Link this field to a global variable\"}\n        tooltipProps={{ placement: \"top\" }}>\n        <LinkPlusIcon />\n      </Icon>\n      <SGlobalVariableForm onSubmit={addLink} data-test=\"link-form\">\n        <p style={{ marginTop: 0, lineHeight: \"1.4\" }}>\n          When linked, clicking a new object from {topic} will update the global variable&nbsp;\n          <GlobalVariableName name={name} />.\n        </p>\n        <UnlinkGlobalVariables name={name} showList />\n        <input autoFocus type=\"text\" value={`$${name}`} onChange={(e) => setName(e.target.value.replace(/^\\$/, \"\"))} />\n        <p data-test=\"action-buttons\">\n          <Button primary={!!name} disabled={!name} onClick={addLink}>\n            Add Link\n          </Button>\n          <Button onClick={() => setIsOpen(false)}>Cancel</Button>\n        </p>\n      </SGlobalVariableForm>\n    </ChildToggle>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\n\nimport { getPath } from \"../interactionUtils\";\nimport useLinkedGlobalVariables, { type LinkedGlobalVariable } from \"../useLinkedGlobalVariables\";\nimport { SPath, SGlobalVariableForm, GlobalVariableName } from \"./index\";\nimport Button from \"webviz-core/src/components/Button\";\n\ntype Props = {\n  linkedGlobalVariable: LinkedGlobalVariable,\n  setIsOpen: (boolean) => void,\n};\nexport default function UnlinkGlobalVariable({\n  linkedGlobalVariable: { topic, markerKeyPath, name },\n  setIsOpen,\n}: Props) {\n  const { linkedGlobalVariables, setLinkedGlobalVariables } = useLinkedGlobalVariables();\n  return (\n    <SGlobalVariableForm style={{ marginLeft: 8 }} data-test=\"unlink-form\">\n      <p style={{ marginTop: 0, lineHeight: \"1.4\" }}>\n        Unlink <GlobalVariableName name={name} /> from {topic}.<SPath>{getPath(markerKeyPath)}</SPath>?\n      </p>\n      <Button\n        danger\n        onClick={() => {\n          const newLinkedGlobalVariables = linkedGlobalVariables.filter(\n            (linkedGlobalVariable) =>\n              !(\n                linkedGlobalVariable.topic === topic &&\n                isEqual(linkedGlobalVariable.markerKeyPath, markerKeyPath) &&\n                linkedGlobalVariable.name === name\n              )\n          );\n          setLinkedGlobalVariables(newLinkedGlobalVariables);\n          setIsOpen(false);\n        }}>\n        Unlink\n      </Button>\n      <Button onClick={() => setIsOpen(false)}>Cancel</Button>\n    </SGlobalVariableForm>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { usePanelContext } from \"webviz-core/src/components/PanelContext\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport RawMessages, { type RawMessagesConfig } from \"webviz-core/src/panels/RawMessages/index\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\nconst STopicLink = styled.span`\n  cursor: pointer;\n  color: ${colors.highlight};\n`;\n\ntype Props = {\n  topic: string,\n};\n\nexport default function TopicLink({ topic }: Props) {\n  const { openSiblingPanel } = usePanelContext();\n  const openRawMessages = React.useCallback(\n    () => {\n      if (!openSiblingPanel) {\n        return;\n      }\n      openSiblingPanel(\n        // $FlowFixMe: https://stackoverflow.com/questions/52508434/adding-static-variable-to-union-of-class-types\n        RawMessages.panelType,\n        // $FlowFixMe\n        (config: RawMessagesConfig) => ({ ...config, topicPath: topic }: RawMessagesConfig)\n      );\n    },\n    [openSiblingPanel, topic]\n  );\n\n  return (\n    <Tooltip placement=\"top\" contents={`View ${topic} in Raw Messages panel`}>\n      {/* extra span to work around tooltip NaN positioning bug */}\n      <span>\n        <STopicLink onClick={openRawMessages}>{topic}</STopicLink>\n      </span>\n    </Tooltip>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nimport { diffLabels, diffArrow } from \"webviz-core/src/panels/RawMessages/getDiff\";\n\nexport const SDiffSpan = styled.span`\n  padding: 0px 4px;\n  text-decoration: inherit;\n`;\n\nexport function HighlightedValue({ itemLabel, keyPath }: { itemLabel: string, keyPath: Array<string | number> }) {\n  // react-json-tree's valueRenderer only gets called for primitives, so diff before/after values must be at same level by the time it gets to the tree\n  const splitItemLabel = `${itemLabel}`.split(` ${diffArrow} `);\n  const itemLabelContainsChange = splitItemLabel.length === 2;\n  if (itemLabelContainsChange) {\n    const [before, after] = splitItemLabel;\n    const beforeText = JSON.parse(JSON.stringify(before));\n    const afterText = JSON.parse(JSON.stringify(after));\n    return (\n      <SDiffSpan style={{ color: diffLabels.CHANGED.color }}>{`${beforeText} ${diffArrow} ${afterText}`}</SDiffSpan>\n    );\n  }\n  return <SDiffSpan>{itemLabel}</SDiffSpan>;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { last } from \"lodash\";\nimport memoizeWeak from \"memoize-weak\";\n\nimport { type MessagePathStructureItem } from \"webviz-core/src/components/MessagePathSyntax/constants\";\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\n\nexport type ValueAction =\n  | {|\n      type: \"pivot\",\n      pivotPath: string, // Path to filter on using the current value, if the current value is an id.\n    |}\n  | {|\n      type: \"primitive\",\n      singleSlicePath: string, // Path that will only return one value per unit of time (for line charts).\n      multiSlicePath: string, // Path that might return multiple values per unit of time (for scatter plots).\n      primitiveType: string, // The ROS primitive type that these paths point at.\n    |};\n\n// Given a root value (e.g. a message object), a root structureItem (e.g. a message definition),\n// and a key path to navigate down the value and strutureItem (e.g. [\"items\", 10, \"speed\"]), return\n// a bunch of paths for that navigated down value.\nexport function getValueActionForValue(\n  rootValue: mixed,\n  rootStructureItem: ?MessagePathStructureItem,\n  keyPath: (number | string)[]\n): ?ValueAction {\n  let singleSlicePath = \"\";\n  let multiSlicePath = \"\";\n  let pivotPath = \"\";\n  let value: mixed = rootValue;\n  let structureItem: ?MessagePathStructureItem = rootStructureItem;\n  // Walk down the keyPath, while updating `value` and `structureItem`\n  for (const pathItem: number | string of keyPath) {\n    if (structureItem == null || value == null) {\n      break;\n    } else if (structureItem.structureType === \"message\" && typeof value === \"object\" && typeof pathItem === \"string\") {\n      structureItem = structureItem.nextByName[pathItem];\n      value = value[pathItem];\n      if (multiSlicePath.endsWith(\"[:]\")) {\n        // We're just inside a message that is inside an array, so we might want to pivot on this new value.\n        pivotPath = `${multiSlicePath}{${pathItem}==${JSON.stringify(value) || \"\"}}`;\n      } else {\n        pivotPath = \"\";\n      }\n      singleSlicePath += `.${pathItem}`;\n      multiSlicePath += `.${pathItem}`;\n    } else if (structureItem.structureType === \"array\" && Array.isArray(value) && typeof pathItem === \"number\") {\n      value = value[pathItem];\n      structureItem = structureItem.next;\n      if (!structureItem) {\n        break;\n      }\n      multiSlicePath = `${singleSlicePath}[:]`;\n      // Ideally show something like `/topic.object[:]{id=123}` for the singleSlicePath, but fall\n      // back to `/topic.object[10]` if necessary.\n      let typicalFilterName;\n      if (structureItem.structureType === \"message\") {\n        typicalFilterName = Object.keys(structureItem.nextByName).find((key) => isTypicalFilterName(key));\n      }\n      if (typeof value === \"object\" && value != null && typeof typicalFilterName === \"string\") {\n        singleSlicePath += `[:]{${typicalFilterName}==${JSON.stringify(value[typicalFilterName]) || \"\"}}`;\n      } else {\n        singleSlicePath += `[${pathItem}]`;\n      }\n    } else if (structureItem.structureType === \"primitive\") {\n      // ROS has some primitives that contain nested data (time+duration). We currently don't\n      // support looking inside them.\n      return;\n    } else {\n      throw new Error(`Invalid structureType: ${structureItem.structureType} for value/pathItem.`);\n    }\n  }\n  // At this point we should be looking at a primitive. If not, just return nothing.\n  if (structureItem && structureItem.structureType === \"primitive\" && value != null) {\n    if (pivotPath && isTypicalFilterName(last(keyPath).toString())) {\n      return { type: \"pivot\", pivotPath };\n    }\n    return {\n      type: \"primitive\",\n      singleSlicePath,\n      multiSlicePath,\n      primitiveType: structureItem.primitiveType,\n    };\n  }\n}\n\n// Given root structureItem (e.g. a message definition),\n// and a key path (comma-joined) to navigate down, return strutureItem for the field at that path\n// Using comma-joined path to allow memoization of this function\nexport const getStructureItemForPath = memoizeWeak(\n  (rootStructureItem: ?MessagePathStructureItem, keyPathJoined: string): ?MessagePathStructureItem => {\n    // split the path and parse into numbers and strings\n    const keyPath: (number | string)[] = [];\n    for (const part: string of keyPathJoined.split(\",\")) {\n      if (!isNaN(part)) {\n        keyPath.push(parseInt(part));\n      } else {\n        keyPath.push(part);\n      }\n    }\n    let structureItem: ?MessagePathStructureItem = rootStructureItem;\n    // Walk down the keyPath, while updating `value` and `structureItem`\n    for (const pathItem: number | string of keyPath) {\n      if (structureItem == null) {\n        break;\n      } else if (structureItem.structureType === \"message\" && typeof pathItem === \"string\") {\n        structureItem = structureItem.nextByName[pathItem];\n      } else if (structureItem.structureType === \"array\" && typeof pathItem === \"number\") {\n        structureItem = structureItem.next;\n        if (!structureItem) {\n          break;\n        }\n      } else if (structureItem.structureType === \"primitive\") {\n        // ROS has some primitives that contain nested data (time+duration). We currently don't\n        // support looking inside them.\n        return structureItem;\n      } else {\n        throw new Error(`Invalid structureType: ${structureItem.structureType} for value/pathItem.`);\n      }\n    }\n    return structureItem;\n  }\n);\n","module.exports = \"# Raw Messages\\n\\nDisplays the data from a specific topic in an easier to read format. As new messages are received the structure shows the latest data, but doesn't reset the view (e.g if you unfold a specific key - it'll stay that way with the values under it updating as messages come in).\\n\\nYou can drill down the message and filter arrays to specific messages using the [message path syntax](/help/message-path-syntax).\\n\\nIf you need to understand the data structure of the messages, a link is provided at the top.\\n\"","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-RawMessages-index-module-3np35--topicInputs {\\n  width: 100%;\\n  line-height: 20px; }\\n\\n.packages-webviz-core-src-panels-RawMessages-index-module-2aqxa--container {\\n  padding-left: 0.5em;\\n  font-family: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n  -webkit-font-feature-settings: \\\"tnum\\\";\\n          font-feature-settings: \\\"tnum\\\"; }\\n\\n.packages-webviz-core-src-panels-RawMessages-index-module-fnnzr--iconWrapper {\\n  display: inline;\\n  padding-right: 40px; }\\n\\n.packages-webviz-core-src-panels-RawMessages-index-module-2uwhq--iconBox {\\n  display: inline-block;\\n  white-space: nowrap;\\n  width: 0px;\\n  height: 0px;\\n  position: relative;\\n  left: 6px; }\\n\\n.packages-webviz-core-src-panels-RawMessages-index-module-44tte--icon > svg {\\n  vertical-align: top; }\\n\\n.packages-webviz-core-src-panels-RawMessages-index-module-4kv8d--singleVal {\\n  font-size: 2.5em;\\n  word-wrap: break-word;\\n  font-weight: bold; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/RawMessages/index.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/mixins.module.scss\"],\"names\":[],\"mappings\":\"AAQA;EACE,YAAW;EACX,kBAAiB,EAClB;;AAED;EAEE,oBAAmB;ECiEnB,uEAHyE;EAIzE,sCAA6B;UAA7B,8BAA6B,EDhE9B;;AAED;EACE,gBAAe;EACf,oBAAmB,EACpB;;AAED;EACE,sBAAqB;EACrB,oBAAmB;EACnB,WAAU;EACV,YAAW;EACX,mBAAkB;EAClB,UAAS,EACV;;AAED;EAEI,oBAAmB,EACpB;;AAGH;EACE,iBAAgB;EAChB,sBAAqB;EACrB,kBAAiB,EAClB\",\"file\":\"index.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n.topicInputs {\\n  width: 100%;\\n  line-height: 20px;\\n}\\n\\n.container {\\n  // match the padding with the default padding used in react-json-tree\\n  padding-left: 0.5em;\\n  @include sans-serif;\\n}\\n\\n.iconWrapper {\\n  display: inline;\\n  padding-right: 40px; // To make it so the icons appear when you move the mouse somewhat close.\\n}\\n\\n.iconBox {\\n  display: inline-block;\\n  white-space: nowrap;\\n  width: 0px;\\n  height: 0px;\\n  position: relative;\\n  left: 6px;\\n}\\n\\n.icon {\\n  > svg {\\n    vertical-align: top;\\n  }\\n}\\n\\n.singleVal {\\n  font-size: 2.5em;\\n  word-wrap: break-word;\\n  font-weight: bold;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: $padding ($padding + 4px);\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $toolbar;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: $control-padding;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active {\\n  color: $text-normal;\\n  // @extend %bold;\\n  background-color: $background-control-selected;\\n}\\n\\n%menu-item-hover {\\n  background-color: $menu-item-hover;\\n  color: $text-normal;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"topicInputs\": \"packages-webviz-core-src-panels-RawMessages-index-module-3np35--topicInputs\",\n\t\"container\": \"packages-webviz-core-src-panels-RawMessages-index-module-2aqxa--container\",\n\t\"iconWrapper\": \"packages-webviz-core-src-panels-RawMessages-index-module-fnnzr--iconWrapper\",\n\t\"iconBox\": \"packages-webviz-core-src-panels-RawMessages-index-module-2uwhq--iconBox\",\n\t\"icon\": \"packages-webviz-core-src-panels-RawMessages-index-module-44tte--icon\",\n\t\"singleVal\": \"packages-webviz-core-src-panels-RawMessages-index-module-4kv8d--singleVal\"\n};","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport ClipboardOutlineIcon from \"@mdi/svg/svg/clipboard-outline.svg\";\nimport { cloneDeepWith } from \"lodash\";\nimport React, { useCallback } from \"react\";\nimport styled from \"styled-components\";\n\nimport Icon from \"webviz-core/src/components/Icon\";\nimport type { Message } from \"webviz-core/src/players/types\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { formatTimeRaw } from \"webviz-core/src/util/time\";\n\nconst SMetadata = styled.div`\n  margin-top: 4px;\n  font-size: 11px;\n  line-height: 1.3;\n  color: #aaa;\n`;\ntype Props = {\n  data: any,\n  diffData: any,\n  diff: any,\n  link: ?string,\n  message: Message,\n  diffMessage: ?Message,\n};\n\nfunction CopyMessageButton({ text, onClick }) {\n  return (\n    <a onClick={onClick} href=\"#\" style={{ textDecoration: \"none\" }}>\n      <Icon tooltip=\"Copy entire message to clipboard\" style={{ position: \"relative\", top: -1 }}>\n        <ClipboardOutlineIcon style={{ verticalAlign: \"middle\" }} />\n      </Icon>{\" \"}\n      {text}\n    </a>\n  );\n}\n\nexport default function Metadata({ data, diffData, diff, link, message, diffMessage }: Props) {\n  const onClickCopy = useCallback(\n    (dataToCopy) => (e: SyntheticMouseEvent<HTMLSpanElement>) => {\n      e.stopPropagation();\n      e.preventDefault();\n      const dataWithoutLargeArrays = cloneDeepWith(dataToCopy, (value) => {\n        if (typeof value === \"object\" && value.buffer) {\n          return \"<buffer>\";\n        }\n      });\n      clipboard.copy(JSON.stringify(dataWithoutLargeArrays, null, 2) || \"\");\n    },\n    []\n  );\n  return (\n    <SMetadata>\n      {!diffMessage &&\n        (link ? (\n          <a style={{ color: \"inherit\" }} target=\"_blank\" rel=\"noopener noreferrer\" href={link}>\n            {message.datatype}\n          </a>\n        ) : (\n          message.datatype\n        ))}\n      {message.receiveTime && `${diffMessage ? \" base\" : \"\"} @ ${formatTimeRaw(message.receiveTime)} ROS `}\n      <CopyMessageButton onClick={onClickCopy(data)} text=\"Copy msg\" />\n\n      {diffMessage && diffMessage.receiveTime && (\n        <>\n          <div>\n            {`diff @ ${formatTimeRaw(diffMessage.receiveTime)} ROS `}\n            <CopyMessageButton onClick={onClickCopy(diffData)} text=\"Copy msg\" />\n          </div>\n          <CopyMessageButton onClick={onClickCopy(diff)} text=\"Copy diff of msgs\" />\n        </>\n      )}\n    </SMetadata>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport ChartBubbleIcon from \"@mdi/svg/svg/chart-bubble.svg\";\nimport ChartLineVariantIcon from \"@mdi/svg/svg/chart-line-variant.svg\";\nimport DotsHorizontalIcon from \"@mdi/svg/svg/dots-horizontal.svg\";\nimport TargetIcon from \"@mdi/svg/svg/target.svg\";\nimport React, { type Node, useCallback } from \"react\";\n\nimport { type ValueAction } from \"./getValueActionForValue\";\nimport styles from \"./index.module.scss\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { openSiblingPlotPanel, plotableRosTypes } from \"webviz-core/src/panels/Plot\";\nimport { openSiblingStateTransitionsPanel, transitionableRosTypes } from \"webviz-core/src/panels/StateTransitions\";\nimport type { PanelConfig } from \"webviz-core/src/types/panels\";\n\ntype Props = {\n  valueAction: ValueAction,\n  basePath: string,\n  onTopicPathChange: (string) => void,\n  openSiblingPanel: (string, cb: (PanelConfig) => PanelConfig) => void,\n};\n\nexport default function RawMessagesIcons({ valueAction, basePath, onTopicPathChange, openSiblingPanel }: Props): Node {\n  const openPlotPanel = useCallback(\n    (pathSuffix: string) => () => {\n      openSiblingPlotPanel(openSiblingPanel, `${basePath}${pathSuffix}`);\n    },\n    [basePath, openSiblingPanel]\n  );\n  const openStateTransitionsPanel = useCallback(\n    (pathSuffix: string) => () => {\n      openSiblingStateTransitionsPanel(openSiblingPanel, `${basePath}${pathSuffix}`);\n    },\n    [basePath, openSiblingPanel]\n  );\n  const onPivot = useCallback(\n    () => onTopicPathChange(`${basePath}${valueAction.type === \"pivot\" ? valueAction.pivotPath : \"\"}`),\n    [basePath, onTopicPathChange, valueAction]\n  );\n  if (valueAction.type === \"pivot\") {\n    return (\n      <Icon fade className={styles.icon} onClick={onPivot} tooltip=\"Pivot on this value\" key=\"pivot\">\n        <TargetIcon />\n      </Icon>\n    );\n  }\n  const { singleSlicePath, multiSlicePath, primitiveType } = valueAction;\n  return (\n    <span>\n      {plotableRosTypes.includes(primitiveType) && (\n        <Icon fade className={styles.icon} onClick={openPlotPanel(singleSlicePath)} tooltip=\"Line chart\">\n          <ChartLineVariantIcon />\n        </Icon>\n      )}\n      {plotableRosTypes.includes(primitiveType) && multiSlicePath !== singleSlicePath && (\n        <Icon fade className={styles.icon} onClick={openPlotPanel(multiSlicePath)} tooltip=\"Scatter plot\">\n          <ChartBubbleIcon />\n        </Icon>\n      )}\n      {transitionableRosTypes.includes(primitiveType) && multiSlicePath === singleSlicePath && (\n        <Icon\n          fade\n          className={styles.icon}\n          onClick={openStateTransitionsPanel(singleSlicePath)}\n          tooltip=\"State Transitions\">\n          <DotsHorizontalIcon />\n        </Icon>\n      )}\n    </span>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { first, last } from \"lodash\";\nimport React from \"react\";\n\nimport { isTypicalFilterName } from \"webviz-core/src/components/MessagePathSyntax/isTypicalFilterName\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport { diffLabels } from \"webviz-core/src/panels/RawMessages/getDiff\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\nimport { format, formatDuration } from \"webviz-core/src/util/time\";\n\nconst DURATION_20_YEARS_SEC = 20 * 365 * 24 * 60 * 60;\nexport const DATA_ARRAY_PREVIEW_LIMIT = 20;\nexport const ROS_COMMON_MSGS: Set<string> = new Set([\n  \"actionlib_msgs\",\n  \"diagnostic_msgs\",\n  \"geometry_msgs\",\n  \"nav_msgs\",\n  \"sensor_msgs\",\n  \"shape_msgs\",\n  \"std_msgs\",\n  \"stereo_msgs\",\n  \"trajectory_msgs\",\n  \"visualization_msgs\",\n]);\n\nfunction getArrow(x: number, y: number) {\n  if (x === 0 && y === 0) {\n    return;\n  }\n  return <span style={{ transform: `rotate(${Math.atan2(-y, x)}rad)`, display: \"inline-block\" }}>→</span>;\n}\n\nexport function getItemString(type: string, data: any, itemType: string, itemString: string) {\n  const keys = Object.keys(data);\n  if (keys.length === 2) {\n    const { sec, nsec } = data;\n    if (sec != null && nsec != null) {\n      // Values \"too small\" to be absolute epoch-based times are probably relative durations.\n      return sec < DURATION_20_YEARS_SEC ? formatDuration(data) : <span>{format(data)}</span>;\n    }\n  }\n\n  // for vectors/points display length\n  if (keys.length === 2) {\n    const { x, y } = data;\n    if (x != null && y != null) {\n      const length = Math.sqrt(x * x + y * y);\n      return (\n        <span>\n          norm = {length.toFixed(2)} {getArrow(x, y)}\n        </span>\n      );\n    }\n  }\n\n  if (keys.length === 3) {\n    const { x, y, z } = data;\n    if (x != null && y != null && z != null) {\n      const length = Math.sqrt(x * x + y * y + z * z);\n      return (\n        <span>\n          norm = {length.toFixed(2)} {z === 0 ? getArrow(x, y) : undefined}\n        </span>\n      );\n    }\n  }\n\n  // Surface typically-used keys directly in the object summary so the user doesn't have to expand it.\n  const filterKeys = keys\n    .filter(isTypicalFilterName)\n    .map((key) => `${key}: ${data[key]}`)\n    .join(\", \");\n  return (\n    <span>\n      {itemType} {filterKeys || itemString}\n    </span>\n  );\n}\n\nfunction getChangeCounts(data, startingCounts) {\n  const possibleLabelTexts = Object.keys(startingCounts);\n  for (const key in data) {\n    if (possibleLabelTexts.includes(key)) {\n      startingCounts[key]++;\n    } else if (typeof data[key] === \"object\") {\n      getChangeCounts(data[key], startingCounts);\n    }\n  }\n  return startingCounts;\n}\n\nexport const getItemStringForDiff = (type: string, data: any, itemType: string, itemString: string) => {\n  const { ADDED, DELETED, CHANGED, ID } = diffLabels;\n  const id = data[ID.labelText];\n  const idLabel = id\n    ? Object.keys(id)\n        .map((key) => `${key}: ${id[key]}`)\n        .join(\", \")\n    : null;\n  const startingCounts = { [ADDED.labelText]: 0, [CHANGED.labelText]: 0, [DELETED.labelText]: 0 };\n  const counts = getChangeCounts(data, startingCounts);\n  return (\n    <>\n      {id ? (\n        <span>\n          {itemType} {idLabel}\n        </span>\n      ) : null}\n      <span style={{ float: \"right\", color: CHANGED.color }}>\n        {counts[ADDED.labelText] || counts[DELETED.labelText] ? (\n          <span\n            style={{\n              display: \"inline-block\",\n              fontSize: \"0.8em\",\n              padding: 2,\n              borderRadius: 3,\n              backgroundColor: ADDED.color,\n              marginRight: 5,\n            }}>\n            <span style={{ color: colors.GREEN }}>\n              {counts[ADDED.labelText] ? `${diffLabels.ADDED.indicator}${counts[ADDED.labelText]} ` : null}\n            </span>\n            <span style={{ color: colors.RED }}>\n              {counts[DELETED.labelText] ? `${diffLabels.DELETED.indicator}${counts[DELETED.labelText]}` : null}\n            </span>\n          </span>\n        ) : null}\n        {counts[CHANGED.labelText] ? (\n          <span\n            style={{\n              display: \"inline-block\",\n              width: 3,\n              height: 3,\n              borderRadius: 3,\n              backgroundColor: CHANGED.color,\n              marginRight: 5,\n            }}>\n            {counts[CHANGED.labelText] ? \" \" : null}\n          </span>\n        ) : null}\n      </span>\n    </>\n  );\n};\n\nexport function getMessageDocumentationLink(datatype: string): ?string {\n  const parts = datatype.split(\"/\");\n  const pkg = first(parts);\n  const filename = last(parts);\n  return ROS_COMMON_MSGS.has(pkg)\n    ? `http://docs.ros.org/api/${pkg}/html/msg/${filename}.html`\n    : getGlobalHooks()\n        .perPanelHooks()\n        .RawMessages.docLinkFunction(filename);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport LinkPlusIcon from \"@mdi/svg/svg/link-plus.svg\";\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport GlobalVariableLink, { SPath, GlobalVariableName } from \"./GlobalVariableLink/index\";\nimport { SEmptyState } from \"./index\";\nimport { getPath } from \"./interactionUtils\";\nimport { type LinkedGlobalVariables } from \"./useLinkedGlobalVariables\";\nimport Icon from \"webviz-core/src/components/Icon\";\n\nconst STable = styled.table`\n  td {\n    padding: 0.3em;\n    border: none;\n    vertical-align: middle;\n  }\n`;\n\ntype Props = {\n  linkedGlobalVariables: LinkedGlobalVariables,\n};\n\nexport default function LinkedGlobalVariableList({ linkedGlobalVariables }: Props) {\n  if (linkedGlobalVariables.length === 0) {\n    return (\n      <SEmptyState>\n        Click the{\" \"}\n        <Icon style={{ display: \"inline\", verticalAlign: \"middle\", lineHeight: 1 }} clickable={false}>\n          <LinkPlusIcon />\n        </Icon>{\" \"}\n        icon in the “Clicked object” tab to link values with global variables.\n      </SEmptyState>\n    );\n  }\n  return (\n    <>\n      <SEmptyState>Clicking on objects from these topics will update the linked global variables.</SEmptyState>\n      <STable>\n        <tbody>\n          {linkedGlobalVariables.map((linkedGlobalVariable, index) => (\n            <tr key={index}>\n              <td>\n                <GlobalVariableLink\n                  linkedGlobalVariable={linkedGlobalVariable}\n                  unlinkTooltip={\n                    <span>\n                      Unlink <GlobalVariableName name={linkedGlobalVariable.name} />\n                    </span>\n                  }\n                />\n              </td>\n              <td style={{ wordBreak: \"break-all\" }}>\n                {linkedGlobalVariable.topic}.<SPath>{getPath(linkedGlobalVariable.markerKeyPath)}</SPath>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </STable>\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { first, omit } from \"lodash\";\nimport * as React from \"react\";\nimport Tree from \"react-json-tree\";\nimport { type MouseEventObject } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport GlobalVariableLink from \"./GlobalVariableLink/index\";\nimport type { InteractionData } from \"./types\";\nimport { type LinkedGlobalVariables } from \"./useLinkedGlobalVariables\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport { jsonTreeTheme } from \"webviz-core/src/util/globalConstants\";\n\nconst SObjectDetails = styled.div`\n  padding: 12px 0 16px 0;\n`;\n\ntype CommonProps = {\n  interactionData: ?InteractionData,\n  linkedGlobalVariables: LinkedGlobalVariables,\n};\n\ntype WrapperProps = CommonProps & {\n  selectedObject: MouseEventObject,\n};\n\ntype Props = CommonProps & {\n  objectToDisplay: any,\n};\n\nexport const getInstanceObj = (marker: any, idx: number) => {\n  return marker.metadataByIndex && marker.metadataByIndex[idx];\n};\n\nexport default function ObjectDetailsWrapper({\n  interactionData,\n  linkedGlobalVariables,\n  selectedObject: { object, instanceIndex },\n}: WrapperProps) {\n  const [showInstance, setShowInstance] = React.useState(true);\n  const instanceObject = getInstanceObj(object, instanceIndex);\n  const dropdownText = {\n    instance: \"Show instance object\",\n    full: \"Show full object\",\n  };\n\n  return instanceObject ? (\n    <div>\n      <Dropdown\n        position=\"below\"\n        value={showInstance}\n        text={showInstance ? dropdownText.instance : dropdownText.full}\n        onChange={setShowInstance}>\n        <span value={true}>{dropdownText.instance}</span>\n        <span value={false}>{dropdownText.full}</span>\n      </Dropdown>\n      <ObjectDetails\n        interactionData={interactionData}\n        linkedGlobalVariables={linkedGlobalVariables}\n        objectToDisplay={showInstance ? instanceObject : object}\n      />\n    </div>\n  ) : (\n    <ObjectDetails\n      interactionData={interactionData}\n      linkedGlobalVariables={linkedGlobalVariables}\n      objectToDisplay={object}\n    />\n  );\n}\n\nfunction ObjectDetails({ interactionData, linkedGlobalVariables, objectToDisplay }: Props) {\n  const topic = (interactionData && interactionData.topic) || \"\";\n  const originalObject = omit(objectToDisplay, \"interactionData\");\n\n  if (!topic) {\n    // show the original object directly if there is no interaction data. e.g. DrawPolygons\n    return (\n      <SObjectDetails>\n        <Tree\n          data={objectToDisplay}\n          shouldExpandNode={(markerKeyPath, data, level) => level < 2}\n          invertTheme={false}\n          theme={{ ...jsonTreeTheme, tree: { margin: 0 } }}\n          hideRoot\n        />\n      </SObjectDetails>\n    );\n  }\n\n  return (\n    <SObjectDetails>\n      <Tree\n        data={originalObject}\n        shouldExpandNode={(markerKeyPath, data, level) => level < 2}\n        invertTheme={false}\n        theme={{ ...jsonTreeTheme, tree: { margin: 0 } }}\n        hideRoot\n        getItemString={(type, data, itemType, itemString) => <span>{itemString}</span>}\n        labelRenderer={(markerKeyPath: string[], p1, p2, hasChildren: boolean, ...rest) => {\n          const label = first(markerKeyPath);\n          if (!hasChildren) {\n            return <span style={{ padding: \"0 4px\" }}>{label}</span>;\n          }\n\n          let objectForPath = originalObject;\n          for (let i = markerKeyPath.length - 1; i >= 0; i--) {\n            objectForPath = objectForPath[markerKeyPath[i]];\n            if (!objectForPath) {\n              break;\n            }\n          }\n\n          if (objectForPath) {\n            return (\n              <GlobalVariableLink\n                hasNestedValue\n                style={{ marginLeft: 4 }}\n                label={label}\n                markerKeyPath={markerKeyPath}\n                topic={topic}\n                variableValue={objectForPath}\n              />\n            );\n          }\n        }}\n        valueRenderer={(label: string, itemValue: any, ...markerKeyPath: string[]) => {\n          return (\n            <GlobalVariableLink\n              style={{ marginLeft: 16 }}\n              label={label}\n              markerKeyPath={markerKeyPath}\n              topic={topic}\n              variableValue={itemValue}\n            />\n          );\n        }}\n      />\n    </SObjectDetails>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ExportVariantIcon from \"@mdi/svg/svg/export-variant.svg\";\nimport { get } from \"lodash\";\nimport React, { useMemo, useState, useCallback } from \"react\";\nimport { type MouseEventObject } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport { SValue, SLabel } from \"./index\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Menu from \"webviz-core/src/components/Menu\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport { getClickedInfo } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/PointCloudBuilder\";\nimport { downloadFiles } from \"webviz-core/src/util\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\n\nconst SRow = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0;\n  margin: 4px 0;\n`;\ntype Props = {\n  selectedObject: MouseEventObject,\n};\n\nexport default function PointCloudDetails({ selectedObject: { object, instanceIndex } }: Props) {\n  const [isOpen, setIsOpen] = useState<boolean>(false);\n  const allPoints: number[] = object.points || [];\n\n  const { clickedPoint, clickedPointColor, additionalFieldValues } =\n    useMemo(() => getClickedInfo(object, instanceIndex), [instanceIndex, object]) || {};\n\n  const additionalFieldNames = useMemo(() => (additionalFieldValues && Object.keys(additionalFieldValues)) || [], [\n    additionalFieldValues,\n  ]);\n\n  const hasAdditionalFieldNames = !!additionalFieldNames.length;\n  const onCopy = useCallback(\n    () => {\n      const dataRows = [];\n      const len = allPoints.length / 3;\n      // get copy data\n      for (let i = 0; i < len; i++) {\n        const rowData = [allPoints[i * 3], allPoints[i * 3 + 1], allPoints[i * 3 + 2]];\n        rowData.push(...additionalFieldNames.map((fieldName) => get(object, [fieldName, i])));\n        dataRows.push(rowData.join(\",\"));\n      }\n\n      const additionalColumns = hasAdditionalFieldNames ? `,${additionalFieldNames.join(\",\")}` : \"\";\n      const dataStr = `x,y,z${additionalColumns}\\n${dataRows.join(\"\\n\")}`;\n      const blob = new Blob([dataStr], { type: \"text/csv;charset=utf-8;\" });\n      downloadFiles([{ blob, fileName: \"PointCloud.csv\" }]);\n      setIsOpen(false);\n    },\n    [additionalFieldNames, hasAdditionalFieldNames, allPoints, object]\n  );\n\n  if (!clickedPoint || allPoints.length === 0) {\n    return null;\n  }\n\n  const colorStyle = clickedPointColor ? { color: `rgba(${clickedPointColor.join(\",\")})` } : {};\n\n  return (\n    <>\n      <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        <ChildToggle position=\"below\" onToggle={() => setIsOpen(!isOpen)} isOpen={isOpen}>\n          <Icon\n            small\n            fade\n            active={isOpen}\n            tooltip={hasAdditionalFieldNames ? \"Export points and fields\" : \"Export points\"}>\n            <ExportVariantIcon />\n          </Icon>\n          <Menu>\n            <Item\n              onClick={() => {\n                clipboard.copy(clickedPoint.join(\", \")).then(() => {\n                  setIsOpen(false);\n                });\n              }}>\n              Copy clicked point to clipboard\n            </Item>\n            <Item onClick={onCopy}>\n              {hasAdditionalFieldNames ? \"Download all points and fields as CSV\" : \"Download all points as CSV\"}\n            </Item>\n          </Menu>\n        </ChildToggle>\n      </div>\n      <SRow>\n        <SLabel width={hasAdditionalFieldNames ? 72 : 44}>Point:</SLabel>\n        <SValue style={{ flex: 1, lineHeight: 1.4, ...colorStyle }}>\n          {clickedPoint.map((x) => (typeof x === \"number\" ? x : JSON.stringify(x))).join(\", \")}\n        </SValue>\n      </SRow>\n      {additionalFieldValues && (\n        <>\n          {Object.keys(additionalFieldValues).map((fieldName) => (\n            <SRow key={fieldName}>\n              <SLabel width={72}>{fieldName.charAt(0).toUpperCase() + fieldName.slice(1)}:</SLabel>\n              <SValue>{additionalFieldValues[fieldName]}</SValue>\n            </SRow>\n          ))}\n        </>\n      )}\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { throttle } from \"lodash\";\n\nconst DELAY = 1000;\n\nconst warn = throttle((...args: any[]) => console.warn(...args), DELAY);\nconst error = throttle((...args: any[]) => console.error(...args), DELAY);\nconst info = throttle((...args: any[]) => console.info(...args), DELAY);\nconst debug = throttle((...args: any[]) => console.log(...args), DELAY);\n\nexport default {\n  debug,\n  info,\n  warn,\n  error,\n};\n","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./ExpandingToolbar.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./ExpandingToolbar.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../node_modules/sass-loader/lib/loader.js??ref--16!./ExpandingToolbar.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-components-ExpandingToolbar-module-3g6tj--tabBar .packages-webviz-core-src-components-ExpandingToolbar-module-4bm9d--tab {\\n  margin: 0;\\n  padding-left: 8px;\\n  padding-right: 8px;\\n  border-radius: 0;\\n  border-top: 2px solid transparent;\\n  border-bottom: 2px solid transparent; }\\n  .packages-webviz-core-src-components-ExpandingToolbar-module-3g6tj--tabBar .packages-webviz-core-src-components-ExpandingToolbar-module-4bm9d--tab.packages-webviz-core-src-components-ExpandingToolbar-module-3ndvr--selected {\\n    border-bottom: 2px solid rgba(247, 247, 243, 0.77); }\\n\\n.packages-webviz-core-src-components-ExpandingToolbar-module-3g6tj--tabBar .packages-webviz-core-src-components-ExpandingToolbar-module-hhvxd--spaceSeparator {\\n  -ms-flex-positive: 1;\\n      flex-grow: 1;\\n  min-width: 24px; }\\n\\n.packages-webviz-core-src-components-ExpandingToolbar-module-41fux--tabBody {\\n  background-color: #1a1a1f;\\n  padding: 4px 12px 12px 12px; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/components/ExpandingToolbar.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA;EAEI,UAAS;EACT,kBAAiB;EACjB,mBAAkB;EAClB,iBAAgB;EAChB,kCAAiC;EACjC,qCAAoC,EAIrC;EAXH;IASM,mDCHiC,EDIlC;;AAVL;EAcI,qBAAY;MAAZ,aAAY;EACZ,gBAAe,EAChB;;AAGH;EACE,0BCOwB;EDNxB,4BAA2B,EAC5B\",\"file\":\"ExpandingToolbar.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.tabBar {\\n  .tab {\\n    margin: 0;\\n    padding-left: 8px;\\n    padding-right: 8px;\\n    border-radius: 0;\\n    border-top: 2px solid transparent;\\n    border-bottom: 2px solid transparent;\\n    &.selected {\\n      border-bottom: 2px solid $text-normal;\\n    }\\n  }\\n\\n  .spaceSeparator {\\n    flex-grow: 1;\\n    min-width: 24px;\\n  }\\n}\\n\\n.tabBody {\\n  background-color: $panel-background;\\n  padding: 4px 12px 12px 12px;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tabBar\": \"packages-webviz-core-src-components-ExpandingToolbar-module-3g6tj--tabBar\",\n\t\"tab\": \"packages-webviz-core-src-components-ExpandingToolbar-module-4bm9d--tab\",\n\t\"selected\": \"packages-webviz-core-src-components-ExpandingToolbar-module-3ndvr--selected\",\n\t\"spaceSeparator\": \"packages-webviz-core-src-components-ExpandingToolbar-module-hhvxd--spaceSeparator\",\n\t\"tabBody\": \"packages-webviz-core-src-components-ExpandingToolbar-module-41fux--tabBody\"\n};","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4ny72--topicSettingsEditor .packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-tw6e7--closeIcon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4ny72--topicSettingsEditor, .packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons {\\n  background-color: #2d2c33;\\n  border-radius: 4px;\\n  padding: 0;\\n  -webkit-box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n          box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  -ms-flex-negative: 0;\\n      flex-shrink: 0; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4gt2e--container {\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex: 1 1 auto;\\n      flex: 1 1 auto;\\n  position: relative;\\n  width: 100%;\\n  height: 100%; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-36swq--world {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  bottom: 0;\\n  right: 0; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4ny72--topicSettingsEditor {\\n  background-color: #1a1a1f;\\n  width: 300px;\\n  padding: 20px; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-sef3w--toolbar {\\n  position: absolute;\\n  top: 15px;\\n  padding: 0px;\\n  z-index: 101;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-direction: column;\\n      flex-direction: column;\\n  -ms-flex-align: end;\\n      align-items: flex-end;\\n  pointer-events: none; }\\n  .packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-sef3w--toolbar.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3xasx--left {\\n    left: 15px; }\\n  .packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-sef3w--toolbar.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-n75xz--right {\\n    top: 35px;\\n    right: 15px; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons {\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-direction: column;\\n      flex-direction: column;\\n  padding: 0px;\\n  margin-bottom: 10px; }\\n  .packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons button {\\n    background-color: transparent;\\n    border: none;\\n    padding-left: 4px;\\n    padding-right: 4px; }\\n  .packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons span.icon {\\n    width: 18px;\\n    height: 18px;\\n    font-size: 18px;\\n    display: inline-block; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3ppq8--buttonsActive span.icon {\\n  color: #22b5ff; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-ftsax--cameraWarning {\\n  margin-top: 0.5em;\\n  font-size: 0.9em;\\n  font-style: italic;\\n  color: rgba(247, 247, 243, 0.3);\\n  width: 0;\\n  min-width: 100%; }\\n\\n.packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-33xh7--cartographer {\\n  padding: 0px; }\\n  .packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-33xh7--cartographer button {\\n    width: 31px !important;\\n    height: 36px !important;\\n    margin: 0px; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/mixins.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAqBA;ECFE,mBAAkB;EAClB,WAAU;EACV,SAAQ;EACR,gBAAe;EACf,gBAAe,EAChB;;ADHD;ECME,0BCUe;EDTf,mBAAkB;EAClB,WAAU;EACV,iFAAwE;UAAxE,yEAAwE;EACxE,iBAAgB;EAChB,qBAAoB;EACpB,qBAAc;MAAd,eAAc,EACf;;AD7BD;EACE,qBAAa;EAAb,cAAa;EACb,mBAAc;MAAd,eAAc;EACd,mBAAkB;EAClB,YAAW;EACX,aAAY,EACb;;AAED;EACE,mBAAkB;EAClB,OAAM;EACN,QAAO;EACP,UAAS;EACT,SAAQ,EACT;;AAED;EAEE,0BEYwB;EFXxB,aAAY;EACZ,cAAa,EAKd;;AAED;EACE,mBAAkB;EAClB,UAlCY;EA2CZ,aAAY;EACZ,aAAY;EACZ,qBAAa;EAAb,cAAa;EACb,2BAAsB;MAAtB,uBAAsB;EACtB,oBAAqB;MAArB,sBAAqB;EAGrB,qBAAoB,EACrB;EAnBD;IAII,WApCU,EAqCX;EALH;IAQI,UAAkB;IAClB,YAzCU,EA0CX;;AAWH;EAEE,qBAAa;EAAb,cAAa;EACb,2BAAsB;MAAtB,uBAAsB;EACtB,aAAY;EACZ,oBAAmB,EAepB;EApBD;IAQI,8BAA6B;IAC7B,aAAY;IACZ,kBAAiB;IACjB,mBAAkB,EACnB;EAZH;IAeI,YAAW;IACX,aAAY;IACZ,gBAAe;IACf,sBAAqB,EACtB;;AAGH;EAEI,eEvCY,EFwCb;;AAGH;EACE,kBAAiB;EACjB,iBAAgB;EAChB,mBAAkB;EAClB,gCErEmC;EFyEnC,SAAQ;EACR,gBAAe,EAChB;;AAED;EACE,aAAY,EAMb;EAPD;IAGI,uBAAsB;IACtB,wBAAuB;IACvB,YAAW,EACZ\",\"file\":\"Layout.module.scss\",\"sourcesContent\":[\"$spacing: 15px;\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n\\n// container for the entire panel\\n.container {\\n  display: flex;\\n  flex: 1 1 auto;\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n.world {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  bottom: 0;\\n  right: 0;\\n}\\n\\n.topicSettingsEditor {\\n  @extend %floating-box;\\n  background-color: $panel-background;\\n  width: 300px;\\n  padding: 20px;\\n\\n  .closeIcon {\\n    @extend %floating-box-close-icon;\\n  }\\n}\\n\\n.toolbar {\\n  position: absolute;\\n  top: $spacing;\\n  &.left {\\n    left: $spacing;\\n  }\\n  &.right {\\n    // move the right toolbar below the floating panel controls\\n    top: $spacing + 20;\\n    right: $spacing;\\n  }\\n  padding: 0px;\\n  z-index: 101;\\n  display: flex;\\n  flex-direction: column;\\n  align-items: flex-end;\\n\\n  // allow mouse events to pass through the empty space in this container element\\n  pointer-events: none;\\n}\\n\\n.buttons {\\n  @extend %floating-box;\\n  display: flex;\\n  flex-direction: column;\\n  padding: 0px;\\n  margin-bottom: 10px;\\n\\n  button {\\n    background-color: transparent;\\n    border: none;\\n    padding-left: 4px;\\n    padding-right: 4px;\\n  }\\n\\n  span:global(.icon) {\\n    width: 18px;\\n    height: 18px;\\n    font-size: 18px;\\n    display: inline-block;\\n  }\\n}\\n\\n.buttonsActive {\\n  span:global(.icon) {\\n    color: $accent;\\n  }\\n}\\n\\n.cameraWarning {\\n  margin-top: 0.5em;\\n  font-size: 0.9em;\\n  font-style: italic;\\n  color: $text-muted;\\n\\n  // don't affect flex parent width\\n  // https://stackoverflow.com/a/25045641/23649\\n  width: 0;\\n  min-width: 100%;\\n}\\n\\n.cartographer {\\n  padding: 0px;\\n  button {\\n    width: 31px !important;\\n    height: 36px !important;\\n    margin: 0px;\\n  }\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: $padding ($padding + 4px);\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $toolbar;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: $control-padding;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active {\\n  color: $text-normal;\\n  // @extend %bold;\\n  background-color: $background-control-selected;\\n}\\n\\n%menu-item-hover {\\n  background-color: $menu-item-hover;\\n  color: $text-normal;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-sef3w--toolbar\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"topicSettingsEditor\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4ny72--topicSettingsEditor\",\n\t\"closeIcon\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-tw6e7--closeIcon\",\n\t\"buttons\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3hmzk--buttons\",\n\t\"container\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-4gt2e--container\",\n\t\"world\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-36swq--world\",\n\t\"left\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3xasx--left\",\n\t\"right\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-n75xz--right\",\n\t\"buttonsActive\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-3ppq8--buttonsActive\",\n\t\"cameraWarning\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-ftsax--cameraWarning\",\n\t\"cartographer\": \"packages-webviz-core-src-panels-ThreeDimensionalViz-Layout-module-33xh7--cartographer\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { type MouseEventObject } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport { type ClickedPosition } from \"webviz-core/src/panels/ThreeDimensionalViz/Layout\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SInteractionContextMenu = styled.div`\n  position: fixed;\n  width: 240px;\n  background: ${colors.DARK4};\n  z-index: 101; /* above the Text marker */\n`;\n\nconst SMenu = styled.ul`\n  margin: 0;\n  padding: 0;\n`;\n\nconst STooltip = styled.div`\n  cursor: pointer;\n  background: ${colors.PURPLE1};\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: none;\n  padding: 8px;\n`;\n\nconst SMenuItem = styled.li`\n  cursor: pointer;\n  padding: 8px;\n  position: relative;\n  &:hover {\n    background: ${colors.PURPLE1};\n    ${STooltip} {\n      display: block;\n    }\n  }\n`;\n\nconst STopic = styled.div`\n  width: 100%;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n`;\n\nconst SId = styled.span`\n  color: ${colors.YELLOW1};\n`;\n\ntype Props = {\n  clickedPosition: ClickedPosition,\n  selectedObjects: MouseEventObject[],\n  onSelectObject: (MouseEventObject) => void,\n};\n\nexport default function InteractionContextMenu({ selectedObjects = [], clickedPosition = {}, onSelectObject }: Props) {\n  return (\n    <SInteractionContextMenu\n      style={{\n        top: clickedPosition.clientY,\n        left: clickedPosition.clientX,\n      }}>\n      <SMenu>\n        {selectedObjects.map(({ object, instanceIndex }, index) => {\n          const menuText = (\n            <>\n              {object.id && <SId>{object.id}</SId>}\n              {object.interactionData && object.interactionData.topic}\n            </>\n          );\n          return (\n            <SMenuItem key={index}>\n              <STopic\n                key={object.id || (object.interactionData && object.interactionData.topic)}\n                onClick={() => onSelectObject({ object, instanceIndex })}>\n                {menuText}\n                <STooltip>{menuText}</STooltip>\n              </STopic>\n            </SMenuItem>\n          );\n        })}\n      </SMenu>\n    </SInteractionContextMenu>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { type Node as ReactNode, useCallback, useMemo } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport GlobalVariableSlider from \"webviz-core/src/components/GlobalVariableSlider\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport type { SliderProps } from \"webviz-core/src/components/SliderWithTicks\";\nimport TextField from \"webviz-core/src/components/TextField\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\n\nexport type GlobalVariableSliderConfig = {\n  sliderProps: SliderProps,\n  globalVariableName: string,\n};\n\ntype Props = {\n  config: GlobalVariableSliderConfig,\n  saveConfig: ($Shape<GlobalVariableSliderConfig>) => void,\n};\n\ntype MenuProps = {\n  config: GlobalVariableSliderConfig,\n  updateConfig: (config: $Shape<GlobalVariableSliderConfig>) => void,\n};\n\n// Validation helper functions for the SliderSettingsMenu\nconst minMaxValidatorFn = (str) => (isNaN(parseFloat(str)) ? \"Must be valid number\" : null);\nconst stepValidatorFn = (str) => {\n  const result = minMaxValidatorFn(str);\n  if (result) {\n    return result;\n  }\n  const number = parseFloat(str);\n  if (number <= 0) {\n    return \"Must be >= 0\";\n  }\n  return null;\n};\n\nfunction SliderSettingsMenu(props: MenuProps) {\n  const { updateConfig, config } = props;\n  const { sliderProps, globalVariableName } = config;\n\n  const updateSliderProps = useCallback(\n    (partial: $Shape<SliderProps>) => {\n      updateConfig({\n        ...config,\n        sliderProps: { ...sliderProps, ...partial },\n      });\n    },\n    [config, sliderProps, updateConfig]\n  );\n\n  const onChangeVariableName = useCallback(\n    (newGlobalVariableName) =>\n      updateConfig({\n        ...config,\n        globalVariableName: newGlobalVariableName,\n      }),\n    [config, updateConfig]\n  );\n\n  const onChangeMin = useCallback((min) => updateSliderProps({ min: parseFloat(min) }), [updateSliderProps]);\n  const onChangeMax = useCallback((max) => updateSliderProps({ max: parseFloat(max) }), [updateSliderProps]);\n  const onChangeStep = useCallback((step) => updateSliderProps({ step: parseFloat(step) }), [updateSliderProps]);\n  return (\n    <>\n      <Item>\n        <TextField\n          value={globalVariableName}\n          onChange={onChangeVariableName}\n          label=\"Global variable name\"\n          validateOnBlur\n        />\n      </Item>\n      <Item>\n        <TextField\n          value={`${sliderProps.min}`}\n          onChange={onChangeMin}\n          placeholder=\"Min\"\n          label=\"Min\"\n          validator={minMaxValidatorFn}\n        />\n      </Item>\n      <Item>\n        <TextField\n          value={`${sliderProps.max}`}\n          onChange={onChangeMax}\n          placeholder=\"Max\"\n          label=\"Max\"\n          validator={minMaxValidatorFn}\n        />\n      </Item>\n      <Item>\n        <TextField\n          value={`${sliderProps.step}`}\n          onChange={onChangeStep}\n          placeholder=\"Step\"\n          label=\"Step\"\n          validator={stepValidatorFn}\n        />\n      </Item>\n    </>\n  );\n}\n\nfunction GlobalVariableSliderPanel(props: Props): ReactNode {\n  const { config, saveConfig } = props;\n  const { sliderProps, globalVariableName } = config;\n  const { globalVariables, setGlobalVariables } = useGlobalVariables();\n\n  const globalVariableValue = globalVariables[globalVariableName];\n  const saveSliderProps = useCallback(\n    (updatedConfig) => {\n      // If the name of the global variable changes, immediately set its value.\n      // Without this, the variable won't be set until the slider is moved.\n      if (updatedConfig.globalVariableName !== config.globalVariableName) {\n        setGlobalVariables({ [updatedConfig.globalVariableName]: globalVariableValue });\n      }\n      saveConfig(updatedConfig);\n    },\n    [config.globalVariableName, globalVariableValue, saveConfig, setGlobalVariables]\n  );\n  const additionalOutput = useMemo(\n    () => {\n      return getGlobalHooks()\n        .perPanelHooks()\n        .GlobalVariableSlider.getVariableSpecificOutput(globalVariableName, globalVariables);\n    },\n    [globalVariableName, globalVariables]\n  );\n  const menuContent = useMemo(() => <SliderSettingsMenu config={config} updateConfig={saveSliderProps} />, [\n    config,\n    saveSliderProps,\n  ]);\n  return (\n    <div style={{ padding: \"25px 4px 4px\" }}>\n      <PanelToolbar floating menuContent={menuContent} />\n      <GlobalVariableSlider sliderProps={sliderProps} globalVariableName={globalVariableName} />\n      {additionalOutput}\n    </div>\n  );\n}\n\nGlobalVariableSliderPanel.panelType = \"GlobalVariableSliderPanel\";\nGlobalVariableSliderPanel.defaultConfig = {\n  sliderProps: { min: 0, max: 10, step: 1 },\n  globalVariableName: \"globalVariable\",\n};\n\nexport default hot(Panel<GlobalVariableSliderConfig>(GlobalVariableSliderPanel));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { type Node as ReactNode, useCallback } from \"react\";\n\nimport { SliderWithTicks } from \"webviz-core/src/components/SliderWithTicks\";\nimport type { SliderProps } from \"webviz-core/src/components/SliderWithTicks\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\n\ntype Props = {\n  sliderProps: SliderProps,\n  globalVariableName: string,\n};\n\n// A slider that controls the value of a global variable\nexport default function GlobalVariableSlider(props: Props): ReactNode {\n  const { globalVariables, setGlobalVariables } = useGlobalVariables();\n  const globalVariableValue = globalVariables[props.globalVariableName];\n\n  const onChange = useCallback(\n    (newValue) => {\n      if (newValue !== globalVariableValue) {\n        setGlobalVariables({ [props.globalVariableName]: newValue });\n      }\n    },\n    [props.globalVariableName, globalVariableValue, setGlobalVariables]\n  );\n  return <SliderWithTicks value={globalVariableValue} sliderProps={props.sliderProps} onChange={onChange} />;\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { sumBy } from \"lodash\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport textWidth from \"text-width\";\n\nimport AutoSizingCanvas from \"webviz-core/src/components/AutoSizingCanvas\";\nimport Slider from \"webviz-core/src/components/Slider\";\nimport mixins from \"webviz-core/src/styles/mixins.module.scss\";\n\n// The minimum ratio between the width of the panel and the total width taken by the labels.\n// If the ratio drops below this value, (due to the width of the panel changing)\n// we will remove every other label until the ratio is back above this value.\nconst MINIMUM_LABEL_FREESPACE_RATIO = 2;\n\nconst TICK_FONT = { family: mixins.monospaceFont, size: 10 };\n\nconst SSliderContainer = styled.div`\n  height: 30px;\n  position: relative;\n  margin-bottom: 4px;\n`;\n\ntype MeasuredLabel = {\n  text: string,\n  tickWidth: number,\n  value: number,\n};\n\nexport type SliderProps = {\n  min: number,\n  max: number,\n  step: number,\n};\n\nexport function SliderWithTicks(props: { value: number, sliderProps: SliderProps, onChange: (number) => void }) {\n  const { value, sliderProps, onChange } = props;\n  return (\n    <SSliderContainer>\n      <AutoSizingCanvas draw={drawTicks(value, sliderProps)} />\n      <div style={{ position: \"absolute\", left: 0, top: 0, right: 0, bottom: 0 }}>\n        <Slider {...sliderProps} value={value} draggable onChange={onChange} />\n      </div>\n    </SSliderContainer>\n  );\n}\n\n// exported for tests\nexport function getNonOverlappingLabels(measuredLabels: MeasuredLabel[], width: number): MeasuredLabel[] {\n  let stepLabels: MeasuredLabel[] = measuredLabels;\n  do {\n    const totalWidth = sumBy(stepLabels, ({ tickWidth }) => tickWidth);\n    const freeSpaceRatio = width / totalWidth;\n    if (freeSpaceRatio >= MINIMUM_LABEL_FREESPACE_RATIO) {\n      break;\n    }\n    stepLabels = stepLabels.filter((_, i) => i % 2 === 0);\n  } while (stepLabels.length > 3);\n  return stepLabels;\n}\n\nfunction drawTicks(futureTime: number | null, sliderConfig: SliderProps) {\n  const { min, max, step } = sliderConfig;\n\n  // First, measure all the step labels' text widths.\n  // we do this outside the canvas context function so it can be cached.\n  const measuredLabels = [];\n\n  // Represents the number of gaps, not the number of ticks\n  const steps = Math.ceil((max - min) / step);\n  for (let i = 0; i <= steps; i++) {\n    const value = Math.min(min + (i / steps) * (max - min), max);\n    const text = value.toFixed(1);\n\n    const tickWidth = textWidth(text, TICK_FONT);\n    measuredLabels.push({\n      text,\n      value,\n      tickWidth,\n    });\n  }\n\n  return (ctx: CanvasRenderingContext2D, width: number, height: number) => {\n    // We don't want labels to overlap, so keep removing every other one until the\n    // ratio of textWidth to the totalWidth of the panel is above the threshold.\n    const stepLabels = getNonOverlappingLabels(measuredLabels, width);\n\n    // Clear the previous labels and draw the new ones\n    ctx.clearRect(0, 0, width, height);\n    stepLabels.forEach(({ text, tickWidth, value }, i) => {\n      const x = (i / (stepLabels.length - 1)) * width - tickWidth / 2;\n      const y = height / 2 + 2;\n\n      if (futureTime === value) {\n        ctx.font = `bold ${TICK_FONT.size}px ${TICK_FONT.family}`;\n        ctx.fillStyle = \"white\";\n      } else {\n        ctx.font = `${TICK_FONT.size}px ${TICK_FONT.family}`;\n        ctx.fillStyle = \"#666\";\n      }\n      ctx.fillText(text, x, y);\n    });\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst { useRef, useState, useLayoutEffect, useCallback } = React;\n\nexport const STextField = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nexport const STextFieldLabel = styled.label`\n  margin: 8px 0;\n  color: ${colors.GRAY};\n`;\n\nexport const SError = styled.div`\n  color: ${colors.RED};\n  margin: 4px 0;\n`;\n\ntype Props = {\n  defaultValue?: string,\n  focusOnMount?: boolean,\n  inputStyle: { [string]: string | number },\n  hideInlineError?: boolean,\n  label?: string,\n  onBlur: () => void,\n  onChange: (value: string) => void,\n  onError?: (error: ?string) => void,\n  placeholder?: string,\n  style: { [string]: string | number },\n  validateOnBlur?: boolean,\n  validator: (value: any) => ?string,\n  value?: string,\n};\n\nexport default function TextField({\n  defaultValue,\n  focusOnMount,\n  inputStyle,\n  hideInlineError,\n  label,\n  onBlur,\n  onChange,\n  onError,\n  placeholder,\n  style,\n  validateOnBlur,\n  validator,\n  value,\n  ...rest\n}: Props) {\n  const [error, setError] = useState<?string>();\n  const [inputStr, setInputStr] = useState<string>(value || defaultValue || \"\");\n\n  const prevIncomingVal = useRef(\"\");\n  const inputRef = useRef(null);\n\n  useLayoutEffect(\n    () => {\n      // only compare if it's a controlled component\n      if (!defaultValue && !validateOnBlur && prevIncomingVal.current !== value) {\n        const validationResult = validator(value);\n        setError(validationResult || null);\n        setInputStr(value || \"\");\n      }\n      prevIncomingVal.current = value;\n    },\n    [defaultValue, validateOnBlur, validator, value]\n  );\n\n  useLayoutEffect(\n    () => {\n      if (inputRef.current && focusOnMount) {\n        inputRef.current.focus();\n      }\n    },\n    [focusOnMount]\n  );\n\n  useLayoutEffect(\n    () => {\n      if (onError) {\n        onError(error);\n      }\n    },\n    [error, onError]\n  );\n\n  const validate = useCallback(\n    (val) => {\n      const validationResult = validator(val);\n      if (validationResult) {\n        setError(validationResult);\n      } else {\n        setError(null);\n        onChange(val);\n      }\n    },\n    [onChange, validator]\n  );\n\n  const handleChange = useCallback(\n    ({ target }) => {\n      setInputStr(target.value);\n      if (!validateOnBlur) {\n        validate(target.value);\n      }\n    },\n    [validate, validateOnBlur]\n  );\n\n  const handleBlur = useCallback(\n    () => {\n      if (validateOnBlur) {\n        validate(inputStr);\n      }\n      if (onBlur) {\n        onBlur();\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [inputStr, onBlur, validate, validateOnBlur]\n  );\n\n  // only show red border when there is some input and it's not valid\n  const errorStyle = inputStr && error ? { border: `1px solid ${colors.RED}` } : {};\n\n  return (\n    <STextField style={style}>\n      {label && <STextFieldLabel>{label}</STextFieldLabel>}\n      <input\n        onBlur={handleBlur}\n        ref={inputRef}\n        placeholder={placeholder}\n        style={{ marginLeft: 0, ...errorStyle, ...inputStyle }}\n        value={inputStr}\n        onChange={handleChange}\n        {...rest}\n      />\n      {error && !hideInlineError && <SError>{error}</SError>}\n    </STextField>\n  );\n}\n\nTextField.defaultProps = {\n  validator: (value) => undefined,\n  onChange: (value) => {},\n  onBlur: (value) => {},\n  inputStyle: {},\n  style: {},\n};\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport MenuDownIcon from \"@mdi/svg/svg/menu-down.svg\";\nimport WavesIcon from \"@mdi/svg/svg/waves.svg\";\nimport cx from \"classnames\";\nimport { last, get, uniq } from \"lodash\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { createSelector } from \"reselect\";\nimport styled from \"styled-components\";\n\nimport ImageCanvas from \"./ImageCanvas\";\nimport imageCanvasStyles from \"./ImageCanvas.module.scss\";\nimport helpContent from \"./index.help.md\";\nimport style from \"./index.module.scss\";\nimport { getCameraInfoTopic, getCameraNamespace, getRelatedMarkerTopics, getMarkerOptions, groupTopics } from \"./util\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport ChildToggle from \"webviz-core/src/components/ChildToggle\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport dropDownStyles from \"webviz-core/src/components/Dropdown/index.module.scss\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { Item, SubMenu } from \"webviz-core/src/components/Menu\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Topic, Message, TypedMessage } from \"webviz-core/src/players/types\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { CameraInfo } from \"webviz-core/src/types/Messages\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\nimport { useShallowMemo, useDeepMemo } from \"webviz-core/src/util/hooks\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\nimport { getSynchronizingReducers } from \"webviz-core/src/util/synchronizeMessages\";\nimport { formatTimeRaw } from \"webviz-core/src/util/time\";\nimport toggle from \"webviz-core/src/util/toggle\";\n\nconst { useMemo, useCallback } = React;\n\ntype DefaultConfig = {|\n  cameraTopic: string,\n  enabledMarkerTopics: string[],\n  customMarkerTopicOptions?: string[],\n  scale: number,\n  synchronize: boolean,\n|};\n\nexport type ImageViewPanelHooks = {\n  defaultConfig: DefaultConfig,\n  imageMarkerDatatypes: string[],\n};\n\nexport type Config = {|\n  ...DefaultConfig,\n  panelHooks?: ImageViewPanelHooks,\n  transformMarkers: boolean,\n  mode: \"fit\" | \"fill\" | \"other\" | null,\n  zoomPercentage: ?number,\n  offset: ?(number[]),\n  saveStoryConfig?: () => void,\n|};\n\nexport type SaveImagePanelConfig = SaveConfig<Config>;\n\ntype Props = {\n  config: Config,\n  saveConfig: SaveImagePanelConfig,\n  topics: Topic[],\n};\n\nconst TopicTimestampSpan = styled.span`\n  padding: 0px 15px 0px 0px;\n  font-size: 10px;\n  font-style: italic;\n`;\n\nconst TopicTimestamp = ({ text, style: styleObj }: { text: string, style?: { [string]: string } }) =>\n  text === \"\" ? null : <TopicTimestampSpan style={styleObj}>{text}</TopicTimestampSpan>;\n\nconst BottomBar = ({ children, containsOpen }: { children?: React.Node, containsOpen: boolean }) => (\n  <div\n    className={cx(imageCanvasStyles[\"bottom-bar\"], {\n      [imageCanvasStyles.containsOpen]: inScreenshotTests ? true : containsOpen,\n    })}>\n    {children}\n  </div>\n);\n\nconst ToggleComponent = ({\n  text,\n  disabled = false,\n  dataTest,\n}: {\n  text: string,\n  disabled?: boolean,\n  dataTest?: string,\n}) => {\n  return (\n    <button style={{ maxWidth: \"100%\", padding: \"4px 8px\" }} className={cx({ disabled })} data-test={dataTest}>\n      <span className={dropDownStyles.title}>{text}</span>\n      <Icon style={{ marginLeft: 4 }}>\n        <MenuDownIcon style={{ width: 14, height: 14, opacity: 0.5 }} />\n      </Icon>\n    </button>\n  );\n};\n\n// Group image topics by the first component of their name\nconst imageTopicsByNamespaceSelector = createSelector(\n  (topics?: $ReadOnlyArray<Topic>) => topics || [],\n  (topics: $ReadOnlyArray<Topic>): Map<string, Topic[]> => {\n    const imageTopics = topics.filter(\n      (topic) => topic.datatype === \"sensor_msgs/Image\" || topic.datatype === \"sensor_msgs/CompressedImage\"\n    );\n    return groupTopics(imageTopics);\n  }\n);\n\nfunction renderEmptyState(\n  cameraTopic: string,\n  markerTopics: string[],\n  shouldSynchronize: boolean,\n  messagesByTopic: { [topic: string]: Message[] }\n) {\n  return (\n    <EmptyState>\n      Waiting for images {markerTopics.length > 0 && \"and markers\"} on:\n      <ul>\n        <li>\n          <code>{cameraTopic}</code>\n        </li>\n        {markerTopics.sort().map((m) => (\n          <li key={m}>\n            <code>{m}</code>\n          </li>\n        ))}\n      </ul>\n      {shouldSynchronize && (\n        <>\n          <p>\n            Synchronization is enabled, so all messages with <code>header.stamp</code>s must match exactly.\n          </p>\n          <ul>\n            {Object.keys(messagesByTopic).map((topic) => (\n              <li key={topic}>\n                <code>{topic}</code>:{\" \"}\n                {messagesByTopic[topic] && messagesByTopic[topic].length\n                  ? messagesByTopic[topic]\n                      .map(({ message }) =>\n                        // In some cases, a user may have subscribed to a topic that does not include a header stamp.\n                        message?.header?.stamp ? formatTimeRaw(message.header.stamp) : \"[ unknown ]\"\n                      )\n                      .join(\", \")\n                  : \"no messages\"}\n              </li>\n            ))}\n          </ul>\n        </>\n      )}\n    </EmptyState>\n  );\n}\n\nfunction useOptionallySynchronizedMessages(\n  shouldSynchronize: boolean,\n  topics: $ReadOnlyArray<PanelAPI.RequestedTopic>\n) {\n  const memoizedTopics = useDeepMemo(topics);\n  const reducers = useMemo(\n    () =>\n      shouldSynchronize\n        ? getSynchronizingReducers(\n            memoizedTopics.map((request) => (typeof request === \"string\" ? request : request.topic))\n          )\n        : {\n            restore: (previousValue) => ({\n              messagesByTopic: previousValue ? previousValue.messagesByTopic : {},\n              synchronizedMessages: null,\n            }),\n            addMessage: ({ messagesByTopic, synchronizedMessages }, newMessage) => ({\n              messagesByTopic: { ...messagesByTopic, [newMessage.topic]: [newMessage] },\n              synchronizedMessages: null,\n            }),\n          },\n    [shouldSynchronize, memoizedTopics]\n  );\n  return PanelAPI.useMessageReducer({\n    topics,\n    ...reducers,\n  });\n}\n\nconst AddTopic = ({ onSelectTopic, topics }: { onSelectTopic: (string) => void, topics: string[] }) => {\n  return (\n    <div style={{ padding: \"8px 12px\", height: \"31px\" }}>\n      <Autocomplete\n        placeholder=\"Add topic\"\n        items={topics}\n        onSelect={onSelectTopic}\n        getItemValue={(s) => s}\n        getItemText={(s) => s}\n      />\n    </div>\n  );\n};\n\nfunction ImageView(props: Props) {\n  const { config, saveConfig } = props;\n  const {\n    scale,\n    synchronize,\n    cameraTopic,\n    enabledMarkerTopics,\n    panelHooks,\n    transformMarkers,\n    customMarkerTopicOptions = [],\n  } = config;\n  const { topics } = PanelAPI.useDataSourceInfo();\n\n  const imageTopicsByNamespace = imageTopicsByNamespaceSelector(topics);\n  // Represents marker topics based on the camera topic prefix (e.g. \"/camera_front_medium\")\n  const allCameraNamespaces = imageTopicsByNamespace ? [...imageTopicsByNamespace.keys()] : [];\n\n  const { imageMarkerDatatypes } = panelHooks ||\n    getGlobalHooks().perPanelHooks().ImageView || { imageMarkerDatatypes: [] };\n  const defaultAvailableMarkerTopics = getMarkerOptions(cameraTopic, topics, allCameraNamespaces, imageMarkerDatatypes);\n  const availableAndEnabledMarkerTopics = uniq([\n    ...defaultAvailableMarkerTopics,\n    ...customMarkerTopicOptions,\n    ...enabledMarkerTopics,\n  ]).sort();\n  const onToggleMarkerName = useCallback(\n    (markerTopic: string) => {\n      saveConfig({ enabledMarkerTopics: toggle(enabledMarkerTopics, markerTopic) });\n    },\n    [saveConfig, enabledMarkerTopics]\n  );\n\n  const onChangeCameraTopic = useCallback(\n    (newCameraTopic: string) => {\n      const newAvailableMarkerTopics = getMarkerOptions(\n        newCameraTopic,\n        topics,\n        allCameraNamespaces,\n        imageMarkerDatatypes\n      );\n\n      const newEnabledMarkerTopics = getRelatedMarkerTopics(enabledMarkerTopics, newAvailableMarkerTopics);\n      saveConfig({\n        cameraTopic: newCameraTopic,\n        transformMarkers: getGlobalHooks()\n          .perPanelHooks()\n          .ImageView.canTransformMarkersByTopic(newCameraTopic),\n\n        enabledMarkerTopics: newEnabledMarkerTopics,\n      });\n    },\n    [topics, allCameraNamespaces, imageMarkerDatatypes, enabledMarkerTopics, saveConfig]\n  );\n\n  const onChangeScale = useCallback(\n    (newScale: number) => {\n      saveConfig({ scale: newScale });\n    },\n    [saveConfig]\n  );\n\n  const onToggleSynchronize = useCallback(\n    () => {\n      saveConfig({ synchronize: !config.synchronize });\n    },\n    [saveConfig, config.synchronize]\n  );\n\n  const renderImageTopicDropdown = () => {\n    const cameraNamespace = getCameraNamespace(cameraTopic);\n\n    if (!imageTopicsByNamespace || imageTopicsByNamespace.size === 0) {\n      return (\n        <Dropdown\n          toggleComponent={\n            <ToggleComponent dataTest={\"topics-dropdown\"} text={cameraTopic || \"no image topics yet\"} disabled />\n          }\n        />\n      );\n    }\n\n    const items = [...imageTopicsByNamespace.keys()].sort().map((group) => {\n      const imageTopics = imageTopicsByNamespace.get(group);\n      if (!imageTopics) {\n        return null;\n      } // satisfy flow\n      imageTopics.sort(naturalSort(\"name\"));\n\n      // place rectified topic above other imageTopics\n      return (\n        <SubMenu\n          direction=\"right\"\n          key={group}\n          text={group}\n          checked={group === cameraNamespace}\n          dataTest={group.substr(1)}>\n          {imageTopics.map((topic) => {\n            return (\n              <Item\n                key={topic.name}\n                value={topic.name}\n                checked={topic.name === cameraTopic}\n                onClick={() => onChangeCameraTopic(topic.name)}>\n                {topic.name}\n              </Item>\n            );\n          })}\n        </SubMenu>\n      );\n    });\n    return (\n      <Dropdown toggleComponent={<ToggleComponent dataTest={\"topics-dropdown\"} text={cameraTopic} />}>{items}</Dropdown>\n    );\n  };\n\n  const renderMarkerDropdown = (cameraInfo: ?CameraInfo, renderedMarkerTimestamps: { [topic: string]: string }) => {\n    const missingRequiredCameraInfo = scale !== 1 && !cameraInfo;\n\n    return (\n      <Dropdown\n        dataTest={\"markers-dropdown\"}\n        closeOnChange={false}\n        onChange={onToggleMarkerName}\n        value={enabledMarkerTopics}\n        text={availableAndEnabledMarkerTopics.length > 0 ? \"markers\" : \"no markers\"}\n        tooltip={\n          missingRequiredCameraInfo\n            ? \"camera_info is required when image resolution is set to less than 100%.\\nResolution can be changed in the panel settings.\"\n            : undefined\n        }\n        disabled={availableAndEnabledMarkerTopics.length === 0 || missingRequiredCameraInfo}>\n        {availableAndEnabledMarkerTopics.map((topic) => (\n          <Item\n            icon={enabledMarkerTopics.includes(topic) ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n            key={topic}\n            value={topic}\n            className={style.dropdownItem}>\n            <span style={{ display: \"inline-block\", marginRight: \"15px\" }}>{topic}</span>\n            <TopicTimestamp text={renderedMarkerTimestamps[topic] || \"\"} />\n            {customMarkerTopicOptions.includes(topic) && (\n              <Icon\n                style={{ position: \"absolute\", right: \"10px\" }}\n                onClick={() =>\n                  saveConfig({\n                    enabledMarkerTopics: enabledMarkerTopics.filter((topicOption) => topicOption !== topic),\n                    customMarkerTopicOptions: customMarkerTopicOptions.filter((topicOption) => topicOption !== topic),\n                  })\n                }>\n                <CloseIcon />\n              </Icon>\n            )}\n          </Item>\n        ))}\n        {\n          <AddTopic\n            topics={topics.map(({ name }) => name).filter((topic) => !availableAndEnabledMarkerTopics.includes(topic))}\n            onSelectTopic={(topic) =>\n              saveConfig({\n                enabledMarkerTopics: [...enabledMarkerTopics, topic],\n                customMarkerTopicOptions: [...customMarkerTopicOptions, topic],\n              })\n            }\n          />\n        }\n      </Dropdown>\n    );\n  };\n\n  const menuContent = useMemo(\n    () => (\n      <>\n        <Item icon={synchronize ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />} onClick={onToggleSynchronize}>\n          <span>Synchronize images and markers</span>\n        </Item>\n        <hr />\n        <SubMenu direction=\"right\" text={`Image resolution: ${(scale * 100).toFixed()}%`}>\n          {[0.2, 0.5, 1].map((value) => {\n            return (\n              <Item key={value} value={value} checked={scale === value} onClick={() => onChangeScale(value)}>\n                {(value * 100).toFixed()}%\n              </Item>\n            );\n          })}\n        </SubMenu>\n      </>\n    ),\n    [scale, onChangeScale, synchronize, onToggleSynchronize]\n  );\n\n  const cameraInfoTopic = getCameraInfoTopic(cameraTopic);\n  const cameraInfo: ?CameraInfo = PanelAPI.useMessageReducer({\n    topics: cameraInfoTopic ? [cameraInfoTopic] : [],\n    restore: useCallback((value) => value, []),\n    addMessage: useCallback((value, { message }: TypedMessage<CameraInfo>) => message, []),\n  });\n\n  const shouldSynchronize = config.synchronize && enabledMarkerTopics.length > 0;\n  const imageAndMarkerTopics = useShallowMemo([{ topic: cameraTopic, imageScale: scale }, ...enabledMarkerTopics]);\n  const { messagesByTopic, synchronizedMessages } = useOptionallySynchronizedMessages(\n    shouldSynchronize,\n    imageAndMarkerTopics\n  );\n  const imageMessage = get(messagesByTopic, [cameraTopic, 0]);\n\n  const markersToRender: Message[] = useMemo(\n    () =>\n      shouldSynchronize\n        ? synchronizedMessages\n          ? enabledMarkerTopics.map((topic) => synchronizedMessages[topic])\n          : []\n        : filterMap(enabledMarkerTopics, (topic) => last(messagesByTopic[topic])),\n    [enabledMarkerTopics, messagesByTopic, shouldSynchronize, synchronizedMessages]\n  );\n  // Timestamps are displayed for informational purposes in the markers menu\n  const renderedMarkerTimestamps = useMemo(\n    () => {\n      const stamps = {};\n      for (const { topic, message } of markersToRender) {\n        // In some cases, a user may have subscribed to a topic that does not include a header stamp.\n        stamps[topic] = message?.header?.stamp ? formatTimeRaw(message.header.stamp) : \"[ not available ]\";\n      }\n      return stamps;\n    },\n    [markersToRender]\n  );\n\n  const pauseFrame = useMessagePipeline(useCallback((messagePipeline) => messagePipeline.pauseFrame, []));\n  const onStartRenderImage = useCallback(\n    () => {\n      const resumeFrame = pauseFrame(\"ImageView\");\n      const onFinishRenderImage = () => {\n        resumeFrame();\n      };\n      return onFinishRenderImage;\n    },\n    [pauseFrame]\n  );\n\n  const rawMarkerData = {\n    markers: markersToRender,\n    scale,\n    transformMarkers,\n    cameraInfo: markersToRender.length > 0 ? cameraInfo : null,\n  };\n\n  const renderToolbar = () => {\n    return (\n      <PanelToolbar floating helpContent={helpContent} menuContent={menuContent}>\n        <div className={style.controls}>\n          {renderImageTopicDropdown()}\n          {renderMarkerDropdown(cameraInfo, renderedMarkerTimestamps)}\n        </div>\n      </PanelToolbar>\n    );\n  };\n\n  if (!imageMessage || (shouldSynchronize && !synchronizedMessages)) {\n    return (\n      <Flex col clip>\n        {renderToolbar()}\n        {renderEmptyState(cameraTopic, enabledMarkerTopics, shouldSynchronize, messagesByTopic)}\n      </Flex>\n    );\n  }\n\n  return (\n    <Flex col clip>\n      {renderToolbar()}\n      <ImageCanvas\n        panelHooks={panelHooks}\n        topic={cameraTopic}\n        image={imageMessage}\n        rawMarkerData={rawMarkerData}\n        config={config}\n        saveConfig={saveConfig}\n        onStartRenderImage={onStartRenderImage}\n      />\n      <ChildToggle.ContainsOpen>\n        {(containsOpen) => {\n          const canTransformMarkers = getGlobalHooks()\n            .perPanelHooks()\n            .ImageView.canTransformMarkersByTopic(cameraTopic);\n\n          const topicTimestamp = (\n            <TopicTimestamp\n              style={{ padding: \"8px 8px 0px 0px\" }}\n              text={imageMessage ? formatTimeRaw(imageMessage.message.header.stamp) : \"\"}\n            />\n          );\n\n          if (!canTransformMarkers) {\n            return <BottomBar containsOpen={containsOpen}>{topicTimestamp}</BottomBar>;\n          }\n\n          return (\n            <BottomBar containsOpen={containsOpen}>\n              {topicTimestamp}\n              <Icon\n                onClick={() => saveConfig({ transformMarkers: !transformMarkers })}\n                tooltip={\n                  transformMarkers\n                    ? \"Markers are being transformed by webviz based on the camera model. Click to turn it off.\"\n                    : `Markers can be transformed by webviz based on the camera model. Click to turn it on.`\n                }\n                fade\n                medium>\n                <WavesIcon style={{ color: transformMarkers ? colors.orange : colors.textBright }} />\n              </Icon>\n            </BottomBar>\n          );\n        }}\n      </ChildToggle.ContainsOpen>\n    </Flex>\n  );\n}\n\nImageView.panelType = \"ImageViewPanel\";\nImageView.defaultConfig = getGlobalHooks().perPanelHooks().ImageView.defaultConfig;\n\nexport default hot(Panel<Config>(ImageView));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport MagnifyIcon from \"@mdi/svg/svg/magnify.svg\";\nimport cx from \"classnames\";\nimport isEqual from \"lodash/isEqual\";\nimport omit from \"lodash/omit\";\nimport panzoom from \"panzoom\";\nimport React from \"react\";\nimport OutsideClickHandler from \"react-outside-click-handler\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport shallowequal from \"shallowequal\";\nimport styled from \"styled-components\";\nimport uuid from \"uuid\";\n\nimport styles from \"./ImageCanvas.module.scss\";\nimport ImageCanvasWorker from \"./ImageCanvas.worker\";\nimport type { ImageViewPanelHooks, Config, SaveImagePanelConfig } from \"./index\";\nimport { renderImage } from \"./renderImage\";\nimport { checkOutOfBounds, type Dimensions } from \"./util\";\nimport ContextMenu from \"webviz-core/src/components/ContextMenu\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport Menu, { Item } from \"webviz-core/src/components/Menu\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport type { Message } from \"webviz-core/src/players/types\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { CameraInfo } from \"webviz-core/src/types/Messages\";\nimport { downloadFiles } from \"webviz-core/src/util\";\nimport debouncePromise from \"webviz-core/src/util/debouncePromise\";\nimport type Rpc from \"webviz-core/src/util/Rpc\";\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\nimport supportsOffscreenCanvas from \"webviz-core/src/util/supportsOffscreenCanvas\";\nimport WebWorkerManager from \"webviz-core/src/util/WebWorkerManager\";\n\ntype OnFinishRenderImage = () => void;\ntype Props = {|\n  topic: string,\n  image: ?Message,\n  rawMarkerData: {|\n    markers: Message[],\n    scale: number,\n    transformMarkers: boolean,\n    cameraInfo: ?CameraInfo,\n  |},\n  panelHooks?: ImageViewPanelHooks,\n  config: Config,\n  saveConfig: SaveImagePanelConfig,\n  onStartRenderImage: () => OnFinishRenderImage,\n  useMainThreadRenderingForTesting?: boolean,\n|};\n\ntype State = {|\n  error: ?Error,\n  openZoomChart: boolean,\n|};\n\nconst SErrorMessage = styled.div`\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  position: absolute;\n  align-items: center;\n  justify-content: center;\n  color: ${colors.red};\n`;\n\nconst MAX_ZOOM_PERCENTAGE = 150;\nconst ZOOM_STEP = 5;\n\nconst webWorkerManager = new WebWorkerManager(ImageCanvasWorker, 1);\n\ntype CanvasRenderer =\n  | {|\n      type: \"rpc\",\n      // This is nullable because we destroy the worker whenever we unmount and recreate it if we remount.\n      worker: ?Rpc,\n    |}\n  | {|\n      type: \"mainThread\",\n    |};\n\nexport default class ImageCanvas extends React.Component<Props, State> {\n  _canvasRef = React.createRef<HTMLCanvasElement>();\n  _divRef = React.createRef<HTMLElement>();\n  _id: string;\n  _canvasRenderer: CanvasRenderer;\n  state = {\n    error: undefined,\n    openZoomChart: false,\n  };\n\n  constructor(props: Props) {\n    super(props);\n    this._id = uuid.v4();\n    // If we support offscreen canvas, use the ImageCanvasWorker because it improves performance by moving canvas\n    // operations off of the main thread. Allow an override for testing / stories.\n    this._canvasRenderer =\n      !supportsOffscreenCanvas() || props.useMainThreadRenderingForTesting\n        ? { type: \"mainThread\" }\n        : { type: \"rpc\", worker: webWorkerManager.registerWorkerListener(this._id) };\n  }\n\n  // Returns the existing RPC worker, or initializes one if it doesn't exist yet.\n  _getRpcWorker = (): Rpc => {\n    const canvasRenderer = this._canvasRenderer;\n    if (canvasRenderer.type === \"rpc\") {\n      // Create the worker if it hasn't been initialized yet.\n      const worker = canvasRenderer.worker || webWorkerManager.registerWorkerListener(this._id);\n      if (!canvasRenderer.worker) {\n        canvasRenderer.worker = worker;\n      }\n      return worker;\n    }\n    throw new Error(\"_getRpcWorker can only be called with canvasRenderer type rpc\");\n  };\n\n  _setCanvasRef = (canvas: ?HTMLCanvasElement) => {\n    if (canvas) {\n      this.loadZoomFromConfig();\n      if (this._canvasRenderer.type === \"rpc\") {\n        const worker = this._getRpcWorker();\n        // $FlowFixMe This is a function that is not yet in Flow.\n        const transferableCanvas = canvas.transferControlToOffscreen();\n        worker.send<void>(\"initialize\", { id: this._id, canvas: transferableCanvas }, [transferableCanvas]);\n      }\n      this._canvasRef.current = canvas;\n    }\n  };\n\n  panZoomCanvas: any = null;\n  bitmapDimensions: Dimensions = { width: 0, height: 0 };\n\n  keepInBounds = (div: HTMLElement) => {\n    const { x, y, scale } = this.panZoomCanvas.getTransform();\n    if (isNaN(x) || isNaN(y)) {\n      sendNotification(\"Tried to keep canvas in bounds but encountered invalid transform values\", \"\", \"app\", \"warn\");\n      return;\n    }\n    // When zoom is 1, the percentage is fitPercentage\n    // (fitPercent * scale) / 100) is the zoomScale for now\n    const updatedPercentage = scale * 100;\n    const rect = div.getBoundingClientRect();\n    const { width, height } = rect;\n    const offset = checkOutOfBounds(\n      x,\n      y,\n      width,\n      height,\n      // calculate the true width and height of image right now\n      (this.bitmapDimensions.width * updatedPercentage) / 100,\n      (this.bitmapDimensions.height * updatedPercentage) / 100\n    );\n    this.props.saveConfig({ mode: \"other\", offset, zoomPercentage: updatedPercentage }, { keepLayoutInUrl: true });\n    if (offset[0] !== x || offset[1] !== y) {\n      this.panZoomCanvas.moveTo(offset[0], offset[1]);\n    }\n  };\n\n  createPanZoom = () => {\n    const canvas = this._canvasRef.current;\n    const div = this._divRef.current;\n    if (canvas && div) {\n      this.panZoomCanvas = panzoom(canvas, {\n        maxZoom: 1.5,\n        minZoom: 0,\n        zoomSpeed: 0.05,\n        smoothScroll: false,\n        filterKey(e, dx, dy, dz) {\n          // don't let panzoom handle keyboard event\n          // because zoom in and out has the wrong offset change\n          // left right up and down is different what we use in our daily life\n          return true;\n        },\n      });\n      this.panZoomCanvas.on(\"zoom\", (e) => {\n        const { scale } = this.panZoomCanvas.getTransform();\n        const minPercent = this.fitPercent() * 0.8;\n        if (scale < minPercent / 100) {\n          this.goToTargetPercentage(minPercent);\n        }\n        this.keepInBounds(div);\n      });\n      this.panZoomCanvas.on(\"pan\", (e) => this.keepInBounds(div));\n    }\n  };\n\n  getImageViewport = () => {\n    const div = this._divRef.current;\n\n    if (!div) {\n      throw new Error(\"Don't have div to get width and height\");\n    }\n    return { imageViewportWidth: div.offsetWidth, imageViewportHeight: div.offsetHeight };\n  };\n\n  moveToCenter = () => {\n    if (!this.panZoomCanvas) {\n      sendNotification(\"Tried to center when there is no panZoomCanvas\", \"\", \"app\", \"error\");\n      return;\n    }\n    const { width, height } = this.bitmapDimensions;\n    const { imageViewportWidth, imageViewportHeight } = this.getImageViewport();\n    this.panZoomCanvas.moveTo(\n      (imageViewportWidth - (width * imageViewportHeight) / height) / 2,\n      (imageViewportHeight - (height * imageViewportWidth) / width) / 2\n    );\n  };\n\n  fitPercent = () => {\n    const { width, height } = this.bitmapDimensions;\n    const { imageViewportWidth, imageViewportHeight } = this.getImageViewport();\n    return Math.min(imageViewportWidth / width, imageViewportHeight / height) * 100;\n  };\n\n  fillPercent = () => {\n    const { width, height } = this.bitmapDimensions;\n    const { imageViewportWidth, imageViewportHeight } = this.getImageViewport();\n    return Math.max(imageViewportWidth / width, imageViewportHeight / height) * 100;\n  };\n\n  loadZoomFromConfig = () => {\n    if (this.panZoomCanvas) {\n      return;\n    }\n    this.createPanZoom();\n    this.applyPanZoom();\n  };\n\n  componentDidMount() {\n    this.renderCurrentImage();\n    document.addEventListener(\"visibilitychange\", this._onVisibilityChange);\n  }\n\n  _onVisibilityChange = () => {\n    // HACK: There is a Chrome bug that causes 2d canvas elements to get cleared when the page\n    // becomes hidden on certain hardware:\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=588434\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=591374\n    // We can hack around this by forcing a re-render when the page becomes visible again.\n    // Ideally we can find a global workaround but we're not sure there is one — can't just\n    // twiddle the width/height attribute of the canvas as suggested in one of the comments on\n    // a chrome bug; it seems like you really have to redraw the frame from scratch.\n    if (document.visibilityState === \"visible\") {\n      this.renderCurrentImage();\n    }\n  };\n\n  componentWillUnmount() {\n    const canvasRenderer = this._canvasRenderer;\n    if (canvasRenderer.type === \"rpc\") {\n      // Unset the PRC worker so that we can destroy the worker if it's no longer necessary.\n      webWorkerManager.unregisterWorkerListener(this._id);\n      canvasRenderer.worker = null;\n    }\n    document.removeEventListener(\"visibilitychange\", this._onVisibilityChange);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const imageChanged = !shallowequal(prevProps, this.props, (a, b, key) => {\n      if (key === \"rawMarkerData\") {\n        return shallowequal(a, b, (innerA, innerB, innerKey) => {\n          if (innerKey === \"markers\") {\n            return shallowequal(innerA, innerB);\n          } else if (innerKey === \"cameraInfo\") {\n            return isEqual(omit(innerA, \"header\"), omit(innerB, \"header\"));\n          }\n        });\n      }\n    });\n    if (imageChanged) {\n      this.renderCurrentImage();\n    }\n  }\n\n  downloadImage = () => {\n    const { topic, image } = this.props;\n    const canvas = this._canvasRef.current;\n\n    // satisfy flow\n    if (!canvas || !image) {\n      return;\n    }\n\n    // context: https://stackoverflow.com/questions/37135417/download-canvas-as-png-in-fabric-js-giving-network-error\n    // read the canvas data as an image (png)\n    canvas.toBlob((blob) => {\n      // name the image the same name as the topic\n      // note: the / characters in the file name will be replaced with _\n      // by the browser\n      // remove the leading / so the image name doesn't start with _\n      const topicName = topic.slice(1);\n      const stamp = image.message.header ? image.message.header.stamp : { sec: 0, nsec: 0 };\n      const fileName = `${topicName}-${stamp.sec}-${stamp.nsec}`;\n      downloadFiles([{ blob, fileName }]);\n    });\n  };\n\n  onCanvasRightClick = (e: SyntheticMouseEvent<HTMLCanvasElement>) => {\n    e.stopPropagation();\n    e.preventDefault();\n    return ContextMenu.show(\n      e.clientX,\n      e.clientY,\n      <Menu>\n        <Item onClick={this.downloadImage}>Download Image</Item>\n      </Menu>\n    );\n  };\n\n  clickMagnify = () => {\n    this.setState((state) => ({ openZoomChart: !state.openZoomChart }));\n  };\n  onZoomFit = (keepLayoutInUrl?: boolean) => {\n    const fitPercent = this.fitPercent();\n    this.panZoomCanvas.zoomAbs(0, 0, fitPercent / 100);\n    this.moveToCenter();\n    this.props.saveConfig({ mode: \"fit\", zoomPercentage: fitPercent }, { keepLayoutInUrl });\n  };\n\n  onZoomFill = (keepLayoutInUrl?: boolean) => {\n    const fillPercent = this.fillPercent();\n    this.panZoomCanvas.zoomAbs(0, 0, fillPercent / 100);\n    this.moveToCenter();\n    this.props.saveConfig({ mode: \"fill\", zoomPercentage: fillPercent }, { keepLayoutInUrl });\n  };\n\n  goToTargetPercentage = (targetPercentage: number) => {\n    const { imageViewportWidth, imageViewportHeight } = this.getImageViewport();\n    this.panZoomCanvas.zoomAbs(imageViewportWidth / 2, imageViewportHeight / 2, targetPercentage / 100);\n  };\n\n  onZoomMinus = () => {\n    const { zoomPercentage } = this.props.config;\n    const targetPercentage = Math.max((zoomPercentage || 100) - ZOOM_STEP, this.fitPercent() * 0.8);\n    this.goToTargetPercentage(targetPercentage);\n  };\n\n  onZoomPlus = () => {\n    const { zoomPercentage } = this.props.config;\n    const targetPercentage = Math.min((zoomPercentage || 100) + ZOOM_STEP, MAX_ZOOM_PERCENTAGE);\n    this.goToTargetPercentage(targetPercentage);\n  };\n\n  renderCurrentImage = debouncePromise(async () => {\n    const { image, rawMarkerData, onStartRenderImage } = this.props;\n    const onFinishImageRender = onStartRenderImage();\n    try {\n      const { imageMarkerDatatypes } = getGlobalHooks().perPanelHooks().ImageView;\n      let dimensions;\n      const canvasRenderer = this._canvasRenderer;\n      if (canvasRenderer.type === \"rpc\") {\n        const worker = this._getRpcWorker();\n        dimensions = await worker.send<?Dimensions>(\"renderImage\", {\n          id: this._id,\n          imageMessage: image,\n          rawMarkerData,\n          imageMarkerDatatypes,\n        });\n      } else {\n        dimensions = await renderImage({\n          canvas: this._canvasRef.current,\n          imageMessage: image,\n          rawMarkerData,\n          imageMarkerDatatypes,\n        });\n      }\n\n      if (dimensions) {\n        this.bitmapDimensions = dimensions;\n        this.loadZoomFromConfig();\n      }\n      if (this.state.error) {\n        this.setState({ error: undefined });\n      }\n    } catch (error) {\n      const topic = image ? image.topic : \"\";\n      sendNotification(`failed to decode image on ${topic}:`, \"\", \"user\", \"error\");\n      this.setState({ error });\n    } finally {\n      onFinishImageRender();\n    }\n  });\n\n  renderZoomChart = () => {\n    return this.state.openZoomChart ? (\n      <div className={styles.zoomChart} data-zoom-menu>\n        <div className={cx(styles.menuItem, styles.notInteractive)}>Use mousewheel or buttons to zoom</div>\n        <div className={cx(styles.menuItem, styles.borderBottom)}>\n          <button className={styles.round} onClick={this.onZoomMinus} data-panel-minus-zoom>\n            -\n          </button>\n          <span>{`${(this.props.config.zoomPercentage || 100).toFixed(1)}%`}</span>\n          <button className={styles.round} onClick={this.onZoomPlus} data-panel-add-zoom>\n            +\n          </button>\n        </div>\n        <Item className={styles.borderBottom} onClick={() => this.goToTargetPercentage(100)} dataTest={\"hundred-zoom\"}>\n          Zoom to 100%\n        </Item>\n        <Item className={styles.borderBottom} onClick={this.onZoomFit} dataTest={\"fit-zoom\"}>\n          Zoom to fit\n        </Item>\n        <Item onClick={this.onZoomFill} dataTest={\"fill-zoom\"}>\n          Zoom to fill\n        </Item>\n      </div>\n    ) : null;\n  };\n\n  applyPanZoom = () => {\n    if (!this.panZoomCanvas) {\n      return;\n    }\n\n    const { imageViewportHeight, imageViewportWidth } = this.getImageViewport();\n    if (!imageViewportHeight || !imageViewportWidth) {\n      // While dragging, the viewport may have zero height or width, which throws off the panZoomCanvas\n      return;\n    }\n\n    const { mode, zoomPercentage, offset } = this.props.config;\n    if (!mode || mode === \"fit\") {\n      this.onZoomFit(true);\n    } else if (mode === \"fill\") {\n      this.onZoomFill(true);\n    } else if (mode === \"other\") {\n      // Go to prevPercentage\n      this.goToTargetPercentage(zoomPercentage || 100);\n      this.panZoomCanvas.moveTo(offset ? offset[0] : 0, offset ? offset[1] : 0);\n    }\n  };\n\n  keyDownHandlers = {\n    \"=\": () => {\n      this.onZoomPlus();\n    },\n    \"-\": () => {\n      this.onZoomMinus();\n    },\n    \"1\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(10);\n      }\n    },\n    \"2\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(20);\n      }\n    },\n    \"3\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(30);\n      }\n    },\n    \"4\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(40);\n      }\n    },\n    \"5\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(50);\n      }\n    },\n    \"6\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(60);\n      }\n    },\n    \"7\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(70);\n      }\n    },\n    \"8\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(80);\n      }\n    },\n    \"9\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(90);\n      }\n    },\n    \"0\": (e: KeyboardEvent) => {\n      if (e.metaKey) {\n        this.goToTargetPercentage(100);\n      }\n    },\n  };\n\n  render() {\n    const { mode, zoomPercentage, offset } = this.props.config;\n    if (zoomPercentage && (zoomPercentage > 150 || zoomPercentage < 0)) {\n      sendNotification(\n        `zoomPercentage for the image panel was ${zoomPercentage}, but must be between 0 and 150. It has been reset to 100.`,\n        \"\",\n        \"user\",\n        \"warn\"\n      );\n      this.props.saveConfig({ zoomPercentage: 100 });\n    }\n    if (offset && offset.length !== 2) {\n      sendNotification(\n        `offset for the image panel was ${JSON.stringify(\n          offset\n        )}, but should be an array of length 2. It has been reset to [0, 0].`,\n        \"\",\n        \"user\",\n        \"warn\"\n      );\n      this.props.saveConfig({ offset: [0, 0] });\n    }\n    return (\n      <ReactResizeDetector handleWidth handleHeight onResize={this.applyPanZoom}>\n        <div className={styles.root} ref={this._divRef}>\n          <KeyListener keyDownHandlers={this.keyDownHandlers} />\n          <div>\n            {this.state.error && <SErrorMessage>Error: {this.state.error.message}</SErrorMessage>}\n            <canvas onContextMenu={this.onCanvasRightClick} ref={this._setCanvasRef} className={styles.canvas} />\n          </div>\n          <OutsideClickHandler\n            onOutsideClick={() => {\n              this.setState({ openZoomChart: false });\n            }}>\n            {this.renderZoomChart()}\n            <button className={styles.magnify} onClick={this.clickMagnify} data-magnify-icon>\n              <MagnifyIcon />{\" \"}\n              {mode === \"other\" ? <span>{zoomPercentage ? `${zoomPercentage.toFixed(1)}%` : \"null\"}</span> : null}\n            </button>\n          </OutsideClickHandler>\n        </div>\n      </ReactResizeDetector>\n    );\n  }\n}\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-ImageView-ImageCanvas-module-de9b6--root {\\n  height: 100%;\\n  position: relative; }\\n\\n.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3wsxs--canvas {\\n  min-width: 0;\\n  min-height: 0;\\n  -o-object-position: top left;\\n     object-position: top left; }\\n\\n.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3kw87--bottom-bar {\\n  -webkit-transition: opacity 0.1s ease-in-out;\\n  -o-transition: opacity 0.1s ease-in-out;\\n  transition: opacity 0.1s ease-in-out;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex: 0 0 auto;\\n      flex: 0 0 auto;\\n  -ms-flex-direction: row;\\n      flex-direction: row;\\n  background-color: transparent;\\n  text-align: right;\\n  position: absolute;\\n  right: 4px;\\n  padding-right: 5px;\\n  bottom: 8px;\\n  z-index: 5000;\\n  background-color: transparent;\\n  opacity: 0; }\\n  .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3kw87--bottom-bar.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-a4s8k--containsOpen {\\n    opacity: 1; }\\n  .mosaic-window:hover .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3kw87--bottom-bar {\\n    opacity: 1; }\\n\\n.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify {\\n  position: absolute;\\n  bottom: 5px;\\n  left: 0;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: #2d2c33;\\n  display: none; }\\n  .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-de9b6--root:hover .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify {\\n    display: block; }\\n  .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify.hoverScreenshot {\\n    display: block; }\\n  .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify svg {\\n    width: 16px;\\n    height: 16px;\\n    fill: white;\\n    float: left; }\\n  .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify span {\\n    color: orange;\\n    float: right;\\n    padding-left: 3px; }\\n\\n.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-4awwh--zoomChart {\\n  position: absolute;\\n  bottom: 45px;\\n  left: 0;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: #2d2c33;\\n  width: 145px;\\n  border-radius: 4%;\\n  display: none; }\\n  .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-de9b6--root:hover .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-4awwh--zoomChart {\\n    display: block; }\\n  .packages-webviz-core-src-panels-ImageView-ImageCanvas-module-4awwh--zoomChart.hoverScreenshot {\\n    display: block; }\\n\\n.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-kres5--round {\\n  margin: 0;\\n  padding: 1px 5px 1px 5px;\\n  border-radius: 100%; }\\n\\n.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-23f2k--borderBottom {\\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1); }\\n\\n.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-45bfu--menuItem {\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-align: center;\\n      align-items: center;\\n  -ms-flex-pack: justify;\\n      justify-content: space-between;\\n  padding: 8px 12px 8px 12px; }\\n\\n.packages-webviz-core-src-panels-ImageView-ImageCanvas-module-pmyrv--notInteractive {\\n  opacity: 0.5; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/ImageView/ImageCanvas.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAOA;EACE,aAAY;EACZ,mBAAkB,EACnB;;AAED;EACE,aAAY;EACZ,cAAa;EACb,6BAAyB;KAAzB,0BAAyB,EAC1B;;AAED;EACE,6CAAoC;EAApC,wCAAoC;EAApC,qCAAoC;EACpC,qBAAa;EAAb,cAAa;EACb,mBAAc;MAAd,eAAc;EACd,wBAAmB;MAAnB,oBAAmB;EACnB,8BAA6B;EAC7B,kBAAiB;EAEjB,mBAAkB;EAClB,WAAU;EACV,mBAAkB;EAClB,YAAW;EACX,cAAa;EACb,8BAA6B;EAC7B,WAAU,EASX;EAvBD;IAiBI,WAAU,EACX;EAED;IACE,WAAU,EACX;;AAGH;EACE,mBAAkB;EAClB,YAAW;EACX,QAAO;EACP,aAAY;EACZ,WAAU;EACV,0BCZe;EDaf,cAAa,EAkBd;EAjBC;IACE,eAAc,EACf;EAVH;IAYI,eAAc,EACf;EAbH;IAeI,YAAW;IACX,aAAY;IACZ,YAAW;IACX,YAAW,EACZ;EAnBH;IAqBI,cAAa;IACb,aAAY;IACZ,kBAAiB,EAClB;;AAGH;EACE,mBAAkB;EAClB,aAAY;EACZ,QAAO;EACP,aAAY;EACZ,WAAU;EACV,0BCvCe;EDwCf,aAAY;EACZ,kBAAiB;EACjB,cAAa,EAOd;EANC;IACE,eAAc,EACf;EAZH;IAcI,eAAc,EACf;;AAGH;EACE,UAAS;EACT,yBAAwB;EACxB,oBAAmB,EACpB;;AAED;EACE,kDAAiD,EAClD;;AAED;EACE,qBAAa;EAAb,cAAa;EACb,uBAAmB;MAAnB,oBAAmB;EACnB,uBAA8B;MAA9B,+BAA8B;EAC9B,2BAA0B,EAC3B;;AAED;EACE,aAAY,EACb\",\"file\":\"ImageCanvas.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.root {\\n  height: 100%;\\n  position: relative;\\n}\\n\\n.canvas {\\n  min-width: 0;\\n  min-height: 0;\\n  object-position: top left;\\n}\\n\\n.bottom-bar {\\n  transition: opacity 0.1s ease-in-out;\\n  display: flex;\\n  flex: 0 0 auto;\\n  flex-direction: row;\\n  background-color: transparent;\\n  text-align: right;\\n\\n  position: absolute;\\n  right: 4px;\\n  padding-right: 5px;\\n  bottom: 8px;\\n  z-index: 5000;\\n  background-color: transparent;\\n  opacity: 0;\\n\\n  &.containsOpen {\\n    opacity: 1;\\n  }\\n\\n  :global(.mosaic-window):hover & {\\n    opacity: 1;\\n  }\\n}\\n\\n.magnify {\\n  position: absolute;\\n  bottom: 5px;\\n  left: 0;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: $toolbar;\\n  display: none;\\n  .root:hover & {\\n    display: block;\\n  }\\n  &:global(.hoverScreenshot) {\\n    display: block;\\n  }\\n  svg {\\n    width: 16px;\\n    height: 16px;\\n    fill: white;\\n    float: left;\\n  }\\n  span {\\n    color: orange;\\n    float: right;\\n    padding-left: 3px;\\n  }\\n}\\n\\n.zoomChart {\\n  position: absolute;\\n  bottom: 45px;\\n  left: 0;\\n  z-index: 102;\\n  opacity: 1;\\n  background-color: $toolbar;\\n  width: 145px;\\n  border-radius: 4%;\\n  display: none;\\n  .root:hover & {\\n    display: block;\\n  }\\n  &:global(.hoverScreenshot) {\\n    display: block;\\n  }\\n}\\n\\n.round {\\n  margin: 0;\\n  padding: 1px 5px 1px 5px;\\n  border-radius: 100%;\\n}\\n\\n.borderBottom {\\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\\n}\\n\\n.menuItem {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 8px 12px 8px 12px;\\n}\\n\\n.notInteractive {\\n  opacity: 0.5;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"root\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-de9b6--root\",\n\t\"canvas\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3wsxs--canvas\",\n\t\"bottom-bar\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-3kw87--bottom-bar\",\n\t\"containsOpen\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-a4s8k--containsOpen\",\n\t\"magnify\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-2fxj4--magnify\",\n\t\"zoomChart\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-4awwh--zoomChart\",\n\t\"round\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-kres5--round\",\n\t\"borderBottom\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-23f2k--borderBottom\",\n\t\"menuItem\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-45bfu--menuItem\",\n\t\"notInteractive\": \"packages-webviz-core-src-panels-ImageView-ImageCanvas-module-pmyrv--notInteractive\"\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"ImageCanvas.worker.js?f5f14559a73acd942875\");\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CameraModel from \"./CameraModel\";\nimport {\n  decodeYUV,\n  decodeRGB8,\n  decodeBGR8,\n  decodeFloat1c,\n  decodeBayerRGGB8,\n  decodeBayerBGGR8,\n  decodeBayerGBRG8,\n  decodeBayerGRBG8,\n  decodeMono8,\n  decodeMono16,\n} from \"./decodings\";\nimport { buildMarkerData, type Dimensions, type RawMarkerData, type MarkerData, type OffscreenCanvas } from \"./util\";\nimport type { Message } from \"webviz-core/src/players/types\";\nimport type { ImageMarker, Color, Point } from \"webviz-core/src/types/Messages\";\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\n\n// Just globally keep track of if we've shown an error in rendering, since typically when you get\n// one error, you'd then get a whole bunch more, which is spammy.\nlet hasLoggedCameraModelError: boolean = false;\n\n// Given a canvas, an image message, and marker info, render the image to the canvas.\n// Nothing in this module should have state.\nexport async function renderImage({\n  canvas,\n  imageMessage,\n  rawMarkerData,\n  imageMarkerDatatypes,\n}: {\n  canvas: ?(HTMLCanvasElement | OffscreenCanvas),\n  imageMessage: any,\n  rawMarkerData: RawMarkerData,\n  imageMarkerDatatypes: string[],\n}): Promise<?Dimensions> {\n  if (!canvas) {\n    return null;\n  }\n  if (!imageMessage) {\n    clearCanvas(canvas);\n    return null;\n  }\n  let markerData = null;\n  try {\n    markerData = buildMarkerData(rawMarkerData);\n  } catch (error) {\n    if (!hasLoggedCameraModelError) {\n      sendNotification(`Failed to initialize camera model from CameraInfo`, error, \"user\", \"warn\");\n      hasLoggedCameraModelError = true;\n    }\n  }\n\n  try {\n    const bitmap = await decodeMessageToBitmap(imageMessage);\n    const dimensions = paintBitmap(canvas, bitmap, markerData, imageMarkerDatatypes);\n    bitmap.close();\n    return dimensions;\n  } catch (error) {\n    // If there is an error, clear the image and re-throw it.\n    clearCanvas(canvas);\n    throw error;\n  }\n}\n\nfunction toRGBA(color: Color) {\n  const { r, g, b, a } = color;\n  return `rgba(${r}, ${g}, ${b}, ${a || 1})`;\n}\n\n// Note: Return type is inexact -- may contain z.\nfunction maybeUnrectifyPoint(cameraModel: ?CameraModel, point: Point): $ReadOnly<{ x: number, y: number }> {\n  if (cameraModel) {\n    return cameraModel.unrectifyPoint(point);\n  }\n  return point;\n}\n\nasync function decodeMessageToBitmap(msg: any): Promise<ImageBitmap> {\n  let image: ImageData | Image | Blob;\n  const { data: rawData, is_bigendian } = msg.message;\n  if (!(rawData instanceof Uint8Array)) {\n    throw new Error(\"Message must have data of type Uint8Array\");\n  }\n\n  // Binary message processing\n  if (msg.datatype === \"sensor_msgs/Image\") {\n    const { width, height, encoding } = msg.message;\n    image = new ImageData(width, height);\n    // prettier-ignore\n    switch (encoding) {\n      case \"yuv422\": decodeYUV(rawData, width, height, image.data); break;\n      case \"rgb8\": decodeRGB8(rawData, width, height, image.data); break;\n      case \"bgr8\": decodeBGR8(rawData, width, height, image.data); break;\n      case \"32FC1\": decodeFloat1c(rawData, width, height, is_bigendian, image.data); break;\n      case \"bayer_rggb8\": decodeBayerRGGB8(rawData, width, height, image.data); break;\n      case \"bayer_bggr8\": decodeBayerBGGR8(rawData, width, height, image.data); break;\n      case \"bayer_gbrg8\": decodeBayerGBRG8(rawData, width, height, image.data); break;\n      case \"bayer_grbg8\": decodeBayerGRBG8(rawData, width, height, image.data); break;\n      case \"mono8\":\n      case \"8UC1\":\n          decodeMono8(rawData, width, height, image.data); break;\n      case \"mono16\":\n      case \"16UC1\":\n          decodeMono16(rawData, width, height, is_bigendian, image.data); break;\n      default:\n        throw new Error(`Unsupported encoding ${encoding}`);\n    }\n  } else if (msg.datatype === \"sensor_msgs/CompressedImage\") {\n    image = new Blob([rawData], { type: `image/${msg.message.format}` });\n  } else {\n    throw new Error(`Message datatype ${msg.datatype} not usable for rendering images.`);\n  }\n\n  return self.createImageBitmap(image);\n}\n\nfunction clearCanvas(canvas: ?HTMLCanvasElement) {\n  if (canvas) {\n    canvas.getContext(\"2d\").clearRect(0, 0, canvas.width, canvas.height);\n  }\n}\n\nfunction paintBitmap(\n  canvas: HTMLCanvasElement,\n  bitmap: ImageBitmap,\n  markerData: MarkerData,\n  imageMarkerDatatypes: string[]\n): ?Dimensions {\n  let bitmapDimensions = { width: bitmap.width, height: bitmap.height };\n  const ctx = canvas.getContext(\"2d\");\n  if (!markerData) {\n    resizeCanvas(canvas, bitmap.width, bitmap.height);\n    ctx.transform(1, 0, 0, 1, 0, 0);\n    ctx.drawImage(bitmap, 0, 0);\n    return bitmapDimensions;\n  }\n\n  const { markers, cameraModel } = markerData;\n  let { originalWidth, originalHeight } = markerData;\n  if (originalWidth == null) {\n    originalWidth = bitmap.width;\n  }\n  if (originalHeight == null) {\n    originalHeight = bitmap.height;\n  }\n\n  bitmapDimensions = { width: originalWidth, height: originalHeight };\n  resizeCanvas(canvas, originalWidth, originalHeight);\n  ctx.save();\n  ctx.scale(originalWidth / bitmap.width, originalHeight / bitmap.height);\n  ctx.drawImage(bitmap, 0, 0);\n  ctx.restore();\n  ctx.save();\n  try {\n    paintMarkers(ctx, markers, cameraModel, imageMarkerDatatypes);\n  } catch (err) {\n    console.warn(\"error painting markers:\", err);\n  } finally {\n    ctx.restore();\n  }\n  return bitmapDimensions;\n}\n\nfunction paintMarkers(\n  ctx: CanvasRenderingContext2D,\n  messages: Message[],\n  cameraModel: ?CameraModel,\n  imageMarkerDatatypes: string[]\n) {\n  for (const { message } of messages) {\n    ctx.save();\n    try {\n      if (Array.isArray(message.markers)) {\n        for (const marker of message.markers) {\n          paintMarker(ctx, marker, cameraModel);\n        }\n      } else {\n        paintMarker(ctx, message, cameraModel);\n      }\n    } catch (e) {\n      console.error(\"Unable to paint marker to ImageView\", e, message);\n    }\n    ctx.restore();\n  }\n}\n\nfunction paintMarker(ctx: CanvasRenderingContext2D, marker: ImageMarker, cameraModel: ?CameraModel) {\n  switch (marker.type) {\n    case 0: {\n      // CIRCLE\n      ctx.beginPath();\n      const { x, y } = maybeUnrectifyPoint(cameraModel, marker.position);\n      ctx.arc(x, y, marker.scale, 0, 2 * Math.PI);\n      if (marker.thickness <= 0) {\n        ctx.fillStyle = toRGBA(marker.outline_color);\n        ctx.fill();\n      } else {\n        ctx.lineWidth = marker.thickness;\n        ctx.strokeStyle = toRGBA(marker.outline_color);\n        ctx.stroke();\n      }\n      break;\n    }\n\n    // LINE_LIST\n    case 2:\n      if (marker.points.length % 2 !== 0) {\n        break;\n      }\n      ctx.strokeStyle = toRGBA(marker.outline_color);\n      ctx.lineWidth = marker.thickness;\n      for (let i = 0; i < marker.points.length; i += 2) {\n        const { x: x1, y: y1 } = maybeUnrectifyPoint(cameraModel, marker.points[i]);\n        const { x: x2, y: y2 } = maybeUnrectifyPoint(cameraModel, marker.points[i + 1]);\n        ctx.beginPath();\n        ctx.moveTo(x1, y1);\n        ctx.lineTo(x2, y2);\n        ctx.stroke();\n      }\n      break;\n\n    // LINE_STRIP, POLYGON\n    case 1:\n    case 3: {\n      if (marker.points.length === 0) {\n        break;\n      }\n      ctx.beginPath();\n      const { x, y } = maybeUnrectifyPoint(cameraModel, marker.points[0]);\n      ctx.moveTo(x, y);\n      for (let i = 1; i < marker.points.length; i++) {\n        const maybeUnrectifiedPoint = maybeUnrectifyPoint(cameraModel, marker.points[i]);\n        ctx.lineTo(maybeUnrectifiedPoint.x, maybeUnrectifiedPoint.y);\n      }\n      if (marker.type === 3) {\n        ctx.closePath();\n      }\n      if (marker.thickness <= 0) {\n        ctx.fillStyle = toRGBA(marker.outline_color);\n        ctx.fill();\n      } else {\n        ctx.strokeStyle = toRGBA(marker.outline_color);\n        ctx.lineWidth = marker.thickness;\n        ctx.stroke();\n      }\n      break;\n    }\n\n    case 4: {\n      // POINTS\n      if (marker.points.length === 0) {\n        break;\n      }\n\n      const size = marker.scale || 4;\n      if (marker.outline_colors && marker.outline_colors.length === marker.points.length) {\n        for (let i = 0; i < marker.points.length; i++) {\n          const { x, y } = maybeUnrectifyPoint(cameraModel, marker.points[i]);\n          ctx.fillStyle = toRGBA(marker.outline_colors[i]);\n          ctx.beginPath();\n          ctx.arc(x, y, size, 0, 2 * Math.PI);\n          ctx.fill();\n        }\n      } else {\n        ctx.beginPath();\n        for (let i = 0; i < marker.points.length; i++) {\n          const { x, y } = maybeUnrectifyPoint(cameraModel, marker.points[i]);\n          ctx.arc(x, y, size, 0, 2 * Math.PI);\n          ctx.closePath();\n        }\n        ctx.fillStyle = toRGBA(marker.fill_color);\n        ctx.fill();\n      }\n      break;\n    }\n\n    case 5: {\n      // TEXT (our own extension on visualization_msgs/Marker)\n      const { x, y } = maybeUnrectifyPoint(cameraModel, marker.position);\n\n      const fontSize = marker.scale * 12;\n      const padding = 4 * marker.scale;\n      ctx.font = `${fontSize}px sans-serif`;\n      ctx.textBaseline = \"bottom\";\n      if (marker.filled) {\n        const metrics = ctx.measureText(marker.text.data);\n        const height = fontSize * 1.2; // Chrome doesn't yet support height in TextMetrics\n        ctx.fillStyle = toRGBA(marker.fill_color);\n        ctx.fillRect(x, y - height, Math.ceil(metrics.width + 2 * padding), Math.ceil(height));\n      }\n      ctx.fillStyle = toRGBA(marker.outline_color);\n      ctx.fillText(marker.text.data, x + padding, y);\n      break;\n    }\n\n    default:\n      console.warn(\"unrecognized image marker type\", marker);\n  }\n}\n\nfunction resizeCanvas(canvas: ?HTMLCanvasElement, width: number, height: number) {\n  if (canvas && (canvas.width !== width || canvas.height !== height)) {\n    canvas.width = width;\n    canvas.height = height;\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nexport function decodeYUV(yuv: Int8Array, width: number, height: number, output: Uint8ClampedArray) {\n  let c = 0;\n  let off = 0;\n\n  // populate 2 pixels at a time\n  const max = height * width;\n  for (let r = 0; r <= max; r += 2) {\n    const u = yuv[off] - 128;\n    const y1 = yuv[off + 1];\n    const v = yuv[off + 2] - 128;\n    const y2 = yuv[off + 3];\n\n    // rgba\n    output[c] = y1 + 1.402 * v;\n    output[c + 1] = y1 - 0.34414 * u - 0.71414 * v;\n    output[c + 2] = y1 + 1.772 * u;\n    output[c + 3] = 255;\n\n    // rgba\n    output[c + 4] = y2 + 1.402 * v;\n    output[c + 5] = y2 - 0.34414 * u - 0.71414 * v;\n    output[c + 6] = y2 + 1.772 * u;\n    output[c + 7] = 255;\n\n    c += 8;\n    off += 4;\n  }\n}\n\nexport function decodeRGB8(rgb: Uint8Array, width: number, height: number, output: Uint8ClampedArray) {\n  let inIdx = 0;\n  let outIdx = 0;\n\n  for (let i = 0; i < width * height; i++) {\n    const r = rgb[inIdx++];\n    const g = rgb[inIdx++];\n    const b = rgb[inIdx++];\n\n    output[outIdx++] = r;\n    output[outIdx++] = g;\n    output[outIdx++] = b;\n    output[outIdx++] = 255;\n  }\n}\n\nexport function decodeBGR8(bgr: Uint8Array, width: number, height: number, output: Uint8ClampedArray) {\n  let inIdx = 0;\n  let outIdx = 0;\n\n  for (let i = 0; i < width * height; i++) {\n    const b = bgr[inIdx++];\n    const g = bgr[inIdx++];\n    const r = bgr[inIdx++];\n\n    output[outIdx++] = r;\n    output[outIdx++] = g;\n    output[outIdx++] = b;\n    output[outIdx++] = 255;\n  }\n}\n\nexport function decodeFloat1c(\n  gray: Uint8Array,\n  width: number,\n  height: number,\n  is_bigendian: boolean,\n  output: Uint8ClampedArray\n) {\n  const view = new DataView(gray.buffer, gray.byteOffset);\n\n  let outIdx = 0;\n  for (let i = 0; i < width * height * 4; i += 4) {\n    const val = view.getFloat32(i, !is_bigendian) * 255;\n    output[outIdx++] = val;\n    output[outIdx++] = val;\n    output[outIdx++] = val;\n    output[outIdx++] = 255;\n  }\n}\n\nexport function decodeMono8(mono8: Uint8Array, width: number, height: number, output: Uint8ClampedArray) {\n  let inIdx = 0;\n  let outIdx = 0;\n\n  for (let i = 0; i < width * height; i++) {\n    const ch = mono8[inIdx++];\n    output[outIdx++] = ch;\n    output[outIdx++] = ch;\n    output[outIdx++] = ch;\n    output[outIdx++] = 255;\n  }\n}\n\nexport function decodeMono16(\n  mono16: Uint8Array,\n  width: number,\n  height: number,\n  is_bigendian: boolean,\n  output: Uint8ClampedArray\n) {\n  const view = new DataView(mono16.buffer, mono16.byteOffset);\n\n  let outIdx = 0;\n  for (let i = 0; i < width * height * 2; i += 2) {\n    let val = view.getUint16(i, !is_bigendian);\n\n    // For now, just assume values are in the range 0-10000, consistent with image_view's default.\n    // TODO: support dynamic range adjustment and/or user-selectable range\n    // References:\n    // https://github.com/ros-perception/image_pipeline/blob/42266892502427eb566a4dffa61b009346491ce7/image_view/src/nodes/image_view.cpp#L80-L88\n    // https://github.com/ros-visualization/rqt_image_view/blob/fe076acd265a05c11c04f9d04392fda951878f54/src/rqt_image_view/image_view.cpp#L582\n    // https://github.com/ros-visualization/rviz/blob/68b464fb6571b8760f91e8eca6fb933ba31190bf/src/rviz/image/ros_image_texture.cpp#L114\n    val = (val / 10000) * 255;\n\n    output[outIdx++] = val;\n    output[outIdx++] = val;\n    output[outIdx++] = val;\n    output[outIdx++] = 255;\n  }\n}\n\n// Specialize the Bayer decode function to a certain encoding. For performance reasons, we use\n// new Function() -- this is about 20% faster than a switch statement and .bind().\nfunction makeSpecializedDecodeBayer(\n  tl,\n  tr,\n  bl,\n  br\n): (data: Uint8Array, width: number, height: number, output: Uint8ClampedArray) => void {\n  // We probably can't afford real debayering/demosaicking, so do something simpler\n  // The input array look like a single-plane array of pixels.  However, each pixel represents a one particular color\n  // for a group of pixels in the 2x2 region.  For 'rggb', there color representatio for the 2x2 region looks like:\n  //\n  // R  | G0\n  // -------\n  // G1 | B\n  //\n  // In other words, a 2x2 region is represented by one R value, one B value, and two G values.  In sophisticated\n  // algorithms, each color will be weighted and interpolated to fill in the missing colors for the pixels.  These\n  // algorithms may reach beyond the local 2x2 region and use values from neighboring regions.\n  //\n  // We'll do something much simpler.  For each group of 2x2, we're replicate the R and B values for all pixels.\n  // For the two row, we'll replicate G0 for the green channels, and replicate G1 for the bottom row.\n  // eslint-disable-next-line no-new-func\n  return (new Function(\n    \"data\",\n    \"width\",\n    \"height\",\n    \"output\",\n    `\n  for (let i = 0; i < height / 2; i++) {\n    let inIdx = i * 2 * width;\n    let outTopIdx = i * 2 * width * 4; // Addresses top row\n    let outBottomIdx = (i * 2 + 1) * width * 4; // Addresses bottom row\n    for (let j = 0; j < width / 2; j++) {\n      const tl = data[inIdx++];\n      const tr = data[inIdx++];\n      const bl = data[inIdx + width - 2];\n      const br = data[inIdx + width - 1];\n\n      const ${tl} = tl;\n      const ${tr} = tr;\n      const ${bl} = bl;\n      const ${br} = br;\n\n      // Top row\n      output[outTopIdx++] = r;\n      output[outTopIdx++] = g0;\n      output[outTopIdx++] = b;\n      output[outTopIdx++] = 255;\n\n      output[outTopIdx++] = r;\n      output[outTopIdx++] = g0;\n      output[outTopIdx++] = b;\n      output[outTopIdx++] = 255;\n\n      // Bottom row\n      output[outBottomIdx++] = r;\n      output[outBottomIdx++] = g1;\n      output[outBottomIdx++] = b;\n      output[outBottomIdx++] = 255;\n\n      output[outBottomIdx++] = r;\n      output[outBottomIdx++] = g1;\n      output[outBottomIdx++] = b;\n      output[outBottomIdx++] = 255;\n    }\n  }`\n  ): any);\n}\n\nexport const decodeBayerRGGB8 = makeSpecializedDecodeBayer(\"r\", \"g0\", \"g1\", \"b\");\nexport const decodeBayerBGGR8 = makeSpecializedDecodeBayer(\"b\", \"g0\", \"g1\", \"r\");\nexport const decodeBayerGBRG8 = makeSpecializedDecodeBayer(\"g0\", \"b\", \"r\", \"g1\");\nexport const decodeBayerGRBG8 = makeSpecializedDecodeBayer(\"g0\", \"r\", \"b\", \"g1\");\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport Tooltip from \"@cruise-automation/tooltip\";\nimport * as React from \"react\";\n\nimport Menu from \"webviz-core/src/components/Menu\";\n\ntype Props = {\n  children: React.Node,\n};\n\n// a tiny wrapper around the tooltip component that automatically\n// hides on the next mouse click so you don't have to manage window listeners yourself\nexport default class ContextMenu extends React.Component<Props> {\n  static show(x: number, y: number, contents: React.Node) {\n    Tooltip.show(x, y, <ContextMenu>{contents}</ContextMenu>);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"click\", this.hide);\n  }\n\n  hide = () => {\n    window.removeEventListener(\"click\", this.hide);\n    Tooltip.hide();\n  };\n\n  render() {\n    return <Menu>{this.props.children}</Menu>;\n  }\n}\n","module.exports = \"# Image View\\n\\nThe Image View panel displays images from `sensor_msgs/Image` or `sensor_msgs/CompressedImage` topics.\\n\\n16-bit images (`16UC1`) are currently displayed assuming the values fall into the 0&ndash;10000 range, consistent with the defaults of the ROS `image_view` tool.\\n\\nThe **markers** dropdown can be used to toggle on and off topics with type `visualization_msgs/ImageMarker`, which will be overlayed on top of the selected image topic. Note that markers are only available if the `CameraInfo` for the selected camera is being published. If the image is unrectified, the markers will be transformed by webviz based on `CameraInfo`.\\n\\nThe **scale** dropdown allows you to adjust the scale of the image.  Since the images are fairly large, it is recommended to use the smallest scale you need to conserve bandwidth.  Currently using `scale 1.0` can negatively impact rendering speed, particularly if you have a limited bandwidth connection. (Note: only applies to streaming connections, which is not part of the open source version yet.)\\n\\nShortcuts:\\n\\n- =: Zoom in\\n- -: Zoom out\\n- Command + (1 2 3 ... 9 0): Go to percentage 10% - 100%. Note that 10% may be less than the minimum zoom size based on panel and image size.\\n\"","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-ImageView-index-module-6m7vg--controls {\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-wrap: wrap;\\n      flex-wrap: wrap;\\n  -ms-flex: 1 1 auto;\\n      flex: 1 1 auto;\\n  -ms-flex-align: center;\\n      align-items: center;\\n  overflow: hidden; }\\n  .packages-webviz-core-src-panels-ImageView-index-module-6m7vg--controls button {\\n    margin: 1px 4px 1px 0; }\\n\\n.packages-webviz-core-src-panels-ImageView-index-module-3hq5q--dropdownItem {\\n  position: relative; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/ImageView/index.module.scss\"],\"names\":[],\"mappings\":\"AAMA;EACE,qBAAa;EAAb,cAAa;EACb,oBAAe;MAAf,gBAAe;EACf,mBAAc;MAAd,eAAc;EACd,uBAAmB;MAAnB,oBAAmB;EACnB,iBAAgB,EAIjB;EATD;IAOI,sBAAqB,EACtB;;AAGH;EACE,mBAAkB,EACnB\",\"file\":\"index.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n.controls {\\n  display: flex;\\n  flex-wrap: wrap;\\n  flex: 1 1 auto;\\n  align-items: center;\\n  overflow: hidden;\\n  button {\\n    margin: 1px 4px 1px 0;\\n  }\\n}\\n\\n.dropdownItem {\\n  position: relative;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"controls\": \"packages-webviz-core-src-panels-ImageView-index-module-6m7vg--controls\",\n\t\"dropdownItem\": \"packages-webviz-core-src-panels-ImageView-index-module-3hq5q--dropdownItem\"\n};","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { get, mapValues } from \"lodash\";\nimport { TimeUtil, type Time } from \"rosbag\";\n\nimport type { MessageHistoryItemsByPath } from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport type { Message } from \"webviz-core/src/players/types\";\n\n// Get all timestamps of all messages, newest first\nfunction allItemStampsNewestFirst(\n  itemsByPath: MessageHistoryItemsByPath,\n  getHeaderStamp?: (itemMessage: Message) => ?Time\n): Time[] {\n  const stamps = [];\n  for (const path in itemsByPath) {\n    for (const item of itemsByPath[path]) {\n      const stamp = getHeaderStamp ? getHeaderStamp(item.message) : get(item.message, [\"message\", \"header\", \"stamp\"]);\n      if (!stamp) {\n        return [];\n      }\n      stamps.push(stamp);\n    }\n  }\n  return stamps.sort((a, b) => -TimeUtil.compare(a, b));\n}\nfunction allMessageStampsNewestFirst(messagesByTopic: { [topic: string]: Message[] }) {\n  const stamps = [];\n  for (const topic in messagesByTopic) {\n    for (const { message } of messagesByTopic[topic]) {\n      const stamp = get(message, [\"header\", \"stamp\"]);\n      if (stamp) {\n        stamps.push(stamp);\n      }\n    }\n  }\n  return stamps.sort((a, b) => -TimeUtil.compare(a, b));\n}\n\n// Get a subset of items matching a particular timestamp\nfunction itemsMatchingStamp(\n  stamp: Time,\n  itemsByPath: MessageHistoryItemsByPath,\n  getHeaderStamp?: (itemMessage: Message) => ?Time\n): ?MessageHistoryItemsByPath {\n  const synchronizedItemsByPath = {};\n  for (const path in itemsByPath) {\n    let found = false;\n    for (const item of itemsByPath[path]) {\n      const thisStamp = getHeaderStamp\n        ? getHeaderStamp(item.message)\n        : get(item.message, [\"message\", \"header\", \"stamp\"]);\n      if (thisStamp && TimeUtil.areSame(stamp, thisStamp)) {\n        found = true;\n        synchronizedItemsByPath[path] = [item];\n        break;\n      }\n    }\n    if (!found) {\n      return null;\n    }\n  }\n  return synchronizedItemsByPath;\n}\n\n// Return a synchronized subset of the messages in `itemsByPath` with exactly matching header.stamps.\n// If multiple sets of synchronized messages are included, the one with the later header.stamp is returned.\nexport default function synchronizeMessages(\n  itemsByPath: MessageHistoryItemsByPath,\n  getHeaderStamp?: (itemMessage: Message) => ?Time\n): ?MessageHistoryItemsByPath {\n  for (const stamp of allItemStampsNewestFirst(itemsByPath, getHeaderStamp)) {\n    const synchronizedItemsByPath = itemsMatchingStamp(stamp, itemsByPath, getHeaderStamp);\n    if (synchronizedItemsByPath) {\n      return synchronizedItemsByPath;\n    }\n  }\n  return null;\n}\n\nfunction getSynchronizedMessages(\n  stamp: Time,\n  topics: $ReadOnlyArray<string>,\n  messages: { [topic: string]: Message[] }\n): ?{ [topic: string]: Message } {\n  const synchronizedMessages = {};\n  for (const topic of topics) {\n    const matchingMessage = messages[topic].find(({ message }) => {\n      const thisStamp = get(message, [\"header\", \"stamp\"]);\n      return thisStamp && TimeUtil.areSame(stamp, thisStamp);\n    });\n    if (!matchingMessage) {\n      return null;\n    }\n    synchronizedMessages[topic] = matchingMessage;\n  }\n  return synchronizedMessages;\n}\n\ntype ReducedValue = {|\n  messagesByTopic: { [topic: string]: Message[] },\n  synchronizedMessages: ?{ [topic: string]: Message },\n|};\n\nfunction getSynchronizedState(\n  topics: $ReadOnlyArray<string>,\n  { messagesByTopic, synchronizedMessages }: ReducedValue\n): ReducedValue {\n  let newMessagesByTopic = messagesByTopic;\n  let newSynchronizedMessages = synchronizedMessages;\n\n  for (const stamp of allMessageStampsNewestFirst(messagesByTopic)) {\n    const syncedMsgs = getSynchronizedMessages(stamp, topics, messagesByTopic);\n    if (syncedMsgs) {\n      // We've found a new synchronized set; remove messages older than these.\n      newSynchronizedMessages = syncedMsgs;\n      newMessagesByTopic = mapValues(newMessagesByTopic, (msgsByTopic) =>\n        msgsByTopic.filter(({ message }) => {\n          const thisStamp = get(message, [\"header\", \"stamp\"]);\n          return !TimeUtil.isLessThan(thisStamp, stamp);\n        })\n      );\n      break;\n    }\n  }\n  return { messagesByTopic: newMessagesByTopic, synchronizedMessages: newSynchronizedMessages };\n}\n\n// Returns reducers for use with PanelAPI.useMessageReducer\nexport function getSynchronizingReducers(topics: $ReadOnlyArray<string>) {\n  return {\n    restore(previousValue: ?ReducedValue) {\n      const messagesByTopic = {};\n      for (const topic of topics) {\n        messagesByTopic[topic] = (previousValue && previousValue.messagesByTopic[topic]) || [];\n      }\n      return getSynchronizedState(topics, { messagesByTopic, synchronizedMessages: null });\n    },\n    addMessage({ messagesByTopic, synchronizedMessages }: ReducedValue, newMessage: Message) {\n      return getSynchronizedState(topics, {\n        messagesByTopic: {\n          ...messagesByTopic,\n          [newMessage.topic]: messagesByTopic[newMessage.topic]\n            ? messagesByTopic[newMessage.topic].concat(newMessage)\n            : [newMessage],\n        },\n        synchronizedMessages,\n      });\n    },\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { groupBy, keyBy, sortBy, mapValues } from \"lodash\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport Button from \"webviz-core/src/components/Button\";\nimport Dropdown from \"webviz-core/src/components/Dropdown\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { Item } from \"webviz-core/src/components/Menu\";\nimport MessageHistoryDEPRECATED from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TextContent from \"webviz-core/src/components/TextContent\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Topic, Message, SubscribePayload, AdvertisePayload } from \"webviz-core/src/players/types\";\nimport { downloadTextFile } from \"webviz-core/src/util\";\n\nconst { useCallback } = React;\n\nconst RECORD_ALL = \"RECORD_ALL\";\n\nconst Container = styled.div`\n  padding: 16px;\n  overflow-y: auto;\n  ul {\n    font-size: 10px;\n    margin-left: 8px;\n  }\n  li {\n    margin: 4px 0;\n  }\n  h1 {\n    font-size: 1.5em;\n    margin-bottom: 0.5em;\n  }\n  section {\n    flex: 1 1 50%;\n    overflow: hidden;\n  }\n`;\n\nfunction getSubscriptionGroup({ requester }: SubscribePayload): string {\n  if (!requester) {\n    return \"<unknown>\";\n  }\n  switch (requester.type) {\n    case \"panel\":\n      return `Panel “${requester.name}”`;\n    case \"node\":\n      return `Node “${requester.name}”`;\n    case \"other\":\n      return requester.name;\n  }\n  (requester.type: empty); // enforce that all cases are handled in switch above\n  // this shouldn't be necessary, but Flow doesn't let us fall off the end without returning a string\n  // https://github.com/facebook/flow/issues/451\n  return `<unknown: ${requester.type} ${requester.name}>`;\n}\n\nfunction getPublisherGroup({ advertiser }: AdvertisePayload): string {\n  if (!advertiser) {\n    return \"<unknown>\";\n  }\n  switch (advertiser.type) {\n    case \"panel\":\n      return `Panel “${advertiser.name}”`;\n  }\n  (advertiser.type: empty);\n  return `<unknown: ${advertiser.type} ${advertiser.name}>`;\n}\n\n// Display webviz internal state for debugging and viewing topic dependencies.\nfunction Internals(): React.Node {\n  const { topics } = PanelAPI.useDataSourceInfo();\n  const subscriptions = useMessagePipeline(\n    useCallback(({ subscriptions: pipelineSubscriptions }) => pipelineSubscriptions, [])\n  );\n  const publishers = useMessagePipeline(useCallback(({ publishers: pipelinePublishers }) => pipelinePublishers, []));\n\n  const [groupedSubscriptions, subscriptionGroups] = React.useMemo(\n    () => {\n      const grouped = groupBy(subscriptions, getSubscriptionGroup);\n      return [grouped, Object.keys(grouped)];\n    },\n    [subscriptions]\n  );\n\n  const renderedSubscriptions = React.useMemo(\n    () => {\n      if (subscriptions.length === 0) {\n        return \"(none)\";\n      }\n      const topicsByName = keyBy(topics, (topic) => topic.name);\n\n      return Object.keys(groupedSubscriptions)\n        .sort()\n        .map((key) => {\n          return (\n            <React.Fragment key={key}>\n              <div style={{ marginTop: 16 }}>{key}:</div>\n              <ul>\n                {sortBy(groupedSubscriptions[key], (sub) => sub.topic).map((sub, i) => (\n                  <li key={i}>\n                    <tt>\n                      {sub.topic}\n                      {topicsByName[sub.topic] &&\n                        topicsByName[sub.topic].originalTopic &&\n                        ` (original topic: ${topicsByName[sub.topic].originalTopic})`}\n                    </tt>\n                  </li>\n                ))}\n              </ul>\n            </React.Fragment>\n          );\n        });\n    },\n    [groupedSubscriptions, subscriptions, topics]\n  );\n\n  const renderedPublishers = React.useMemo(\n    () => {\n      if (publishers.length === 0) {\n        return \"(none)\";\n      }\n      const groupedPublishers = groupBy(publishers, getPublisherGroup);\n      return Object.keys(groupedPublishers)\n        .sort()\n        .map((key) => {\n          return (\n            <React.Fragment key={key}>\n              <div style={{ marginTop: 16 }}>{key}:</div>\n              <ul>\n                {sortBy(groupedPublishers[key], (sub) => sub.topic).map((sub, i) => (\n                  <li key={i}>\n                    <tt>{sub.topic}</tt>\n                  </li>\n                ))}\n              </ul>\n            </React.Fragment>\n          );\n        });\n    },\n    [publishers]\n  );\n\n  const [recordGroup, setRecordGroup] = React.useState<string>(RECORD_ALL);\n  const [recordingTopics, setRecordingTopics] = React.useState<?(string[])>();\n  const recordedData = React.useRef<?{ topics: Topic[], frame: { [string]: Message[] } }>();\n\n  function onRecordClick() {\n    if (recordingTopics) {\n      recordedData.current = undefined;\n      setRecordingTopics(undefined);\n      return;\n    }\n    const recordSubs = recordGroup === RECORD_ALL ? subscriptions : groupedSubscriptions[recordGroup];\n    setRecordingTopics(recordSubs.map((sub) => sub.topic));\n  }\n\n  function downloadJSON() {\n    downloadTextFile(JSON.stringify(recordedData.current) || \"{}\", \"fixture.json\");\n  }\n\n  const historyRecorder = React.useMemo(\n    () => {\n      if (!recordingTopics) {\n        return false;\n      }\n      return (\n        <MessageHistoryDEPRECATED paths={recordingTopics} historySize={1}>\n          {({ itemsByPath }) => {\n            const frame = mapValues(itemsByPath, (items) => items.map(({ message }) => message));\n            recordedData.current = {\n              topics: filterMap(Object.keys(itemsByPath), (topic) =>\n                itemsByPath[topic] && itemsByPath[topic].length\n                  ? { name: topic, datatype: itemsByPath[topic][0].message.datatype }\n                  : null\n              ),\n              frame,\n            };\n            return null;\n          }}\n        </MessageHistoryDEPRECATED>\n      );\n    },\n    [recordingTopics]\n  );\n\n  return (\n    <Container>\n      <PanelToolbar floating />\n      <h1>Recording</h1>\n      <TextContent>\n        Press to start recording topic data for debug purposes. The latest messages on each topic will be kept and\n        formatted into a fixture that can be used to create a test.\n      </TextContent>\n      <Flex row wrap style={{ padding: \"8px 0 32px\" }}>\n        <Button isPrimary small onClick={onRecordClick} data-test=\"internals-record-button\">\n          {recordingTopics ? `Recording ${recordingTopics.length} topics…` : \"Record raw data\"}\n        </Button>\n        <Dropdown\n          disabled={!!recordingTopics}\n          text={`Record from: ${recordGroup === RECORD_ALL ? \"All panels\" : recordGroup}`}\n          value={recordGroup}\n          onChange={(value) => setRecordGroup(value)}>\n          <Item value={RECORD_ALL}>All panels</Item>\n          {subscriptionGroups.map((group) => (\n            <Item key={group} value={group}>\n              {group}\n            </Item>\n          ))}\n        </Dropdown>\n        {recordingTopics && (\n          <Button small onClick={downloadJSON} data-test=\"internals-download-button\">\n            Download JSON\n          </Button>\n        )}\n        {historyRecorder}\n      </Flex>\n      <Flex row>\n        <section data-test=\"internals-subscriptions\">\n          <h1>Subscriptions</h1>\n          {renderedSubscriptions}\n        </section>\n        <section data-test=\"internals-publishers\">\n          <h1>Publishers</h1>\n          {renderedPublishers}\n        </section>\n      </Flex>\n    </Container>\n  );\n}\nInternals.panelType = \"Internals\";\nInternals.defaultConfig = {};\n\nexport default hot(Panel<{}>(Internals));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport ArrowLeftIcon from \"@mdi/svg/svg/arrow-left.svg\";\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxOutlineIcon from \"@mdi/svg/svg/checkbox-marked-circle-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport PlusIcon from \"@mdi/svg/svg/plus.svg\";\nimport { some } from \"lodash\";\nimport * as React from \"react\";\nimport Dimensions from \"react-container-dimensions\";\nimport { hot } from \"react-hot-loader/root\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\nimport uuid from \"uuid\";\n\nimport { type Script } from \"./script\";\nimport { setUserNodes as setUserNodesAction } from \"webviz-core/src/actions/panels\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport SpinningLoadingIcon from \"webviz-core/src/components/SpinningLoadingIcon\";\nimport TextContent from \"webviz-core/src/components/TextContent\";\nimport BottomBar from \"webviz-core/src/panels/NodePlayground/BottomBar\";\nimport Playground from \"webviz-core/src/panels/NodePlayground/playground-icon.svg\";\nimport Sidebar from \"webviz-core/src/panels/NodePlayground/Sidebar\";\nimport { trustUserNode } from \"webviz-core/src/players/UserNodePlayer/nodeSecurity\";\nimport type { UserNodeDiagnostics } from \"webviz-core/src/reducers/userNodes\";\nimport type { UserNodes } from \"webviz-core/src/types/panels\";\nimport { DEFAULT_WEBVIZ_NODE_PREFIX } from \"webviz-core/src/util/globalConstants\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst Editor = React.lazy(() =>\n  import(/* webpackChunkName: \"node-playground-editor\" */ \"webviz-core/src/panels/NodePlayground/Editor\")\n);\n\nconst skeletonBody = `import { Message } from \"ros\";\n\ntype InputTopicMsg = { /* YOUR INPUT TOPIC TYPE HERE */ };\ntype Output = { /* DEFINED YOUR OUTPUT HERE */ };\n\nexport const inputs = [];\nexport const output = \"${DEFAULT_WEBVIZ_NODE_PREFIX}\";\n\nconst publisher = (message: Message<InputTopicMsg>): Output => {\n  return {};\n};\n\nexport default publisher;`;\n\ntype Config = {|\n  selectedNodeId: ?string,\n  // Used only for storybook screenshot testing.\n  editorForStorybook?: React.Node,\n  // Used only for storybook screenshot testing.\n  additionalBackStackItems?: Script[],\n  vimMode: boolean,\n|};\n\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n};\n\nconst UnsavedDot = styled.div`\n  display: ${({ isSaved }: { isSaved: boolean }) => (isSaved ? \"none\" : \"initial\")};\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  position: absolute;\n  right: 8px;\n  top: 50%;\n  transform: translateY(-50%);\n  background-color: ${colors.DARK9};\n`;\n\n// Exported for screenshot testing.\nexport const NodePlaygroundSettings = ({ config, saveConfig }: Props) => (\n  <Item\n    icon={config.vimMode ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n    onClick={() => saveConfig({ vimMode: !config.vimMode })}>\n    <span>Vim Mode</span>\n  </Item>\n);\n\nconst SecurityBarWrapper = styled.div`\n  width: 100%;\n  height: 40px;\n  background-color: ${colors.REDL1};\n  display: flex;\n  justify-content: space-between;\n  padding: 8px;\n  align-items: center;\n  font-weight: bold;\n`;\n\nconst TrustButton = styled.button`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 75px;\n  padding: 4px 8px;\n  vertical-align: middle;\n  font-weight: bold;\n  border: 2px solid ${colors.LIGHT1};\n`;\n\nconst SecurityBar = ({ onClick }: { onClick: () => void }) => (\n  <SecurityBarWrapper>\n    <p>\n      Warning: This panel will execute user-defined code that is coming from a remote source. Make sure you trust it.\n    </p>\n    <TrustButton data-test=\"trust-user-scripts\" onClick={onClick}>\n      Trust\n      <Icon small>\n        <CheckboxOutlineIcon />\n      </Icon>\n    </TrustButton>\n  </SecurityBarWrapper>\n);\n\nconst SWelcomeScreen = styled.div`\n  display: flex;\n  text-align: center;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  padding: 25%;\n  height: 100%;\n  > * {\n    margin: 4px 0;\n  }\n`;\n\nexport type Explorer = null | \"docs\" | \"nodes\";\n\nconst WelcomeScreen = ({\n  addNewNode,\n  updateExplorer,\n}: {|\n  addNewNode: () => void,\n  updateExplorer: (explorer: Explorer) => void,\n|}) => {\n  return (\n    <SWelcomeScreen>\n      <Playground />\n      <TextContent>\n        Welcome to Node Playground! Get started by reading the{\" \"}\n        <a\n          href=\"\"\n          onClick={(e) => {\n            e.preventDefault();\n            updateExplorer(\"docs\");\n          }}>\n          docs\n        </a>\n        , or just create a new node.\n      </TextContent>\n      <Button style={{ marginTop: \"8px\" }} onClick={addNewNode}>\n        <Icon medium>\n          <PlusIcon />\n        </Icon>{\" \"}\n        New node\n      </Button>\n    </SWelcomeScreen>\n  );\n};\n\nfunction NodePlayground(props: Props) {\n  const { config, saveConfig } = props;\n  const { selectedNodeId, editorForStorybook, vimMode } = config;\n\n  const [explorer, updateExplorer] = React.useState<Explorer>(null);\n\n  const userNodes = useSelector((state) => state.panels.userNodes);\n  const userNodeDiagnostics = useSelector((state) => state.userNodes.userNodeDiagnostics);\n  const needsUserTrust = useSelector((state) => {\n    const nodes: UserNodeDiagnostics[] = (Object.values(state.userNodes): any);\n    return some(nodes, ({ trusted }) => typeof trusted === \"boolean\" && !trusted);\n  });\n\n  const dispatch = useDispatch();\n  const setUserNodes = React.useCallback((payload: UserNodes) => dispatch(setUserNodesAction(payload)), [dispatch]);\n\n  const selectedNodeDiagnostics =\n    selectedNodeId && userNodeDiagnostics[selectedNodeId] ? userNodeDiagnostics[selectedNodeId].diagnostics : [];\n  const selectedNode = selectedNodeId ? userNodes[selectedNodeId] : undefined;\n  const [scriptBackStack, setScriptBackStack] = React.useState<Script[]>([]);\n  // Holds the currently active script\n  const currentScript = scriptBackStack.length > 0 ? scriptBackStack[scriptBackStack.length - 1] : null;\n  const isCurrentScriptSelectedNode = !!selectedNode && !!currentScript && currentScript.fileName === selectedNode.name;\n  const isNodeSaved = !isCurrentScriptSelectedNode || currentScript?.code === selectedNode?.sourceCode;\n  const selectedNodeLogs =\n    selectedNodeId && userNodeDiagnostics[selectedNodeId] ? userNodeDiagnostics[selectedNodeId].logs : [];\n\n  const inputTitle = currentScript\n    ? currentScript.fileName + (currentScript.readOnly ? \" (READONLY)\" : \"\")\n    : \"node name\";\n  const inputStyle = {\n    borderRadius: 0,\n    margin: 0,\n    backgroundColor: colors.DARK2,\n    padding: \"4px 20px\",\n    width: `${inputTitle.length + 4}ch`, // Width based on character count of title + padding\n  };\n\n  React.useLayoutEffect(\n    () => {\n      if (selectedNode) {\n        const testItems = props.config.additionalBackStackItems || [];\n        setScriptBackStack([\n          { fileName: selectedNode.name, code: selectedNode.sourceCode, readOnly: false },\n          ...testItems,\n        ]);\n      }\n    },\n    [props.config.additionalBackStackItems, selectedNode]\n  );\n\n  // UX nicety so that the user can see which nodes need to be verified.\n  React.useLayoutEffect(\n    () => {\n      if (needsUserTrust) {\n        updateExplorer(\"nodes\");\n      }\n    },\n    [needsUserTrust]\n  );\n\n  const addNewNode = React.useCallback(\n    () => {\n      const newNodeId = uuid.v4();\n      // TODO: Add integration test for this flow.\n      trustUserNode({ id: newNodeId, sourceCode: skeletonBody }).then(() => {\n        setUserNodes({\n          [newNodeId]: {\n            sourceCode: skeletonBody,\n            name: `${DEFAULT_WEBVIZ_NODE_PREFIX}${newNodeId.split(\"-\")[0]}`,\n          },\n        });\n        saveConfig({ selectedNodeId: newNodeId });\n      });\n    },\n    [saveConfig, setUserNodes]\n  );\n\n  const trustSelectedNode = React.useCallback(\n    () => {\n      if (!selectedNodeId || !selectedNode) {\n        return;\n      }\n      trustUserNode({ id: selectedNodeId, sourceCode: selectedNode.sourceCode }).then(() => {\n        // no-op in order to trigger the useUserNodes hook.\n        setUserNodes({});\n      });\n    },\n    [selectedNode, selectedNodeId, setUserNodes]\n  );\n\n  const saveNode = React.useCallback(\n    (script) => {\n      if (!selectedNodeId || !script) {\n        return;\n      }\n      trustUserNode({ id: selectedNodeId, sourceCode: script }).then(() => {\n        setUserNodes({ [selectedNodeId]: { ...selectedNode, sourceCode: script } });\n      });\n    },\n    [selectedNode, selectedNodeId, setUserNodes]\n  );\n\n  const setScriptOverride = React.useCallback(\n    (script: Script) => {\n      setScriptBackStack([...scriptBackStack, script]);\n    },\n    [scriptBackStack]\n  );\n\n  const goBack = React.useCallback(\n    () => {\n      setScriptBackStack(scriptBackStack.slice(0, scriptBackStack.length - 1));\n    },\n    [scriptBackStack]\n  );\n\n  const setScriptCode = React.useCallback(\n    (code: string) => {\n      // update code at top of backstack\n      const backStack = [...scriptBackStack];\n      if (backStack.length > 0) {\n        const script = { ...backStack[backStack.length - 1] };\n        if (!script.readOnly) {\n          script.code = code;\n          setScriptBackStack(backStack);\n        }\n      }\n    },\n    [scriptBackStack]\n  );\n\n  return (\n    <Dimensions>\n      {({ height, width }) => (\n        <Flex col style={{ height, position: \"relative\" }}>\n          <PanelToolbar floating menuContent={<NodePlaygroundSettings {...props} />} />\n          <Flex style={{ height, width }}>\n            <Sidebar\n              explorer={explorer}\n              updateExplorer={updateExplorer}\n              selectNode={(nodeId) => {\n                if (selectedNodeId && currentScript && isCurrentScriptSelectedNode) {\n                  // Save current state so that user can seamlessly go back to previous work.\n                  setUserNodes({\n                    [selectedNodeId]: { ...selectedNode, sourceCode: currentScript.code },\n                  });\n                }\n                saveConfig({ selectedNodeId: nodeId });\n              }}\n              deleteNode={(nodeId) => {\n                setUserNodes({ ...userNodes, [nodeId]: undefined });\n                saveConfig({ selectedNodeId: undefined });\n              }}\n              selectedNodeId={selectedNodeId}\n              userNodes={userNodes}\n              needsUserTrust={needsUserTrust}\n              userNodeDiagnostics={userNodeDiagnostics}\n            />\n            <Flex col>\n              <Flex\n                start\n                style={{\n                  flexGrow: 0,\n                  backgroundColor: colors.DARK1,\n                  alignItems: \"center\",\n                }}>\n                {scriptBackStack.length > 1 && (\n                  <Icon large tooltip=\"Go back\" dataTest=\"go-back\" style={{ color: colors.DARK9 }} onClick={goBack}>\n                    <ArrowLeftIcon />\n                  </Icon>\n                )}\n                {selectedNodeId && (\n                  <div style={{ position: \"relative\" }}>\n                    <input\n                      type=\"text\"\n                      placeholder=\"node name\"\n                      value={inputTitle}\n                      disabled={!currentScript || currentScript.readOnly}\n                      style={inputStyle}\n                      spellCheck={false}\n                      onChange={(e) => {\n                        const newNodeName = e.target.value;\n                        setUserNodes({\n                          ...userNodes,\n                          [selectedNodeId]: { ...selectedNode, name: newNodeName },\n                        });\n                      }}\n                    />\n                    <UnsavedDot isSaved={isNodeSaved} />\n                  </div>\n                )}\n                <Icon\n                  large\n                  tooltip=\"new node\"\n                  dataTest=\"new-node\"\n                  style={{ color: colors.DARK9, padding: \"0 5px\" }}\n                  onClick={addNewNode}>\n                  <PlusIcon />\n                </Icon>\n              </Flex>\n\n              {userNodeDiagnostics[selectedNodeId] &&\n                typeof userNodeDiagnostics[selectedNodeId].trusted === \"boolean\" &&\n                !userNodeDiagnostics[selectedNodeId].trusted && <SecurityBar onClick={trustSelectedNode} />}\n              <Flex col style={{ flexGrow: 1, position: \"relative\" }}>\n                {!selectedNodeId && <WelcomeScreen addNewNode={addNewNode} updateExplorer={updateExplorer} />}\n                <div\n                  key={`${height}x${width}`}\n                  data-nativeundoredo=\"true\"\n                  style={{\n                    height: \"100%\",\n                    width: \"100%\",\n                    display: selectedNodeId\n                      ? \"initial\"\n                      : \"none\" /* Ensures the monaco-editor starts loading before the user opens it */,\n                  }}>\n                  <React.Suspense\n                    fallback={\n                      <Flex center style={{ width: \"100%\", height: \"100%\" }}>\n                        <Icon large>\n                          <SpinningLoadingIcon />\n                        </Icon>\n                      </Flex>\n                    }>\n                    {editorForStorybook || (\n                      <Editor\n                        script={currentScript}\n                        setScriptCode={setScriptCode}\n                        setScriptOverride={setScriptOverride}\n                        vimMode={vimMode}\n                        resizeKey={`${width}-${height}-${explorer || \"none\"}-${selectedNodeId || \"none\"}`}\n                        save={saveNode}\n                      />\n                    )}\n                  </React.Suspense>\n                </div>\n                <BottomBar\n                  nodeId={selectedNodeId}\n                  isSaved={isNodeSaved}\n                  save={() => saveNode(currentScript?.code)}\n                  diagnostics={selectedNodeDiagnostics}\n                  logs={selectedNodeLogs}\n                />\n              </Flex>\n            </Flex>\n          </Flex>\n        </Flex>\n      )}\n    </Dimensions>\n  );\n}\n\nNodePlayground.panelType = \"NodePlayground\";\nNodePlayground.defaultConfig = { selectedNodeId: undefined, vimMode: false };\n\nexport default hot(Panel<Config>(NodePlayground));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\n\nimport { clearUserNodeLogs } from \"webviz-core/src/actions/userNodes\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport DiagnosticsSection from \"webviz-core/src/panels/NodePlayground/BottomBar/DiagnosticsSection\";\nimport LogsSection from \"webviz-core/src/panels/NodePlayground/BottomBar/LogsSection\";\nimport type { Diagnostic, UserNodeLog } from \"webviz-core/src/players/UserNodePlayer/types\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SHeaderItem = styled.div`\n  cursor: pointer;\n  padding: 4px;\n  text-transform: uppercase;\n`;\n\ntype Props = {\n  nodeId: ?string,\n  isSaved: boolean,\n  save: () => void,\n  diagnostics: Diagnostic[],\n  logs: UserNodeLog[],\n};\n\ntype HeaderItemProps = {\n  text: string,\n  isOpen: boolean,\n  numItems: number,\n};\n\nconst HeaderItem = ({ isOpen, numItems, text }: HeaderItemProps) => (\n  <SHeaderItem\n    style={{\n      color: numItems ? colors.RED : \"inherit\",\n      borderBottom: isOpen ? `1px solid ${colors.DARK6}` : \"none\",\n      paddingBottom: isOpen ? 2 : 0,\n    }}>\n    {text} {numItems || \"\"}\n  </SHeaderItem>\n);\n\ntype BottomBarDisplayState = \"closed\" | \"diagnostics\" | \"logs\";\n\nconst BottomBar = ({ nodeId, isSaved, save, diagnostics, logs }: Props) => {\n  const [bottomBarDisplay: BottomBarDisplayState, setBottomBarDisplay] = useState(\"closed\");\n  const [autoScroll, setAutoScroll] = useState(true);\n\n  const dispatch = useDispatch();\n  const clearLogs = React.useCallback((payload: string) => dispatch(clearUserNodeLogs(payload)), [dispatch]);\n  const scrollContainer = useRef(null);\n\n  useEffect(\n    () => {\n      if (autoScroll) {\n        if (scrollContainer.current) {\n          scrollContainer.current.scrollTop = scrollContainer.current.scrollHeight;\n        }\n      }\n    },\n    [autoScroll, logs]\n  );\n\n  return (\n    <Flex col style={{ backgroundColor: colors.DARK1, position: \"absolute\", bottom: 0, right: 0, left: 0 }}>\n      <Flex\n        row\n        start\n        style={{\n          padding: 5,\n          bottom: 0,\n        }}>\n        <Flex\n          center\n          style={{ flexGrow: 0, color: colors.DARK9 }}\n          dataTest=\"np-errors\"\n          onClick={() => {\n            if (bottomBarDisplay !== \"diagnostics\") {\n              setBottomBarDisplay(\"diagnostics\");\n            } else {\n              setBottomBarDisplay(\"closed\");\n            }\n          }}>\n          <HeaderItem text=\"Problems\" numItems={diagnostics.length} isOpen={bottomBarDisplay === \"diagnostics\"} />\n        </Flex>\n        <Flex\n          center\n          style={{ flexGrow: 0, color: colors.DARK9 }}\n          dataTest=\"np-logs\"\n          onClick={() => {\n            if (bottomBarDisplay !== \"logs\") {\n              setBottomBarDisplay(\"logs\");\n            } else {\n              setBottomBarDisplay(\"closed\");\n            }\n          }}>\n          <HeaderItem text=\"Logs\" numItems={logs.length} isOpen={bottomBarDisplay === \"logs\"} />\n        </Flex>\n        <Button\n          style={{ padding: \"2px 4px\" }}\n          primary={!isSaved}\n          disabled={isSaved}\n          tooltip={\"ctrl/cmd + s\"}\n          onClick={() => {\n            if (nodeId) {\n              save();\n              clearLogs(nodeId);\n            }\n          }}>\n          {isSaved ? \"saved\" : \"save\"}\n        </Button>\n      </Flex>\n      <div\n        ref={scrollContainer}\n        onScroll={({ target }) => {\n          const scrolledUp = target.scrollHeight - target.scrollTop > target.clientHeight;\n          if (scrolledUp && autoScroll) {\n            setAutoScroll(false);\n          } else if (!scrolledUp && !autoScroll) {\n            setAutoScroll(true);\n          }\n        }}\n        style={{\n          overflowY: bottomBarDisplay !== \"closed\" ? \"scroll\" : \"auto\",\n          height: bottomBarDisplay !== \"closed\" ? 150 : 0,\n          color: colors.DARK9,\n        }}>\n        {bottomBarDisplay === \"diagnostics\" && <DiagnosticsSection diagnostics={diagnostics} />}\n        {bottomBarDisplay === \"logs\" && <LogsSection nodeId={nodeId} logs={logs} clearLogs={clearLogs} />}\n      </div>\n    </Flex>\n  );\n};\n\nexport default BottomBar;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport AlertCircleIcon from \"@mdi/svg/svg/alert-circle.svg\";\nimport AlertIcon from \"@mdi/svg/svg/alert.svg\";\nimport HelpCircleIcon from \"@mdi/svg/svg/help-circle.svg\";\nimport InformationIcon from \"@mdi/svg/svg/information.svg\";\nimport { invert } from \"lodash\";\nimport React from \"react\";\n\nimport Icon from \"webviz-core/src/components/Icon\";\nimport type { Diagnostic } from \"webviz-core/src/players/UserNodePlayer/types\";\nimport { DiagnosticSeverity } from \"webviz-core/src/players/UserNodePlayer/types\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst severityColors = {\n  Hint: colors.YELLOWL1,\n  Info: colors.BLUEL1,\n  Warning: colors.ORANGEL1,\n  Error: colors.REDL1,\n};\n\nconst severityIcons = {\n  Hint: <HelpCircleIcon />,\n  Info: <InformationIcon />,\n  Warning: <AlertIcon />,\n  Error: <AlertCircleIcon />,\n};\n\ntype Props = {\n  diagnostics: Diagnostic[],\n};\n\nconst DiagnosticsSection = ({ diagnostics }: Props) => {\n  return diagnostics.length ? (\n    <ul>\n      {diagnostics.map(({ severity, message, source, startColumn = null, startLineNumber = null }, i) => {\n        const severityLabel = invert(DiagnosticSeverity)[severity];\n        const errorLoc =\n          startLineNumber != null && startColumn != null ? `[${startLineNumber + 1},${startColumn + 1}]` : null;\n        return (\n          <li key={`${message}_${i}`}>\n            <Icon tooltip=\"Severity\" small style={{ color: severityColors[severityLabel] }} active>\n              {severityIcons[severityLabel]}\n            </Icon>\n            <span style={{ padding: \"5px\" }}>{message}</span>\n            <span style={{ color: colors.GRAY }}>\n              {source} {errorLoc}\n            </span>\n          </li>\n        );\n      })}\n    </ul>\n  ) : (\n    <p>No problems to display.</p>\n  );\n};\n\nexport default DiagnosticsSection;\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React from \"react\";\nimport Tree from \"react-json-tree\";\nimport styled from \"styled-components\";\n\nimport type { UserNodeLog } from \"webviz-core/src/players/UserNodePlayer/types\";\nimport { jsonTreeTheme } from \"webviz-core/src/util/globalConstants\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SListItem = styled.li`\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n  cursor: default;\n\n  :hover {\n    background-color: ${colors.DARK4};\n  }\n`;\n\ntype Props = {\n  nodeId: ?string,\n  logs: UserNodeLog[],\n  clearLogs: (nodeId: string) => void,\n};\n\nconst valueColorMap = {\n  string: jsonTreeTheme.base0B,\n  number: jsonTreeTheme.base09,\n  boolean: jsonTreeTheme.base09,\n  object: jsonTreeTheme.base08, // null\n  undefined: jsonTreeTheme.base08,\n};\n\nconst LogsSection = ({ nodeId, logs, clearLogs }: Props) => {\n  if (logs.length === 0) {\n    return (\n      <>\n        <p>No logs to display.</p>\n        <p>\n          Invoke <code>log(someValue)</code> in your Webviz node code to see data printed here.\n        </p>\n      </>\n    );\n  }\n  return (\n    <>\n      <button\n        data-test=\"np-logs-clear\"\n        style={{ padding: \"3px 5px\", position: \"absolute\", right: 5, top: 5 }}\n        onClick={() => {\n          if (nodeId) {\n            clearLogs(nodeId);\n          }\n        }}>\n        clear logs\n      </button>\n      <ul>\n        {logs.map(({ source, value }, idx) => {\n          const renderTreeObj = value != null && typeof value === \"object\";\n          return (\n            <SListItem key={`${idx}${source}`} style={{ padding: renderTreeObj ? \"0px 3px\" : \"6px 3px 3px\" }}>\n              {renderTreeObj ? (\n                <Tree hideRoot data={value} invertTheme={false} theme={jsonTreeTheme} />\n              ) : (\n                <span style={{ color: valueColorMap[typeof value] || colors.LIGHT }}>\n                  {value == null || value === false ? String(value) : value}\n                </span>\n              )}\n              <div style={{ color: colors.DARK9, textDecoration: \"underline\" }}>{source}</div>\n            </SListItem>\n          );\n        })}\n      </ul>\n    </>\n  );\n};\n\nexport default LogsSection;\n","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport React from \"react\";\nexport default ((_ref) => {\n  let {\n    styles = {}\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"styles\"]);\n\n  return React.createElement(\n    \"svg\",\n    _extends({ width: \"138\", height: \"107\", viewBox: \"0 0 138 107\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\" }, props),\n    React.createElement(\"path\", { d: \"M47.5 19L44 21l3.5 1.5M53.5 22.5L57 21l-3.5-2\", stroke: \"#C8C8C7\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }),\n    React.createElement(\"path\", { d: \"M47 28l5-10.5\", stroke: \"#C8C8C7\", strokeLinecap: \"round\" }),\n    React.createElement(\"path\", { d: \"M0 106.5h39m9.5 0H79m5.5 0H109m11.5 0H136M29.076 47.5L47 27.744 64.924 47.5H29.076z\", stroke: \"#C8C8C7\" }),\n    React.createElement(\"path\", { d: \"M89.5 2.5l-3.5 2L89.5 6M95.5 6L99 4.5l-3.5-2\", stroke: \"#C8C8C7\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }),\n    React.createElement(\"path\", { d: \"M89 11.5L94 1\", stroke: \"#C8C8C7\", strokeLinecap: \"round\" }),\n    React.createElement(\"path\", { d: \"M71.076 31L89 11.244 106.924 31H71.076zM34.5 79.238h25V89.5h-25V79.238zm25-1h-25V47.5h25v30.738zM76.5 37.073h25V71.5h-25V37.073zm25-1h-25V31h25v5.073z\", stroke: \"#C8C8C7\" }),\n    React.createElement(\"circle\", { cx: \"47\", cy: \"61\", r: \"4.5\", stroke: \"#C8C8C7\" }),\n    React.createElement(\"circle\", { cx: \"89\", cy: \"89\", r: \"5.5\", stroke: \"#C8C8C7\" }),\n    React.createElement(\"path\", { d: \"M113 71.5v-11H68m45 11V85c0 5 9.092 12.56 19 10.5l4.5 11H120m-7-35h-11.5M68 60.5h-8.5v11H68m0-11v11m0 0h8.5m43 35h.5m-18.5-35H89m12.5 0V89m0 17.5V89m-25-17.5V89m0-17.5H89m-12.5 35V89m0 0h7M89 71.5v12m5.5 5.5h7m0 0c1.6 9.6 13 15.667 18.5 17.5m-31-12v12M49.075 34.928l4.85 5.144M59.5 89.5v17M34.5 89.5v17M.5 93l34-28.5M1.5 106.5l33-27.5M14 106.5l20.5-17M6 88.5L5.5 103M14 82l-.5 14.5M22 75l-.5 14.5m8.5-21L29.5 83\", stroke: \"#C8C8C7\" })\n  );\n});","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ArrowLeftBoldIcon from \"@mdi/svg/svg/arrow-left-bold.svg\";\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport DeleteIcon from \"@mdi/svg/svg/delete.svg\";\nimport FileMultipleIcon from \"@mdi/svg/svg/file-multiple.svg\";\nimport HelpCircleIcon from \"@mdi/svg/svg/help-circle.svg\";\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport TextContent from \"webviz-core/src/components/TextContent\";\nimport type { Explorer } from \"webviz-core/src/panels/NodePlayground\";\nimport nodePlaygroundDocs from \"webviz-core/src/panels/NodePlayground/index.help.md\";\nimport type { UserNodeDiagnostics } from \"webviz-core/src/reducers/userNodes\";\nimport { type UserNodes } from \"webviz-core/src/types/panels\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst MenuWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 40px;\n  background-color: ${colors.DARK1};\n  & > * {\n    margin: 10px;\n  }\n`;\n\nconst ExplorerWrapper = styled.div`\n  display: ${({ show }: { show: boolean }) => (show ? \"initial\" : \"none\")};\n  background-color: ${colors.GRAY2};\n  max-width: 325px;\n  min-width: 275px;\n  overflow: auto;\n`;\n\nconst ListItem = styled.li`\n  padding: 5px;\n  cursor: pointer;\n  display: flex;\n  justify-content: space-between;\n  word-break: break-all;\n  align-items: center;\n  color: ${({ trusted }) => (!trusted ? colors.REDL1 : \"inherit\")};\n  background-color: ${({ selected }: { selected: boolean }) => (selected ? colors.DARK9 : \"transparent\")};\n  span {\n    opacity: 0;\n  }\n  &:hover {\n    background-color: ${colors.DARK9};\n    span {\n      opacity: 1;\n    }\n  }\n`;\n\nconst SFlex = styled.div`\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n\n  pre {\n    white-space: pre-wrap;\n  }\n`;\n\ntype NodesListProps = {\n  nodes: UserNodes,\n  selectNode: (id: string) => void,\n  deleteNode: (id: string) => void,\n  collapse: () => void,\n  selectedNodeId: ?string,\n  userNodeDiagnostics: {\n    [guid: string]: UserNodeDiagnostics,\n  },\n};\n\nconst NodesList = ({\n  nodes,\n  selectNode,\n  deleteNode,\n  collapse,\n  selectedNodeId,\n  userNodeDiagnostics,\n}: NodesListProps) => {\n  const [search, updateSearch] = React.useState(\"\");\n  return (\n    <Flex col>\n      <Flex row style={{ padding: \"5px\", alignItems: \"center\" }}>\n        <Flex style={{ position: \"relative\", flexGrow: 1 }}>\n          <input\n            placeholder=\"search nodes\"\n            type=\"text\"\n            value={search}\n            onChange={(e) => updateSearch(e.target.value)}\n            style={{ backgroundColor: colors.DARK2, margin: 0, padding: \"4px\", width: \"100%\" }}\n            spellCheck={false}\n          />\n          {search ? (\n            <Icon\n              small\n              onClick={() => updateSearch(\"\")}\n              style={{\n                color: colors.DARK9,\n                position: \"absolute\",\n                right: \"5px\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n              }}>\n              <CloseIcon />\n            </Icon>\n          ) : null}\n        </Flex>\n        <Icon onClick={collapse} medium tooltip={\"collapse\"}>\n          <ArrowLeftBoldIcon />\n        </Icon>\n      </Flex>\n      {Object.keys(nodes)\n        .filter((nodeId) => !search || new RegExp(search).test(nodeId))\n        .map((nodeId) => {\n          const trusted = userNodeDiagnostics[nodeId] ? userNodeDiagnostics[nodeId].trusted : true;\n          return (\n            <ListItem\n              key={nodeId}\n              selected={selectedNodeId === nodeId}\n              onClick={() => selectNode(nodeId)}\n              trusted={trusted}>\n              {nodes[nodeId].name}\n              <Icon onClick={() => deleteNode(nodeId)} medium>\n                <DeleteIcon />\n              </Icon>\n            </ListItem>\n          );\n        })}\n    </Flex>\n  );\n};\n\ntype Props = {|\n  selectNode: (nodeId: string) => void,\n  deleteNode: (nodeId: string) => void,\n  userNodes: UserNodes,\n  selectedNodeId: ?string,\n  otherMarkdownDocsForTest?: string,\n  needsUserTrust: boolean,\n  userNodeDiagnostics: {\n    [guid: string]: UserNodeDiagnostics,\n  },\n  explorer: Explorer,\n  updateExplorer: (explorer: Explorer) => void,\n|};\n\nconst RedDot = styled.div`\n  width: 10px;\n  height: 10px;\n  border-radius: 50%;\n  background-color: ${colors.REDL1};\n  position: absolute;\n  bottom: -2px;\n  right: -2px;\n`;\n\nconst Sidebar = ({\n  userNodes,\n  selectNode,\n  deleteNode,\n  selectedNodeId,\n  otherMarkdownDocsForTest,\n  needsUserTrust,\n  userNodeDiagnostics,\n  explorer,\n  updateExplorer,\n}: Props) => {\n  const nodesSelected = explorer === \"nodes\";\n  const docsSelected = explorer === \"docs\";\n  return (\n    <>\n      <MenuWrapper>\n        <Icon\n          dataTest=\"node-explorer\"\n          onClick={() => updateExplorer(nodesSelected ? null : \"nodes\")}\n          large\n          tooltip={\"node explorer\"}\n          style={{ color: nodesSelected ? \"inherit\" : colors.DARK9, position: \"relative\" }}>\n          <FileMultipleIcon />\n          {needsUserTrust && <RedDot />}\n        </Icon>\n        <Icon\n          dataTest=\"docs-explorer\"\n          onClick={() => updateExplorer(docsSelected ? null : \"docs\")}\n          large\n          tooltip={\"docs\"}\n          style={{ color: docsSelected ? \"inherit\" : colors.DARK9 }}>\n          <HelpCircleIcon />\n        </Icon>\n      </MenuWrapper>\n      <ExplorerWrapper show={!!explorer}>\n        {explorer === \"nodes\" ? (\n          <NodesList\n            nodes={userNodes}\n            selectNode={selectNode}\n            deleteNode={deleteNode}\n            collapse={() => updateExplorer(null)}\n            selectedNodeId={selectedNodeId}\n            userNodeDiagnostics={userNodeDiagnostics}\n          />\n        ) : (\n          <SFlex>\n            <TextContent style={{ backgroundColor: \"transparent\" }} linkTarget=\"_blank\">\n              {otherMarkdownDocsForTest || nodePlaygroundDocs}\n            </TextContent>\n          </SFlex>\n        )}\n      </ExplorerWrapper>\n    </>\n  );\n};\n\nexport default Sidebar;\n","module.exports = \"# Node Playground\\n\\nNode Playground is a code editor sandbox in which you can write pseudo-ROS topics that get published within Webviz. Node Playground allows you to manipulate, reduce, and filter existing ROS messages and output them in a way that is useful to you.\\n\\n## Getting Started\\n\\nNode Playground uses TypeScript to typecheck messages coming in and out of your nodes. If you are already familiar with TypeScript, skip the \\\"Learning TypeScript\\\" section below.\\n\\n### Learning TypeScript\\n\\nTypeScript is a superset of JavaScript, so Google syntactic questions (e.g. how to manipulate arrays, or access object properties) using JavaScript terms, and semantic questions (e.g. how to make an object property optional) using TypeScript terms.\\n\\nHere are some resources to get yourself ramped up:\\n\\n- [Basic Types](https://www.typescriptlang.org/docs/handbook/basic-types.html)\\n- [Gitbook](https://basarat.gitbooks.io/typescript/content/docs/why-typescript.html)\\n\\nPost in #stay-typesafe for TypeScript questions.\\n\\n### Writing Your First Webviz Node\\n\\nEvery Webviz node must declare 3 exports that determine how it should execute:\\n\\n- An inputs array of topic names.\\n- An output topic with an enforced prefix: `/webviz_node/`.\\n- A publisher function that takes messages from input topics and publishes messages under your output topic.\\n\\nHere is a basic node that echoes its input:\\n\\n```typescript\\nimport { Message } from \\\"ros\\\";\\n\\ntype RosOutMsg = {\\n  level: number,\\n  name: string,\\n  msg: string,\\n  file: string,\\n  function: string,\\n  line: number,\\n  topics: string[],\\n};\\n\\nexport const inputs = [ \\\"/rosout\\\" ];\\nexport const output = \\\"/webviz_node/echo\\\";\\n\\nconst publisher = (message: Message<RosOutMsg>): RosOutMsg => {\\n  return message.message;\\n};\\n\\nexport default publisher;\\n```\\n\\nIf you drag in a bag, you should now be able to subscribe to the “/webviz_node/echo” topic in the Raw Messages panel.\\n\\nBut let’s say you want to render some markers in the 3D panel. When you create a new node, you’ll be presented with some boilerplate:\\n\\n```typescript\\nimport { Message } from \\\"ros\\\";\\n\\ntype InputTopicMsg = { /* YOUR INPUT TOPIC TYPE HERE */ };\\ntype Output = { /* DEFINED YOUR OUTPUT HERE */ };\\n\\nexport const inputs = [];\\nexport const output = \\\"/webviz_node/\\\";\\n\\nconst publisher = (message: Message<InputTopicMsg>): Output => {\\n  return {};\\n};\\n\\nexport default publisher;\\n```\\n\\nYou’ll notice a few things:\\n\\n- The type `Message` is being imported from a custom library called `ros`. For more information on these type definitions and where they come from, refer to the [Important Types to Know](#important-types-to-know) section below.\\n\\n- The type `InputTopicMsg` has no properties.\\n\\nYou'll need to define your own types here from your input topics.\\n\\n- The type `Output` has no properties.\\n\\nYou will need to fill in this type's definition to include the output properties you care about. For markers, you _must_ return a type of the form `{ markers: MarkerType[] }`. Reference the Markers section below for example types.\\n\\nStrictly typing your nodes will help you debug issues at compile time rather than at runtime. It's not always obvious in Webviz how message properties are affecting the visualized output, and so the more you strictly type your nodes, the less likely you will make mistakes.\\n\\nWith that said, you can disable Typescript checks while getting a rough draft of your node working by adding `// @ts-ignore` on the line above the one you want to ignore.\\n\\n#### Using Multiple Input Topics\\n\\nIn some cases, you will want to define multiple input topics:\\n\\n```typescript\\nimport { Time, Message, Header, Pose, LineStripMarker } from \\\"ros\\\";\\n\\ntype BaseMessage<Topic, Msg> = Message<Msg> & {\\n  topic: Topic\\n}\\n\\ntype RosOutMsg = {\\n  header: Header,\\n  pose: Pose\\n};\\ntype RosOut = BaseMessage<\\\"/rosout\\\", RosOutMsg>;\\n\\ntype Transform = {\\n  translation: number[],\\n  rotation: number[]\\n}\\ntype TransformMsg = {\\n  header: Header,\\n  child_frame_id: string,\\n  transform: Transform\\n}\\ntype TransformMsgArray = {\\n  transforms: TransformMsg[]\\n};\\ntype Tf = BaseMessage<\\\"/tf\\\", TransformMsgArray>;\\n\\ntype Marker = LineStripMarker;\\ntype MarkerArray = {\\n  markers: Marker[]\\n}\\n\\nexport const inputs = [ \\\"/rosout\\\", \\\"/tf\\\" ];\\nexport const output = \\\"/webviz_node/echo\\\";\\n\\nconst publisher = (message: RosOut | Tf): MarkerArray => {\\n\\n  if (message.topic === \\\"/rosout\\\") {\\n    // type is now refined to `/rosout` -- you can use `message.message.pose` safely\\n  } else {\\n    // type is now refined to `/tf` -- you can use `message.message.transforms` safely\\n  }\\n\\n  return { markers: [] };\\n};\\n\\nexport default publisher;\\n```\\n\\nThis snippet uses [union types](https://www.typescriptlang.org/docs/handbook/advanced-types.html#union-types) to assert that the message in the publisher function can take either a `/rosout` or `/tf` topic. Use an `if`/`else` clause to differentiate between incoming topic datatypes when manipulating messages.\\n\\nTo combine messages from multiple topics, create a variable in your node's global scope to reference every time your publisher function is invoked. Check timestamps to make sure you are not publishing out-of-sync data.\\n\\n```typescript\\nlet lastReceiveTime: Time | null = null;\\nconst myScope: { tf: TfMsg, rosout: RosOutMsg } = { 'tf': null, 'rosout': null };\\n\\nconst publisher = (message: RosOut | Tf): MarkerArray => {\\n  const { receiveTime  } = message;\\n  let inSync = true;\\n  if (receiveTime.sec !== lastReceiveTime.sec || receiveTime.nsec !== lastReceiveTime.nsec) {\\n    lastReceiveTime = receiveTime;\\n    inSync = false;\\n  }\\n\\n  if (message.topic === \\\"/rosout\\\") {\\n    myScope.rosout = message.message;\\n  } else {\\n    myScope.tf = message.message\\n  }\\n\\n  if (!inSync) {\\n    return { markers: [] };\\n  }\\n  ... rest of publishing logic...\\n```\\n\\n## Important Types to Know\\n\\nBy using types to publish your node messages, you can catch errors at compile time, rather than at runtime.\\n\\nThe type definitions below are provided in the Node Playground environment by default, via Webviz's `ros` library.\\n\\n```typescript\\n// RGBA\\ntype RGBA = { // all values are scaled between 0-1 instead of 0-255\\n    r: number,\\n    g: number,\\n    b: number,\\n    a: number // opacity -- typically you should set this to 1.\\n};\\n\\n// Time\\ntype Time = {\\n    sec: number,\\n    nsec: number\\n};\\n\\n// Message\\ntype Message<T> = {\\n  topic: string,\\n  datatype: string,\\n  op: \\\"message\\\",\\n  receiveTime: Time,\\n  message: T,\\n}\\n\\n// Header\\ntype Header = {\\n  frame_id: string,\\n  stamp: Time,\\n};\\n\\n// Point\\ntype Point = {\\n  x: number,\\n  y: number,\\n  z: number\\n};\\n\\n// Scale\\ntype Scale = {\\n  x: number,\\n  y: number,\\n  z: number\\n};\\n\\n// Orientation\\ntype Orientation = {\\n  x: number,\\n  y: number,\\n  z: number,\\n  w: number\\n};\\n\\n// Pose\\ntype Pose = {\\n  position: Point,\\n  orientation: Orientation\\n};\\n\\n// Markers\\n// All marker types build on this base marker type.\\n/**\\n * For publishing markers, every other marker is built up on this base type.\\n * The 'id' property has to be unique, as duplicate ids will cause markers to\\n * be overwritten. The 'ns' property corresponds to namespace under which your\\n * marker is published. In most cases, you will just want to set the 'action'\\n * property to '0'.\\n  */\\ntype BaseMarker = {\\n  header: Header,\\n  ns: string, // namespace that your marker is published under.\\n  id: string | number, // IMPORTANT: Needs to be unique. Duplicate ids will overwrite other markers.\\n  action: 0 | 1 | 2 | 3, // In most cases, you will want to use '0' here.\\n  pose: Pose,\\n  scale: Scale,\\n  color?: RGBA,\\n  customMetadata?: { [key: string]: any }\\n};\\n\\n// MultiPointMarker\\n/**\\n * When publishing markers with a 'points' array, the 'color' field takes 1 RGBA object to apply to all points,\\n * while the 'colors' field takes in an array of RGBA objects to apply to each point. When both are present,\\n * the 'colors' field overrides the 'color' field.\\n  */\\ntype MultiPointMarker = BaseMarker & {\\n  points: Point[],\\n  color?: RGBA,\\n  colors?: RGBA[]\\n};\\n\\n// ArrowMarker\\n/**\\n * When publishing markers with a 'points' array, the 'color' field takes 1 RGBA object to apply to all points,\\n * while the 'colors' field takes in an array of RGBA objects to apply to each point. When both are present,\\n * the 'colors' field overrides the 'color' field.\\n  */\\nexport declare type ArrowMarker = BaseMarker & {\\n  type: 0,\\n  points?: Point[],\\n  size?: ArrowSize,\\n}\\n\\ntype ArrowSize = {\\n  shaftWidth: number,\\n  headLength: number,\\n  headWidth: number\\n};\\n\\n// CubeMarker\\ntype CubeMarker = BaseMarker & {\\n  type: 1\\n};\\n\\n// CubeListMarker\\ntype CubeListMarker = MultiPointMarker & {\\n  type: 6\\n};\\n\\n// SphereMarker\\ntype SphereMarker = BaseMarker & {\\n  type: 2\\n};\\n\\n// SphereListMarker\\ntype SphereListMarker = MultiPointMarker & {\\n  type: 7\\n};\\n\\n// CylinderMarker\\ntype CylinderMarker = BaseMarker & {\\n  type: 3\\n};\\n\\n// LineStripMarker\\ntype LineStripMarker = MultiPointMarker & {\\n  type: 4\\n};\\n\\n// LineListMarker\\ntype LineListMarker = MultiPointMarker & {\\n  type: 5\\n};\\n\\n// PointsMarker\\ntype PointsMarker = MultiPointMarker & {\\n  type: 8\\n};\\n\\n// TextMarker\\ntype TextMarker = BaseMarker & {\\n  type: 9,\\n  text: string\\n};\\n\\n// TriangleListMarker\\ntype TriangleListMarker = MultiPointMarker & {\\n  type: 11\\n};\\n\\n// MeshMarker\\ntype MeshMarker = MultiPointMarker & {\\n  type: 10\\n};\\n\\n// FilledPolygonMarker\\ntype FilledPolygonMarker = MultiPointMarker & {\\n  type: 107\\n};\\n```\\n\\nTo use these predefined type definitions in your Webviz node code, import them from the `ros` library at the top of your code.\\n\\n```typescript\\nimport { RGBA, Header, Message } from 'ros';\\n\\ntype MyCustomMsg = { header: Header, color: RGBA };\\n\\nexport const inputs = [\\\"/some_input\\\"];\\nexport const output = \\\"/webviz_node/\\\";\\n\\ntype Marker = {};\\ntype MarkerArray = {\\n  markers: Marker[]\\n};\\n\\nconst publisher = (message: Message<MyCustomMsg>): MarkerArray => {\\n  return { markers: [] };\\n};\\n\\nexport default publisher;\\n```\\n\\n## Debugging\\n\\nFor easier debugging, invoke `log(someValue)` anywhere in your Webviz node code to print values to the `Logs` section at the bottom of the panel. The only value you cannot `log()` is one that is, or contains, a function definition.\\n\\n```typescript\\nconst add = (a: number, b: number): number => a + b;\\n\\n// NO ERRORS\\nlog(50, \\\"ABC\\\", null, undefined, 5 + 5, { \\\"abc\\\": 2, \\\"def\\\": false }, add(1, 2));\\n\\n// ERRORS\\nlog(() => {});\\nlog(add);\\nlog({ \\\"add\\\": add, \\\"subtract\\\": (a: number, b: number): number => a - b })\\n```\\n\\nInvoking `log()` outside your publisher function will invoke it once, when your node is registered. Invoking `log()` inside your publisher function will log that value every time your publisher function is called.\\n\\n## FAQ\\n\\n> What if I don't want to produce a message every time `publish` is called?\\n\\nAll you need to do is do an early (or late) return in your function body that is hit when you don't want to publish. For instance, let's say you only wanted to publish messages when a constant in the input is _not_ `3`:\\n\\n```typescript\\nimport { Message } from \\\"ros\\\";\\n\\nexport const inputs = [\\\"/state\\\"];\\nexport const output = \\\"/webviz_node/manual_metrics\\\";\\n\\nconst publisher = (msg: Message<{ constant: number }>): { metrics: number } | undefined => {\\n  if (msg.message.constant === 3) {\\n    return;\\n  }\\n  return { /* YOUR DATA HERE */ };\\n};\\n\\nexport default publisher;\\n```\\n\\nNote the union return type in the `publisher` definition. We've indicated to Typescript that this function can return `undefined`, and we do so within the conditional block (In Typescript, if you `return` without a value, it will implicitly return `undefined`). When this code path is hit, we don't publish any message.\\n\"","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport _ from \"lodash\";\nimport React, { useCallback } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport helpContent from \"./index.help.md\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\n\nconst STextArea = styled.textarea`\n  width: 100%;\n  height: 100%;\n  resize: none;\n  border: none;\n  margin: 0;\n  padding: 4px 6px;\n  &:focus {\n    background: rgba(255, 255, 255, 0.1);\n  }\n`;\n\ntype Config = { noteText: string };\ntype Props = { config: Config, saveConfig: SaveConfig<Config> };\nfunction Note({ config, saveConfig }: Props) {\n  const onChangeText = useCallback(\n    (event: SyntheticInputEvent<HTMLTextAreaElement>) => {\n      saveConfig({ noteText: event.target.value });\n    },\n    [saveConfig]\n  );\n\n  return (\n    <Flex col style={{ height: \"100%\" }}>\n      <PanelToolbar helpContent={helpContent} floating />\n      <STextArea placeholder=\"Enter note here\" value={config.noteText} onChange={onChangeText} />\n    </Flex>\n  );\n}\nNote.panelType = \"Note\";\nNote.defaultConfig = { noteText: \"\" };\n\nexport default hot(Panel<Config>(Note));\n","module.exports = \"# Note Panel\\n\\nProvides a place for you to write and save your notes.\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport Flex from \"webviz-core/src/components/Flex\";\nimport MessageHistoryDEPRECATED from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport { type MessagePipelineContext, useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\n\n// Little dummy panel that just shows the number of renders that happen when not subscribing\n// to anything. Useful for debugging performance issues.\nlet panelRenderCount = 0;\nlet messageHistoryRenderCount = 0;\nlet useMessageReducerRenderCount = 0;\nlet messagePipelineRenderCount = 0;\n\nwindow.getNumberOfRendersCountsForTests = function() {\n  return {\n    panelRenderCount,\n    messageHistoryRenderCount,\n    useMessageReducerRenderCount,\n    messagePipelineRenderCount,\n  };\n};\n\nfunction HooksComponent() {\n  PanelAPI.useMessageReducer({\n    topics: [],\n    restore: React.useCallback(() => null, []),\n    addMessage: React.useCallback(() => null, []),\n  });\n  return `useMessageReducerRenderCount: ${++useMessageReducerRenderCount}`;\n}\n\nfunction MessagePipelineRendersComponent() {\n  // This is a private API, so panels should not be using it, but it's still bad if it renders too\n  // much. And in practice there might still be some panels that use it directly. :-(\n  useMessagePipeline<MessagePipelineContext>((context: MessagePipelineContext) => context);\n  return `messagePipelineRenderCount: ${++messagePipelineRenderCount}`;\n}\n\nfunction NumberOfRenders(): React.Node {\n  panelRenderCount++;\n  return (\n    <Flex col>\n      <PanelToolbar />\n      <Flex row center style={{ fontSize: 20, lineHeight: 1.5, textAlign: \"center\" }}>\n        <MessageHistoryDEPRECATED paths={[]}>\n          {() => (\n            <>\n              panelRenderCount: {panelRenderCount} <br />\n              messageHistoryRenderCount: {++messageHistoryRenderCount}\n            </>\n          )}\n        </MessageHistoryDEPRECATED>\n        <br />\n        <HooksComponent />\n        <br />\n        {!inScreenshotTests() && <MessagePipelineRendersComponent /> // Too flakey for screenshots.\n        }\n      </Flex>\n    </Flex>\n  );\n}\n\nNumberOfRenders.panelType = \"NumberOfRenders\";\nNumberOfRenders.defaultConfig = {};\n\nexport default hot(Panel<{}>(NumberOfRenders));\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { last, sumBy } from \"lodash\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { useMessagePipeline } from \"webviz-core/src/components/MessagePipeline\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport { Sparkline, type SparklinePoint } from \"webviz-core/src/components/Sparkline\";\nimport type { PlayerStateActiveData } from \"webviz-core/src/players/types\";\nimport { subtractTimes, toSec } from \"webviz-core/src/util/time\";\n\nconst TIME_RANGE = 5000;\n\ntype PlaybackPerformanceItemProps = {|\n  points: SparklinePoint[],\n  maximum: number,\n  decimalPlaces: number,\n  children: React.Node,\n|};\n\nfunction PlaybackPerformanceItem(props: PlaybackPerformanceItemProps): React.Node {\n  return (\n    <div style={{ margin: 8 }}>\n      <Sparkline points={props.points} maximum={props.maximum} width={100} height={30} timeRange={TIME_RANGE} />\n      <div style={{ display: \"inline-block\", marginLeft: 12, verticalAlign: \"middle\" }}>\n        {(last(props.points) || { value: 0 }).value.toFixed(props.decimalPlaces)}\n        {props.children}\n        <div style={{ color: \"#aaa\" }}>\n          {(sumBy(props.points, \"value\") / props.points.length).toFixed(props.decimalPlaces)} avg\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction PlaybackPerformance(): React.Node {\n  const timestamp = Date.now();\n  const activeData = useMessagePipeline(React.useCallback(({ playerState }) => playerState.activeData, []));\n  const playbackInfo = React.useRef<?{| timestamp: number, activeData: PlayerStateActiveData |}>();\n  const lastPlaybackInfo = playbackInfo.current;\n  if (activeData && (!playbackInfo.current || playbackInfo.current.activeData !== activeData)) {\n    playbackInfo.current = { timestamp: Date.now(), activeData };\n  }\n\n  const perfPoints = React.useRef<{|\n    speed: SparklinePoint[],\n    framerate: SparklinePoint[],\n    bagTimeMs: SparklinePoint[],\n  |}>({\n    speed: [],\n    framerate: [],\n    bagTimeMs: [],\n  });\n\n  if (\n    activeData &&\n    playbackInfo.current &&\n    lastPlaybackInfo &&\n    lastPlaybackInfo.activeData !== activeData &&\n    lastPlaybackInfo.activeData.isPlaying &&\n    activeData.isPlaying &&\n    lastPlaybackInfo.activeData.lastSeekTime === activeData.lastSeekTime &&\n    lastPlaybackInfo.activeData.currentTime !== activeData.currentTime\n  ) {\n    const renderTimeMs = Date.now() - lastPlaybackInfo.timestamp;\n    const bagTimeMs = toSec(subtractTimes(activeData.currentTime, lastPlaybackInfo.activeData.currentTime)) * 1000;\n    perfPoints.current.speed.push({ value: bagTimeMs / renderTimeMs, timestamp });\n    perfPoints.current.framerate.push({ value: 1000 / renderTimeMs, timestamp });\n    perfPoints.current.bagTimeMs.push({ value: bagTimeMs, timestamp });\n    for (const name in perfPoints.current) {\n      const points = perfPoints.current[name];\n      while (points[0] && points[0].timestamp < timestamp - TIME_RANGE) {\n        points.shift();\n      }\n    }\n  }\n\n  return (\n    <Flex col>\n      <PanelToolbar floating />\n      <Flex col wrap center start style={{ lineHeight: 1, whiteSpace: \"nowrap\" }}>\n        <PlaybackPerformanceItem points={perfPoints.current.speed} maximum={1.6} decimalPlaces={2}>\n          &times; realtime\n        </PlaybackPerformanceItem>\n        <PlaybackPerformanceItem points={perfPoints.current.framerate} maximum={30} decimalPlaces={1}>\n          fps\n        </PlaybackPerformanceItem>\n        <PlaybackPerformanceItem points={perfPoints.current.bagTimeMs} maximum={300} decimalPlaces={0}>\n          ms bag frame\n        </PlaybackPerformanceItem>\n      </Flex>\n    </Flex>\n  );\n}\n\nPlaybackPerformance.panelType = \"PlaybackPerformance\";\nPlaybackPerformance.defaultConfig = {};\n\nexport default hot(Panel<{}>(PlaybackPerformance));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { max } from \"lodash\";\nimport * as React from \"react\";\n\nimport AutoSizingCanvas from \"webviz-core/src/components/AutoSizingCanvas\";\n\nexport type SparklinePoint = {| value: number, timestamp: number |};\n\ntype SparklineProps = {|\n  points: SparklinePoint[],\n  width: number,\n  height: number,\n  timeRange: number,\n  maximum?: number,\n  nowStamp?: number, // Mostly for testing.\n|};\n\nfunction draw(\n  points: SparklinePoint[],\n  maximum: number,\n  timeRange: number,\n  nowStamp: number,\n  context: CanvasRenderingContext2D,\n  width: number,\n  height: number\n) {\n  const maxValue = Math.max(maximum, max(points.map(({ value }) => value)));\n  context.clearRect(0, 0, width, height);\n  context.beginPath();\n  context.strokeStyle = \"white\";\n  let first = true;\n  for (const { value, timestamp } of points) {\n    const x = ((timeRange + timestamp - nowStamp) / timeRange) * width;\n    const y = (1 - value / maxValue) * height;\n    if (first) {\n      context.moveTo(x, y);\n      first = false;\n    } else {\n      context.lineTo(x, y);\n    }\n  }\n  context.stroke();\n}\n\nexport function Sparkline(props: SparklineProps) {\n  return (\n    <div\n      style={{\n        display: \"inline-block\",\n        verticalAlign: \"-10px\",\n        backgroundColor: \"#333\",\n        width: props.width,\n        height: props.height,\n      }}>\n      <AutoSizingCanvas\n        draw={(context: CanvasRenderingContext2D, width: number, height: number) => {\n          draw(props.points, props.maximum || 0, props.timeRange, props.nowStamp || Date.now(), context, width, height);\n        }}\n      />\n    </div>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport buildSampleMessage from \"./buildSampleMessage\";\nimport { PanelToolbarInput, PanelToolbarLabel } from \"webviz-core/shared/panelToolbarStyles\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Item from \"webviz-core/src/components/Menu/Item\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport Publisher from \"webviz-core/src/components/Publisher\";\nimport { PlayerCapabilities, type Topic } from \"webviz-core/src/players/types\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\n\ntype Config = {|\n  topicName: string,\n  datatype: string,\n  buttonText: string,\n  buttonTooltip: string,\n  buttonColor: string,\n  advancedView: boolean,\n  value: string,\n|};\n\ntype Props = {\n  config: Config,\n  saveConfig: ($Shape<Config>) => void,\n\n  // player state\n  capabilities: string[],\n  topics: Topic[],\n  datatypes: RosDatatypes,\n};\n\ntype PanelState = {|\n  cachedProps: $Shape<Props>,\n  datatypeNames: string[],\n  parsedObject: ?any,\n  error: ?string,\n|};\n\nconst STextArea = styled.textarea`\n  width: 100%;\n  height: 100%;\n  resize: none;\n`;\n\nconst STextAreaContainer = styled.div`\n  flex-grow: 1;\n  padding: 12px 0;\n`;\n\nconst SErrorText = styled.div`\n  flex: 1 1 auto;\n  display: flex;\n  align-items: center;\n  padding: 4px;\n  color: ${colors.red};\n`;\n\nconst SSpan = styled.span`\n  opacity: 0.8;\n`;\nconst SRow = styled.div`\n  display: flex;\n  line-height: 24px;\n  flex-shrink: 0;\n`;\n\nfunction getTopicName(topic: Topic): string {\n  return topic.name;\n}\n\nfunction parseInput(value: string): $Shape<PanelState> {\n  let parsedObject;\n  let error = null;\n  try {\n    const parsedAny = JSON.parse(value);\n    if (Array.isArray(parsedAny)) {\n      error = \"Message content must be an object, not an array\";\n    } else if (parsedAny === null) {\n      error = \"Message content must be an object, not null\";\n    } else if (typeof parsedAny !== \"object\") {\n      error = `Message content must be an object, not ‘${typeof parsedAny}’`;\n    } else {\n      parsedObject = parsedAny;\n    }\n  } catch (e) {\n    error = value ? e.message : \"\";\n  }\n  return { error, parsedObject };\n}\n\nclass Publish extends React.PureComponent<Props, PanelState> {\n  static panelType = \"Publish\";\n  static defaultConfig = {\n    topicName: \"\",\n    datatype: \"\",\n    buttonText: \"Publish\",\n    buttonTooltip: \"\",\n    buttonColor: \"#00A871\",\n    advancedView: true,\n    value: \"\",\n  };\n\n  _publisher = React.createRef<Publisher>();\n\n  state = {\n    cachedProps: {},\n    datatypeNames: [],\n    error: null,\n    parsedObject: undefined,\n  };\n\n  static getDerivedStateFromProps(props: Props, state: PanelState) {\n    const newState: $Shape<PanelState> = parseInput(props.config.value);\n    let changed = false;\n\n    if (props !== state.cachedProps) {\n      newState.cachedProps = props;\n      changed = true;\n    }\n\n    if (props.datatypes !== state.cachedProps.datatypes) {\n      newState.datatypeNames = Object.keys(props.datatypes).sort();\n      changed = true;\n    }\n\n    // when the selected datatype changes, replace the textarea contents with a sample message of the correct shape\n    // Make sure not to build a sample message on first load, though -- we don't want to overwrite\n    // the user's message just because state.cachedProps.config hasn't been initialized.\n    if (\n      props.config.datatype &&\n      state.cachedProps?.config?.datatype != null &&\n      props.config.datatype !== state.cachedProps?.config?.datatype &&\n      props.datatypes[props.config.datatype] != null\n    ) {\n      const sampleMessage = buildSampleMessage(props.datatypes, props.config.datatype);\n      if (sampleMessage) {\n        const stringifiedSampleMessage = JSON.stringify(sampleMessage, null, 2);\n        props.saveConfig({ value: stringifiedSampleMessage });\n        changed = true;\n      }\n    }\n\n    return changed ? newState : null;\n  }\n\n  _onChangeTopic = (event, topicName: string) => {\n    this.props.saveConfig({ topicName });\n  };\n\n  // when a known topic is selected, also fill in its datatype\n  _onSelectTopic = (topicName: string, topic: Topic, autocomplete: Autocomplete) => {\n    this.props.saveConfig({ topicName, datatype: topic.datatype });\n    autocomplete.blur();\n  };\n\n  _onSelectDatatype = (datatype: string, value: any, autocomplete: Autocomplete) => {\n    this.props.saveConfig({ datatype });\n    autocomplete.blur();\n  };\n\n  _publish = () => {\n    const { topicName } = this.props.config;\n    const { parsedObject } = this.state;\n    if (topicName && parsedObject && this._publisher.current) {\n      this._publisher.current.publish(parsedObject);\n    } else {\n      throw new Error(`called _publish() when input was invalid`);\n    }\n  };\n\n  _onChange = (event: SyntheticInputEvent<HTMLTextAreaElement>) => {\n    this.props.saveConfig({ value: event.target.value });\n  };\n\n  _renderMenuContent() {\n    const { config, saveConfig } = this.props;\n\n    return (\n      <>\n        <Item\n          icon={config.advancedView ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n          onClick={() => {\n            saveConfig({ advancedView: !config.advancedView });\n          }}>\n          <span>Advanced mode</span>\n        </Item>\n        <Item>\n          <PanelToolbarLabel>Button text</PanelToolbarLabel>\n          <PanelToolbarInput\n            type=\"text\"\n            value={config.buttonText}\n            onChange={(event) => {\n              saveConfig({ buttonText: event.target.value });\n            }}\n            placeholder=\"Publish\"\n          />\n        </Item>\n        <Item>\n          <PanelToolbarLabel>Button tooltip</PanelToolbarLabel>\n          <PanelToolbarInput\n            type=\"text\"\n            value={config.buttonTooltip}\n            onChange={(event) => {\n              saveConfig({ buttonTooltip: event.target.value });\n            }}\n          />\n        </Item>\n        <Item>\n          <PanelToolbarLabel>Button color (rgba or hex)</PanelToolbarLabel>\n          <PanelToolbarInput\n            type=\"text\"\n            value={config.buttonColor}\n            onChange={(event) => {\n              saveConfig({ buttonColor: event.target.value });\n            }}\n            placeholder=\"rgba(1,1,1,1) or #FFFFFF\"\n          />\n        </Item>\n      </>\n    );\n  }\n\n  render() {\n    const {\n      capabilities,\n      topics,\n      config: { topicName, datatype, buttonText, buttonTooltip, buttonColor, advancedView, value },\n    } = this.props;\n\n    const { datatypeNames, parsedObject, error } = this.state;\n    const canPublish = capabilities.includes(PlayerCapabilities.advertise);\n    const buttonRowStyle = advancedView ? { flex: \"0 0 auto\" } : { flex: \"0 0 auto\", justifyContent: \"center\" };\n\n    return (\n      <Flex col style={{ height: \"100%\", padding: \"12px\" }}>\n        {topicName && datatype && (\n          <Publisher ref={this._publisher} name=\"Publish\" topic={topicName} datatype={datatype} />\n        )}\n        <PanelToolbar floating menuContent={this._renderMenuContent()} />\n        {advancedView && (\n          <SRow>\n            <SSpan>Topic:</SSpan>\n            <Autocomplete\n              placeholder=\"Choose a topic\"\n              items={topics}\n              hasError={false}\n              onChange={this._onChangeTopic}\n              onSelect={this._onSelectTopic}\n              selectedItem={{ name: topicName }}\n              getItemText={getTopicName}\n              getItemValue={getTopicName}\n            />\n          </SRow>\n        )}\n        {advancedView && (\n          <SRow>\n            <PanelToolbarLabel>Datatype:</PanelToolbarLabel>\n            <Autocomplete\n              clearOnFocus\n              placeholder=\"Choose a datatype\"\n              items={datatypeNames}\n              onSelect={this._onSelectDatatype}\n              selectedItem={datatype}\n            />\n          </SRow>\n        )}\n        {advancedView && (\n          <STextAreaContainer>\n            <STextArea placeholder=\"Enter message content as JSON\" value={value || \"\"} onChange={this._onChange} />\n          </STextAreaContainer>\n        )}\n        <Flex row style={buttonRowStyle}>\n          {error && <SErrorText>{error}</SErrorText>}\n          <Button\n            style={canPublish ? { backgroundColor: buttonColor } : {}}\n            tooltip={canPublish ? buttonTooltip : \"Connect to ROS to publish data\"}\n            disabled={!canPublish || !parsedObject}\n            primary={canPublish && !!parsedObject}\n            onClick={this._publish}>\n            {buttonText}\n          </Button>\n        </Flex>\n      </Flex>\n    );\n  }\n}\n\nexport default hot(Panel<Config>(Publish));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { RosDatatypes } from \"webviz-core/src/types/RosDatatypes\";\n\nexport const builtinSampleValues = {\n  bool: false,\n  int8: 0,\n  uint8: 0,\n  int16: 0,\n  uint16: 0,\n  int32: 0,\n  uint32: 0,\n  int64: 0,\n  uint64: 0,\n  float32: 0,\n  float64: 0,\n  string: \"\",\n  time: { sec: 0, nsec: 0 },\n  duration: { sec: 0, nsec: 0 },\n};\n\nexport default function buildSampleMessage(datatypes: RosDatatypes, datatype: string): ?any {\n  const builtin = builtinSampleValues[datatype];\n  if (builtin != null) {\n    return builtin;\n  }\n  const fields = datatypes[datatype].fields;\n  if (!fields) {\n    return null;\n  }\n  const obj = {};\n  for (const field of fields) {\n    if (field.isConstant) {\n      continue;\n    }\n    const sample = buildSampleMessage(datatypes, field.type);\n    if (field.isArray) {\n      if (field.arrayLength != null) {\n        obj[field.name] = new Array(field.arrayLength).fill(sample);\n      } else {\n        obj[field.name] = [sample];\n      }\n    } else {\n      obj[field.name] = sample;\n    }\n  }\n  return obj;\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport * as React from \"react\";\nimport uuid from \"uuid\";\n\nimport { MessagePipelineConsumer, type MessagePipelineContext } from \"webviz-core/src/components/MessagePipeline\";\n\ntype Props = {|\n  topic: string,\n  datatype: string,\n  name: string,\n|};\n\n// Component that registers a publisher with the player and provides a publish() function to publish data.\nexport default class Publisher extends React.PureComponent<Props> {\n  _id: string = uuid.v4();\n  _context: ?MessagePipelineContext;\n\n  _getContext(): MessagePipelineContext {\n    if (!this._context) {\n      throw new Error(\"this._context is missing in <Publisher>\");\n    }\n    return this._context;\n  }\n\n  _setPublishers() {\n    const { topic, datatype, name } = this.props;\n    this._getContext().setPublishers(this._id, [{ topic, datatype, advertiser: { type: \"panel\", name } }]);\n  }\n\n  componentDidMount() {\n    this._setPublishers();\n  }\n\n  componentDidUpdate() {\n    this._setPublishers();\n  }\n\n  componentWillUnmount() {\n    this._getContext().setPublishers(this._id, []);\n  }\n\n  publish(msg: any) {\n    const { topic } = this.props;\n    this._getContext().publish({ topic, msg });\n  }\n\n  render() {\n    return (\n      <MessagePipelineConsumer>\n        {(context: MessagePipelineContext) => {\n          this._context = context;\n          return null;\n        }}\n      </MessagePipelineConsumer>\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ClipboardOutlineIcon from \"@mdi/svg/svg/clipboard-outline.svg\";\nimport cx from \"classnames\";\nimport React, { PureComponent } from \"react\";\nimport { hot } from \"react-hot-loader/root\";\nimport { Creatable as ReactSelectCreatable } from \"react-select\";\nimport VirtualizedSelect from \"react-virtualized-select\";\nimport { createSelector } from \"reselect\";\n\nimport helpContent from \"./index.help.md\";\nimport styles from \"./index.module.scss\";\nimport LevelToString, { KNOWN_LOG_LEVELS } from \"./LevelToString\";\nimport LogMessage from \"./LogMessage\";\nimport logStyle from \"./LogMessage.module.scss\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport LogList from \"webviz-core/src/components/LogList\";\nimport MessageHistoryDEPRECATED, {\n  type MessageHistoryData,\n  type MessageHistoryItem,\n} from \"webviz-core/src/components/MessageHistoryDEPRECATED\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport TopicToRenderMenu from \"webviz-core/src/components/TopicToRenderMenu\";\nimport type { Message, Topic } from \"webviz-core/src/players/types\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\nimport { ROSOUT_TOPIC } from \"webviz-core/src/util/globalConstants\";\n\n// Remove creatable warning https://github.com/JedWatson/react-select/issues/2181\nclass Creatable extends React.Component<{}, {}> {\n  render() {\n    return <ReactSelectCreatable {...this.props} />;\n  }\n}\n\ntype Option = {\n  value: any,\n  label: string,\n};\n\ntype Config = {\n  searchTerms: string[],\n  minLogLevel: number,\n  topicToRender: string,\n};\n\ntype Props = {\n  config: Config,\n  saveConfig: (Config) => void,\n  topics: Topic[],\n};\n\n// Create the log level options nodes once since they don't change per render.\nconst LOG_LEVEL_OPTIONS = KNOWN_LOG_LEVELS.map((level) => ({\n  label: `>= ${LevelToString(level)}`,\n  value: level,\n}));\n\n// Persist the identity of selectedOptions for React Creatable.\n// Without it, we can't create new options.\nexport const stringsToOptions = createSelector<*, *, *, _>(\n  (strs: string[]) => strs,\n  (strs: string[]): Option[] => strs.map((value) => ({ label: value, value }))\n);\n\nexport const getShouldDisplayMsg = (msg: Message, minLogLevel: number, searchTerms: string[]): boolean => {\n  if (msg.message.level < minLogLevel) {\n    return false;\n  }\n\n  if (searchTerms.length < 1) {\n    // No search term filters so this message should be visible.\n    return true;\n  }\n  const searchTermsInLowerCase = searchTerms.map((term) => term.toLowerCase());\n  for (const searchTerm of searchTermsInLowerCase) {\n    if (msg.message.name.toLowerCase().includes(searchTerm) || msg.message.msg.toLowerCase().includes(searchTerm)) {\n      return true;\n    }\n  }\n  return false;\n};\n\nclass RosoutPanel extends PureComponent<Props> {\n  static defaultConfig = { searchTerms: [], minLogLevel: 1, topicToRender: ROSOUT_TOPIC };\n  static panelType = \"RosOut\";\n\n  _onNodeFilterChange = (selectedOptions: Option[]) => {\n    this.props.saveConfig({ ...this.props.config, searchTerms: selectedOptions.map((option) => option.value) });\n  };\n\n  _onLogLevelChange = (minLogLevel: number) => {\n    this.props.saveConfig({ ...this.props.config, minLogLevel });\n  };\n\n  _filterFn = (item: MessageHistoryItem) =>\n    getShouldDisplayMsg(item.message, this.props.config.minLogLevel, this.props.config.searchTerms);\n\n  _getFilteredMessages(items: MessageHistoryItem[]): MessageHistoryItem[] {\n    const { minLogLevel, searchTerms } = this.props.config;\n    const hasActiveFilters = minLogLevel > 1 || searchTerms.length > 0;\n    if (!hasActiveFilters) {\n      // This early return avoids looping over the full list with a filter that will always return true.\n      return items;\n    }\n    return items.filter(this._filterFn);\n  }\n\n  _renderFiltersBar = (seenNodeNames: Set<string>, msgs: MessageHistoryItem[]) => {\n    const { minLogLevel, searchTerms } = this.props.config;\n    const nodeNameOptions = Array.from(seenNodeNames).map((name) => ({ label: name, value: name }));\n\n    return (\n      <div className={styles.filtersBar}>\n        <VirtualizedSelect\n          className={cx(styles.severityFilter)}\n          clearable={false}\n          searchable={false}\n          value={minLogLevel}\n          optionHeight={parseInt(styles.optionHeight)}\n          maxHeight={parseInt(styles.optionHeight) * KNOWN_LOG_LEVELS.length}\n          options={LOG_LEVEL_OPTIONS}\n          optionRenderer={({ key, style: styleProp, option, selectValue, focusedOption }) => (\n            <div\n              className={cx(logStyle[LevelToString(option.value).toLowerCase()], \"VirtualizedSelectOption\", {\n                VirtualizedSelectFocusedOption: focusedOption === option,\n              })}\n              style={styleProp}\n              onClick={() => this._onLogLevelChange(option.value)}\n              key={key}>\n              {option.label}\n            </div>\n          )}\n          valueComponent={(option) => <span>{`Min Severity: ${LevelToString(option.value.value)}`}</span>}\n        />\n        <VirtualizedSelect\n          className={styles.nodeFilter}\n          clearable\n          multi\n          closeOnSelect={false}\n          value={stringsToOptions(searchTerms)}\n          onChange={this._onNodeFilterChange}\n          options={nodeNameOptions}\n          optionHeight={parseInt(styles.optionHeight)}\n          placeholder=\"Filter by node name or message text\"\n          searchable\n          selectComponent={Creatable}\n          promptTextCreator={(label) => `Node names or msgs containing \"${label}\"`}\n        />\n        <div className={styles.itemsCountField}>\n          {msgs.length} {msgs.length === 1 ? \"item\" : \"items\"}\n          <Icon\n            style={{ padding: \"1px 0px 0px 6px\" }}\n            onClick={() => {\n              clipboard.copy(JSON.stringify(msgs, null, 2));\n            }}\n            tooltip=\"Copy rosout to clipboard\">\n            <ClipboardOutlineIcon />\n          </Icon>\n        </div>\n      </div>\n    );\n  };\n  _renderRow({ item, style, key, index }) {\n    return (\n      <div key={key} style={index === 0 ? { ...style, paddingTop: 36 } : style}>\n        <LogMessage msg={item.message.message} />\n      </div>\n    );\n  }\n\n  render() {\n    const { topics, config } = this.props;\n    const seenNodeNames = new Set();\n\n    const topicToRenderMenu = (\n      <TopicToRenderMenu\n        topicToRender={config.topicToRender}\n        onChange={(topicToRender) => this.props.saveConfig({ ...this.props.config, topicToRender })}\n        topics={topics}\n        singleTopicDatatype=\"rosgraph_msgs/Log\"\n        defaultTopicToRender={ROSOUT_TOPIC}\n      />\n    );\n\n    return (\n      <MessageHistoryDEPRECATED paths={[config.topicToRender]} historySize={100000}>\n        {({ itemsByPath }: MessageHistoryData) => {\n          const msgs: MessageHistoryItem[] = itemsByPath[config.topicToRender];\n          msgs.forEach((msg) => seenNodeNames.add(msg.message.message.name));\n\n          return (\n            <Flex col>\n              <PanelToolbar floating helpContent={helpContent} additionalIcons={topicToRenderMenu}>\n                {this._renderFiltersBar(seenNodeNames, msgs)}\n              </PanelToolbar>\n              <div className={styles.content}>\n                <LogList items={this._getFilteredMessages(msgs)} renderRow={this._renderRow} />\n              </div>\n            </Flex>\n          );\n        }}\n      </MessageHistoryDEPRECATED>\n    );\n  }\n}\n\nexport default hot(Panel<Config>(RosoutPanel));\n","module.exports = \"# rosout\\n\\nDisplays messages from the `/rosout` topic. The messages can be filtered using the filter dropdowns at the top of the panel. These hide away when unused, so you need to hover over the top section of the panel to reveal them. There are two filtering options:\\n\\n- Minimum Severity: The left dropdown lets you choose a severity below which to hide messages.\\n- Node Name/Message: The text field lets you add search terms by which to filter the log messages. The filter applies to both node names and message text.\\n\\nNode name and message filters are \\\"OR\\\"ed, so if you have two, it'll show messages that meet either. The severity is an \\\"AND\\\" with the node names / messages &mdash; if a message is below the minimum severity, it won't show up regardless of matching the name or content.\\n\"","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"singleton\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--14-oneOf-0!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/lib/loader.js??ref--16!./index.module.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"div.Select-menu-outer {\\n  background-color: #2d2c33;\\n  border-radius: 4px;\\n  padding: 0;\\n  -webkit-box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n          box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  -ms-flex-negative: 0;\\n      flex-shrink: 0; }\\n\\n.VirtualizedSelectOption {\\n  text-decoration: none;\\n  padding: 8px 12px;\\n  cursor: pointer;\\n  color: rgba(247, 247, 243, 0.77);\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n      -ms-user-select: none;\\n          user-select: none;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-align: center;\\n      align-items: center; }\\n\\n.VirtualizedSelectSelectedOption {\\n  color: rgba(247, 247, 243, 0.77);\\n  background-color: rgba(59, 46, 118, 0.6); }\\n\\n.VirtualizedSelectOption:hover, .VirtualizedSelectFocusedOption {\\n  background-color: #3b2e76;\\n  color: rgba(247, 247, 243, 0.77); }\\n\\n.packages-webviz-core-src-panels-Rosout-index-module-4nshd--content {\\n  font-family: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n  -ms-flex: 1 1 auto;\\n      flex: 1 1 auto;\\n  display: -ms-flexbox;\\n  display: flex;\\n  position: relative; }\\n\\n.packages-webviz-core-src-panels-Rosout-index-module-42gh9--filtersBar {\\n  background-color: #2d2c33;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-wrap: wrap;\\n      flex-wrap: wrap;\\n  -ms-flex: 1 1 auto;\\n      flex: 1 1 auto;\\n  left: 0;\\n  width: 100%; }\\n\\n.packages-webviz-core-src-panels-Rosout-index-module-2nczq--severityFilter {\\n  -ms-flex: 0 1 auto;\\n      flex: 0 1 auto;\\n  min-width: 120px;\\n  margin-left: 10px;\\n  width: unset !important; }\\n\\n.packages-webviz-core-src-panels-Rosout-index-module-3tekj--nodeFilter {\\n  -ms-flex: 2 1 auto;\\n      flex: 2 1 auto;\\n  min-width: 200px;\\n  width: unset !important; }\\n\\n.packages-webviz-core-src-panels-Rosout-index-module-hu4fx--itemsCountField {\\n  display: -ms-flexbox;\\n  display: flex;\\n  -ms-flex-align: center;\\n      align-items: center;\\n  border-radius: 4px;\\n  color: rgba(255, 255, 255, 0.5);\\n  padding: 0px 8px; }\\n\\n {\\n  /**\\n * React Select\\n * ============\\n * Created by Jed Watson and Joss Mackison for KeystoneJS, http://www.keystonejs.com/\\n * https://twitter.com/jedwatson https://twitter.com/jossmackison https://twitter.com/keystonejs\\n * MIT License: https://github.com/JedWatson/react-select\\n*/\\n  /* Collection default theme */\\n  /* Grid default theme */\\n  /* Table default theme */\\n  /* List default theme */\\n  /*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvdXJjZS9zdHlsZXMuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDhCQUE4Qjs7QUFFOUI7Q0FDQzs7QUFFRDtDQUNDOztBQUVELHdCQUF3Qjs7QUFFeEI7Q0FDQzs7QUFFRDtDQUNDOztBQUVELHlCQUF5Qjs7QUFFekI7Q0FDQzs7QUFFRDtDQUNDOztBQUVEO0VBQ0UsaUJBQWlCO0VBQ2pCLDBCQUEwQjtFQUMxQixxQkFBYztFQUFkLHFCQUFjO0VBQWQsY0FBYztFQUNkLCtCQUFvQjtFQUFwQiw4QkFBb0I7TUFBcEIsd0JBQW9CO1VBQXBCLG9CQUFvQjtFQUNwQiwwQkFBb0I7TUFBcEIsdUJBQW9CO1VBQXBCLG9CQUFvQjtDQUNyQjtBQUNEO0VBQ0UscUJBQWM7RUFBZCxxQkFBYztFQUFkLGNBQWM7RUFDZCwrQkFBb0I7RUFBcEIsOEJBQW9CO01BQXBCLHdCQUFvQjtVQUFwQixvQkFBb0I7RUFDcEIsMEJBQW9CO01BQXBCLHVCQUFvQjtVQUFwQixvQkFBb0I7Q0FDckI7O0FBRUQ7RUFDRSxzQkFBc0I7RUFDdEIsZ0JBQWdCO0VBQ2hCLG9CQUFvQjtFQUNwQix3QkFBd0I7RUFDeEIsaUJBQWlCO0NBQ2xCOztBQUVEOztFQUVFLG1CQUFtQjtFQUNuQixlQUFlO0NBQ2hCO0FBQ0Q7RUFDRSx3QkFBd0I7RUFDeEIsb0JBQW9CO0NBQ3JCOztBQUVEOztFQUVFLGtCQUFrQjtDQUNuQjtBQUNEO0VBQ0UsZ0JBQWdCO0NBQ2pCOztBQUVEO0VBQ0UscUJBQWM7RUFBZCxxQkFBYztFQUFkLGNBQWM7RUFDZCwwQkFBb0I7TUFBcEIsdUJBQW9CO1VBQXBCLG9CQUFvQjtDQUNyQjtBQUNEO0VBQ0Usb0JBQWU7TUFBZixtQkFBZTtVQUFmLGVBQWU7RUFDZixZQUFZO0VBQ1osV0FBVztFQUNYLG1CQUFtQjtDQUNwQjs7QUFFRCx3QkFBd0I7O0FBRXhCO0NBQ0MiLCJmaWxlIjoic3R5bGVzLmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIENvbGxlY3Rpb24gZGVmYXVsdCB0aGVtZSAqL1xuXG4uUmVhY3RWaXJ0dWFsaXplZF9fQ29sbGVjdGlvbiB7XG59XG5cbi5SZWFjdFZpcnR1YWxpemVkX19Db2xsZWN0aW9uX19pbm5lclNjcm9sbENvbnRhaW5lciB7XG59XG5cbi8qIEdyaWQgZGVmYXVsdCB0aGVtZSAqL1xuXG4uUmVhY3RWaXJ0dWFsaXplZF9fR3JpZCB7XG59XG5cbi5SZWFjdFZpcnR1YWxpemVkX19HcmlkX19pbm5lclNjcm9sbENvbnRhaW5lciB7XG59XG5cbi8qIFRhYmxlIGRlZmF1bHQgdGhlbWUgKi9cblxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlIHtcbn1cblxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19HcmlkIHtcbn1cblxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19oZWFkZXJSb3cge1xuICBmb250LXdlaWdodDogNzAwO1xuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xufVxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19yb3cge1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xufVxuXG4uUmVhY3RWaXJ0dWFsaXplZF9fVGFibGVfX2hlYWRlclRydW5jYXRlZFRleHQge1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIG1heC13aWR0aDogMTAwJTtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gIG92ZXJmbG93OiBoaWRkZW47XG59XG5cbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9faGVhZGVyQ29sdW1uLFxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19yb3dDb2x1bW4ge1xuICBtYXJnaW4tcmlnaHQ6IDEwcHg7XG4gIG1pbi13aWR0aDogMHB4O1xufVxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19yb3dDb2x1bW4ge1xuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbn1cblxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19oZWFkZXJDb2x1bW46Zmlyc3Qtb2YtdHlwZSxcbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9fcm93Q29sdW1uOmZpcnN0LW9mLXR5cGUge1xuICBtYXJnaW4tbGVmdDogMTBweDtcbn1cbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9fc29ydGFibGVIZWFkZXJDb2x1bW4ge1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9fc29ydGFibGVIZWFkZXJJY29uQ29udGFpbmVyIHtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbn1cbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9fc29ydGFibGVIZWFkZXJJY29uIHtcbiAgZmxleDogMCAwIDI0cHg7XG4gIGhlaWdodDogMWVtO1xuICB3aWR0aDogMWVtO1xuICBmaWxsOiBjdXJyZW50Q29sb3I7XG59XG5cbi8qIExpc3QgZGVmYXVsdCB0aGVtZSAqL1xuXG4uUmVhY3RWaXJ0dWFsaXplZF9fTGlzdCB7XG59XG4iXX0= */ }\\n  div.Select-menu {\\n    padding-bottom: 5em !important; }\\n  .Select-control {\\n    font-size: 12px; }\\n    .Select-control .Select-clear {\\n      line-height: 24px;\\n      font-size: 18px; }\\n\\n@keyframes packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin {\\n  to {\\n    -webkit-transform: rotate(1turn);\\n            transform: rotate(1turn); } }\\n\\n@-webkit-keyframes packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin {\\n  to {\\n    -webkit-transform: rotate(1turn); } }\\n  .Select {\\n    position: relative; }\\n    .Select input::-webkit-contacts-auto-fill-button,\\n    .Select input::-webkit-credentials-auto-fill-button {\\n      display: none !important; }\\n    .Select input::-ms-clear {\\n      display: none !important; }\\n    .Select input::-ms-reveal {\\n      display: none !important; }\\n    .Select,\\n    .Select div,\\n    .Select input,\\n    .Select span {\\n      -webkit-box-sizing: border-box;\\n      box-sizing: border-box; }\\n    .Select.is-disabled .Select-arrow-zone {\\n      cursor: default;\\n      pointer-events: none; }\\n    .Select.is-disabled > .Select-control {\\n      background-color: #f9f9f9; }\\n      .Select.is-disabled > .Select-control:hover {\\n        -webkit-box-shadow: none;\\n                box-shadow: none; }\\n    .Select.is-searchable.is-open > .Select-control {\\n      cursor: text; }\\n    .Select.is-searchable.is-focused:not(.is-open) > .Select-control {\\n      cursor: text; }\\n    .Select.is-open > .Select-control {\\n      border-bottom-right-radius: 0;\\n      border-bottom-left-radius: 0;\\n      background: #2d2c33;\\n      border-color: rgba(0, 0, 0, 0) transparent rgba(13, 13, 13, 0); }\\n      .Select.is-open > .Select-control .Select-arrow {\\n        top: -2px;\\n        border-color: transparent transparent rgba(247, 247, 243, 0.77);\\n        border-width: 0 5px 5px; }\\n    .Select.is-focused > .Select-control {\\n      background: #2d2c33; }\\n    .Select.is-focused:not(.is-open) > .Select-control {\\n      border-color: transparent rgba(13, 13, 13, 0) rgba(13, 13, 13, 0);\\n      -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1), 0 0 5px -1px fade(transparent, 50%);\\n              box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1), 0 0 5px -1px fade(transparent, 50%); }\\n    .Select.has-value.is-clearable.Select--single > .Select-control .Select-value {\\n      padding-right: 38px; }\\n    .Select.has-value.Select--single > .Select-control .Select-value .Select-value-label,\\n    .Select.has-value.is-pseudo-focused.Select--single > .Select-control .Select-value .Select-value-label {\\n      color: rgba(247, 247, 243, 0.77); }\\n    .Select.has-value.Select--single > .Select-control .Select-value a.Select-value-label,\\n    .Select.has-value.is-pseudo-focused.Select--single > .Select-control .Select-value a.Select-value-label {\\n      cursor: pointer;\\n      text-decoration: none; }\\n      .Select.has-value.Select--single > .Select-control .Select-value a.Select-value-label:hover, .Select.has-value.Select--single > .Select-control .Select-value a.Select-value-label:focus,\\n      .Select.has-value.is-pseudo-focused.Select--single > .Select-control .Select-value a.Select-value-label:hover,\\n      .Select.has-value.is-pseudo-focused.Select--single > .Select-control .Select-value a.Select-value-label:focus {\\n        color: transparent;\\n        outline: none;\\n        text-decoration: underline; }\\n      .Select.has-value.Select--single > .Select-control .Select-value a.Select-value-label:focus,\\n      .Select.has-value.is-pseudo-focused.Select--single > .Select-control .Select-value a.Select-value-label:focus {\\n        background: #2d2c33; }\\n    .Select.has-value.is-pseudo-focused .Select-input {\\n      opacity: 0; }\\n    .Select.is-open .Select-arrow,\\n    .Select .Select-arrow-zone:hover > .Select-arrow {\\n      border-top-color: #666; }\\n    .Select.Select--rtl {\\n      direction: rtl;\\n      text-align: right; }\\n  .Select-control {\\n    background-color: #2d2c33;\\n    border-color: rgba(13, 13, 13, 0) transparent rgba(0, 0, 0, 0);\\n    border-radius: 4px;\\n    border: 1px solid transparent;\\n    color: rgba(247, 247, 243, 0.77);\\n    cursor: default;\\n    display: table;\\n    border-spacing: 0;\\n    border-collapse: separate;\\n    height: 24px;\\n    outline: none;\\n    overflow: hidden;\\n    position: relative;\\n    width: 100%; }\\n    .Select-control:hover {\\n      -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.06);\\n              box-shadow: 0 1px 0 rgba(0, 0, 0, 0.06); }\\n    .Select-control .Select-input:focus {\\n      outline: none;\\n      background: #2d2c33; }\\n  .Select-placeholder,\\n  .Select--single > .Select-control .Select-value {\\n    bottom: 0;\\n    color: rgba(247, 247, 243, 0.27);\\n    left: 0;\\n    line-height: 26px;\\n    padding-left: 10px;\\n    padding-right: 10px;\\n    position: absolute;\\n    right: 0;\\n    top: 0;\\n    max-width: 100%;\\n    overflow: hidden;\\n    -o-text-overflow: ellipsis;\\n       text-overflow: ellipsis;\\n    white-space: nowrap; }\\n  .Select-input {\\n    height: 26px;\\n    padding-left: 10px;\\n    padding-right: 10px;\\n    vertical-align: middle; }\\n    .Select-input > input {\\n      width: 100%;\\n      background: none transparent;\\n      border: 0 none;\\n      -webkit-box-shadow: none;\\n              box-shadow: none;\\n      cursor: default;\\n      display: inline-block;\\n      font-family: inherit;\\n      font-size: inherit;\\n      margin: 0;\\n      outline: none;\\n      line-height: 17px;\\n      /* For IE 8 compatibility */\\n      padding: 4px 0 8px;\\n      /* For IE 8 compatibility */\\n      -webkit-appearance: none; }\\n      .packages-webviz-core-src-panels-Rosout-index-module-jr6wb--is-focused .Select-input > input {\\n        cursor: text; }\\n  .Select-control:not(.is-searchable) > .Select-input {\\n    outline: none; }\\n  .Select-loading-zone {\\n    cursor: pointer;\\n    display: table-cell;\\n    position: relative;\\n    text-align: center;\\n    vertical-align: middle;\\n    width: 16px; }\\n  .Select-loading {\\n    -webkit-animation: Select-animation-spin 400ms infinite linear;\\n    animation: Select-animation-spin 400ms infinite linear;\\n    width: 16px;\\n    height: 16px;\\n    -webkit-box-sizing: border-box;\\n            box-sizing: border-box;\\n    border-radius: 50%;\\n    border: 2px solid transparent;\\n    border-right-color: rgba(247, 247, 243, 0.77);\\n    display: inline-block;\\n    position: relative;\\n    vertical-align: middle; }\\n  .Select-clear-zone {\\n    -webkit-animation: Select-animation-fadeIn 200ms;\\n    animation: Select-animation-fadeIn 200ms;\\n    color: rgba(247, 247, 243, 0.77);\\n    cursor: pointer;\\n    display: table-cell;\\n    position: relative;\\n    text-align: center;\\n    vertical-align: middle;\\n    width: 13px; }\\n    .Select-clear-zone:hover {\\n      color: #D0021B; }\\n  .Select-clear {\\n    display: inline-block;\\n    font-size: 12px;\\n    line-height: 1; }\\n  .Select--multi .Select-clear-zone {\\n    width: 13px; }\\n  .Select--multi .Select-multi-value-wrapper {\\n    display: inline-block; }\\n  .Select .Select-aria-only {\\n    position: absolute;\\n    display: inline-block;\\n    height: 1px;\\n    width: 1px;\\n    margin: -1px;\\n    clip: rect(0, 0, 0, 0);\\n    overflow: hidden;\\n    float: left; }\\n  .Select-arrow-zone {\\n    cursor: pointer;\\n    display: table-cell;\\n    position: relative;\\n    text-align: center;\\n    vertical-align: middle;\\n    width: 25px;\\n    padding-right: 5px; }\\n    .packages-webviz-core-src-panels-Rosout-index-module-33x8g--Select--rtl .Select-arrow-zone {\\n      padding-right: 0;\\n      padding-left: 5px; }\\n  .Select-arrow {\\n    border-color: rgba(247, 247, 243, 0.77) transparent transparent;\\n    border-style: solid;\\n    border-width: 5px 5px 2.5px;\\n    display: inline-block;\\n    height: 0;\\n    width: 0;\\n    position: relative; }\\n\\n@-webkit-keyframes packages-webviz-core-src-panels-Rosout-index-module-2xhh8--Select-animation-fadeIn {\\n  from {\\n    opacity: 0; }\\n  to {\\n    opacity: 1; } }\\n\\n@keyframes packages-webviz-core-src-panels-Rosout-index-module-2xhh8--Select-animation-fadeIn {\\n  from {\\n    opacity: 0; }\\n  to {\\n    opacity: 1; } }\\n  .Select-menu-outer {\\n    border-bottom-right-radius: 4px;\\n    border-bottom-left-radius: 4px;\\n    background-color: #2d2c33;\\n    border: 1px solid transparent;\\n    border-top-color: rgba(45, 44, 51, 0.5);\\n    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.06);\\n            box-shadow: 0 1px 0 rgba(0, 0, 0, 0.06);\\n    -webkit-box-sizing: border-box;\\n            box-sizing: border-box;\\n    margin-top: -1px;\\n    max-height: 200px;\\n    position: absolute;\\n    left: 0;\\n    top: 100%;\\n    width: 100%;\\n    z-index: 1000;\\n    -webkit-overflow-scrolling: touch; }\\n  .Select-menu {\\n    max-height: 198px;\\n    overflow-y: auto; }\\n  .Select-option {\\n    -webkit-box-sizing: border-box;\\n            box-sizing: border-box;\\n    background-color: red;\\n    color: rgba(255, 255, 255, 0.77);\\n    cursor: pointer;\\n    display: block;\\n    padding: 8px 10px; }\\n    .Select-option:last-child {\\n      border-bottom-right-radius: 4px;\\n      border-bottom-left-radius: 4px; }\\n    .Select-option.is-selected {\\n      background-color: #f5faff;\\n      color: rgba(247, 247, 243, 0.77); }\\n    .Select-option.is-focused {\\n      background-color: #f2f9fc;\\n      color: rgba(247, 247, 243, 0.77); }\\n    .Select-option.is-disabled {\\n      color: rgba(255, 255, 255, 0.77);\\n      cursor: default; }\\n  .Select-noresults {\\n    -webkit-box-sizing: border-box;\\n            box-sizing: border-box;\\n    color: rgba(255, 255, 255, 0.77);\\n    cursor: default;\\n    display: block;\\n    padding: 8px 10px; }\\n  .Select--multi .Select-input {\\n    vertical-align: middle;\\n    margin-left: 10px;\\n    padding: 0; }\\n  .Select--multi.Select--rtl .Select-input {\\n    margin-left: 0;\\n    margin-right: 10px; }\\n  .Select--multi.has-value .Select-input {\\n    margin-left: 5px; }\\n  .Select--multi .Select-value {\\n    background-color: #f2f9fc;\\n    border-radius: 2px;\\n    border: 1px solid #c9e6f2;\\n    color: #08c;\\n    display: inline-block;\\n    font-size: 12px;\\n    margin-left: 5px;\\n    margin-top: 5px;\\n    vertical-align: top; }\\n  .Select--multi .Select-value-icon,\\n  .Select--multi .Select-value-label {\\n    display: inline-block;\\n    vertical-align: middle; }\\n  .Select--multi .Select-value-label {\\n    border-bottom-right-radius: 2px;\\n    border-top-right-radius: 2px;\\n    cursor: default;\\n    padding: 2px 5px; }\\n  .Select--multi a.Select-value-label {\\n    color: #08c;\\n    cursor: pointer;\\n    text-decoration: none; }\\n    .Select--multi a.Select-value-label:hover {\\n      text-decoration: underline; }\\n  .Select--multi .Select-value-icon {\\n    cursor: pointer;\\n    border-bottom-left-radius: 2px;\\n    border-top-left-radius: 2px;\\n    border-right: 1px solid #c9e6f2;\\n    padding: 1px 5px 3px; }\\n    .Select--multi .Select-value-icon:hover, .Select--multi .Select-value-icon:focus {\\n      background-color: #ddeff7;\\n      color: #0077b3; }\\n    .Select--multi .Select-value-icon:active {\\n      background-color: #c9e6f2; }\\n  .Select--multi.Select--rtl .Select-value {\\n    margin-left: 0;\\n    margin-right: 5px; }\\n  .Select--multi.Select--rtl .Select-value-icon {\\n    border-right: none;\\n    border-left: 1px solid #c9e6f2; }\\n  .Select--multi.is-disabled .Select-value {\\n    background-color: #fcfcfc;\\n    border: 1px solid #e3e3e3;\\n    color: #333; }\\n  .Select--multi.is-disabled .Select-value-icon {\\n    cursor: not-allowed;\\n    border-right: 1px solid #e3e3e3; }\\n    .Select--multi.is-disabled .Select-value-icon:hover, .Select--multi.is-disabled .Select-value-icon:focus, .Select--multi.is-disabled .Select-value-icon:active {\\n      background-color: #fcfcfc; }\\n\\n@keyframes packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin {\\n  to {\\n    -webkit-transform: rotate(1turn);\\n            transform: rotate(1turn); } }\\n\\n@-webkit-keyframes packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin {\\n  to {\\n    -webkit-transform: rotate(1turn); } }\\n  .ReactVirtualized__Table__headerRow {\\n    font-weight: 700;\\n    text-transform: uppercase;\\n    display: -ms-flexbox;\\n    display: flex;\\n    -ms-flex-direction: row;\\n    flex-direction: row;\\n    -ms-flex-align: center;\\n    align-items: center; }\\n  .ReactVirtualized__Table__row {\\n    display: -ms-flexbox;\\n    display: flex;\\n    -ms-flex-direction: row;\\n    flex-direction: row;\\n    -ms-flex-align: center;\\n    align-items: center; }\\n  .ReactVirtualized__Table__headerTruncatedText {\\n    display: inline-block;\\n    max-width: 100%;\\n    white-space: nowrap;\\n    -o-text-overflow: ellipsis;\\n       text-overflow: ellipsis;\\n    overflow: hidden; }\\n  .ReactVirtualized__Table__headerColumn,\\n  .ReactVirtualized__Table__rowColumn {\\n    margin-right: 10px;\\n    min-width: 0px; }\\n  .ReactVirtualized__Table__rowColumn {\\n    -o-text-overflow: ellipsis;\\n       text-overflow: ellipsis;\\n    white-space: nowrap; }\\n  .ReactVirtualized__Table__headerColumn:first-of-type,\\n  .ReactVirtualized__Table__rowColumn:first-of-type {\\n    margin-left: 10px; }\\n  .ReactVirtualized__Table__sortableHeaderColumn {\\n    cursor: pointer; }\\n  .ReactVirtualized__Table__sortableHeaderIconContainer {\\n    display: -ms-flexbox;\\n    display: flex;\\n    -ms-flex-align: center;\\n    align-items: center; }\\n  .ReactVirtualized__Table__sortableHeaderIcon {\\n    -ms-flex: 0 0 24px;\\n    flex: 0 0 24px;\\n    height: 1em;\\n    width: 1em;\\n    fill: currentColor; }\\n  .VirtualizedSelectFocusedOption {\\n    background-color: #3b2e76 !important; }\\n  .Select {\\n    width: 100%; }\\n  .Select-input > input {\\n    color: rgba(247, 247, 243, 0.77); }\\n  .Select-multi-value-wrapper {\\n    display: table-cell;\\n    position: relative; }\\n  .Select--multi .Select-multi-value-wrapper {\\n    width: 100%; }\\n  .Select--multi .Select-arrow {\\n    opacity: 0.5; }\\n  .Select--multi .Select-value {\\n    color: rgba(247, 247, 243, 0.88);\\n    background-color: rgba(59, 46, 118, 0.6);\\n    border: 1px solid rgba(247, 247, 243, 0.1);\\n    margin: 2px; }\\n  .Select--multi .Select-value-icon {\\n    display: -ms-inline-flexbox;\\n    display: inline-flex;\\n    -ms-flex-align: center;\\n        align-items: center;\\n    padding: 0 0 0 4px;\\n    opacity: 0.5;\\n    border: 0; }\\n    .Select--multi .Select-value-icon:hover {\\n      color: inherit;\\n      background-color: transparent;\\n      opacity: 1; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/Rosout/index.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/mixins.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\",\"/home/circleci/project/packages/webviz-core/node_modules/react-select/scss/select.scss\",\"/home/circleci/project/packages/webviz-core/node_modules/react-virtualized/styles.css\",\"/home/circleci/project/packages/webviz-core/node_modules/react-select/scss/spinner.scss\",\"/home/circleci/project/packages/webviz-core/node_modules/react-select/scss/control.scss\",\"/home/circleci/project/packages/webviz-core/node_modules/react-select/scss/mixins.scss\",\"/home/circleci/project/packages/webviz-core/node_modules/react-select/scss/menu.scss\",\"/home/circleci/project/packages/webviz-core/node_modules/react-select/scss/multi.scss\"],\"names\":[],\"mappings\":\"AAqDA;EC1BE,0BCUe;EDTf,mBAAkB;EAClB,WAAU;EACV,iFAAwE;UAAxE,yEAAwE;EACxE,iBAAgB;EAChB,qBAAoB;EACpB,qBAAc;MAAd,eAAc,EACf;;ADmBD;EChBE,sBAAqB;EACrB,kBA5ByC;EA6BzC,gBAAe;EACf,iCC1BqC;ED2BrC,0BAAiB;KAAjB,uBAAiB;MAAjB,sBAAiB;UAAjB,kBAAiB;EACjB,qBAAa;EAAb,cAAa;EACb,uBAAmB;MAAnB,oBAAmB,EAKpB;;ADKD;ECcE,iCCrDqC;EDuDrC,yCC7DkD,ED8DnD;;ADjBD;ECoBE,0BC/CuB;EDgDvB,iCC5DqC,ED6DtC;;AD3DD;ECsEE,kFAFmF;EDlEnF,mBAAc;MAAd,eAAc;EACd,qBAAa;EAAb,cAAa;EACb,mBAAkB,EACnB;;AAED;EACE,0BEae;EFZf,qBAAa;EAAb,cAAa;EACb,oBAAe;MAAf,gBAAe;EACf,mBAAc;MAAd,eAAc;EACd,QAAO;EACP,YAAW,EACZ;;AAED;EACE,mBAAc;MAAd,eAAc;EACd,iBAAgB;EAChB,kBAAiB;EACjB,wBAAuB,EACxB;;AAED;EACE,mBAAc;MAAd,eAAc;EACd,iBAAgB;EAChB,wBAAuB,EACxB;;AAED;EACE,qBAAa;EAAb,cAAa;EACb,uBAAmB;MAAnB,oBAAmB;EACnB,mBAAkB;EAClB,gCAA+B;EAC/B,iBAAgB,EACjB;;AAED;EGrDA;;;;;;EAME;ECNF,8BAA8B;EAQ9B,wBAAwB;EAQxB,yBAAyB;EA8EzB,wBAAwB;EAKxB,qqGAAqqG,EJ8BpqG;EA5ED;IAKI,+BAA8B,EAC/B;EANH;IAQI,gBCpDY,EDyDb;IAbH;MAUM,kBAAkC;MAClC,gBAAkC,EACnC;;AK/CL;EACC;IAAK,iCAAwB;YAAxB,yBAAwB,EAAA,EAAA;;AAE9B;EACC;IAAK,iCAAgC,EAAA,EAAA;EL+BtC;IM7CC,mBAAkB,EA6GlB;INhED;;MMxCE,yBAAwB,EACxB;INuCF;MMrCE,yBAAwB,EACxB;INoCF;MMlCE,yBAAwB,EACxB;INiCF;;;;MOLC,+BDrB+B;MCuB/B,uBDvB+B,EAC9B;INyBF;MMpBG,gBAAe;MACf,qBAAoB,EACpB;INkBH;MMfG,0BHzBwC,EG6BxC;MNWH;QMbI,yBAAgB;gBAAhB,iBAAgB,EAChB;INYJ;MMNG,aAAY,EACZ;INKH;MMFG,aAAY,EACZ;INCH;MOzBC,8BD4BiC;MC3BjC,6BD2BiC;MAChC,oBJpBe;MIqBf,+DAAwH,EAQxH;MNbF;QMSG,UAAS;QACT,gEJjDoC;QIkDpC,wBHVoC,EGWpC;INZH;MMgBE,oBJhCe,EIiCf;INjBF;MMoBE,kEAAwH;MACxH,4FHxDwH;cGwDxH,oFHxDwH,EGyDxH;INtBF;MM0BE,oBAA8D,EAC9D;IN3BF;;MMgCG,iCJvEoC,EIwEpC;INjCH;;MMmCG,gBAAe;MACf,sBAAqB,EAYrB;MNhDH;;;QMwCI,mBNvBqC;QMwBrC,cAAa;QACb,2BAA0B,EAC1B;MN3CJ;;QM8CI,oBJ9Da,EI+Db;IN/CJ;MMqDE,WAAU,EACV;INtDF;;MM0DE,uBH1DsC,EG2DtC;IN3DF;MM6DE,eAAc;MACd,kBAAiB,EACjB;EN/DF;IMqEC,0BJrFgB;IIsFhB,+DAAwH;IACxH,mBH5GsC;IG6GtC,8BNxDwC;IMyDxC,iCJhHsC;IIiHtC,gBAAe;IACf,eAAc;IACd,kBAAiB;IACjB,0BAAyB;IACzB,aN5D2C;IM6D3C,cAAa;IACb,iBAAgB;IAChB,mBAAkB;IAClB,YAAW,EAUX;IN5FD;MMqFE,gDHjH6D;cGiH7D,wCHjH6D,EGkH7D;INtFF;MMyFE,cAAa;MACb,oBJ1Ge,EI2Gf;EN3FF;;IMiGC,UAAS;IACT,iCN7E8D;IM8E9D,QAAO;IACP,kBNjFoC;IMkFpC,mBH9HuC;IG+HvC,oBH/HuC;IGgIvC,mBAAkB;IAClB,SAAQ;IACR,OAAM;IAGN,gBAAe;IACf,iBAAgB;IAChB,2BAAuB;OAAvB,wBAAuB;IACvB,oBAAmB,EACnB;ENhHD;IMuHC,aNpGoC;IMqGpC,mBHjJuC;IGkJvC,oBHlJuC;IGmJvC,uBAAsB,EAwBtB;INlJD;MM6HE,YAAW;MACX,6BAA4B;MAC5B,eAAc;MACd,yBAAgB;cAAhB,iBAAgB;MAChB,gBAAe;MACf,sBAAqB;MACrB,qBAAoB;MACpB,mBAAkB;MAElB,UAAS;MACT,cAAa;MAEb,kBAAiB;MAAG,4BAA4B;MAChD,mBAAwG;MAAG,4BAA4B;MACvI,yBAAwB,EAKxB;MAHA;QACC,aAAY,EACZ;EN/IH;IMsJC,cAAa,EACb;ENvJD;IM2JC,gBAAe;IACf,oBAAmB;IACnB,mBAAkB;IAClB,mBAAkB;IAClB,uBAAsB;IACtB,YH5JuC,EG6JvC;ENjKD;IOXC,+DFnC+D;IEqC/D,uDFrC+D;IEE/D,YJgDuC;II/CvC,aJ+CuC;IEhDvC,+BAAsB;YAAtB,uBAAsB;IACtB,mBAAkB;IAClB,8BL0DwC;IKzDxC,8CHEsC;IGDtC,sBAAqB;IACrB,mBAAkB;IC2MlB,uBAAsB,EACtB;ENrKD;IOXC,iDDsLiD;ICpLjD,yCDoLiD;IACjD,iCJnNsC;IIoNtC,gBAAe;IACf,oBAAmB;IACnB,mBAAkB;IAClB,mBAAkB;IAClB,uBAAsB;IACtB,YHtLsE,EG2LtE;INvLD;MMqLE,eH1LyC,EG2LzC;ENtLF;IMyLC,sBAAqB;IACrB,gBHjMoE;IGkMpE,eAAc,EACd;EN5LD;IM8LC,YHlMsE,EGmMtE;EN/LD;IMkME,sBAAqB,EACtB;ENnMD;IMqMC,mBAAkB;IAClB,sBAAqB;IACrB,YAAW;IACX,WAAU;IACV,aAAY;IACZ,uBAAmB;IACnB,iBAAgB;IAChB,YAAW,EACX;EN7MD;IMmNC,gBAAe;IACf,oBAAmB;IACnB,mBAAkB;IAClB,mBAAkB;IAClB,uBAAsB;IACtB,YAAgC;IAChC,mBHxNsC,EG8NtC;IAJA;MACC,iBAAgB;MAChB,kBH5NqC,EG6NrC;EN9NF;IMkOC,gEAAyD;IACzD,oBAAmB;IACnB,4BAA+E;IAC/E,sBAAqB;IACrB,UAAS;IACT,SAAQ;IACR,mBAAkB,EAClB;;AAUD;EACC;IAAO,WAAU,EAAA;EACjB;IAAK,WAAU,EAAA,EAAA;;AAEhB;EACC;IAAO,WAAU,EAAA;EACjB;IAAK,WAAU,EAAA,EAAA;ENzPhB;IOzBC,gCJZsC;IIatC,+BJbsC;IKHtC,0BNwBgB;IMvBhB,8BRuDwC;IQtDxC,wCAAwE;IACxE,gDLS8D;YKT9D,wCLS8D;IKR9D,+BAAsB;YAAtB,uBAAsB;IACtB,iBAAgB;IAChB,kBLawC;IKZxC,mBAAkB;IAClB,QAAO;IACP,UAAS;IACT,YAAW;IACX,cLOuC;IKNvC,kCAAiC,EACjC;ER2BD;IQrBC,kBAA2C;IAC3C,iBAAgB,EAChB;ERmBD;IQbC,+BAAsB;YAAtB,uBAAsB;IACtB,sBRkCuB;IQjCvB,iCLPmE;IKQnE,gBAAe;IACf,eAAc;IACd,kBLjBuC,EKsCvC;IRbD;MOzBC,gCJZsC;MIatC,+BJbsC,EKiCrC;IRIF;MQDE,0BLZyC;MKazC,iCNvCqC,EMwCrC;IRDF;MQIE,0BLnByC;MKoBzC,iCN5CqC,EM6CrC;IRNF;MQSE,iCLrBkE;MKsBlE,gBAAe,EACf;ERXF;IQmBC,+BAAsB;YAAtB,uBAAsB;IACtB,iCL9BmE;IK+BnE,gBAAe;IACf,eAAc;IACd,kBLhDuC,EKiDvC;ERxBD;IS1CE,uBAAsB;IAEtB,kBNesC;IMdtC,WAAU,EACV;ETsCF;ISpCE,eAAc;IACd,mBNUsC,EMTtC;ETkCF;IS9BE,iBNwCqC,EMvCrC;ET6BF;ISzBE,0BNwCyC;IMvCzC,mBNiCqC;IMhCrC,0BNuC8D;IMtC9D,YNoCsC;IMnCtC,sBAAqB;IACrB,gBRxBc;IQyBd,iBN6BqC;IM5BrC,gBN4BqC;IM3BrC,oBAAmB,EACnB;ETgBF;;ISXE,sBAAqB;IACrB,uBAAsB,EACtB;ETSF;IO9BC,gCJuCsC;IItCtC,6BJsCsC;IMbrC,gBAAe;IACf,iBNeqC,EMdrC;ETEF;ISAE,YNcsC;IMbtC,gBAAe;IACf,sBAAqB,EAKrB;ITPF;MSKG,2BAA0B,EAC1B;ETNH;ISWE,gBAAe;IF/BhB,+BJ6BsC;II5BtC,4BJ4BsC;IMIrC,gCNG8D;IMA9D,qBAAgH,EAUhH;IT1BF;MSoBG,0BNF4D;MMG5D,eNJ+D,EMK/D;ITtBH;MSwBG,0BNR6D,EMS7D;ETzBH;IS8BI,eAAc;IACd,kBNrBmC,EMsBpC;EThCH;ISkCG,mBAAkB;IAClB,+BNnB6D,EMoB7D;ETpCH;IS0CE,0BNtByC;IMuBzC,0BNtBuE;IMuBvE,YNzBsC,EM0BtC;ET7CF;ISgDE,oBAAmB;IACnB,gCN5BuE,EMmCvE;ITxDF;MSsDG,0BNlCwC,EMmCxC;;AJ1FH;EACC;IAAK,iCAAwB;YAAxB,yBAAwB,EAAA,EAAA;;AAE9B;EACC;IAAK,iCAAgC,EAAA,EAAA;EL+BtC;II5BE,iBAAgB;IAChB,0BAAyB;IAEzB,qBAAoB;IACpB,cAAa;IAGT,wBAAuB;IACnB,oBAAmB;IAEvB,uBAAsB;IAClB,oBAAmB,EAC5B;EJgBD;IIbE,qBAAoB;IACpB,cAAa;IAGT,wBAAuB;IACnB,oBAAmB;IAEvB,uBAAsB;IAClB,oBAAmB,EAC5B;EJID;IIDE,sBAAqB;IACrB,gBAAe;IACf,oBAAmB;IACnB,2BAAuB;OAAvB,wBAAuB;IACvB,iBAAgB,EACjB;EJJD;;IIQE,mBAAkB;IAClB,eAAc,EACf;EJVD;IIYE,2BAAuB;OAAvB,wBAAuB;IACvB,oBAAmB,EACpB;EJdD;;IIkBE,kBAAiB,EAClB;EJnBD;IIqBE,gBAAe,EAChB;EJtBD;II0BE,qBAAoB;IACpB,cAAa;IAET,uBAAsB;IAClB,oBAAmB,EAC5B;EJ/BD;IIkCM,mBAAkB;IACd,eAAc;IACtB,YAAW;IACX,WAAU;IACV,mBAAkB,EACnB;EJvCD;IAwCI,qCAA6C,EAC9C;EAzCH;IA2CI,YAAW,EACZ;EA5CH;IA8CI,iCErFmC,EFsFpC;EA/CH;IAiDI,oBAAmB;IACnB,mBAAkB,EACnB;EAnDH;IAqDI,YAAW,EACZ;EAtDH;IAwDI,aAAY,EACb;EAzDH;IA2DI,iCEnGmC;IFoGnC,yCEzGgD;IF0GhD,2CE3GyC;IF4GzC,YAAW,EACZ;EA/DH;IAiEI,4BAAoB;IAApB,qBAAoB;IACpB,uBAAmB;QAAnB,oBAAmB;IACnB,mBAAkB;IAClB,aAAY;IACZ,UAAS,EAMV;IA3EH;MAuEM,eAAc;MACd,8BAA6B;MAC7B,WAAU,EACX\",\"file\":\"index.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/mixins.module.scss\\\";\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n$option-height: 24;\\n$option-font-size: $text-size;\\n\\n:export {\\n  optionHeight: $option-height;\\n}\\n\\n.content {\\n  @include monospace;\\n  flex: 1 1 auto;\\n  display: flex;\\n  position: relative;\\n}\\n\\n.filtersBar {\\n  background-color: $toolbar;\\n  display: flex;\\n  flex-wrap: wrap;\\n  flex: 1 1 auto;\\n  left: 0;\\n  width: 100%;\\n}\\n\\n.severityFilter {\\n  flex: 0 1 auto;\\n  min-width: 120px;\\n  margin-left: 10px;\\n  width: unset !important;\\n}\\n\\n.nodeFilter {\\n  flex: 2 1 auto;\\n  min-width: 200px;\\n  width: unset !important;\\n}\\n\\n.itemsCountField {\\n  display: flex;\\n  align-items: center;\\n  border-radius: 4px;\\n  color: rgba(255, 255, 255, 0.5);\\n  padding: 0px 8px;\\n}\\n\\n:global {\\n  div.Select-menu-outer {\\n    @extend %floating-box;\\n  }\\n  div.Select-menu {\\n    padding-bottom: 5em !important; // TODO(jacob): not working when there are enough items to scroll?\\n  }\\n  .Select-control {\\n    font-size: $option-font-size;\\n    .Select-clear {\\n      line-height: $option-font-size * 2;\\n      font-size: $option-font-size * 1.5;\\n    }\\n  }\\n  $select-item-font-size: $option-font-size;\\n  $select-input-bg: $toolbar;\\n  $select-input-border-color: transparent;\\n  $select-input-border-focus: transparent;\\n  $select-input-height: $option-height * 1px;\\n  $select-input-internal-height: 26px;\\n  $select-text-color: $text-control;\\n  $select-input-placeholder: transparentize($text-control, 0.5);\\n  $select-option-bg: red;\\n  $select-clear-color: $text-control;\\n  $select-loading-color: $text-control;\\n  $select-arrow-color: $text-control;\\n\\n  @import \\\"~react-select/scss/default\\\";\\n  @import \\\"~react-virtualized/styles\\\";\\n  // @import '~react-virtualized-select/styles';\\n\\n  .VirtualizedSelectOption {\\n    @extend %menu-item;\\n  }\\n  .VirtualizedSelectSelectedOption {\\n    @extend %menu-item-active;\\n  }\\n  .VirtualizedSelectFocusedOption {\\n    @extend %menu-item-hover;\\n    // TODO(jacob): doesn't override react-virtualized-select styles for some reason\\n    background-color: $menu-item-hover !important;\\n  }\\n  .Select {\\n    width: 100%;\\n  }\\n  .Select-input > input {\\n    color: $select-text-color;\\n  }\\n  .Select-multi-value-wrapper {\\n    display: table-cell;\\n    position: relative;\\n  }\\n  .Select--multi .Select-multi-value-wrapper {\\n    width: 100%;\\n  }\\n  .Select--multi .Select-arrow {\\n    opacity: 0.5;\\n  }\\n  .Select--multi .Select-value {\\n    color: $text-bright;\\n    background-color: $background-control-selected;\\n    border: 1px solid $background-control;\\n    margin: 2px;\\n  }\\n  .Select--multi .Select-value-icon {\\n    display: inline-flex;\\n    align-items: center;\\n    padding: 0 0 0 4px;\\n    opacity: 0.5;\\n    border: 0;\\n    &:hover {\\n      color: inherit;\\n      background-color: transparent;\\n      opacity: 1;\\n    }\\n  }\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"./colors.module.scss\\\";\\n\\n$padding: 8px;\\n$text-size: 12px;\\n$control-padding: $padding ($padding + 4px);\\n$control-margin: 0 0.2em;\\n\\n%bold {\\n  font-weight: bold;\\n  letter-spacing: 0.4px;\\n}\\n\\n%floating-box-close-icon {\\n  position: absolute;\\n  right: 7px;\\n  top: 7px;\\n  cursor: pointer;\\n  font-size: 16px;\\n}\\n\\n%floating-box {\\n  background-color: $toolbar;\\n  border-radius: 4px;\\n  padding: 0;\\n  box-shadow: 0 6px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(0, 0, 0, 0.25);\\n  overflow: hidden;\\n  pointer-events: auto;\\n  flex-shrink: 0;\\n}\\n\\n%menu-item {\\n  text-decoration: none;\\n  padding: $control-padding;\\n  cursor: pointer;\\n  color: $text-control;\\n  user-select: none;\\n  display: flex;\\n  align-items: center;\\n\\n  &:hover {\\n    @extend %menu-item-hover;\\n  }\\n}\\n\\n%modal-subtitle {\\n  color: $text-bright;\\n  font-size: 16px;\\n  line-height: 16px * 1.25;\\n}\\n\\n%clearfix {\\n  &:after {\\n    content: \\\" \\\";\\n    visibility: hidden;\\n    display: block;\\n    height: 0;\\n    clear: both;\\n  }\\n}\\n\\n%menu-item-active {\\n  color: $text-normal;\\n  // @extend %bold;\\n  background-color: $background-control-selected;\\n}\\n\\n%menu-item-hover {\\n  background-color: $menu-item-hover;\\n  color: $text-normal;\\n}\\n\\n$sans-serif-font: \\\"Inter UI\\\", -apple-system, BlinkMacSystemFont, sans-serif;\\n\\n@mixin sans-serif {\\n  font-family: $sans-serif-font;\\n  font-feature-settings: \\\"tnum\\\";\\n}\\n\\n$monospace-font: \\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace;\\n@mixin monospace {\\n  font-family: $monospace-font;\\n}\\n\\n%list-item-icon {\\n  margin-right: 4px;\\n  svg {\\n    font-size: 16px;\\n    position: relative;\\n    top: -1px;\\n  }\\n}\\n\\n:export {\\n  monospaceFont: $monospace-font;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\",\"/**\\n * React Select\\n * ============\\n * Created by Jed Watson and Joss Mackison for KeystoneJS, http://www.keystonejs.com/\\n * https://twitter.com/jedwatson https://twitter.com/jossmackison https://twitter.com/keystonejs\\n * MIT License: https://github.com/JedWatson/react-select\\n*/\\n\\n// Variables\\n// ------------------------------\\n\\n// control options\\n$select-input-bg:                   #fff !default;\\n$select-input-bg-disabled:          #f9f9f9 !default;\\n$select-input-bg-focus:             $select-input-bg !default;\\n$select-input-border-color:         #ccc !default;\\n$select-input-border-radius:        4px !default;\\n$select-input-border-focus:         #08c !default; // blue\\n$select-input-box-shadow-focus:     inset 0 1px 2px rgba(0, 0, 0, 0.1), 0 0 5px -1px fade($select-input-border-focus, 50%) !default;\\n$select-input-border-width:         1px !default;\\n$select-input-height:               36px !default;\\n$select-input-internal-height:      ($select-input-height - ($select-input-border-width * 2)) !default;\\n$select-input-placeholder:          #aaa !default;\\n$select-text-color:                 #333 !default;\\n$select-link-hover-color:           $select-input-border-focus !default;\\n$select-input-hover-box-shadow:     0 1px 0 rgba(0, 0, 0, 0.06) !default;\\n\\n$select-padding-vertical:           8px !default;\\n$select-padding-horizontal:         10px !default;\\n\\n// menu options\\n$select-menu-zindex:                1000 !default;\\n$select-menu-max-height:            200px !default;\\n$select-menu-box-shadow:            $select-input-hover-box-shadow !default;\\n\\n$select-option-color:               lighten($select-text-color, 20%) !default;\\n$select-option-bg:                  $select-input-bg !default;\\n$select-option-focused-color:       $select-text-color !default;\\n$select-option-focused-bg:          #f2f9fc !default; // pale blue\\n$select-option-selected-color:      $select-text-color !default;\\n$select-option-selected-bg:         #f5faff !default; // lightest blue\\n$select-option-disabled-color:      lighten($select-text-color, 60%) !default;\\n\\n$select-noresults-color:            lighten($select-text-color, 40%) !default;\\n\\n// clear \\\"x\\\" button\\n$select-clear-size:                 floor(($select-input-height / 2)) !default;\\n$select-clear-color:                #999 !default;\\n$select-clear-hover-color:          #D0021B !default; // red\\n$select-clear-width:                ($select-input-internal-height / 2) !default;\\n\\n// arrow indicator\\n$select-arrow-color:                #999 !default;\\n$select-arrow-color-hover:          #666 !default;\\n$select-arrow-width:                5px !default;\\n\\n// loading indicator\\n$select-loading-size:               16px !default;\\n$select-loading-color:              $select-text-color !default;\\n$select-loading-color-bg:           $select-input-border-color !default;\\n\\n// multi-select item\\n$select-item-border-radius:         2px !default;\\n$select-item-gutter:                5px !default;\\n$select-item-padding-vertical:      2px !default;\\n$select-item-padding-horizontal:    5px !default;\\n$select-item-font-size:             .9em !default;\\n$select-item-color:                 #08c !default; // pale blue\\n$select-item-bg:                    #f2f9fc !default;\\n$select-item-border-color:          darken($select-item-bg, 10%) !default;\\n$select-item-hover-color:           darken($select-item-color, 5%) !default; // pale blue\\n$select-item-hover-bg:              darken($select-item-bg, 5%) !default;\\n$select-item-disabled-color:        #333 !default;\\n$select-item-disabled-bg:           #fcfcfc !default;\\n$select-item-disabled-border-color: darken($select-item-disabled-bg, 10%) !default;\\n\",\"/* Collection default theme */\\n\\n.ReactVirtualized__Collection {\\n}\\n\\n.ReactVirtualized__Collection__innerScrollContainer {\\n}\\n\\n/* Grid default theme */\\n\\n.ReactVirtualized__Grid {\\n}\\n\\n.ReactVirtualized__Grid__innerScrollContainer {\\n}\\n\\n/* Table default theme */\\n\\n.ReactVirtualized__Table {\\n}\\n\\n.ReactVirtualized__Table__Grid {\\n}\\n\\n.ReactVirtualized__Table__headerRow {\\n  font-weight: 700;\\n  text-transform: uppercase;\\n  display: -webkit-box;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -webkit-box-orient: horizontal;\\n  -webkit-box-direction: normal;\\n      -ms-flex-direction: row;\\n          flex-direction: row;\\n  -webkit-box-align: center;\\n      -ms-flex-align: center;\\n          align-items: center;\\n}\\n.ReactVirtualized__Table__row {\\n  display: -webkit-box;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -webkit-box-orient: horizontal;\\n  -webkit-box-direction: normal;\\n      -ms-flex-direction: row;\\n          flex-direction: row;\\n  -webkit-box-align: center;\\n      -ms-flex-align: center;\\n          align-items: center;\\n}\\n\\n.ReactVirtualized__Table__headerTruncatedText {\\n  display: inline-block;\\n  max-width: 100%;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n}\\n\\n.ReactVirtualized__Table__headerColumn,\\n.ReactVirtualized__Table__rowColumn {\\n  margin-right: 10px;\\n  min-width: 0px;\\n}\\n.ReactVirtualized__Table__rowColumn {\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n}\\n\\n.ReactVirtualized__Table__headerColumn:first-of-type,\\n.ReactVirtualized__Table__rowColumn:first-of-type {\\n  margin-left: 10px;\\n}\\n.ReactVirtualized__Table__sortableHeaderColumn {\\n  cursor: pointer;\\n}\\n\\n.ReactVirtualized__Table__sortableHeaderIconContainer {\\n  display: -webkit-box;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -webkit-box-align: center;\\n      -ms-flex-align: center;\\n          align-items: center;\\n}\\n.ReactVirtualized__Table__sortableHeaderIcon {\\n  -webkit-box-flex: 0;\\n      -ms-flex: 0 0 24px;\\n          flex: 0 0 24px;\\n  height: 1em;\\n  width: 1em;\\n  fill: currentColor;\\n}\\n\\n/* List default theme */\\n\\n.ReactVirtualized__List {\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvdXJjZS9zdHlsZXMuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDhCQUE4Qjs7QUFFOUI7Q0FDQzs7QUFFRDtDQUNDOztBQUVELHdCQUF3Qjs7QUFFeEI7Q0FDQzs7QUFFRDtDQUNDOztBQUVELHlCQUF5Qjs7QUFFekI7Q0FDQzs7QUFFRDtDQUNDOztBQUVEO0VBQ0UsaUJBQWlCO0VBQ2pCLDBCQUEwQjtFQUMxQixxQkFBYztFQUFkLHFCQUFjO0VBQWQsY0FBYztFQUNkLCtCQUFvQjtFQUFwQiw4QkFBb0I7TUFBcEIsd0JBQW9CO1VBQXBCLG9CQUFvQjtFQUNwQiwwQkFBb0I7TUFBcEIsdUJBQW9CO1VBQXBCLG9CQUFvQjtDQUNyQjtBQUNEO0VBQ0UscUJBQWM7RUFBZCxxQkFBYztFQUFkLGNBQWM7RUFDZCwrQkFBb0I7RUFBcEIsOEJBQW9CO01BQXBCLHdCQUFvQjtVQUFwQixvQkFBb0I7RUFDcEIsMEJBQW9CO01BQXBCLHVCQUFvQjtVQUFwQixvQkFBb0I7Q0FDckI7O0FBRUQ7RUFDRSxzQkFBc0I7RUFDdEIsZ0JBQWdCO0VBQ2hCLG9CQUFvQjtFQUNwQix3QkFBd0I7RUFDeEIsaUJBQWlCO0NBQ2xCOztBQUVEOztFQUVFLG1CQUFtQjtFQUNuQixlQUFlO0NBQ2hCO0FBQ0Q7RUFDRSx3QkFBd0I7RUFDeEIsb0JBQW9CO0NBQ3JCOztBQUVEOztFQUVFLGtCQUFrQjtDQUNuQjtBQUNEO0VBQ0UsZ0JBQWdCO0NBQ2pCOztBQUVEO0VBQ0UscUJBQWM7RUFBZCxxQkFBYztFQUFkLGNBQWM7RUFDZCwwQkFBb0I7TUFBcEIsdUJBQW9CO1VBQXBCLG9CQUFvQjtDQUNyQjtBQUNEO0VBQ0Usb0JBQWU7TUFBZixtQkFBZTtVQUFmLGVBQWU7RUFDZixZQUFZO0VBQ1osV0FBVztFQUNYLG1CQUFtQjtDQUNwQjs7QUFFRCx3QkFBd0I7O0FBRXhCO0NBQ0MiLCJmaWxlIjoic3R5bGVzLmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIENvbGxlY3Rpb24gZGVmYXVsdCB0aGVtZSAqL1xuXG4uUmVhY3RWaXJ0dWFsaXplZF9fQ29sbGVjdGlvbiB7XG59XG5cbi5SZWFjdFZpcnR1YWxpemVkX19Db2xsZWN0aW9uX19pbm5lclNjcm9sbENvbnRhaW5lciB7XG59XG5cbi8qIEdyaWQgZGVmYXVsdCB0aGVtZSAqL1xuXG4uUmVhY3RWaXJ0dWFsaXplZF9fR3JpZCB7XG59XG5cbi5SZWFjdFZpcnR1YWxpemVkX19HcmlkX19pbm5lclNjcm9sbENvbnRhaW5lciB7XG59XG5cbi8qIFRhYmxlIGRlZmF1bHQgdGhlbWUgKi9cblxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlIHtcbn1cblxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19HcmlkIHtcbn1cblxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19oZWFkZXJSb3cge1xuICBmb250LXdlaWdodDogNzAwO1xuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xufVxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19yb3cge1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xufVxuXG4uUmVhY3RWaXJ0dWFsaXplZF9fVGFibGVfX2hlYWRlclRydW5jYXRlZFRleHQge1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIG1heC13aWR0aDogMTAwJTtcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XG4gIG92ZXJmbG93OiBoaWRkZW47XG59XG5cbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9faGVhZGVyQ29sdW1uLFxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19yb3dDb2x1bW4ge1xuICBtYXJnaW4tcmlnaHQ6IDEwcHg7XG4gIG1pbi13aWR0aDogMHB4O1xufVxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19yb3dDb2x1bW4ge1xuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbn1cblxuLlJlYWN0VmlydHVhbGl6ZWRfX1RhYmxlX19oZWFkZXJDb2x1bW46Zmlyc3Qtb2YtdHlwZSxcbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9fcm93Q29sdW1uOmZpcnN0LW9mLXR5cGUge1xuICBtYXJnaW4tbGVmdDogMTBweDtcbn1cbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9fc29ydGFibGVIZWFkZXJDb2x1bW4ge1xuICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9fc29ydGFibGVIZWFkZXJJY29uQ29udGFpbmVyIHtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbn1cbi5SZWFjdFZpcnR1YWxpemVkX19UYWJsZV9fc29ydGFibGVIZWFkZXJJY29uIHtcbiAgZmxleDogMCAwIDI0cHg7XG4gIGhlaWdodDogMWVtO1xuICB3aWR0aDogMWVtO1xuICBmaWxsOiBjdXJyZW50Q29sb3I7XG59XG5cbi8qIExpc3QgZGVmYXVsdCB0aGVtZSAqL1xuXG4uUmVhY3RWaXJ0dWFsaXplZF9fTGlzdCB7XG59XG4iXX0= */\",\"//\\n// Spinner\\n// ------------------------------\\n@import 'mixins';\\n\\n@mixin Select-spinner($size, $orbit, $satellite)\\n{\\n\\t@include animation( Select-animation-spin 400ms infinite linear );\\n\\t@include square($size);\\n\\tbox-sizing: border-box;\\n\\tborder-radius: 50%;\\n\\tborder: floor(($size / 8)) solid $orbit;\\n\\tborder-right-color: $satellite;\\n\\tdisplay: inline-block;\\n\\tposition: relative;\\n\\n}\\n\\n@keyframes Select-animation-spin {\\n\\tto { transform: rotate(1turn); }\\n}\\n@-webkit-keyframes Select-animation-spin {\\n\\tto { -webkit-transform: rotate(1turn); }\\n}\\n\",\"//\\n// Control\\n// ------------------------------\\n\\n@import 'spinner';\\n@import 'mixins';\\n\\n.Select {\\n\\tposition: relative;\\n\\n\\t// disable some browser-specific behaviours that break the input\\n\\tinput::-webkit-contacts-auto-fill-button,\\n\\tinput::-webkit-credentials-auto-fill-button {\\n\\t\\tdisplay: none !important;\\n\\t}\\n\\tinput::-ms-clear {\\n\\t\\tdisplay: none !important;\\n\\t}\\n\\tinput::-ms-reveal {\\n\\t\\tdisplay: none !important;\\n\\t}\\n\\n\\t// preferred box model\\n\\t&,\\n\\t& div,\\n\\t& input,\\n\\t& span {\\n\\t\\t@include box-sizing(border-box);\\n\\t}\\n\\n\\t// handle disabled state\\n\\t&.is-disabled {\\n\\t\\t.Select-arrow-zone {\\n\\t\\t\\tcursor: default;\\n\\t\\t\\tpointer-events: none;\\n\\t\\t}\\n\\n\\t\\t> .Select-control {\\n\\t\\t\\tbackground-color: $select-input-bg-disabled;\\n\\t\\t\\t&:hover {\\n\\t\\t\\t\\tbox-shadow: none;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\n\\t&.is-searchable {\\n\\t\\t&.is-open > .Select-control {\\n\\t\\t\\tcursor: text;\\n\\t\\t}\\n\\n\\t\\t&.is-focused:not(.is-open) > .Select-control {\\n\\t\\t\\tcursor: text;\\n\\t\\t}\\n\\t}\\n\\n\\t&.is-open > .Select-control {\\n\\t\\t@include border-bottom-radius( 0 );\\n\\t\\tbackground: $select-input-bg;\\n\\t\\tborder-color: darken($select-input-border-color, 10%) $select-input-border-color lighten($select-input-border-color, 5%);\\n\\n\\t\\t// flip the arrow so its pointing up when the menu is open\\n\\t\\t.Select-arrow {\\n\\t\\t\\ttop: -2px;\\n\\t\\t\\tborder-color: transparent transparent $select-arrow-color;\\n\\t\\t\\tborder-width: 0 $select-arrow-width $select-arrow-width;\\n\\t\\t}\\n\\t}\\n\\n\\t&.is-focused > .Select-control {\\n\\t\\tbackground: $select-input-bg-focus;\\n\\t}\\n\\n\\t&.is-focused:not(.is-open) > .Select-control {\\n\\t\\tborder-color: $select-input-border-focus lighten($select-input-border-focus, 5%) lighten($select-input-border-focus, 5%);\\n\\t\\tbox-shadow: $select-input-box-shadow-focus;\\n\\t}\\n\\n\\n\\t&.has-value.is-clearable.Select--single > .Select-control .Select-value {\\n\\t\\tpadding-right: ($select-clear-width + $select-arrow-width * 5);\\n\\t}\\n\\n\\t&.has-value.Select--single > .Select-control .Select-value,\\n\\t&.has-value.is-pseudo-focused.Select--single > .Select-control .Select-value {\\n\\t\\t.Select-value-label {\\n\\t\\t\\tcolor: $select-text-color;\\n\\t\\t}\\n\\t\\ta.Select-value-label {\\n\\t\\t\\tcursor: pointer;\\n\\t\\t\\ttext-decoration: none;\\n\\n\\t\\t\\t&:hover,\\n\\t\\t\\t&:focus {\\n\\t\\t\\t\\tcolor: $select-link-hover-color;\\n\\t\\t\\t\\toutline: none;\\n\\t\\t\\t\\ttext-decoration: underline;\\n\\t\\t\\t}\\n\\n\\t\\t\\t&:focus {\\n\\t\\t\\t\\tbackground: $select-input-bg-focus;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\n\\t// fake-hide the input when the control is pseudo-focused\\n\\t&.has-value.is-pseudo-focused .Select-input {\\n\\t\\topacity: 0;\\n\\t}\\n\\n\\t&.is-open .Select-arrow,\\n\\t.Select-arrow-zone:hover > .Select-arrow {\\n\\t\\tborder-top-color: $select-arrow-color-hover;\\n\\t}\\n\\t&.Select--rtl {\\n\\t\\tdirection: rtl;\\n\\t\\ttext-align: right;\\n\\t}\\n}\\n\\n// base\\n\\n.Select-control {\\n\\tbackground-color: $select-input-bg;\\n\\tborder-color: lighten($select-input-border-color, 5%) $select-input-border-color darken($select-input-border-color, 10%);\\n\\tborder-radius: $select-input-border-radius;\\n\\tborder: $select-input-border-width solid $select-input-border-color;\\n\\tcolor: $select-text-color;\\n\\tcursor: default;\\n\\tdisplay: table;\\n\\tborder-spacing: 0;\\n\\tborder-collapse: separate;\\n\\theight: $select-input-height;\\n\\toutline: none;\\n\\toverflow: hidden;\\n\\tposition: relative;\\n\\twidth: 100%;\\n\\n\\t&:hover {\\n\\t\\tbox-shadow: $select-input-hover-box-shadow;\\n\\t}\\n\\n\\t.Select-input:focus {\\n\\t\\toutline: none;\\n\\t\\tbackground: $select-input-bg-focus;\\n\\t}\\n}\\n\\n// placeholder\\n.Select-placeholder,\\n.Select--single > .Select-control .Select-value {\\n\\tbottom: 0;\\n\\tcolor: $select-input-placeholder;\\n\\tleft: 0;\\n\\tline-height: $select-input-internal-height;\\n\\tpadding-left: $select-padding-horizontal;\\n\\tpadding-right: $select-padding-horizontal;\\n\\tposition: absolute;\\n\\tright: 0;\\n\\ttop: 0;\\n\\n\\t// crop text\\n\\tmax-width: 100%;\\n\\toverflow: hidden;\\n\\ttext-overflow: ellipsis;\\n\\twhite-space: nowrap;\\n}\\n\\n\\n// the <input> element users type in\\n\\n.Select-input {\\n\\t// inherits `display: inline-block` from \\\"react-input-autosize\\\"\\n\\theight: $select-input-internal-height;\\n\\tpadding-left: $select-padding-horizontal;\\n\\tpadding-right: $select-padding-horizontal;\\n\\tvertical-align: middle;\\n\\n\\t> input {\\n\\t\\twidth: 100%;\\n\\t\\tbackground: none transparent;\\n\\t\\tborder: 0 none;\\n\\t\\tbox-shadow: none;\\n\\t\\tcursor: default;\\n\\t\\tdisplay: inline-block;\\n\\t\\tfont-family: inherit;\\n\\t\\tfont-size: inherit;\\n\\t\\t// height: $select-input-internal-height;\\n\\t\\tmargin: 0;\\n\\t\\toutline: none;\\n\\t\\t// padding: 0;\\n\\t\\tline-height: 17px;  /* For IE 8 compatibility */\\n\\t\\tpadding: (($select-input-internal-height - 14) / 2 - 2) 0 (($select-input-internal-height - 14) / 2 + 2);  /* For IE 8 compatibility */\\n\\t\\t-webkit-appearance: none;\\n\\n\\t\\t.is-focused & {\\n\\t\\t\\tcursor: text;\\n\\t\\t}\\n\\t}\\n\\n}\\n\\n// fake input\\n.Select-control:not(.is-searchable) > .Select-input {\\n\\toutline: none;\\n}\\n\\n// loading indicator\\n.Select-loading-zone {\\n\\tcursor: pointer;\\n\\tdisplay: table-cell;\\n\\tposition: relative;\\n\\ttext-align: center;\\n\\tvertical-align: middle;\\n\\twidth: $select-loading-size;\\n}\\n.Select-loading {\\n\\t@include Select-spinner($select-loading-size, $select-loading-color-bg, $select-loading-color);\\n\\tvertical-align: middle;\\n}\\n\\n\\n// the little cross that clears the field\\n\\n.Select-clear-zone {\\n\\t@include animation( Select-animation-fadeIn 200ms );\\n\\tcolor: $select-clear-color;\\n\\tcursor: pointer;\\n\\tdisplay: table-cell;\\n\\tposition: relative;\\n\\ttext-align: center;\\n\\tvertical-align: middle;\\n\\twidth: $select-clear-width;\\n\\n\\t&:hover {\\n\\t\\tcolor: $select-clear-hover-color;\\n\\t}\\n}\\n.Select-clear {\\n\\tdisplay: inline-block;\\n\\tfont-size: $select-clear-size;\\n\\tline-height: 1;\\n}\\n.Select--multi .Select-clear-zone {\\n\\twidth: $select-clear-width;\\n}\\n\\n.Select--multi .Select-multi-value-wrapper {\\n  display: inline-block;\\n}\\n.Select .Select-aria-only {\\n\\tposition: absolute;\\n\\tdisplay: inline-block;\\n\\theight: 1px;\\n\\twidth: 1px;\\n\\tmargin: -1px;\\n\\tclip: rect(0,0,0,0);\\n\\toverflow: hidden;\\n\\tfloat: left;\\n}\\n\\n\\n// arrow indicator\\n\\n.Select-arrow-zone {\\n\\tcursor: pointer;\\n\\tdisplay: table-cell;\\n\\tposition: relative;\\n\\ttext-align: center;\\n\\tvertical-align: middle;\\n\\twidth: ($select-arrow-width * 5);\\n\\tpadding-right: $select-arrow-width;\\n\\n\\t.Select--rtl & {\\n\\t\\tpadding-right: 0;\\n\\t\\tpadding-left: $select-arrow-width;\\n\\t}\\n}\\n\\n.Select-arrow {\\n\\tborder-color: $select-arrow-color transparent transparent;\\n\\tborder-style: solid;\\n\\tborder-width: $select-arrow-width $select-arrow-width ($select-arrow-width / 2);\\n\\tdisplay: inline-block;\\n\\theight: 0;\\n\\twidth: 0;\\n\\tposition: relative;\\n}\\n\\n\\n\\n\\n// Animation\\n// ------------------------------\\n\\n// fade in\\n\\n@-webkit-keyframes Select-animation-fadeIn {\\n\\tfrom { opacity: 0; }\\n\\tto { opacity: 1; }\\n}\\n@keyframes Select-animation-fadeIn {\\n\\tfrom { opacity: 0; }\\n\\tto { opacity: 1; }\\n}\\n\",\"//\\n// Mixins\\n// ------------------------------\\n\\n\\n// Utilities\\n\\n@mixin size($width, $height)\\n{\\n\\twidth: $width;\\n\\theight: $height;\\n}\\n@mixin square($size)\\n{\\n\\t@include size($size, $size);\\n}\\n@mixin border-top-radius($radius)\\n{\\n\\tborder-top-right-radius: $radius;\\n\\tborder-top-left-radius: $radius;\\n}\\n@mixin border-right-radius($radius)\\n{\\n\\tborder-bottom-right-radius: $radius;\\n\\tborder-top-right-radius: $radius;\\n}\\n@mixin border-bottom-radius($radius)\\n{\\n\\tborder-bottom-right-radius: $radius;\\n\\tborder-bottom-left-radius: $radius;\\n}\\n@mixin border-left-radius($radius)\\n{\\n\\tborder-bottom-left-radius: $radius;\\n\\tborder-top-left-radius: $radius;\\n}\\n\\n\\n// Vendor Prefixes\\n\\n@mixin animation($animation)\\n{\\n\\t-webkit-animation: $animation;\\n\\t-o-animation: $animation;\\n\\tanimation: $animation;\\n}\\n@mixin box-sizing($boxmodel)\\n{\\n\\t-webkit-box-sizing: $boxmodel;\\n\\t-moz-box-sizing: $boxmodel;\\n\\tbox-sizing: $boxmodel;\\n}\\n\",\"//\\n// Select Menu\\n// ------------------------------\\n\\n\\n// wrapper around the menu\\n\\n.Select-menu-outer {\\n\\t// Unfortunately, having both border-radius and allows scrolling using overflow defined on the same\\n\\t// element forces the browser to repaint on scroll.  However, if these definitions are split into an\\n\\t// outer and an inner element, the browser is able to optimize the scrolling behavior and does not\\n\\t// have to repaint on scroll.\\n\\t@include border-bottom-radius( $select-input-border-radius );\\n\\tbackground-color: $select-input-bg;\\n\\tborder: 1px solid $select-input-border-color;\\n\\tborder-top-color: mix($select-input-bg, $select-input-border-color, 50%);\\n\\tbox-shadow: $select-menu-box-shadow;\\n\\tbox-sizing: border-box;\\n\\tmargin-top: -1px;\\n\\tmax-height: $select-menu-max-height;\\n\\tposition: absolute;\\n\\tleft: 0;\\n\\ttop: 100%;\\n\\twidth: 100%;\\n\\tz-index: $select-menu-zindex;\\n\\t-webkit-overflow-scrolling: touch;\\n}\\n\\n\\n// wrapper\\n\\n.Select-menu {\\n\\tmax-height: ($select-menu-max-height - 2px);\\n\\toverflow-y: auto;\\n}\\n\\n\\n// options\\n\\n.Select-option {\\n\\tbox-sizing: border-box;\\n\\tbackground-color: $select-option-bg;\\n\\tcolor: $select-option-color;\\n\\tcursor: pointer;\\n\\tdisplay: block;\\n\\tpadding: $select-padding-vertical $select-padding-horizontal;\\n\\n\\t&:last-child {\\n\\t\\t@include border-bottom-radius( $select-input-border-radius );\\n\\t}\\n\\n\\t&.is-selected {\\n\\t\\tbackground-color: $select-option-selected-bg;\\n\\t\\tcolor: $select-option-selected-color;\\n\\t}\\n\\n\\t&.is-focused {\\n\\t\\tbackground-color: $select-option-focused-bg;\\n\\t\\tcolor: $select-option-focused-color;\\n\\t}\\n\\n\\t&.is-disabled {\\n\\t\\tcolor: $select-option-disabled-color;\\n\\t\\tcursor: default;\\n\\t}\\n\\n}\\n\\n\\n// no results\\n\\n.Select-noresults {\\n\\tbox-sizing: border-box;\\n\\tcolor: $select-noresults-color;\\n\\tcursor: default;\\n\\tdisplay: block;\\n\\tpadding: $select-padding-vertical $select-padding-horizontal;\\n}\\n\",\"//\\n// Multi-Select\\n// ------------------------------\\n\\n\\n// Base\\n\\n.Select--multi {\\n\\n\\t// add margin to the input element\\n\\t.Select-input {\\n\\t\\tvertical-align: middle;\\n\\t\\t// border: 1px solid transparent;\\n\\t\\tmargin-left: $select-padding-horizontal;\\n\\t\\tpadding: 0;\\n\\t}\\n\\t&.Select--rtl .Select-input {\\n\\t\\tmargin-left: 0;\\n\\t\\tmargin-right: $select-padding-horizontal;\\n\\t}\\n\\n\\t// reduce margin once there is value\\n\\t&.has-value .Select-input {\\n\\t\\tmargin-left: $select-item-gutter;\\n\\t}\\n\\n\\t// Items\\n\\t.Select-value {\\n\\t\\tbackground-color: $select-item-bg;\\n\\t\\tborder-radius: $select-item-border-radius;\\n\\t\\tborder: 1px solid $select-item-border-color;\\n\\t\\tcolor: $select-item-color;\\n\\t\\tdisplay: inline-block;\\n\\t\\tfont-size: $select-item-font-size;\\n\\t\\tmargin-left: $select-item-gutter;\\n\\t\\tmargin-top: $select-item-gutter;\\n\\t\\tvertical-align: top;\\n\\t}\\n\\n\\t// common\\n\\t.Select-value-icon,\\n\\t.Select-value-label {\\n\\t\\tdisplay: inline-block;\\n\\t\\tvertical-align: middle;\\n\\t}\\n\\n\\t// label\\n\\t.Select-value-label {\\n\\t\\t@include border-right-radius( $select-item-border-radius );\\n\\t\\tcursor: default;\\n\\t\\tpadding: $select-item-padding-vertical $select-item-padding-horizontal;\\n\\t}\\n\\ta.Select-value-label {\\n\\t\\tcolor: $select-item-color;\\n\\t\\tcursor: pointer;\\n\\t\\ttext-decoration: none;\\n\\n\\t\\t&:hover {\\n\\t\\t\\ttext-decoration: underline;\\n\\t\\t}\\n\\t}\\n\\n\\t// icon\\n\\t.Select-value-icon {\\n\\t\\tcursor: pointer;\\n\\t\\t@include border-left-radius( $select-item-border-radius );\\n\\t\\tborder-right: 1px solid $select-item-border-color;\\n\\n\\t\\t// move the baseline up by 1px\\n\\t\\tpadding: ($select-item-padding-vertical - 1) $select-item-padding-horizontal ($select-item-padding-vertical + 1);\\n\\n\\t\\t&:hover,\\n\\t\\t&:focus {\\n\\t\\t\\tbackground-color: $select-item-hover-bg;\\n\\t\\t\\tcolor: $select-item-hover-color;\\n\\t\\t}\\n\\t\\t&:active {\\n\\t\\t\\tbackground-color: $select-item-border-color;\\n\\t\\t}\\n\\t}\\n\\n\\t&.Select--rtl {\\n\\t\\t.Select-value {\\n\\t\\t  margin-left: 0;\\n\\t\\t  margin-right: $select-item-gutter;\\n\\t\\t}\\n\\t\\t.Select-value-icon {\\n\\t\\t\\tborder-right: none;\\n\\t\\t\\tborder-left: 1px solid $select-item-border-color;\\n\\t\\t}\\n\\t}\\n}\\n\\n.Select--multi.is-disabled {\\n\\t.Select-value {\\n\\t\\tbackground-color: $select-item-disabled-bg;\\n\\t\\tborder: 1px solid $select-item-disabled-border-color;\\n\\t\\tcolor: $select-item-disabled-color;\\n\\t}\\n\\t// icon\\n\\t.Select-value-icon {\\n\\t\\tcursor: not-allowed;\\n\\t\\tborder-right: 1px solid $select-item-disabled-border-color;\\n\\n\\t\\t&:hover,\\n\\t\\t&:focus,\\n\\t\\t&:active {\\n\\t\\t\\tbackground-color: $select-item-disabled-bg;\\n\\t\\t}\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"monospaceFont\": \"\\\"Roboto Mono\\\", Menlo, Inconsolata, \\\"Courier New\\\", Courier, monospace\",\n\t\"optionHeight\": \"24\",\n\t\"content\": \"packages-webviz-core-src-panels-Rosout-index-module-4nshd--content\",\n\t\"filtersBar\": \"packages-webviz-core-src-panels-Rosout-index-module-42gh9--filtersBar\",\n\t\"severityFilter\": \"packages-webviz-core-src-panels-Rosout-index-module-2nczq--severityFilter\",\n\t\"nodeFilter\": \"packages-webviz-core-src-panels-Rosout-index-module-3tekj--nodeFilter\",\n\t\"itemsCountField\": \"packages-webviz-core-src-panels-Rosout-index-module-hu4fx--itemsCountField\",\n\t\"is-focused\": \"packages-webviz-core-src-panels-Rosout-index-module-jr6wb--is-focused\",\n\t\"Select--rtl\": \"packages-webviz-core-src-panels-Rosout-index-module-33x8g--Select--rtl\",\n\t\"Select-animation-spin\": \"packages-webviz-core-src-panels-Rosout-index-module-4nj9t--Select-animation-spin\",\n\t\"Select-animation-fadeIn\": \"packages-webviz-core-src-panels-Rosout-index-module-2xhh8--Select-animation-fadeIn\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport _ from \"lodash\";\nimport React from \"react\";\nimport type { Time } from \"rosbag\";\n\nimport LevelToString from \"./LevelToString\";\nimport style from \"./LogMessage.module.scss\";\nimport { type Header } from \"webviz-core/src/types/Messages\";\n\n// pad the start of `val` with 0's to make the total string length `count` size\nfunction PadStart(val, count) {\n  return _.padStart(`${val}`, count, \"0\");\n}\n\nfunction Stamp(props: { stamp: Time }) {\n  const stamp = props.stamp;\n  return (\n    <span>\n      {PadStart(stamp.sec, 10)}.{PadStart(stamp.nsec, 9)}\n    </span>\n  );\n}\n\ntype Props = {|\n  msg: { file: string, line: string, level: number, name: string, msg: string, header: Header },\n|};\n\n// $FlowFixMe - flow doesn't have a definition for React.memo\nexport default React.memo(function LogMessage({ msg }: Props) {\n  const altStr = `${msg.file}:${msg.line}`;\n\n  const strLevel = LevelToString(msg.level);\n\n  const levelClassName = style[strLevel.toLocaleLowerCase()];\n\n  // the first message line is rendered with the info/stamp/name\n  // following newlines are rendered on their own line\n  const lines = msg.msg.split(\"\\n\");\n  return (\n    <div title={altStr} className={`${style.container} ${levelClassName}`}>\n      <div>\n        <span>[{_.padStart(strLevel, 5, \" \")}]</span>\n        <span>\n          [<Stamp stamp={msg.header.stamp} />]\n        </span>\n        <span>\n          [{msg.name}\n          ]:\n        </span>\n        <span>&nbsp;</span>\n        <span>{lines[0]}</span>\n      </div>\n      {/* extra lines */}\n      <div>\n        {/* using array index as key is desired here since the index does not change */}\n        {lines.slice(1).map((line, idx) => {\n          return (\n            <div key={idx}>\n              &nbsp;&nbsp;&nbsp;&nbsp;\n              {line}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n});\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".packages-webviz-core-src-panels-Rosout-LogMessage-module-3paw6--container {\\n  text-indent: -20px;\\n  padding-left: 20px;\\n  white-space: pre-wrap;\\n  line-height: 1.2; }\\n\\n.packages-webviz-core-src-panels-Rosout-LogMessage-module-nvhh6--fatal {\\n  color: #ff7c96;\\n  font-weight: bold; }\\n\\n.packages-webviz-core-src-panels-Rosout-LogMessage-module-5htzm--error {\\n  color: #ff7c96; }\\n\\n.packages-webviz-core-src-panels-Rosout-LogMessage-module-rj2kj--warn {\\n  color: #ccb862; }\\n\\n.packages-webviz-core-src-panels-Rosout-LogMessage-module-3zsp7--info {\\n  color: #586e75; }\\n\\n.packages-webviz-core-src-panels-Rosout-LogMessage-module-4bs2y--debug {\\n  color: #93a1a1; }\\n\", \"\", {\"version\":3,\"sources\":[\"/home/circleci/project/packages/webviz-core/src/panels/Rosout/LogMessage.module.scss\",\"/home/circleci/project/packages/webviz-core/src/styles/colors.module.scss\"],\"names\":[],\"mappings\":\"AAQA;EACE,mBAAkB;EAClB,mBAAkB;EAClB,sBAAqB;EACrB,iBAAgB,EACjB;;AAED;EACE,eCwBW;EDvBX,kBAAiB,EAClB;;AAED;EACE,eCmBW,EDlBZ;;AAED;EACE,eCcc,EDbf;;AAED;EACE,eAAc,EACf;;AAED;EACE,eAAc,EACf\",\"file\":\"LogMessage.module.scss\",\"sourcesContent\":[\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n@import \\\"~webviz-core/src/styles/colors.module.scss\\\";\\n\\n.container {\\n  text-indent: -20px;\\n  padding-left: 20px;\\n  white-space: pre-wrap;\\n  line-height: 1.2;\\n}\\n\\n.fatal {\\n  color: $red;\\n  font-weight: bold;\\n}\\n\\n.error {\\n  color: $red;\\n}\\n\\n.warn {\\n  color: $orange;\\n}\\n\\n.info {\\n  color: #586e75;\\n}\\n\\n.debug {\\n  color: #93a1a1;\\n}\\n\",\"//  Copyright (c) 2018-present, Cruise LLC\\n//\\n//  This source code is licensed under the Apache License, Version 2.0,\\n//  found in the LICENSE file in the root directory of this source tree.\\n//  You may not use this file except in compliance with the License.\\n\\n$background: #121217;\\n$background-control: rgba(247, 247, 243, 0.1);\\n$background-control-selected: rgba(59, 46, 118, 0.6);\\n$toolbar-background: rgba(0, 0, 0, 0.9);\\n$tooltip-background: rgba(71, 69, 81, 0.9);\\n\\n// $text-control: mix($background, white, 25%); //#ededed;\\n$text-bright: rgba(247, 247, 243, 0.88);\\n$text-normal: rgba(247, 247, 243, 0.77);\\n$text-disabled: rgba(247, 247, 243, 0.15);\\n$text-muted: rgba(247, 247, 243, 0.3);\\n$text-control: $text-normal;\\n$text-control-hover: rgba(247, 247, 243, 1);\\n\\n$text-input: rgba(0, 0, 0, 0.8);\\n$text-input-disabled: rgba(0, 0, 0, 0.3);\\n\\n$highlight: #29bee7;\\n\\n$menu-item-selected: $background-control-selected;\\n$menu-item-hover: #3b2e76;\\n\\n$divider: rgba(247, 247, 243, 0.1);\\n\\n$green: #05d27d;\\n$light-green: #5cd6a9;\\n$yellow: #f5d358;\\n$light-purple: #c1c5d6;\\n$grey: #e7e9ef;\\n$panel-background: #1a1a1f;\\n$toolbar-fixed: #1f1e27;\\n$toolbar: #2d2c33;\\n$accent: #22b5ff;\\n$orange: #ccb862;\\n$red: #ff7c96;\\n\\n:export {\\n  highlight: $highlight;\\n  green: $green;\\n  lightGreen: $light-green;\\n  accent: $accent;\\n  yellow: $yellow;\\n  lightPurple: $light-purple;\\n  grey: $grey;\\n  panelBackground: $panel-background;\\n  orange: $orange;\\n  toolbar: $toolbar;\\n  red: $red;\\n  divider: $divider;\\n  tooltipBackground: $tooltip-background;\\n  textMuted: $text-muted;\\n  textBright: $text-bright;\\n  textDisabled: $text-disabled;\\n  backgroundControl: $background-control;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\nexports.locals = {\n\t\"highlight\": \"#29bee7\",\n\t\"green\": \"#05d27d\",\n\t\"lightGreen\": \"#5cd6a9\",\n\t\"accent\": \"#22b5ff\",\n\t\"yellow\": \"#f5d358\",\n\t\"lightPurple\": \"#c1c5d6\",\n\t\"grey\": \"#e7e9ef\",\n\t\"panelBackground\": \"#1a1a1f\",\n\t\"orange\": \"#ccb862\",\n\t\"toolbar\": \"#2d2c33\",\n\t\"red\": \"#ff7c96\",\n\t\"divider\": \"rgba(247, 247, 243, 0.1)\",\n\t\"tooltipBackground\": \"rgba(71, 69, 81, 0.9)\",\n\t\"textMuted\": \"rgba(247, 247, 243, 0.3)\",\n\t\"textBright\": \"rgba(247, 247, 243, 0.88)\",\n\t\"textDisabled\": \"rgba(247, 247, 243, 0.15)\",\n\t\"backgroundControl\": \"rgba(247, 247, 243, 0.1)\",\n\t\"container\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-3paw6--container\",\n\t\"fatal\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-nvhh6--fatal\",\n\t\"error\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-5htzm--error\",\n\t\"warn\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-rj2kj--warn\",\n\t\"info\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-3zsp7--info\",\n\t\"debug\": \"packages-webviz-core-src-panels-Rosout-LogMessage-module-4bs2y--debug\"\n};","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport _ from \"lodash\";\nimport * as React from \"react\";\nimport { List, AutoSizer, CellMeasurer, CellMeasurerCache } from \"react-virtualized\";\nimport uuid from \"uuid\";\n\nimport Button from \"webviz-core/src/components/Button\";\n\n// TODO(Audrey): import types from react-virtualized once they are available\n// RowRendererParams, CellMeasureCache\ntype RowRendererParams = {|\n  className: string,\n  columns: any[],\n  index: number,\n  isScrolling: boolean,\n  onRowClick: ?() => void,\n  onRowDoubleClick: ?() => void,\n  onRowMouseOver: ?() => void,\n  onRowMouseOut: ?() => void,\n  rowData: any,\n  style: StyleObj,\n  parent?: any,\n  key: number | string,\n|};\n\ntype RenderRowInput<Item> = {| ...RowRendererParams, item: Item |};\n\nexport type RenderRow<Item> = (RenderRowInput<Item>) => React.Node;\n\n// List for showing large number of items, which are expected to be appended to the end regularly.\n// Automatically scrolls to the bottom unless you explicitly scroll up.\nfunction LogList<Item>({ items, renderRow }: {| items: Item[], renderRow: RenderRow<Item> |}) {\n  // Automatically scrolling to the bottom by default.\n  const [autoScroll, setAutoScroll] = React.useState(true);\n\n  // For keeping a reference to the container <div>. Unfortunately there don't seem to be other\n  // convenient ways to do this; e.g. `ref` doesn't work.\n  const listId = React.useRef<string>(uuid.v4());\n\n  // Cache for item heights.\n  const cache = React.useRef<CellMeasurerCache>(new CellMeasurerCache({ fixedWidth: true }));\n\n  // Keep track of the last width to see if we need to clear the cache.\n  const lastWidth = React.useRef<number>(-1);\n\n  // Keep track of the last items that we rendered to see if we need to clear the cache.\n  const lastItems = React.useRef<Item[]>([]);\n\n  // Last time we rendered; used in `onScroll`.\n  const lastRenderTime = React.useRef<number>(0);\n  lastRenderTime.current = Date.now();\n\n  // If we have fewer items now, or if any of the old items don't match any more, we have to clear\n  // the cache of heights.\n  if (items.length < lastItems.current.length || !lastItems.current.every((item, index) => item === items[index])) {\n    cache.current.clearAll();\n  }\n  lastItems.current = items;\n\n  // `onWheel` is only called when the user explicitly scrolls using the scroll wheel or track pad.\n  // This is reliable, so we don't need any buffers or checks. However, this doesn't cover all cases\n  // of users scrolling (e.g. keyboard or dragging the scroll bar) so we also need `onScroll` below.\n  const onWheel = React.useCallback(\n    () => {\n      const containerEl = document.getElementById(listId.current);\n      if (!containerEl) {\n        return;\n      }\n      const newAutoScroll = containerEl.scrollHeight - containerEl.scrollTop <= containerEl.clientHeight;\n      if (newAutoScroll !== autoScroll) {\n        setAutoScroll(newAutoScroll);\n      }\n    },\n    [autoScroll]\n  );\n\n  // As said above, we need `onScroll` to catch some of the user scroll events. However, it's also\n  // triggered when a scroll happens for a different reason, e.g. by the browser or initiated from\n  // our own code. There's unfortunately no easy way to differentiate between them, and often during\n  // rendering the `onScroll` events can't quite keep up with the actual rendering, so we require\n  // rendering to not have happened for a second, and we have a bit of a buffer for how much\n  // scrolling we require to have been done. In practice this seems to be working reasonably well.\n  const onScroll = React.useCallback(\n    () => {\n      if (Date.now() - lastRenderTime.current < 1000) {\n        return;\n      }\n      const containerEl = document.getElementById(listId.current);\n      if (!containerEl) {\n        return;\n      }\n      const newAutoScroll = containerEl.scrollHeight - containerEl.scrollTop <= containerEl.clientHeight + 5;\n      if (newAutoScroll !== autoScroll) {\n        setAutoScroll(newAutoScroll);\n      }\n    },\n    [autoScroll]\n  );\n\n  const onResetView = React.useCallback(() => {\n    setAutoScroll(true);\n  }, []);\n\n  return (\n    <AutoSizer>\n      {({ width, height }) => {\n        // If the width changed, row heights might have changed, so we need to clear the cache.\n        if (lastWidth.current !== width) {\n          cache.current.clearAll();\n        }\n        lastWidth.current = width;\n\n        return (\n          <div style={{ position: \"relative\", width, height }}>\n            <List\n              width={width}\n              height={height}\n              style={{ outline: \"none\" }}\n              deferredMeasurementCache={cache.current}\n              rowHeight={cache.current.rowHeight}\n              rowRenderer={(rowProps) => (\n                <CellMeasurer\n                  key={rowProps.key}\n                  cache={cache.current}\n                  parent={rowProps.parent}\n                  columnIndex={0}\n                  rowIndex={rowProps.index}>\n                  {renderRow({ ...rowProps, item: items[rowProps.index] })}\n                </CellMeasurer>\n              )}\n              rowCount={items.length}\n              overscanRowCount={10}\n              onScroll={onScroll}\n              id={listId.current}\n              containerProps={{ onWheel }}\n              {...(autoScroll ? { scrollToIndex: items.length - 1 } : undefined)}\n            />\n            {!autoScroll && (\n              <div style={{ position: \"absolute\", bottom: 5, right: 10 }}>\n                <Button tooltip=\"(shortcut: scroll down)\" onClick={onResetView}>\n                  reset view\n                </Button>\n              </div>\n            )}\n          </div>\n        );\n      }}\n    </AutoSizer>\n  );\n}\n\nexport default LogList;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport * as React from \"react\";\nimport { hot } from \"react-hot-loader/root\";\n\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\n\n// Little dummy panel that just subscribes to a bunch of topics. Doesn't actually\n// do anything with them.\n\ntype Config = { topics: string };\ntype Props = { config: Config, saveConfig: SaveConfig<Config> };\n\nfunction SubscribeToList({ config, saveConfig }: Props): React.Node {\n  const topics = config.topics.split(/\\s*(?:\\n|,|\\s)\\s*/);\n  const messagesSeen = PanelAPI.useMessageReducer<number>({\n    topics,\n    restore: React.useCallback(() => 0, []),\n    addMessage: React.useCallback((seenBefore) => seenBefore + 1, []),\n  });\n  return (\n    <Flex col>\n      <PanelToolbar floating />\n      <textarea\n        style={{ flexGrow: 1, border: \"none\" }}\n        placeholder=\"add /some/topics/here separated by newlines or commas or whitespace\"\n        value={config.topics}\n        onChange={React.useCallback((event) => saveConfig({ topics: event.target.value }), [saveConfig])}\n      />\n      <div style={{ position: \"absolute\", bottom: 8, right: 12 }}>messages seen: {messagesSeen}</div>\n    </Flex>\n  );\n}\n\nSubscribeToList.panelType = \"SubscribeToList\";\nSubscribeToList.defaultConfig = { topics: \"\" };\n\nexport default hot(Panel<Config>(SubscribeToList));\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CloseIcon from \"@mdi/svg/svg/close.svg\";\nimport PlusIcon from \"@mdi/svg/svg/plus.svg\";\nimport React, { useCallback } from \"react\";\nimport { useDrop } from \"react-dnd\";\nimport { hot } from \"react-hot-loader/root\";\nimport { MosaicDragType } from \"react-mosaic-component\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport styled from \"styled-components\";\nimport textWidth from \"text-width\";\n\nimport helpContent from \"./index.help.md\";\nimport { savePanelConfigs } from \"webviz-core/src/actions/panels\";\nimport EmptyBoxSvg from \"webviz-core/src/assets/emptyBox.svg\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport { UnconnectedPanelLayout } from \"webviz-core/src/components/PanelLayout\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport cssColors from \"webviz-core/src/styles/colors.module.scss\";\nimport type { TabPanelConfig as Config } from \"webviz-core/src/types/layouts\";\nimport type { SaveConfig } from \"webviz-core/src/types/panels\";\nimport { TAB_PANEL_TYPE } from \"webviz-core/src/util/globalConstants\";\nimport { DEFAULT_TAB_PANEL_CONFIG } from \"webviz-core/src/util/layout\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst FONT_SIZE = 12;\nconst FONT_FAMILY = \"'Inter UI', -apple-system, BlinkMacSystemFont, sans-serif\";\nconst MAX_TAB_WIDTH = 100;\nconst MIN_ACTIVE_TAB_WIDTH = 40;\nconst MIN_OTHER_TAB_WIDTH = 14;\nfunction measureText(text: string): number {\n  return textWidth(text, { family: FONT_FAMILY, size: FONT_SIZE }) + 3;\n}\n\nconst STab = styled.div`\n  display: flex;\n  background-color: ${({ isActive }) => (isActive ? colors.DARK4 : \"\")};\n  width: 100%;\n  min-width: ${({ isActive, value, numTabs }) =>\n    isActive\n      ? `calc(max(${MIN_ACTIVE_TAB_WIDTH}px,  min(${Math.ceil(\n          measureText(value) + 30\n        )}px, ${MAX_TAB_WIDTH}px, 100% - ${MIN_OTHER_TAB_WIDTH * (numTabs - 1)}px)))`\n      : undefined};\n  max-width: ${MAX_TAB_WIDTH}px;\n  padding: 1px;\n  height: 20px;\n  border-right: 1px solid ${colors.DARK4};\n`;\nconst SInput = styled.input`\n  width: ${(props) => (props.isActive ? \"calc(100% - 20px)\" : \"100%\")};\n  cursor: pointer;\n`;\nconst clearBgStyle = { backgroundColor: \"transparent\", padding: 0 };\n\nconst SDropTarget = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  background-color: ${({ isOver }) => (isOver ? cssColors.textDisabled : \"transparent\")};\n  border: ${({ isOver }) => (isOver ? `1px solid ${cssColors.textMuted}` : \"none\")};\n`;\n\nconst SEmptyStateText = styled.div`\n  font-size: 16px;\n  margin: 16px 72px;\n  text-align: center;\n  line-height: 1.5;\n  color: rgba(247, 247, 243, 0.3);\n`;\n\nconst EmptyDropTarget = ({ mosaicId, tabId }: { mosaicId: ?string, tabId: ?string }) => {\n  const [{ isOver }, drop] = useDrop({\n    accept: MosaicDragType.WINDOW,\n    drop: (item, monitor) => {\n      if (monitor.getItem().mosaicId === mosaicId) {\n        return {\n          tabId,\n        };\n      }\n    },\n    collect: (monitor, props) => ({\n      isOver: monitor.isOver(),\n    }),\n  });\n  return (\n    <SDropTarget ref={drop} isOver={isOver}>\n      <EmptyBoxSvg />\n      <SEmptyStateText>Nothing here yet. Drag in a panel to get started.</SEmptyStateText>\n    </SDropTarget>\n  );\n};\n\ntype Props = { config: Config, saveConfig: SaveConfig<Config> };\nfunction Tab({ config, saveConfig }: Props) {\n  const dispatch = useDispatch();\n  const actions = React.useMemo(() => bindActionCreators({ savePanelConfigs }, dispatch), [dispatch]);\n  const mosaicId = useSelector(({ mosaic }) => mosaic.mosaicId);\n  const { tabs, activeTabIdx } = config;\n\n  const selectTab = useCallback(\n    (idx) => {\n      saveConfig({ activeTabIdx: idx });\n    },\n    [saveConfig]\n  );\n  const editTab = useCallback(\n    (idx, e) => {\n      const newTabs = tabs.slice();\n      newTabs[idx] = { ...tabs[idx], title: e.target.value };\n      saveConfig({ tabs: newTabs });\n    },\n    [saveConfig, tabs]\n  );\n  const removeTab = useCallback(\n    (idx) => {\n      const newTabs = tabs.slice(0, idx).concat(tabs.slice(idx + 1));\n      const lastIdx = tabs.length - 1;\n      saveConfig({ tabs: newTabs, activeTabIdx: activeTabIdx === lastIdx ? lastIdx - 1 : activeTabIdx });\n    },\n    [activeTabIdx, saveConfig, tabs]\n  );\n  const addTab = useCallback(\n    () => {\n      const newTab = { title: `${tabs.length + 1}`, layout: null };\n      saveConfig({ ...config, activeTabIdx: tabs.length, tabs: tabs.concat([newTab]) });\n    },\n    [config, saveConfig, tabs]\n  );\n\n  const onChangeLayout = useCallback(\n    (layout) => {\n      const newTabs = tabs.slice();\n      newTabs[activeTabIdx] = { ...tabs[activeTabIdx], layout };\n      saveConfig({ tabs: newTabs });\n    },\n    [activeTabIdx, saveConfig, tabs]\n  );\n\n  const currentLayout = tabs[activeTabIdx]?.layout;\n\n  return (\n    <PanelContext.Consumer>\n      {(panelContext) => (\n        <Flex col style={{ paddingTop: 0, position: \"relative\" }}>\n          <PanelToolbar helpContent={helpContent} showHiddenControlsOnHover>\n            <Flex>\n              {tabs.map((tab, idx) => {\n                const isActive = activeTabIdx === idx;\n                return (\n                  <STab\n                    key={idx}\n                    isActive={isActive}\n                    numTabs={tabs.length}\n                    value={tab.title || \"\"}\n                    onClick={selectTab.bind(null, idx)}>\n                    <Tooltip contents={tab.title || \"Enter tab name\"} placement=\"top\">\n                      <SInput\n                        isActive={isActive}\n                        disabled={!isActive}\n                        placeholder=\"Enter tab name\"\n                        style={clearBgStyle}\n                        value={tab.title || \"\"}\n                        onChange={editTab.bind(null, idx)}\n                      />\n                    </Tooltip>\n                    {isActive && tabs.length > 1 ? (\n                      <Icon\n                        small\n                        fade\n                        dataTest=\"remove-tab\"\n                        tooltip=\"Remove tab\"\n                        style={{ width: \"22px\" }}\n                        onClick={removeTab.bind(null, idx)}>\n                        <CloseIcon onMouseDown={(e) => e.preventDefault()} />\n                      </Icon>\n                    ) : null}\n                  </STab>\n                );\n              })}\n              <Icon small fade dataTest=\"add-tab\" tooltip=\"Add tab\" style={{ flexShrink: 0 }} onClick={addTab}>\n                <PlusIcon onMouseDown={(e) => e.preventDefault()} />\n              </Icon>\n            </Flex>\n          </PanelToolbar>\n          {currentLayout ? (\n            <UnconnectedPanelLayout\n              importHooks={false}\n              layout={currentLayout}\n              savePanelConfigs={actions.savePanelConfigs}\n              onChange={onChangeLayout}\n              setMosaicId={() => {}}\n              mosaicId={mosaicId}\n              tabId={panelContext?.id}\n              removeRootDropTarget\n            />\n          ) : (\n            <EmptyDropTarget mosaicId={mosaicId} tabId={panelContext?.id} />\n          )}\n        </Flex>\n      )}\n    </PanelContext.Consumer>\n  );\n}\nTab.panelType = TAB_PANEL_TYPE;\nTab.defaultConfig = DEFAULT_TAB_PANEL_CONFIG;\n\nexport default hot(Panel<Config>(Tab));\n","module.exports = \"# Tab\\n\\nAllows users to group multiple Webviz panels in a mini layout, each nested under a tab.\\n\\n## Grouping Panels into a Tab Panel\\n\\nSelect or deselect any panel by pressing `Cmd` + click.\\n\\nUsers can choose one of 2 ways to group the selected panels:\\n\\n- Combine selected panels under a single tab in a new Tab panel\\n- Create a separate tab for each selected panel in a new Tab panel\\n\\nHovering over any of the selected panels will allow you to make your choice.\\n\"","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport React from \"react\";\nexport default ((_ref) => {\n  let {\n    styles = {}\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"styles\"]);\n\n  return React.createElement(\n    \"svg\",\n    _extends({ width: \"150\", height: \"64\", viewBox: \"0 0 150 64\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\" }, props),\n    React.createElement(\"ellipse\", { cx: \"75\", cy: \"53.5\", rx: \"75\", ry: \"10.5\", fill: \"#36363D\" }),\n    React.createElement(\"path\", { d: \"M16 19h116v28a6 6 0 0 1-6 6H22a6 6 0 0 1-6-6V19z\", fill: \"#404047\" }),\n    React.createElement(\"path\", { d: \"M17 18.82h115m-115 0v28a6 6 0 0 0 6 6h103a6 6 0 0 0 6-6v-28m-115 0L28.316 1H119l13 17.82\", stroke: \"#606066\", strokeWidth: \"2\", strokeLinecap: \"square\" }),\n    React.createElement(\"path\", { d: \"M57 29.5a3.5 3.5 0 0 1 3.5-3.5h27a3.5 3.5 0 1 1 0 7h-27a3.5 3.5 0 0 1-3.5-3.5z\", fill: \"#2D2C32\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\"rect\", { x: \"62\", y: \"6\", width: \"25\", height: \"5\", rx: \"2.5\", fill: \"#2D2C32\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\"path\", { stroke: \"#606066\", strokeWidth: \"2\", d: \"M29 1v18M119 1v18\" })\n  );\n});","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { flatten, pick, round } from \"lodash\";\nimport React, { useMemo, useCallback, useRef, useEffect } from \"react\";\nimport Dimensions from \"react-container-dimensions\";\nimport DocumentEvents from \"react-document-events\";\nimport ReactDOM from \"react-dom\";\nimport { hot } from \"react-hot-loader/root\";\nimport styled from \"styled-components\";\n\nimport helpContent from \"./index.help.md\";\nimport { PanelToolbarLabel, PanelToolbarInput } from \"webviz-core/shared/panelToolbarStyles\";\nimport EmptyState from \"webviz-core/src/components/EmptyState\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport { Item } from \"webviz-core/src/components/Menu\";\nimport MessagePathInput from \"webviz-core/src/components/MessagePathSyntax/MessagePathInput\";\nimport { useLatestMessageDataItem } from \"webviz-core/src/components/MessagePathSyntax/useLatestMessageDataItem\";\nimport Panel from \"webviz-core/src/components/Panel\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport ChartComponent from \"webviz-core/src/components/ReactChartjs\";\nimport tooltipStyles from \"webviz-core/src/components/Tooltip.module.scss\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst SContainer = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  flex-direction: column;\n  height: 100%;\n`;\n\nconst SRoot = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  width: 100%;\n  overflow: hidden;\n`;\n\n// TODO: Autocomplete should only show paths that actually match the format this panel supports\nconst VALID_TYPES = [\"message\"];\nconst keysToPick = [\n  \"order\",\n  \"label\",\n  \"backgroundColor\",\n  \"borderColor\",\n  \"borderDash\",\n  \"borderWidth\",\n  \"pointBackgroundColor\",\n  \"pointBorderColor\",\n  \"pointBorderWidth\",\n  \"pointRadius\",\n  \"pointStyle\",\n  \"data\",\n];\n\nconst isValidMinMaxVal = (val?: string) => {\n  return val == null || val === \"\" || !isNaN(parseFloat(val));\n};\n\ntype Path = { value: string };\ntype Config = { path: Path, minXVal?: string, maxXVal?: string, minYVal?: string, maxYVal?: string };\ntype Props = { config: Config, saveConfig: ($Shape<Config>) => void };\nexport type Line = {\n  order: number,\n  label: string,\n  backgroundColor?: string,\n  borderColor?: string,\n  borderDash?: string,\n  borderWidth?: number,\n  pointBackgroundColor?: string,\n  pointBorderColor?: string,\n  pointBorderWidth?: number,\n  pointRadius?: number,\n  pointStyle?: string,\n  data: { x: number, y: number }[],\n};\ntype PlotMessage = {\n  lines: Line[],\n  points: Line[],\n  polygons: Line[],\n  title?: string,\n  yAxisLabel?: string,\n  xAxisLabel?: string,\n};\nfunction TwoDimensionalPlot(props: Props) {\n  const {\n    config: { path, minXVal, maxXVal, minYVal, maxYVal },\n    saveConfig,\n  } = props;\n\n  const tooltip = useRef<?HTMLDivElement>(null);\n  const chartComponent = useRef<?ChartComponent>(null);\n\n  const menuContent = useMemo(\n    () => (\n      <>\n        <Item>\n          <Flex>\n            <Flex col style={{ maxWidth: 100, marginRight: 5 }}>\n              <PanelToolbarLabel>Min X</PanelToolbarLabel>\n              <PanelToolbarInput\n                style={isValidMinMaxVal(minXVal) ? {} : { color: colors.REDL1 }}\n                value={minXVal}\n                onChange={({ target }) => saveConfig({ minXVal: target.value })}\n                onClick={(e) => e.stopPropagation()}\n                placeholder=\"auto\"\n              />\n            </Flex>\n            <Flex col style={{ maxWidth: 100 }}>\n              <PanelToolbarLabel>Max X</PanelToolbarLabel>\n              <PanelToolbarInput\n                style={isValidMinMaxVal(maxXVal) ? {} : { color: colors.REDL1 }}\n                value={maxXVal}\n                onChange={({ target }) => saveConfig({ maxXVal: target.value })}\n                onClick={(e) => e.stopPropagation()}\n                placeholder=\"auto\"\n              />\n            </Flex>\n          </Flex>\n        </Item>\n        <Item>\n          <Flex>\n            <Flex col style={{ maxWidth: 100, marginRight: 5 }}>\n              <PanelToolbarLabel>Min Y</PanelToolbarLabel>\n              <PanelToolbarInput\n                style={isValidMinMaxVal(minYVal) ? {} : { color: colors.REDL1 }}\n                value={minYVal}\n                onChange={({ target }) => saveConfig({ minYVal: target.value })}\n                onClick={(e) => e.stopPropagation()}\n                placeholder=\"auto\"\n              />\n            </Flex>\n            <Flex col style={{ maxWidth: 100 }}>\n              <PanelToolbarLabel>Max Y</PanelToolbarLabel>\n              <PanelToolbarInput\n                style={isValidMinMaxVal(maxYVal) ? {} : { color: colors.REDL1 }}\n                value={maxYVal}\n                onChange={({ target }) => saveConfig({ maxYVal: target.value })}\n                onClick={(e) => e.stopPropagation()}\n                placeholder=\"auto\"\n              />\n            </Flex>\n          </Flex>\n        </Item>\n      </>\n    ),\n    [maxXVal, maxYVal, minXVal, minYVal, saveConfig]\n  );\n\n  const getBufferedMinMax = useCallback((allVals: number[]) => {\n    const minVal = Math.min(...allVals);\n    const maxVal = Math.max(...allVals);\n    const diff = maxVal - minVal;\n    return {\n      min: !diff ? minVal - 1 : minVal - diff * 0.05,\n      max: !diff ? maxVal + 1 : maxVal + diff * 0.05,\n    };\n  }, []);\n\n  const removeTooltip = useCallback(() => {\n    if (tooltip.current) {\n      ReactDOM.unmountComponentAtNode(tooltip.current);\n    }\n    if (tooltip.current && tooltip.current.parentNode) {\n      // Satisfy flow.\n      tooltip.current.parentNode.removeChild(tooltip.current);\n      tooltip.current = null;\n    }\n  }, []);\n\n  // Always clean up tooltips when unmounting.\n  useEffect(\n    () => {\n      return () => {\n        removeTooltip();\n      };\n    },\n    [removeTooltip]\n  );\n\n  const item = useLatestMessageDataItem(path.value);\n  const message: PlotMessage = (item?.queriedData[0]?.value: any);\n  const { title, yAxisLabel, xAxisLabel, lines = [], points = [], polygons = [] } = message || {};\n  const data = useMemo(\n    () =>\n      message\n        ? {\n            datasets: [\n              ...lines.map((line, idx) => ({ ...pick(line, keysToPick), showLine: true, fill: false })),\n              ...points.map((point, idx) => pick(point, keysToPick)),\n              ...polygons.map((polygon, idx) => ({\n                ...pick(polygon, keysToPick),\n                data: polygon.data[0] ? polygon.data.concat([polygon.data[0]]) : polygon.data,\n                fill: true,\n                pointRadius: 0,\n                showLine: true,\n                lineTension: 0,\n              })),\n            ].sort((a, b) => (b.order || 0) - (a.order || 0)),\n          }\n        : { datasets: [] },\n    [lines, message, points, polygons]\n  );\n\n  const { allXs, allYs } = useMemo(\n    () => ({\n      allXs: flatten(data.datasets.map((dataset) => (dataset.data ? dataset.data.map(({ x }) => x) : []))),\n      allYs: flatten(data.datasets.map((dataset) => (dataset.data ? dataset.data.map(({ y }) => y) : []))),\n    }),\n    [data.datasets]\n  );\n\n  const options = useMemo(\n    () => ({\n      title: { display: !!title, text: title },\n      scales: {\n        yAxes: [\n          {\n            scaleLabel: { display: !!yAxisLabel, labelString: yAxisLabel },\n            ticks: {\n              min: parseFloat(minYVal) ? parseFloat(minYVal) : getBufferedMinMax(allYs).min,\n              max: parseFloat(maxYVal) ? parseFloat(maxYVal) : getBufferedMinMax(allYs).max,\n            },\n          },\n        ],\n        xAxes: [\n          {\n            scaleLabel: { display: !!xAxisLabel, labelString: xAxisLabel },\n            ticks: {\n              min: parseFloat(minXVal) ? parseFloat(minXVal) : getBufferedMinMax(allXs).min,\n              max: parseFloat(maxXVal) ? parseFloat(maxXVal) : getBufferedMinMax(allXs).max,\n            },\n          },\n        ],\n      },\n      color: colors.GRAY,\n      animation: { duration: 0 },\n      legend: { display: false },\n      pan: { enabled: false },\n      zoom: { enabled: false },\n      plugins: {},\n    }),\n    [allXs, allYs, getBufferedMinMax, maxXVal, maxYVal, minXVal, minYVal, title, xAxisLabel, yAxisLabel]\n  );\n\n  const onMouseMove = useCallback(\n    async (event: MouseEvent) => {\n      const currentChartComponent = chartComponent.current;\n      if (!currentChartComponent || !currentChartComponent.canvas) {\n        removeTooltip();\n        return;\n      }\n      const { canvas } = currentChartComponent;\n      const canvasRect = canvas.getBoundingClientRect();\n      const isTargetingCanvas = event.target === canvas;\n      if (\n        event.pageX < canvasRect.left ||\n        event.pageX > canvasRect.right ||\n        event.pageY < canvasRect.top ||\n        event.pageY > canvasRect.bottom ||\n        !isTargetingCanvas\n      ) {\n        removeTooltip();\n        return;\n      }\n\n      const tooltipElement = await currentChartComponent.getElementAtXAxis(event);\n      if (!tooltipElement) {\n        removeTooltip();\n        return;\n      }\n      let tooltipDatapoint, tooltipLabel;\n      for (const { data: dataPoints, label } of data.datasets) {\n        const datapoint = dataPoints.find(\n          (_datapoint) =>\n            _datapoint.x === tooltipElement.data.x && String(_datapoint.y) === String(tooltipElement.data.y)\n        );\n        if (datapoint) {\n          tooltipDatapoint = datapoint;\n          tooltipLabel = label;\n          break;\n        }\n      }\n      if (!tooltipDatapoint) {\n        removeTooltip();\n        return;\n      }\n\n      if (!tooltip.current) {\n        tooltip.current = document.createElement(\"div\");\n        if (canvas.parentNode) {\n          canvas.parentNode.appendChild(tooltip.current);\n        }\n      }\n\n      const currentTooltip = tooltip.current;\n      if (currentTooltip) {\n        let label = tooltipLabel ? `${tooltipLabel}: ` : \"\";\n        label += `(${round(tooltipDatapoint.x, 5)}, ${round(tooltipDatapoint.y, 5)})`;\n        ReactDOM.render(\n          <div\n            className={tooltipStyles.tooltip}\n            style={{ position: \"absolute\", left: tooltipElement.view.x, top: tooltipElement.view.y }}>\n            {label}\n          </div>,\n          currentTooltip\n        );\n      }\n    },\n    [data.datasets, removeTooltip]\n  );\n\n  const emptyMessage = !points.length && !lines.length && !polygons.length;\n\n  return (\n    <SContainer>\n      <PanelToolbar helpContent={helpContent} menuContent={menuContent}>\n        <MessagePathInput\n          path={path.value}\n          onChange={(newValue) => saveConfig({ path: { value: newValue } })}\n          inputStyle={{ height: \"100%\" }}\n          validTypes={VALID_TYPES}\n          placeholder=\"Select topic messages with 2D Plot data to visualize\"\n          autoSize\n        />\n      </PanelToolbar>\n      {!message ? (\n        <EmptyState>Waiting for next message</EmptyState>\n      ) : emptyMessage ? (\n        <EmptyState>No 2D Plot data (lines, points, polygons) to visualize</EmptyState>\n      ) : (\n        <SRoot>\n          <Dimensions>\n            {({ width, height }) => (\n              <ChartComponent\n                ref={chartComponent}\n                type=\"scatter\"\n                width={width}\n                height={height}\n                key={`${width}x${height}`}\n                options={options}\n                data={data}\n              />\n            )}\n          </Dimensions>\n          <DocumentEvents capture onMouseDown={onMouseMove} onMouseUp={onMouseMove} onMouseMove={onMouseMove} />\n        </SRoot>\n      )}\n    </SContainer>\n  );\n}\n\nTwoDimensionalPlot.panelType = \"TwoDimensionalPlot\";\nTwoDimensionalPlot.defaultConfig = { path: { value: \"\" } };\n\nexport default hot(Panel<Config>(TwoDimensionalPlot));\n","module.exports = \"# 2D Plot\\n\\nThe 2D Plot panel allows users to define within their ROS messages the points, lines, and polygons they would like to visualize on an x- and y-axis.\\n\\nThe panel's API currently allows users to specify the plot's title and axes labels, and supports the visualization of 3 types of markers: `points`, `lines`, and `polygons`. Any incoming message with these 3 keys pointing to an array of API-conforming marker objects can be displayed in the 2D Plot panel.\\n\\nThe chart options supported by the 2D Plot panel API are:\\n\\n- `title`\\n- `xAxisLabel`\\n- `yAxisLabel`\\n\\nThere are 3 types of datasets supported by the 2D PLot panel API - `lines`, `points`, and `polygons`. Each of these dataset types can be customized by the following options:\\n\\n- `order` - z-index\\n- `label` - unique ID\\n- `backgroundColor`\\n- `borderColor`\\n- `borderDash` - length and spacing of dashes - see [MDN](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash)\\n- `borderWidth`\\n- `pointBackgroundColor`\\n- `pointBorderColor`\\n- `pointBorderWidth`\\n- `pointRadius`\\n- `pointStyle` - can be 'circle', 'cross', 'crossRot', 'dash', 'line', 'rect', 'rectRounded', 'rectRot', or 'star'\\n- `data` - an array of coordinate objects, e.g. `[{x: 0, y: 1}, {x: 2, y: 5}]`\\n\\nOnly `label` and `data` are required - all other options have reasonable default values.\\n\\nBelow is a basic example of a message that could be consumed by the 2D Plot panel:\\n\\n```js\\n{\\n  op: \\\"message\\\",\\n  topic: \\\"/plot_a\\\",\\n  datatype: \\\"webviz_msgs/2DPlotMsg\\\",\\n  receiveTime: { sec: 1532375120, nsec: 317760607 },\\n  message: {\\n    title: \\\"This is Plot A\\\",\\n    xAxisLabel: \\\"This is my X axis label\\\",\\n    yAxisLabel: \\\"This is my Y axis label\\\",\\n    lines: [\\n      // 1 solid red line\\n      { label: \\\"solid-line\\\", borderColor: \\\"red\\\", backgroundColor: \\\"red\\\", data: [{ x: 0, y: 0 }, { x: 5, y: 5 }] },\\n      // 1 dashed pink line\\n      {\\n        label: \\\"dashed-line\\\",\\n        borderDash: [5, 5],\\n        borderColor: \\\"pink\\\",\\n        backgroundColor: \\\"pink\\\",\\n        data: [{ x: 1, y: 0.5 }, { x: 5, y: 3.5 }],\\n      },\\n    ],\\n    points: [\\n      // 3 circular blue points\\n      {\\n        label: \\\"circle-point\\\",\\n        pointBackgroundColor: \\\"blue\\\",\\n        data: [{ x: 1.5, y: 2.5 }, { x: 3, y: 4 }, { x: 4, y: 3.5 }],\\n      },\\n      // 2 teal Xs\\n      {\\n        label: \\\"cross-point\\\",\\n        pointBackgroundColor: \\\"teal\\\",\\n        pointBorderColor: \\\"teal\\\",\\n        pointStyle: \\\"crossRot\\\",\\n        pointRadius: 10,\\n        data: [{ x: 2, y: 1 }, { x: 4, y: 1 }],\\n      },\\n    ],\\n    polygons: [\\n      // 1 light gray triangle\\n      {\\n        label: \\\"polygon\\\",\\n        borderColor: \\\"lightgray\\\",\\n        backgroundColor: \\\"lightgray\\\",\\n        data: [{ x: 3, y: 1 }, { x: 4, y: 2 }, { x: 4.5, y: 1.5 }],\\n      },\\n    ],\\n  },\\n}\\n```\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport hoistNonReactStatics from \"hoist-non-react-statics\";\nimport { uniq } from \"lodash\";\nimport * as React from \"react\";\n\nimport * as PanelAPI from \"webviz-core/src/PanelAPI\";\nimport type { Message, Topic } from \"webviz-core/src/players/types\";\nimport { useChangeDetector } from \"webviz-core/src/util/hooks\";\n\n// This higher-order component provides compatibility between the old way of Panels receiving\n// messages, using \"frames\" and keeping state themselves, and the new `useMessageReducer` API which\n// manages state for you and allows in the future for more flexibility in accessing messages.\n//\n// TODO(JP): Remove FrameCompatibilityDEPRECATED from the last panel where it's still used: the 3d panel!\n// This is the \"Scenebuilder refactor\" project.\nexport function FrameCompatibilityDEPRECATED<Props>(ChildComponent: React.ComponentType<Props>, baseTopics: string[]) {\n  function FrameCompatibilityComponent(props: Props & { forwardedRef: any, topics: Topic[] }) {\n    const { forwardedRef, ...childProps } = props;\n    const [topics, setTopics] = React.useState<string[]>(baseTopics);\n    const componentSetSubscriptions = React.useCallback((newTopics: string[]) => {\n      setTopics(uniq(newTopics.concat(baseTopics || [])));\n    }, []);\n\n    // NOTE(JP): This is a huge abuse of the `useMessageReducer` API. Never use `useMessageReducer`\n    // in this way yourself!! `restore` and `addMessage` should be pure functions and not have\n    // side effects!\n    const frame = React.useRef({});\n    const lastClearTime = PanelAPI.useMessageReducer({\n      topics,\n      restore: React.useCallback(\n        () => {\n          frame.current = {};\n          return Date.now();\n        },\n        [frame]\n      ),\n      addMessage: React.useCallback(\n        (time, message: Message) => {\n          frame.current[message.topic] = frame.current[message.topic] || [];\n          frame.current[message.topic].push(message);\n          return time;\n        },\n        [frame]\n      ),\n    });\n\n    const cleared = useChangeDetector([lastClearTime], false);\n    const latestFrame = frame.current;\n    frame.current = {};\n\n    return (\n      <ChildComponent\n        {...childProps}\n        ref={forwardedRef}\n        frame={latestFrame}\n        setSubscriptions={componentSetSubscriptions}\n        cleared={cleared}\n      />\n    );\n  }\n\n  return hoistNonReactStatics(\n    React.forwardRef((props, ref) => {\n      return <FrameCompatibilityComponent {...props} forwardedRef={ref} />;\n    }),\n    ChildComponent\n  );\n}\n","module.exports = \"# 3D\\n\\nPlots visualization messages in a 3D scene.  You can select topics using the left-hand topic list; you can toggle the ability to follow orientation and manually select the frame you follow in the right-hand controls.  Selected topics will have their messages visualized within the 3D scene.  Topic selection is part of the configuration and will be saved between reloads and can be shared with `Import / Export Layout`.  This panel can be expanded / collapsed by clicking on the caret icon to the left of it.\\n\\nBy default the scene will follow the center of a frame.  When you move the camera, the camera will be offset from the center of that frame, but stay relative to that center.\\n\\nYou can toggle between a 3D perspective camera and a top-down, 2D orthographic camera of the scene by clicking on the _toggle 2D / 3D_ button in the top left of the 3D view panel.\\n\\n`Left-click + drag` on the scene to move the camera position parallel to the ground.  If 'follow' mode is on this will disengage it.\\n\\n`Right-click + drag` on the scene to pan and rotate the camera.  Dragging left/right will rotate the camera around the Z axis, and in 3D camera mode dragging top/bottom will pan the camera around the world's x/y axis.\\n\\n`Mouse-wheel` controls the 'zoom' of the camera.  Wheeling \\\"up\\\" will zoom the camera closer in while wheeling \\\"down\\\" will zoom the camera farther away.\\n\\nIn 3D camera mode, you can also use \\\"shooter controls\\\" (like those found in most popular desktop first-person shooter games) of `w` `a` `s` `d` to move the camera forward / left / backwards / right respective to the camera's position, and use `z` `x` to zoom in and out.  It's easy to get lost when using these controls as there is nothing anchoring the camera to the scene.\\n\\nHolding down `shift` in while performing any interaction with the camera will adjust values by 1/10th of their normal adjustments.  This allows precision movements and adjustments to the camera.\\n\\n_tip: If you get 'lost' in the scene and end up looking into infinite blank space and can't find your way back try clicking on 'follow' to snap the camera back to the default position._\\n\\n## Interacting with markers\\n\\nMarkers can be selected to see details about them. Open the \\\"Interactions\\\" panel from the right-side controls and click a marker to see information such as the topic name and marker contents.\\n\\nClicking on a point in a point cloud offers additional information, such as the color and coordinates of the point clicked. Selecting a point cloud also allows exporting all points from the point cloud message as a CSV.\\n\\n### Linking selected markers to global variables\\n\\nIt's possible to link fields from a selected marker to global variables. In the \\\"Clicked object\\\" tab of the \\\"Interactions\\\" panel, hover over a key in the JSON view of the marker. A button should appear that, when clicked, opens a dialog box that allows linking the field to a global variable.\\n\\nWhen a global variable is linked, selecting another marker that contains the same key will update the global variable. For example, with the tracked object \\\"id\\\" field linked to the global variable \\\"$trackedObjectId\\\", clicking another tracked object will update the \\\"$trackedObjectId\\\" field. This makes it easy to use the information about selected markers in other panels.\\n\\n## Drawing Polygons\\n\\n- To start a drawing, hold `ctrl` and click on the canvas. This will place the first point of the polygon. Continue holding ctrl and click as may times as you want to create a `string` of points connected by lines. To terminate your drawing release `ctrl` and click a final time. This will place one final point at the mouse location and 'close' the polygon. The polygon will still be selected until you click \\\"off\\\" of the polygon to anywhere else on the canvas.\\n- To select a polygon, click it once.\\n- To select a point within a polygon click it once.\\n- To move a polygon you have drawn you can click + drag on the polygon.\\n- To resize a polygon you can click + drag on an individual point within the polygon to move it. This will resize the polygon: all the points will remain connected to one another.\\n- To place a new point within an existing polygon, double click on a line within the polygon. This will bisect the line at the current double-click position, inserting a new point you may drag around to move.\\n- To delete the entire polygon, press the `delete` key when the polygon is selected.\\n- To delete an existing point in a polygon, double-click it, or press `delete` with a point selected.\\n\"","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CheckboxBlankOutlineIcon from \"@mdi/svg/svg/checkbox-blank-outline.svg\";\nimport CheckboxMarkedIcon from \"@mdi/svg/svg/checkbox-marked.svg\";\nimport React, {\n  type Node,\n  useMemo,\n  useRef,\n  useState,\n  useReducer,\n  useCallback,\n  useLayoutEffect,\n  useEffect,\n} from \"react\";\nimport {\n  PolygonBuilder,\n  DrawPolygons,\n  type CameraState,\n  type ReglClickInfo,\n  type MouseEventObject,\n  type Polygon,\n} from \"regl-worldview\";\nimport { type Time } from \"rosbag\";\n\nimport useTopicTree from \"./useTopicTree\";\nimport { useExperimentalFeature } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport KeyListener from \"webviz-core/src/components/KeyListener\";\nimport { Item } from \"webviz-core/src/components/Menu\";\nimport PanelToolbar from \"webviz-core/src/components/PanelToolbar\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport useGlobalVariables from \"webviz-core/src/hooks/useGlobalVariables\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport useDataSourceInfo from \"webviz-core/src/PanelAPI/useDataSourceInfo\";\nimport DebugStats from \"webviz-core/src/panels/ThreeDimensionalViz/DebugStats\";\nimport { POLYGON_TAB_TYPE, type DrawingTabType } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools\";\nimport MeasuringTool, { type MeasureInfo } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/MeasuringTool\";\nimport { type Save3DConfig, type ThreeDimensionalVizConfig } from \"webviz-core/src/panels/ThreeDimensionalViz/index\";\nimport { InteractionContextMenu } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions\";\nimport useLinkedGlobalVariables from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/useLinkedGlobalVariables\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport LayoutToolbar from \"webviz-core/src/panels/ThreeDimensionalViz/LayoutToolbar\";\nimport SceneBuilder from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder\";\nimport { useSearchText } from \"webviz-core/src/panels/ThreeDimensionalViz/SearchText\";\nimport {\n  getUpdatedGlobalVariablesBySelectedObject,\n  type TargetPose,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport { TOPIC_DISPLAY_MODES } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSelector/TopicDisplayModeSelector\";\nimport TopicSettingsModal from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TopicSettingsModal\";\nimport TopicTreeV2 from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/TopicTreeV2\";\nimport useSceneBuilderAndTransformsData from \"webviz-core/src/panels/ThreeDimensionalViz/TopicTreeV2/useSceneBuilderAndTransformsData\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport TransformsBuilder from \"webviz-core/src/panels/ThreeDimensionalViz/TransformsBuilder\";\nimport World from \"webviz-core/src/panels/ThreeDimensionalViz/World\";\nimport type { Frame, Topic } from \"webviz-core/src/players/types\";\nimport type { Extensions } from \"webviz-core/src/reducers/extensions\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\nimport { useShallowMemo } from \"webviz-core/src/util/hooks\";\nimport { videoRecordingMode } from \"webviz-core/src/util/inAutomatedRunMode\";\nimport { topicsByTopicName } from \"webviz-core/src/util/selectors\";\n\ntype EventName = \"onDoubleClick\" | \"onMouseMove\" | \"onMouseDown\" | \"onMouseUp\";\nexport type ClickedPosition = { clientX: number, clientY: number };\n\nexport type LayoutToolbarSharedProps = {|\n  cameraState: $Shape<CameraState>,\n  followOrientation: boolean,\n  followTf?: string | false,\n  onAlignXYAxis: () => void,\n  onCameraStateChange: (CameraState) => void,\n  onFollowChange: (followTf?: string | false, followOrientation?: boolean) => void,\n  saveConfig: Save3DConfig,\n  targetPose: ?TargetPose,\n  transforms: Transforms,\n  isPlaying?: boolean,\n|};\n\nexport type LayoutTopicSettingsSharedProps = {|\n  transforms: Transforms,\n  topics: Topic[],\n  saveConfig: Save3DConfig,\n|};\n\ntype Props = {|\n  ...LayoutToolbarSharedProps,\n  ...LayoutTopicSettingsSharedProps,\n  children?: Node,\n  cleared?: boolean,\n  currentTime: Time,\n  extensions: Extensions,\n  frame?: Frame,\n  helpContent: Node | string,\n  isPlaying?: boolean,\n  config: ThreeDimensionalVizConfig,\n  saveConfig: Save3DConfig,\n  setSubscriptions: (subscriptions: string[]) => void,\n  topics: Topic[],\n  transforms: Transforms,\n|};\n\ntype SelectedObjectState = {\n  clickedPosition: ClickedPosition,\n  selectedObject: ?MouseEventObject, // to be set when clicked a single object or selected one of the clicked topics from the context menu\n  selectedObjects: MouseEventObject[],\n};\n\nexport type EditTopicState = { tooltipPosX: number, topic: Topic };\n\nexport default function LayoutForTopicTreeV2({\n  cameraState,\n  children,\n  cleared,\n  currentTime,\n  extensions,\n  followOrientation,\n  followTf,\n  frame,\n  helpContent,\n  isPlaying,\n  onAlignXYAxis,\n  onCameraStateChange,\n  onFollowChange,\n  saveConfig,\n  topics,\n  targetPose,\n  transforms,\n  setSubscriptions,\n  config,\n  config: {\n    autoTextBackgroundColor,\n    checkedKeys,\n    expandedKeys,\n    enableShortDisplayNames,\n    flattenMarkers,\n    modifiedNamespaceTopics,\n    pinTopics,\n    selectedPolygonEditFormat = \"yaml\",\n    showCrosshair,\n    autoSyncCameraState,\n    topicDisplayMode = TOPIC_DISPLAY_MODES.SHOW_TREE.value,\n    topicSettings,\n  },\n}: Props) {\n  const [filterText, setFilterText] = useState(\"\"); // Topic tree text for filtering to see certain topics.\n  const containerRef = useRef<?HTMLDivElement>();\n  const { linkedGlobalVariables } = useLinkedGlobalVariables();\n  const { globalVariables, setGlobalVariables } = useGlobalVariables();\n  const [debug, setDebug] = useState(false);\n  const [showTopicTree, setShowTopicTree] = useState<boolean>(false);\n  const [polygonBuilder, setPolygonBuilder] = useState(() => new PolygonBuilder());\n  const [measureInfo, setMeasureInfo] = useState<MeasureInfo>({\n    measureState: \"idle\",\n    measurePoints: { start: undefined, end: undefined },\n  });\n  const [currentEditingTopic, setCurrentEditingTopic] = useState<?Topic>(undefined);\n\n  const searchTextProps = useSearchText();\n  const { searchTextOpen, searchText, setSearchTextMatches, searchTextMatches, selectedMatchIndex } = searchTextProps;\n  // used for updating DrawPolygon during mouse move and scenebuilder namespace change.\n  const [_, forceUpdate] = useReducer((x) => x + 1, 0);\n  const measuringElRef = useRef<?MeasuringTool>(null);\n  const [drawingTabType, setDrawingTabType] = useState<?DrawingTabType>(undefined);\n  const [selectedObjectState, setSelectedObjectState] = useState<?SelectedObjectState>(undefined);\n  const selectedObject = selectedObjectState && selectedObjectState.selectedObject;\n\n  useLayoutEffect(\n    () => {\n      if (!selectedObject) {\n        return;\n      }\n      const newGlobalVariables = getUpdatedGlobalVariablesBySelectedObject(selectedObject, linkedGlobalVariables);\n      if (newGlobalVariables) {\n        setGlobalVariables(newGlobalVariables);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps, only update global variables when selectedObject changes\n    [selectedObject]\n  );\n\n  // initialize the SceneBuilder and TransformsBuilder\n  const { sceneBuilder, transformsBuilder } = useMemo(\n    () => ({\n      sceneBuilder: new SceneBuilder(),\n      transformsBuilder: new TransformsBuilder(),\n    }),\n    []\n  );\n\n  // Ensure that we show new namespaces and errors any time scenebuilder adds them.\n  useMemo(\n    () => {\n      sceneBuilder.setOnForceUpdate(forceUpdate);\n    },\n    [sceneBuilder, forceUpdate]\n  );\n\n  const {\n    topicTreeConfig,\n    staticallyAvailableNamespacesByTopic,\n    supportedMarkerDatatypesSet,\n    defaultTopicSettings,\n  } = useMemo(\n    () => ({\n      supportedMarkerDatatypesSet: new Set(\n        Object.values(getGlobalHooks().perPanelHooks().ThreeDimensionalViz.SUPPORTED_MARKER_DATATYPES)\n      ),\n      topicTreeConfig: getGlobalHooks()\n        .startupPerPanelHooks()\n        .ThreeDimensionalViz.getDefaultTopicTreeV2(),\n      staticallyAvailableNamespacesByTopic: getGlobalHooks()\n        .startupPerPanelHooks()\n        .ThreeDimensionalViz.getStaticallyAvailableNamespacesByTopic(),\n      defaultTopicSettings: getGlobalHooks()\n        .startupPerPanelHooks()\n        .ThreeDimensionalViz.getDefaultSettings(),\n    }),\n    []\n  );\n\n  const { availableNamespacesByTopic, sceneErrorsByKey: sceneErrorsByTopicKey } = useSceneBuilderAndTransformsData({\n    sceneBuilder,\n    staticallyAvailableNamespacesByTopic,\n    transforms,\n  });\n\n  // Use deep compare so that we only regenerate rootTreeNode when topics change.\n  const memoizedTopics = useShallowMemo(topics);\n\n  // Only show topics with supported datatype as available in topic tree.\n  const topicTreeTopics = useMemo(\n    () => memoizedTopics.filter((topic) => supportedMarkerDatatypesSet.has(topic.datatype)),\n    [memoizedTopics, supportedMarkerDatatypesSet]\n  );\n\n  const {\n    allKeys,\n    derivedCustomSettingsByKey,\n    getIsNamespaceCheckedByDefault,\n    getIsTreeNodeVisibleInScene,\n    getIsTreeNodeVisibleInTree,\n    hasFeatureColumn,\n    rootTreeNode,\n    sceneErrorsByKey,\n    selectedNamespacesByTopic,\n    selectedTopicNames,\n    shouldExpandAllKeys,\n    toggleCheckAllAncestors,\n    toggleCheckAllDescendants,\n    toggleNamespaceChecked,\n    toggleNodeChecked,\n    toggleNodeExpanded,\n  } = useTopicTree({\n    availableNamespacesByTopic,\n    checkedKeys,\n    defaultTopicSettings,\n    expandedKeys,\n    filterText,\n    modifiedNamespaceTopics: modifiedNamespaceTopics || [],\n    providerTopics: topicTreeTopics,\n    saveConfig,\n    sceneErrorsByTopicKey,\n    topicDisplayMode,\n    topicSettings,\n    topicTreeConfig,\n  });\n\n  useEffect(() => setSubscriptions(selectedTopicNames), [selectedTopicNames, setSubscriptions]);\n  const { playerId } = useDataSourceInfo();\n\n  const rootTf = useMemo(\n    () => {\n      // TODO(Audrey): add tests for the clearing behavior\n      if (cleared) {\n        sceneBuilder.clear();\n      }\n      if (!frame) {\n        return;\n      }\n      const rootTfID = transforms.rootOfTransform(\n        followTf || getGlobalHooks().perPanelHooks().ThreeDimensionalViz.rootTransformFrame\n      ).id;\n\n      sceneBuilder.setPlayerId(playerId);\n      sceneBuilder.setTransforms(transforms, rootTfID);\n      sceneBuilder.setFlattenMarkers(!!flattenMarkers);\n      sceneBuilder.setSelectedNamespacesByTopic(selectedNamespacesByTopic);\n      sceneBuilder.setTopicSettings(topicSettings);\n\n      // toggle scene builder topics based on visible topic nodes in the tree\n      const topicsByName = topicsByTopicName(topics);\n      const selectedTopics = filterMap(selectedTopicNames, (name) => topicsByName[name]);\n      sceneBuilder.setTopics(selectedTopics);\n\n      sceneBuilder.setGlobalVariables(globalVariables);\n      sceneBuilder.setFrame(frame);\n      sceneBuilder.setCurrentTime(currentTime);\n      sceneBuilder.render();\n\n      // update the transforms and set the selected ones to render\n      transformsBuilder.setTransforms(transforms, rootTfID);\n      transformsBuilder.setSelectedTransforms(selectedNamespacesByTopic[\"/tf\"] || []);\n\n      return rootTfID;\n    },\n    [\n      cleared,\n      frame,\n      transforms,\n      followTf,\n      sceneBuilder,\n      playerId,\n      flattenMarkers,\n      selectedNamespacesByTopic,\n      topicSettings,\n      topics,\n      selectedTopicNames,\n      globalVariables,\n      currentTime,\n      transformsBuilder,\n    ]\n  );\n\n  const handleDrawPolygons = useCallback(\n    (eventName: EventName, ev: MouseEvent, args: ?ReglClickInfo) => {\n      polygonBuilder[eventName](ev, args);\n      forceUpdate();\n    },\n    [polygonBuilder]\n  );\n\n  const isDrawing = useMemo(() => measureInfo.measureState !== \"idle\" || drawingTabType === POLYGON_TAB_TYPE, [\n    drawingTabType,\n    measureInfo.measureState,\n  ]);\n  // use callbackInputsRef to prevent unnecessary callback changes\n  const callbackInputsRef = useRef({\n    cameraState,\n    debug,\n    drawingTabType,\n    handleDrawPolygons,\n    showTopicTree,\n    saveConfig,\n    selectedObjectState,\n    topics,\n    autoSyncCameraState: !!autoSyncCameraState,\n    isDrawing,\n  });\n  callbackInputsRef.current = {\n    cameraState,\n    debug,\n    drawingTabType,\n    handleDrawPolygons,\n    showTopicTree,\n    saveConfig,\n    selectedObjectState,\n    topics,\n    autoSyncCameraState: !!autoSyncCameraState,\n    isDrawing,\n  };\n\n  const handleEvent = useCallback((eventName: EventName, ev: MouseEvent, args: ?ReglClickInfo) => {\n    if (!args) {\n      return;\n    }\n    const {\n      drawingTabType: currentDrawingTabType,\n      handleDrawPolygons: currentHandleDrawPolygons,\n    } = callbackInputsRef.current;\n    // $FlowFixMe get around index signature error\n    const measuringHandler = measuringElRef.current && measuringElRef.current[eventName];\n    const measureActive = measuringElRef.current && measuringElRef.current.measureActive;\n    if (measuringHandler && measureActive) {\n      return measuringHandler(ev, args);\n    } else if (currentDrawingTabType === POLYGON_TAB_TYPE) {\n      currentHandleDrawPolygons(eventName, ev, args);\n    }\n  }, []);\n\n  const {\n    onClick,\n    onControlsOverlayClick,\n    onDoubleClick,\n    onExitTopicTreeFocus,\n    onMouseDown,\n    onMouseMove,\n    onMouseUp,\n    onClearSelectedObject,\n    onSelectObject,\n    onSetPolygons,\n    toggleCameraMode,\n    toggleDebug,\n  } = useMemo(\n    () => {\n      return {\n        onClick: (ev: MouseEvent, args: ?ReglClickInfo) => {\n          // Don't set any clicked objects when measuring distance or drawing polygons.\n          if (callbackInputsRef.current.isDrawing) {\n            return;\n          }\n          const selectedObjects = (args && args.objects) || [];\n          const clickedPosition = { clientX: ev.clientX, clientY: ev.clientY };\n          if (selectedObjects.length === 0) {\n            setSelectedObjectState(undefined);\n          } else if (selectedObjects.length === 1) {\n            // select the object directly if there is only one\n            setSelectedObjectState({ selectedObject: selectedObjects[0], selectedObjects, clickedPosition });\n          } else {\n            // open up context menu to select one object to show details\n            setSelectedObjectState({ selectedObject: undefined, selectedObjects, clickedPosition });\n          }\n        },\n        onControlsOverlayClick: (ev: SyntheticMouseEvent<HTMLDivElement>) => {\n          if (!containerRef.current) {\n            return;\n          }\n          const target = ((ev.target: any): HTMLElement);\n          // Only close if the click target is inside the panel, e.g. don't close when dropdown menus rendered in portals are clicked\n          if (containerRef.current.contains(target)) {\n            setShowTopicTree(false);\n          }\n        },\n        onDoubleClick: (ev: MouseEvent, args: ?ReglClickInfo) => handleEvent(\"onDoubleClick\", ev, args),\n        onExitTopicTreeFocus: (ev) => {\n          if (containerRef.current) {\n            containerRef.current.focus();\n          }\n        },\n        onMouseDown: (ev: MouseEvent, args: ?ReglClickInfo) => handleEvent(\"onMouseDown\", ev, args),\n        onMouseMove: (ev: MouseEvent, args: ?ReglClickInfo) => handleEvent(\"onMouseMove\", ev, args),\n        onMouseUp: (ev: MouseEvent, args: ?ReglClickInfo) => handleEvent(\"onMouseUp\", ev, args),\n        onClearSelectedObject: () => setSelectedObjectState(undefined),\n        onSelectObject: (selectedObj: MouseEventObject) =>\n          setSelectedObjectState({ ...callbackInputsRef.current.selectedObjectState, selectedObject: selectedObj }),\n        onSetPolygons: (polygons: Polygon[]) => setPolygonBuilder(new PolygonBuilder(polygons)),\n        toggleDebug: () => setDebug(!callbackInputsRef.current.debug),\n        toggleCameraMode: () => {\n          const { cameraState: currentCameraState, saveConfig: currentSaveConfig } = callbackInputsRef.current;\n          currentSaveConfig({ cameraState: { ...currentCameraState, perspective: !currentCameraState.perspective } });\n          if (measuringElRef.current && currentCameraState.perspective) {\n            measuringElRef.current.reset();\n          }\n        },\n      };\n    },\n    [handleEvent]\n  );\n\n  const glTextEnabled = useExperimentalFeature(\"glText\");\n  const keyDownHandlers = useMemo(\n    () => {\n      const handlers: { [key: string]: (e: KeyboardEvent) => void } = {\n        \"3\": () => {\n          toggleCameraMode();\n        },\n        Escape: (e) => {\n          e.preventDefault();\n          setDrawingTabType(null);\n          searchTextProps.toggleSearchTextOpen(false);\n          if (document.activeElement && document.activeElement === containerRef.current) {\n            document.activeElement.blur();\n          }\n        },\n        t: (e) => {\n          e.preventDefault();\n          // Unpin before enabling keyboard toggle open/close.\n          if (pinTopics) {\n            saveConfig({ pinTopics: false }, { keepLayoutInUrl: true });\n            return;\n          }\n          setShowTopicTree(!showTopicTree);\n        },\n      };\n\n      if (glTextEnabled) {\n        handlers.f = (e: KeyboardEvent) => {\n          if (e.ctrlKey || e.metaKey) {\n            e.preventDefault();\n            searchTextProps.toggleSearchTextOpen(true);\n            if (!searchTextProps.searchInputRef || !searchTextProps.searchInputRef.current) {\n              return;\n            }\n            searchTextProps.searchInputRef.current.select();\n          }\n        };\n      }\n      return handlers;\n    },\n    [glTextEnabled, pinTopics, saveConfig, searchTextProps, showTopicTree, toggleCameraMode]\n  );\n\n  const markerProviders = useMemo(() => extensions.markerProviders.concat([sceneBuilder, transformsBuilder]), [\n    extensions.markerProviders,\n    sceneBuilder,\n    transformsBuilder,\n  ]);\n\n  const cursorType = isDrawing ? \"crosshair\" : \"\";\n\n  const { MapComponent, videoRecordingStyle } = useMemo(\n    () => ({\n      MapComponent: getGlobalHooks().perPanelHooks().ThreeDimensionalViz.MapComponent,\n      videoRecordingStyle: { visibility: videoRecordingMode() ? \"hidden\" : \"visible\" },\n    }),\n    []\n  );\n\n  const memoizedScene = useShallowMemo(sceneBuilder.getScene());\n  const mapNamespaces = useShallowMemo(selectedNamespacesByTopic[\"/metadata\"] || []);\n  const mapElement = useMemo(\n    () =>\n      MapComponent && (\n        <MapComponent\n          extensions={mapNamespaces}\n          scene={memoizedScene}\n          debug={debug}\n          perspective={!!cameraState.perspective}\n        />\n      ),\n    [MapComponent, cameraState.perspective, debug, mapNamespaces, memoizedScene]\n  );\n\n  return (\n    <div\n      ref={containerRef}\n      onClick={onControlsOverlayClick}\n      tabIndex={-1}\n      className={styles.container}\n      style={{ cursor: cursorType }}\n      data-test=\"3dviz-layout\">\n      <KeyListener keyDownHandlers={keyDownHandlers} />\n      <PanelToolbar\n        floating\n        helpContent={helpContent}\n        menuContent={\n          <>\n            <Item\n              tooltip=\"Markers with 0 as z-value in pose or points are updated to have the z-value of the flattened base frame.\"\n              icon={flattenMarkers ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n              onClick={() => saveConfig({ flattenMarkers: !flattenMarkers })}>\n              Flatten markers\n            </Item>\n            <Item\n              tooltip=\"Automatically apply dark/light background color to text.\"\n              icon={autoTextBackgroundColor ? <CheckboxMarkedIcon /> : <CheckboxBlankOutlineIcon />}\n              onClick={() => saveConfig({ autoTextBackgroundColor: !autoTextBackgroundColor })}>\n              Auto Text Background\n            </Item>\n          </>\n        }\n      />\n      <div style={{ ...videoRecordingStyle, position: \"relative\", width: \"100%\", height: \"100%\" }}>\n        {containerRef.current && (\n          <TopicTreeV2\n            availableNamespacesByTopic={availableNamespacesByTopic}\n            checkedKeys={checkedKeys}\n            containerHeight={containerRef.current.clientHeight}\n            containerWidth={containerRef.current.clientWidth}\n            expandedKeys={expandedKeys}\n            getIsTreeNodeVisibleInScene={getIsTreeNodeVisibleInScene}\n            getIsTreeNodeVisibleInTree={getIsTreeNodeVisibleInTree}\n            getIsNamespaceCheckedByDefault={getIsNamespaceCheckedByDefault}\n            onExitTopicTreeFocus={onExitTopicTreeFocus}\n            toggleCheckAllAncestors={toggleCheckAllAncestors}\n            toggleCheckAllDescendants={toggleCheckAllDescendants}\n            toggleNamespaceChecked={toggleNamespaceChecked}\n            toggleNodeChecked={toggleNodeChecked}\n            toggleNodeExpanded={toggleNodeExpanded}\n            topicDisplayMode={topicDisplayMode}\n            pinTopics={pinTopics}\n            rootTreeNode={rootTreeNode}\n            saveConfig={saveConfig}\n            derivedCustomSettingsByKey={derivedCustomSettingsByKey}\n            sceneErrorsByKey={sceneErrorsByKey}\n            setCurrentEditingTopic={setCurrentEditingTopic}\n            setShowTopicTree={setShowTopicTree}\n            showTopicTree={showTopicTree}\n            filterText={filterText}\n            setFilterText={setFilterText}\n            allKeys={allKeys}\n            shouldExpandAllKeys={shouldExpandAllKeys}\n          />\n        )}\n        {currentEditingTopic && (\n          <TopicSettingsModal\n            currentEditingTopic={currentEditingTopic}\n            hasFeatureColumn={hasFeatureColumn}\n            setCurrentEditingTopic={setCurrentEditingTopic}\n            sceneBuilderMessage={\n              sceneBuilder.collectors[currentEditingTopic.name] &&\n              sceneBuilder.collectors[currentEditingTopic.name].getMessages()[0]\n            }\n            saveConfig={saveConfig}\n            topicSettings={topicSettings}\n          />\n        )}\n      </div>\n      <div className={styles.world}>\n        <World\n          key={`${callbackInputsRef.current.autoSyncCameraState ? \"synced\" : \"not-synced\"}`}\n          autoTextBackgroundColor={!!autoTextBackgroundColor}\n          cameraState={cameraState}\n          isPlaying={!!isPlaying}\n          markerProviders={markerProviders}\n          onCameraStateChange={onCameraStateChange}\n          onClick={onClick}\n          onDoubleClick={onDoubleClick}\n          onMouseDown={onMouseDown}\n          onMouseMove={onMouseMove}\n          onMouseUp={onMouseUp}\n          searchTextOpen={searchTextOpen}\n          searchText={searchText}\n          setSearchTextMatches={setSearchTextMatches}\n          searchTextMatches={searchTextMatches}\n          selectedMatchIndex={selectedMatchIndex}>\n          {mapElement}\n          {children}\n          <DrawPolygons>{polygonBuilder.polygons}</DrawPolygons>\n          <div style={videoRecordingStyle}>\n            <LayoutToolbar\n              cameraState={cameraState}\n              debug={debug}\n              drawingTabType={drawingTabType}\n              isDrawing={isDrawing}\n              followOrientation={followOrientation}\n              followTf={followTf}\n              interactionData={selectedObject && selectedObject.object && selectedObject.object.interactionData}\n              isPlaying={isPlaying}\n              measureInfo={measureInfo}\n              measuringElRef={measuringElRef}\n              onAlignXYAxis={onAlignXYAxis}\n              onCameraStateChange={onCameraStateChange}\n              autoSyncCameraState={!!autoSyncCameraState}\n              onClearSelectedObject={onClearSelectedObject}\n              onFollowChange={onFollowChange}\n              onSetDrawingTabType={setDrawingTabType}\n              onSetPolygons={onSetPolygons}\n              onToggleCameraMode={toggleCameraMode}\n              onToggleDebug={toggleDebug}\n              polygonBuilder={polygonBuilder}\n              saveConfig={saveConfig}\n              selectedObject={selectedObject}\n              selectedPolygonEditFormat={selectedPolygonEditFormat}\n              setMeasureInfo={setMeasureInfo}\n              showCrosshair={showCrosshair}\n              targetPose={targetPose}\n              transforms={transforms}\n              rootTf={rootTf}\n              {...searchTextProps}\n            />\n          </div>\n          {selectedObjectState &&\n            selectedObjectState.selectedObjects.length > 1 &&\n            !selectedObjectState.selectedObject && (\n              <InteractionContextMenu\n                clickedPosition={selectedObjectState.clickedPosition}\n                onSelectObject={onSelectObject}\n                selectedObjects={selectedObjectState.selectedObjects}\n              />\n            )}\n          {process.env.NODE_ENV !== \"production\" && !inScreenshotTests() && debug && <DebugStats />}\n        </World>\n      </div>\n    </div>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport React, { useContext, useRef } from \"react\";\nimport { WorldviewReactContext, type WorldviewContextType } from \"regl-worldview\";\n\nconst style = {\n  position: \"absolute\",\n  bottom: 5,\n  right: 5,\n  backgroundColor: \"rgba(1, 1, 1, 0.2)\",\n  padding: 5,\n  fontFamily: \"monospace\",\n};\n\n// Looks at the regl stats and throws errors if it seems we're going over acceptable (arbitrary) max ranges.\n// The maxes are arbitrarily set to be an order of magnitude higher than the 'steady state' of a pretty loaded webviz scene to\n// allow for plenty of headroom.\nfunction validate(stats) {\n  if (stats.bufferCount > 500) {\n    throw new Error(`Possible gl buffer leak detected. Buffer count: ${stats.bufferCount}`);\n  }\n  if (stats.elementsCount > 500) {\n    throw new Error(`Possible gl elements leak detected. Buffer count: ${stats.elementsCount}`);\n  }\n  if (stats.textureCount > 500) {\n    throw new Error(`Possible gl texture leak detected. Texture count: ${stats.textureCount}`);\n  }\n  // We should likely have far fewer than 100 shaders...they only get created when regl \"compiles\" a command.\n  // Nevertheless, we should check in case there's some wild code somewhere constantly recompiling a command.\n  if (stats.shaderCount > 100) {\n    throw new Error(`Possible gl shader leak detected. Shader count: ${stats.shaderCount}`);\n  }\n}\n\n// Shows debug regl stats in the 3d panel.  Crashes the panel if regl stats drift outside of acceptable ranges.\n// TODO(bmc): move to regl-worldview at some point\nexport default function DebugStats() {\n  const context = useContext<WorldviewContextType>(WorldviewReactContext);\n  const renderCount = useRef(0);\n  renderCount.current = renderCount.current + 1;\n  if (context.initializedData.regl) {\n    const { stats } = context.initializedData.regl;\n    validate(stats);\n    const textureSize = (stats.getTotalTextureSize() / (1024 * 1024)).toFixed(1);\n    const bufferSize = (stats.getTotalBufferSize() / (1024 * 1024)).toFixed(1);\n    return (\n      <div style={style}>\n        <div>renders: {renderCount.current}</div>\n        <div>\n          buffers: {stats.bufferCount} ({bufferSize}) Mb\n        </div>\n        <div>\n          textures: {stats.textureCount} ({textureSize}) Mb\n        </div>\n        <div>elements: {stats.elementsCount}</div>\n        <div>shaders: {stats.shaderCount}</div>\n      </div>\n    );\n  }\n  return null;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { PolygonBuilder, Polygon } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport Button from \"webviz-core/src/components/Button\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport ValidatedInput, { type EditFormat } from \"webviz-core/src/components/ValidatedInput\";\nimport { polygonPointsValidator } from \"webviz-core/src/components/validators\";\nimport { SValue, SLabel } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/Interactions\";\nimport {\n  polygonsToPoints,\n  getFormattedString,\n  pointsToPolygons,\n  getPolygonLineDistances,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/utils/drawToolUtils\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\n\nexport type Point2D = {| x: number, y: number |};\n\nexport const SRow = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 8px 0;\n`;\n\ntype Props = {\n  onSetPolygons: (polygons: Polygon[]) => void,\n  polygonBuilder: PolygonBuilder,\n  selectedPolygonEditFormat: EditFormat,\n};\n\nexport default function Polygons({ onSetPolygons, polygonBuilder, selectedPolygonEditFormat }: Props) {\n  const { saveConfig } = React.useContext(PanelContext) || {};\n  const polygons: Polygon[] = polygonBuilder.polygons;\n  const [polygonPoints, setPolygonPoints] = React.useState<Point2D[][]>(() => polygonsToPoints(polygons));\n  function polygonBuilderOnChange() {\n    setPolygonPoints(polygonsToPoints(polygons));\n  }\n  polygonBuilder.onChange = polygonBuilderOnChange;\n\n  return (\n    <>\n      <ValidatedInput\n        format={selectedPolygonEditFormat}\n        value={polygonPoints}\n        onSelectFormat={(selectedFormat) => saveConfig({ selectedPolygonEditFormat: selectedFormat })}\n        onChange={(newPolygonPoints) => {\n          if (newPolygonPoints) {\n            setPolygonPoints(newPolygonPoints);\n            onSetPolygons(pointsToPolygons(newPolygonPoints));\n          }\n        }}\n        dataValidator={polygonPointsValidator}>\n        <Button\n          small\n          tooltip=\"Copy Polygons\"\n          onClick={() => {\n            clipboard.copy(getFormattedString(polygonPoints, selectedPolygonEditFormat));\n          }}>\n          Copy\n        </Button>\n      </ValidatedInput>\n      <SRow>\n        <SLabel>Total length:</SLabel>\n        <SValue>{getPolygonLineDistances(polygonPoints).toFixed(2)} m</SValue>\n      </SRow>\n      <p style={{ marginTop: 0 }}>\n        <em>\n          Start drawing by holding <b>ctrl</b> and clicking on the 3D panel.\n        </em>\n      </p>\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { Polygon, PolygonPoint } from \"regl-worldview\";\n\nimport { EDIT_FORMAT, type EditFormat } from \"webviz-core/src/components/ValidatedInput\";\nimport { type Point2D } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools\";\nimport YAML from \"webviz-core/src/util/yaml\";\n\nexport function polygonsToPoints(polygons: Polygon[]): Point2D[][] {\n  return polygons.map((poly) => {\n    return poly.points.map((point) => ({ x: point.point[0], y: point.point[1] }));\n  });\n}\n\nexport function pointsToPolygons(polygonPoints: Point2D[][]): Polygon[] {\n  // map the points back to polygons\n  return polygonPoints.map((pointsPerPolygon, idx) => {\n    const polygon = new Polygon(`${idx}`);\n    polygon.points = pointsPerPolygon.map(({ x, y }) => new PolygonPoint([x, y, 0]));\n    return polygon;\n  });\n}\n\nfunction pointsToYaml(polygonPoints: Point2D[][]): string {\n  if (!polygonPoints.length || !polygonPoints[0].length) {\n    return \"\";\n  }\n  return YAML.stringify(polygonPoints);\n}\n\nfunction pointsToJson(polygonPoints: Point2D[][]): string {\n  return JSON.stringify(polygonPoints, null, 2);\n}\n\nexport function getFormattedString(polygonPoints: Point2D[][], selectedPolygonEditFormat: EditFormat) {\n  return selectedPolygonEditFormat === EDIT_FORMAT.JSON ? pointsToJson(polygonPoints) : pointsToYaml(polygonPoints);\n}\n\n// calculate the sum of the line distances\nexport function getPolygonLineDistances(polygonPoints: Point2D[][]): number {\n  return polygonPoints.reduce((memo, polyPoints, idx) => {\n    if (polyPoints.length > 1) {\n      for (let i = 0; i < polyPoints.length - 1; i++) {\n        memo += Math.hypot(polyPoints[i + 1].x - polyPoints[i].x, polyPoints[i + 1].y - polyPoints[i].y);\n      }\n    }\n    return memo;\n  }, 0);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport cx from \"classnames\";\nimport React, { useMemo } from \"react\";\nimport { PolygonBuilder, type MouseEventObject, type Polygon } from \"regl-worldview\";\n\nimport { useExperimentalFeature } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport CameraInfo from \"webviz-core/src/panels/ThreeDimensionalViz/CameraInfo\";\nimport Crosshair from \"webviz-core/src/panels/ThreeDimensionalViz/Crosshair\";\nimport DrawingTools, { type DrawingTabType } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools\";\nimport MeasuringTool, { type MeasureInfo } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/MeasuringTool\";\nimport FollowTFControl from \"webviz-core/src/panels/ThreeDimensionalViz/FollowTFControl\";\nimport Interactions, { type InteractionData } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions\";\nimport { type LayoutToolbarSharedProps } from \"webviz-core/src/panels/ThreeDimensionalViz/Layout\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport MainToolbar from \"webviz-core/src/panels/ThreeDimensionalViz/MainToolbar\";\nimport MeasureMarker from \"webviz-core/src/panels/ThreeDimensionalViz/MeasureMarker\";\nimport SearchText, { type SearchTextProps } from \"webviz-core/src/panels/ThreeDimensionalViz/SearchText\";\n\ntype Props = {|\n  ...LayoutToolbarSharedProps,\n  autoSyncCameraState: boolean,\n  debug: boolean,\n  isDrawing: boolean,\n  drawingTabType: ?DrawingTabType,\n  interactionData: ?InteractionData,\n  measureInfo: MeasureInfo,\n  measuringElRef: { current: ?MeasuringTool },\n  onClearSelectedObject: () => void,\n  setMeasureInfo: (MeasureInfo) => void,\n  onSetDrawingTabType: (?DrawingTabType) => void,\n  onSetPolygons: (polygons: Polygon[]) => void,\n  onToggleCameraMode: () => void,\n  onToggleDebug: () => void,\n  polygonBuilder: PolygonBuilder,\n  rootTf: ?string,\n  selectedObject: ?MouseEventObject,\n  selectedPolygonEditFormat: \"json\" | \"yaml\",\n  showCrosshair: ?boolean,\n  ...SearchTextProps,\n|};\n\nfunction LayoutToolbar({\n  autoSyncCameraState,\n  cameraState,\n  debug,\n  isDrawing,\n  drawingTabType,\n  followOrientation,\n  followTf,\n  interactionData,\n  isPlaying,\n  measureInfo,\n  measuringElRef,\n  onAlignXYAxis,\n  onCameraStateChange,\n  onClearSelectedObject,\n  onFollowChange,\n  setMeasureInfo,\n  onSetDrawingTabType,\n  onSetPolygons,\n  onToggleCameraMode,\n  onToggleDebug,\n  polygonBuilder,\n  rootTf,\n  saveConfig,\n  searchInputRef,\n  searchText,\n  searchTextMatches,\n  searchTextOpen,\n  selectedMatchIndex,\n  selectedObject,\n  selectedPolygonEditFormat,\n  setSearchText,\n  setSearchTextMatches,\n  setSelectedMatchIndex,\n  showCrosshair,\n  targetPose,\n  toggleSearchTextOpen,\n  transforms,\n}: Props) {\n  const additionalToolbarItemsElem = useMemo(\n    () => {\n      const AdditionalToolbarItems = getGlobalHooks().perPanelHooks().ThreeDimensionalViz.AdditionalToolbarItems;\n      return (\n        <div className={cx(styles.buttons, styles.cartographer)}>\n          <AdditionalToolbarItems transforms={transforms} />\n        </div>\n      );\n    },\n    [transforms]\n  );\n\n  const glTextEnabled = useExperimentalFeature(\"glText\");\n  return (\n    <>\n      <MeasuringTool\n        ref={measuringElRef}\n        measureState={measureInfo.measureState}\n        measurePoints={measureInfo.measurePoints}\n        onMeasureInfoChange={setMeasureInfo}\n      />\n      <div className={cx(styles.toolbar, styles.right)}>\n        {glTextEnabled && (\n          <div className={styles.buttons}>\n            <SearchText\n              searchTextOpen={searchTextOpen}\n              toggleSearchTextOpen={toggleSearchTextOpen}\n              searchText={searchText}\n              setSearchText={setSearchText}\n              setSearchTextMatches={setSearchTextMatches}\n              searchTextMatches={searchTextMatches}\n              searchInputRef={searchInputRef}\n              setSelectedMatchIndex={setSelectedMatchIndex}\n              selectedMatchIndex={selectedMatchIndex}\n              onCameraStateChange={onCameraStateChange}\n              cameraState={cameraState}\n              transforms={transforms}\n              rootTf={rootTf}\n              onFollowChange={onFollowChange}\n            />\n          </div>\n        )}\n        <div className={styles.buttons}>\n          <FollowTFControl\n            transforms={transforms}\n            tfToFollow={followTf ? followTf : undefined}\n            followOrientation={followOrientation}\n            onFollowChange={onFollowChange}\n          />\n        </div>\n        <MainToolbar\n          measureInfo={measureInfo}\n          measuringTool={measuringElRef.current}\n          perspective={cameraState.perspective}\n          debug={debug}\n          onToggleCameraMode={onToggleCameraMode}\n          onToggleDebug={onToggleDebug}\n        />\n        {measuringElRef.current && measuringElRef.current.measureDistance}\n        <Interactions\n          isDrawing={isDrawing}\n          interactionData={interactionData}\n          onClearSelectedObject={onClearSelectedObject}\n          selectedObject={selectedObject}\n        />\n        <DrawingTools\n          onSetPolygons={onSetPolygons}\n          polygonBuilder={polygonBuilder}\n          saveConfig={saveConfig}\n          selectedPolygonEditFormat={selectedPolygonEditFormat}\n          onSetDrawingTabType={onSetDrawingTabType}\n        />\n        <CameraInfo\n          cameraState={cameraState}\n          targetPose={targetPose}\n          followOrientation={followOrientation}\n          followTf={followTf}\n          isPlaying={isPlaying}\n          onAlignXYAxis={onAlignXYAxis}\n          onCameraStateChange={onCameraStateChange}\n          showCrosshair={!!showCrosshair}\n          autoSyncCameraState={autoSyncCameraState}\n        />\n        {additionalToolbarItemsElem}\n      </div>\n      {!cameraState.perspective && showCrosshair && <Crosshair cameraState={cameraState} />}\n      <MeasureMarker measurePoints={measureInfo.measurePoints} />\n    </>\n  );\n}\n\nexport default React.memo<Props>(LayoutToolbar);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport CameraControlIcon from \"@mdi/svg/svg/camera-control.svg\";\nimport { vec3 } from \"gl-matrix\";\nimport { isEqual } from \"lodash\";\nimport * as React from \"react\";\nimport { type CameraState, cameraStateSelectors } from \"regl-worldview\";\nimport styled from \"styled-components\";\n\nimport Button from \"webviz-core/src/components/Button\";\nimport ExpandingToolbar, { ToolGroup } from \"webviz-core/src/components/ExpandingToolbar\";\nimport Flex from \"webviz-core/src/components/Flex\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport PanelContext from \"webviz-core/src/components/PanelContext\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { UncontrolledValidatedInput, YamlInput } from \"webviz-core/src/components/ValidatedInput\";\nimport { point2DValidator, cameraStateValidator } from \"webviz-core/src/components/validators\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport { Renderer, type ThreeDimensionalVizConfig } from \"webviz-core/src/panels/ThreeDimensionalViz\";\nimport { SValue, SLabel } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/Interactions\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport {\n  getNewCameraStateOnFollowChange,\n  type TargetPose,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/threeDimensionalVizUtils\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\nimport clipboard from \"webviz-core/src/util/clipboard\";\n\nexport const CAMERA_TAB_TYPE = \"Camera\";\n\nconst LABEL_WIDTH = 112;\nconst TEMP_VEC3 = [0, 0, 0];\nconst ZERO_VEC3 = Object.freeze([0, 0, 0]);\nconst DEFAULT_CAMERA_INFO_WIDTH = 260;\n\nconst SRow = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\ntype CameraStateInfoProps = {\n  cameraState: $Shape<CameraState>,\n  onAlignXYAxis: () => void,\n};\n\nexport type CameraInfoPropsWithoutCameraState = {\n  followOrientation: boolean,\n  followTf?: string | false,\n  isPlaying?: boolean,\n  onAlignXYAxis: () => void,\n  onCameraStateChange: (CameraState) => void,\n  showCrosshair?: boolean,\n  autoSyncCameraState: boolean,\n  defaultSelectedTab?: string,\n};\n\ntype CameraInfoProps = {\n  cameraState: $Shape<CameraState>,\n  targetPose: ?TargetPose,\n} & CameraInfoPropsWithoutCameraState;\n\nfunction CameraStateInfo({ cameraState, onAlignXYAxis }: CameraStateInfoProps) {\n  return (\n    <>\n      {Object.keys(cameraState)\n        .sort()\n        .map((key) => {\n          let val = cameraState[key];\n          if (key === \"perspective\") {\n            val = cameraState[key] ? \"true\" : \"false\";\n          } else if (Array.isArray(cameraState[key])) {\n            val = cameraState[key].map((x) => x.toFixed(1)).join(\", \");\n          } else if (typeof cameraState[key] === \"number\") {\n            val = cameraState[key].toFixed(2);\n          }\n          return [key, val];\n        })\n        .map(([key, val]) => (\n          <SRow key={key}>\n            <SLabel width={LABEL_WIDTH}>{key}:</SLabel> <SValue>{val}</SValue>\n            {key === \"thetaOffset\" && (\n              <Button\n                onClick={onAlignXYAxis}\n                tooltip=\"Align XY axis by reseting thetaOffset to 0. Will no longer follow orientation.\">\n                RESET\n              </Button>\n            )}\n          </SRow>\n        ))}\n    </>\n  );\n}\n\nexport default function CameraInfo({\n  cameraState,\n  targetPose,\n  followOrientation,\n  followTf,\n  isPlaying,\n  onAlignXYAxis,\n  onCameraStateChange,\n  showCrosshair,\n  autoSyncCameraState,\n  defaultSelectedTab,\n}: CameraInfoProps) {\n  const [selectedTab, setSelectedTab] = React.useState(defaultSelectedTab);\n  const { updatePanelConfig, saveConfig } = React.useContext(PanelContext) || {};\n  const [edit, setEdit] = React.useState<boolean>(false);\n\n  const { target, targetOffset } = cameraState;\n  const targetHeading = cameraStateSelectors.targetHeading(cameraState);\n  const camPos2D = vec3.add(TEMP_VEC3, target, vec3.rotateZ(TEMP_VEC3, targetOffset, ZERO_VEC3, -targetHeading));\n  const camPos2DTrimmed = camPos2D.map((num) => +num.toFixed(2));\n\n  const syncCameraState = () => {\n    updatePanelConfig(Renderer.panelType, (config: ThreeDimensionalVizConfig) => {\n      // Transform the camera state by whichever TF or orientation the other panels are following.\n      const newCameraState = getNewCameraStateOnFollowChange({\n        prevCameraState: cameraState,\n        prevTargetPose: targetPose,\n        prevFollowTf: followTf,\n        prevFollowOrientation: followOrientation,\n        newFollowTf: config.followTf,\n        newFollowOrientation: config.followOrientation,\n      });\n      return { ...config, cameraState: newCameraState };\n    });\n  };\n\n  return (\n    <ExpandingToolbar\n      tooltip=\"Camera\"\n      icon={\n        <Icon style={{ color: autoSyncCameraState ? colors.accent : \"white\" }}>\n          <CameraControlIcon />\n        </Icon>\n      }\n      className={styles.buttons}\n      selectedTab={selectedTab}\n      onSelectTab={(newSelectedTab) => setSelectedTab(newSelectedTab)}>\n      <ToolGroup name={CAMERA_TAB_TYPE}>\n        <Flex col style={{ minWidth: DEFAULT_CAMERA_INFO_WIDTH }}>\n          <Flex row reverse>\n            <Button\n              tooltip=\"Copy cameraState\"\n              small\n              onClick={() => {\n                clipboard.copy(JSON.stringify(cameraState, null, 2));\n              }}>\n              Copy\n            </Button>\n            <Button\n              disabled={!!isPlaying}\n              tooltip={isPlaying ? \"Pause player to edit raw camera state object\" : \"Edit raw camera state object\"}\n              onClick={() => setEdit(!edit)}>\n              {edit ? \"Done\" : \"Edit\"}\n            </Button>\n            <Button tooltip=\"Sync camera state across all 3D panels\" onClick={syncCameraState}>\n              Sync\n            </Button>\n          </Flex>\n          {edit && !isPlaying ? (\n            <UncontrolledValidatedInput\n              format=\"yaml\"\n              value={cameraState}\n              onChange={(newCameraState) => saveConfig({ cameraState: newCameraState })}\n              dataValidator={cameraStateValidator}\n            />\n          ) : (\n            <Flex col>\n              <CameraStateInfo cameraState={cameraState} onAlignXYAxis={onAlignXYAxis} />\n              <Flex col>\n                <SRow style={{ marginBottom: 8 }}>\n                  <Tooltip placement=\"top\" contents=\"Automatically sync camera across all 3D panels\">\n                    <SLabel>Auto sync:</SLabel>\n                  </Tooltip>\n                  <SValue>\n                    <input\n                      type=\"checkbox\"\n                      checked={autoSyncCameraState}\n                      onChange={() =>\n                        updatePanelConfig(Renderer.panelType, (config) => ({\n                          ...config,\n                          cameraState,\n                          autoSyncCameraState: !autoSyncCameraState,\n                        }))\n                      }\n                    />\n                  </SValue>\n                </SRow>\n                <SRow style={{ marginBottom: 8 }}>\n                  <SLabel style={cameraState.perspective ? { color: colors.textMuted } : {}}>Show crosshair:</SLabel>\n                  <SValue>\n                    <input\n                      type=\"checkbox\"\n                      disabled={cameraState.perspective}\n                      checked={showCrosshair}\n                      onChange={() => saveConfig({ showCrosshair: !showCrosshair })}\n                    />\n                  </SValue>\n                </SRow>\n                {showCrosshair && !cameraState.perspective && (\n                  <SRow style={{ paddingLeft: LABEL_WIDTH, marginBottom: 8 }}>\n                    <SValue>\n                      <YamlInput\n                        inputStyle={{ width: 140 }}\n                        value={{ x: camPos2DTrimmed[0], y: camPos2DTrimmed[1] }}\n                        onChange={(data) => {\n                          const newPos = [data.x, data.y, 0];\n                          // extract the targetOffset by subtracting from the target and un-rotating by heading\n                          const newTargetOffset = vec3.rotateZ(\n                            [0, 0, 0],\n                            vec3.sub(TEMP_VEC3, newPos, cameraState.target),\n                            ZERO_VEC3,\n                            cameraStateSelectors.targetHeading(cameraState)\n                          );\n                          if (!isEqual(cameraState.targetOffset, newTargetOffset)) {\n                            onCameraStateChange({ ...cameraState, targetOffset: newTargetOffset });\n                          }\n                        }}\n                        dataValidator={point2DValidator}\n                      />\n                    </SValue>\n                  </SRow>\n                )}\n              </Flex>\n              {followTf ? (\n                <SRow>\n                  <SLabel>Following frame:</SLabel>\n                  <SValue>\n                    <code>{followTf}</code>\n                    {followOrientation && \" with orientation\"}\n                  </SValue>\n                </SRow>\n              ) : (\n                <p>Locked to map ({getGlobalHooks().perPanelHooks().ThreeDimensionalViz.rootTransformFrame})</p>\n              )}\n            </Flex>\n          )}\n        </Flex>\n      </ToolGroup>\n    </ExpandingToolbar>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { vec3, quat } from \"gl-matrix\";\nimport React from \"react\";\nimport { cameraStateSelectors, Lines, type CameraState } from \"regl-worldview\";\n\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\n\ntype Props = {\n  cameraState: CameraState,\n};\n\nexport default function Crosshair({ cameraState }: Props) {\n  const { target, targetOffset, distance, thetaOffset } = cameraState;\n  const targetHeading = cameraStateSelectors.targetHeading(cameraState);\n  // move the crosshair to the center of the camera's viewport: the target + targetOffset rotated by heading\n  const crosshairPoint = [0, 0, 0];\n  vec3.add(crosshairPoint, vec3.rotateZ(crosshairPoint, targetOffset, [0, 0, 0], -targetHeading), target);\n\n  // orient and size the crosshair so it remains visually fixed in the center\n  const length = 0.02 * distance;\n  const orientation = [0, 0, 0, 1];\n  const theta = targetHeading + thetaOffset;\n\n  quat.rotateZ(orientation, orientation, -theta);\n\n  const crosshair = (z, extraThickness) => {\n    const thickness = 0.004 * distance * (1 + extraThickness);\n    return {\n      header: {\n        frame_id: getGlobalHooks().rootTransformFrame,\n        stamp: { sec: 0, nsec: 0 },\n      },\n      type: 5,\n      action: 0,\n      id: \"\",\n      ns: \"\",\n      pose: {\n        position: { x: crosshairPoint[0], y: crosshairPoint[1], z },\n        orientation: {\n          x: orientation[0],\n          y: orientation[1],\n          z: orientation[2],\n          w: orientation[3],\n        },\n      },\n      points: [\n        { x: -length * (1 + 0.1 * extraThickness), y: 0, z: 0 },\n        { x: length * (1 + 0.1 * extraThickness), y: 0, z: 0 },\n        { x: 0, y: -length * (1 + 0.1 * extraThickness), z: 0 },\n        { x: 0, y: length * (1 + 0.1 * extraThickness), z: 0 },\n      ],\n      scale: { x: thickness, y: thickness, z: thickness },\n    };\n  };\n\n  return (\n    <Lines>\n      {[\n        {\n          ...crosshair(1000, 0.6),\n          color: { r: 0, g: 0, b: 0, a: 1 },\n        },\n        {\n          ...crosshair(1001, 0),\n          color: { r: 1, g: 1, b: 1, a: 1 },\n        },\n      ]}\n    </Lines>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport CrosshairsGpsIcon from \"@mdi/svg/svg/crosshairs-gps.svg\";\nimport MenuDownIcon from \"@mdi/svg/svg/menu-down.svg\";\nimport MenuLeftIcon from \"@mdi/svg/svg/menu-left.svg\";\nimport CompassOutlineIcon from \"@mdi/svg/svg/navigation.svg\";\nimport { sortBy, debounce } from \"lodash\";\nimport React, { memo, createRef, useCallback, useState } from \"react\";\nimport shallowequal from \"shallowequal\";\nimport styled from \"styled-components\";\n\nimport { type Transform } from \"./Transforms\";\nimport Autocomplete from \"webviz-core/src/components/Autocomplete\";\nimport Button from \"webviz-core/src/components/Button\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\ntype TfTreeNode = {\n  tf: Transform,\n  children: TfTreeNode[],\n  depth: number,\n};\n\ntype TfTree = {\n  roots: TfTreeNode[],\n  nodes: { [string]: TfTreeNode },\n};\n\nconst treeNodeToTfId = (node) => node.tf.id;\n\nconst buildTfTree = (transforms: Transform[]): TfTree => {\n  const tree: TfTree = {\n    roots: [],\n    nodes: {},\n  };\n  // Create treeNodes for all tfs.\n  for (const tf of transforms) {\n    if (tree.nodes[tf.id]) {\n      continue;\n    }\n    tree.nodes[tf.id] = {\n      tf,\n      children: [],\n      depth: 0,\n    };\n  }\n\n  // Now add children to their parents treenode.\n  for (const tf of transforms) {\n    if (tf.parent) {\n      const parentTreeNode = tree.nodes[tf.parent.id];\n      parentTreeNode.children.push(tree.nodes[tf.id]);\n    } else {\n      tree.roots.push(tree.nodes[tf.id]);\n    }\n  }\n\n  // Cast the list to satisfy flow (because Object.values returns array of mixed).\n  const allNodes = ((Object.values(tree.nodes): any): TfTreeNode[]);\n  // Do a final pass sorting all the children lists.\n  for (const node of allNodes) {\n    node.children = sortBy(node.children, treeNodeToTfId);\n  }\n  tree.roots = sortBy(tree.roots, treeNodeToTfId);\n\n  // Calculate depths\n  const setDepth = (node: TfTreeNode, depth: number) => {\n    node.depth = depth;\n    node.children.forEach((child) => setDepth(child, depth + 1));\n  };\n  tree.roots.forEach((root) => setDepth(root, 0));\n\n  return tree;\n};\n\ntype Props = {\n  transforms: any,\n  tfToFollow?: string,\n  followOrientation?: boolean,\n  onFollowChange: (tfId?: string | false, followOrientation?: boolean) => void,\n};\n\nfunction* getDescendants(nodes: TfTreeNode[]) {\n  for (const node of nodes) {\n    yield node;\n    yield* getDescendants(node.children);\n  }\n}\n\nfunction getItemText(node: TfTreeNode | { tf: { id: string }, depth: number }) {\n  return \"\".padEnd(node.depth * 4) + node.tf.id;\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex: 1 1 auto;\n  align-items: center;\n  position: relative;\n`;\n\nconst defaultFollowTfFrame = getGlobalHooks().perPanelHooks().ThreeDimensionalViz.defaultFollowTransformFrame;\n\nconst arePropsEqual = (prevProps, nextProps) => {\n  if (!nextProps.tfToFollow) {\n    const tfTree = buildTfTree(nextProps.transforms.values());\n    const allNodes = Array.from(getDescendants(tfTree.roots));\n    const nodesWithoutDefaultFollowTfFrame = allNodes && allNodes.length && !defaultFollowTfFrame;\n    if (nodesWithoutDefaultFollowTfFrame) {\n      return false;\n    }\n  }\n  return shallowequal(prevProps, nextProps);\n};\n\nconst FollowTFControl = memo<Props>((props: Props) => {\n  const { transforms, tfToFollow, followOrientation, onFollowChange } = props;\n  const [forceShowFrameList, setForceShowFrameList] = useState(false);\n  const [hovering, setHovering] = useState(false);\n  const [lastSelectedFrame, setLastSelectedFrame] = useState(undefined);\n\n  const tfTree = buildTfTree(transforms.values());\n  const allNodes = Array.from(getDescendants(tfTree.roots));\n  const nodesWithoutDefaultFollowTfFrame = allNodes && allNodes.length && !defaultFollowTfFrame;\n  const newFollowTfFrame = allNodes && allNodes[0] && allNodes[0].tf && allNodes[0].tf.id;\n\n  const autocomplete = createRef<Autocomplete>();\n\n  const getDefaultFollowTransformFrame = useCallback(\n    () => {\n      return nodesWithoutDefaultFollowTfFrame ? newFollowTfFrame : defaultFollowTfFrame;\n    },\n    [nodesWithoutDefaultFollowTfFrame, newFollowTfFrame]\n  );\n\n  const getFollowButtonTooltip = useCallback(\n    () => {\n      if (!tfToFollow) {\n        if (lastSelectedFrame) {\n          return `Follow ${lastSelectedFrame}`;\n        }\n        return `Follow ${getDefaultFollowTransformFrame()}`;\n      } else if (!followOrientation) {\n        return \"Follow Orientation\";\n      }\n      return \"Unfollow\";\n    },\n    [tfToFollow, followOrientation, lastSelectedFrame, getDefaultFollowTransformFrame]\n  );\n\n  const onClickFollowButton = useCallback(\n    () => {\n      if (!tfToFollow) {\n        if (lastSelectedFrame) {\n          return onFollowChange(lastSelectedFrame);\n        }\n        return onFollowChange(getDefaultFollowTransformFrame());\n      } else if (!followOrientation) {\n        return onFollowChange(tfToFollow, true);\n      }\n      return onFollowChange(false);\n    },\n    [tfToFollow, lastSelectedFrame, onFollowChange, getDefaultFollowTransformFrame, followOrientation]\n  );\n\n  const onSelectFrame = useCallback(\n    (id: string, item: mixed, autocompleteNode: Autocomplete) => {\n      setLastSelectedFrame(id === getDefaultFollowTransformFrame() ? undefined : id);\n      onFollowChange(id, followOrientation);\n      autocompleteNode.blur();\n    },\n    [setLastSelectedFrame, getDefaultFollowTransformFrame, onFollowChange, followOrientation]\n  );\n\n  const openFrameList = useCallback(\n    (event: SyntheticEvent<Element>) => {\n      event.preventDefault();\n      setForceShowFrameList(true);\n      if (autocomplete.current) {\n        autocomplete.current.focus();\n      }\n    },\n    [setForceShowFrameList, autocomplete]\n  );\n\n  // slight delay to prevent the arrow from disappearing when you're trying to click it\n  const onMouseLeaveDebounced = useCallback(\n    debounce(() => {\n      setHovering(false);\n    }, 200),\n    [setHovering]\n  );\n\n  const onMouseEnter = useCallback(\n    () => {\n      onMouseLeaveDebounced.cancel();\n      setHovering(true);\n    },\n    [onMouseLeaveDebounced, setHovering]\n  );\n\n  const followingCustomFrame = tfToFollow && tfToFollow !== getDefaultFollowTransformFrame();\n  const showFrameList = lastSelectedFrame != null || forceShowFrameList || followingCustomFrame;\n  const selectedFrameId = tfToFollow || lastSelectedFrame;\n  const selectedItem = selectedFrameId ? { tf: { id: selectedFrameId }, depth: 0 } : undefined;\n\n  return (\n    <Container\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeaveDebounced}\n      style={{ color: tfToFollow ? undefined : colors.textMuted }}>\n      {showFrameList && (\n        <Autocomplete\n          ref={autocomplete}\n          items={allNodes}\n          getItemValue={treeNodeToTfId}\n          getItemText={getItemText}\n          selectedItem={selectedItem}\n          placeholder={selectedItem ? getItemText(selectedItem) : \"choose a target frame\"}\n          onSelect={onSelectFrame}\n          sortWhenFiltering={false}\n          minWidth={0}\n          clearOnFocus\n          autoSize\n          menuStyle={{\n            // bump the menu down to reduce likelihood of it appearing while the mouse is\n            // already over it, which causes onMouseEnter not to be delivered correctly and\n            // breaks selection\n            marginTop: 4,\n          }}\n          onBlur={() => {\n            setForceShowFrameList(false);\n            setHovering(false);\n          }}\n        />\n      )}\n      {showFrameList ? (\n        <Icon onClick={openFrameList}>\n          <MenuDownIcon />\n        </Icon>\n      ) : hovering ? (\n        <Icon\n          tooltip={\"Select Another Frame\\u2026\"}\n          onClick={openFrameList}\n          tooltipProps={{ placement: \"top\" }}\n          style={{ color: \"white\" }}>\n          <MenuLeftIcon />\n        </Icon>\n      ) : null}\n      <Button tooltipProps={{ placement: \"top\" }} onClick={onClickFollowButton} tooltip={getFollowButtonTooltip()}>\n        <Icon style={{ color: tfToFollow ? colors.accent : \"white\" }}>\n          {followOrientation ? <CompassOutlineIcon /> : <CrosshairsGpsIcon />}\n        </Icon>\n      </Button>\n    </Container>\n  );\n}, arePropsEqual);\nexport default FollowTFControl;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport BugIcon from \"@mdi/svg/svg/bug.svg\";\nimport RulerIcon from \"@mdi/svg/svg/ruler.svg\";\nimport Video3dIcon from \"@mdi/svg/svg/video-3d.svg\";\nimport * as React from \"react\";\n\nimport Button from \"webviz-core/src/components/Button\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport MeasuringTool, { type MeasureInfo } from \"webviz-core/src/panels/ThreeDimensionalViz/DrawingTools/MeasuringTool\";\nimport styles from \"webviz-core/src/panels/ThreeDimensionalViz/Layout.module.scss\";\nimport colors from \"webviz-core/src/styles/colors.module.scss\";\n\ntype Props = {\n  measuringTool: ?MeasuringTool,\n  measureInfo: MeasureInfo,\n  perspective: boolean,\n  debug: boolean,\n  onToggleCameraMode: () => void,\n  onToggleDebug: () => void,\n};\n\nfunction MainToolbar({\n  measuringTool,\n  measureInfo: { measureState },\n  debug,\n  onToggleCameraMode,\n  onToggleDebug,\n  perspective = false,\n}: Props) {\n  const cameraModeTip = perspective ? \"Switch to 2D camera\" : \"Switch to 3D camera\";\n  const measureActive = measureState === \"place-start\" || measureState === \"place-finish\";\n  return (\n    <div className={styles.buttons}>\n      <Button tooltip={cameraModeTip} onClick={onToggleCameraMode}>\n        <Icon style={{ color: perspective ? colors.accent : \"white\" }}>\n          <Video3dIcon />\n        </Icon>\n      </Button>\n      <Button\n        disabled={perspective}\n        tooltip={\n          perspective\n            ? \"Switch to 2D Camera to Measure Distance\"\n            : measureActive\n            ? \"Cancel Measuring\"\n            : \"Measure Distance\"\n        }\n        onClick={measuringTool ? measuringTool.toggleMeasureState : undefined}>\n        <Icon\n          style={{\n            color: measureActive ? colors.accent : perspective ? undefined : \"white\",\n          }}>\n          <RulerIcon />\n        </Icon>\n      </Button>\n      {process.env.NODE_ENV === \"development\" && (\n        <Button tooltip=\"Debug\" onClick={onToggleDebug}>\n          <Icon style={{ color: debug ? colors.accent : \"white\" }}>\n            <BugIcon />\n          </Icon>\n        </Button>\n      )}\n    </div>\n  );\n}\n\nexport default React.memo<Props>(MainToolbar);\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport { Lines, Spheres, type Point } from \"regl-worldview\";\n\ntype Props = {\n  measurePoints: { start: ?Point, end: ?Point },\n};\n\nconst sphereSize: number = 0.3;\nconst lineSize: number = 0.1;\n\nconst defaultSphere: any = Object.freeze({\n  type: 2,\n  action: 0,\n  scale: { x: sphereSize, y: sphereSize, z: 0.1 },\n  color: { r: 1, g: 0.2, b: 0, a: 1 },\n});\nconst defaultPose: any = Object.freeze({ orientation: { x: 0, y: 0, z: 0, w: 1 } });\n\nexport default function MeasureMarker({ measurePoints: { start, end } }: Props) {\n  const spheres = [];\n  const lines = [];\n  if (start) {\n    const startPoint = { ...start };\n\n    spheres.push({\n      ...defaultSphere,\n      id: \"_measure_start\",\n      pose: { position: startPoint, ...defaultPose },\n    });\n\n    if (end) {\n      const endPoint = { ...end };\n      lines.push({\n        ...defaultSphere,\n        id: \"_measure_line\",\n        points: [start, end],\n        pose: { ...defaultPose, position: { x: 0, y: 0, z: 0 } },\n        scale: { x: lineSize, y: 1, z: 1 },\n        type: 4,\n      });\n\n      spheres.push({\n        ...defaultSphere,\n        id: \"_measure_end\",\n        pose: { position: endPoint, ...defaultPose },\n      });\n    }\n  }\n\n  return (\n    <>\n      {lines.length && <Lines>{lines}</Lines>}\n      {spheres.length && <Spheres>{spheres}</Spheres>}\n    </>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { some, mapValues } from \"lodash\";\nimport type { Time } from \"rosbag\";\n\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport MessageCollector from \"webviz-core/src/panels/ThreeDimensionalViz/SceneBuilder/MessageCollector\";\nimport { getSceneErrorsByTopic } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicGroups/topicGroupsUtils\";\nimport { parseColorSetting } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicGroups/TopicSettingsEditor\";\nimport { LINED_CONVEX_HULL_RENDERING_SETTING } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport type { Topic, Frame, Message } from \"webviz-core/src/players/types\";\nimport type { Marker, Namespace, OccupancyGridMessage, MutablePose, Pose } from \"webviz-core/src/types/Messages\";\nimport type { MarkerProvider, MarkerCollector, Scene } from \"webviz-core/src/types/Scene\";\nimport Bounds from \"webviz-core/src/util/Bounds\";\nimport { POSE_MARKER_SCALE } from \"webviz-core/src/util/globalConstants\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\nimport { emptyPose } from \"webviz-core/src/util/Pose\";\nimport sendNotification from \"webviz-core/src/util/sendNotification\";\nimport { fromSec } from \"webviz-core/src/util/time\";\n\nexport type TopicSettingsCollection = {\n  [topic: string]: any,\n};\n\n// builds a syntehtic arrow marker from a geometry_msgs/PoseStamped\n// these pose sizes were manually configured in rviz; for now we hard-code them here\nexport function buildSyntheticArrowMarker(msg: any, flattenedZHeightPose: ?Pose) {\n  msg.message.pose = getGlobalHooks()\n    .perPanelHooks()\n    .ThreeDimensionalViz.getMessagePose(msg, flattenedZHeightPose);\n  return {\n    type: 103,\n    header: msg.message.header,\n    pose: msg.message.pose,\n    scale: POSE_MARKER_SCALE,\n    color: getGlobalHooks()\n      .perPanelHooks()\n      .ThreeDimensionalViz.getSyntheticArrowMarkerColor(msg.topic),\n  };\n}\n\n// TODO(JP): looks like we might not actually use these fields in the new topic picker?\nexport type ErrorDetails = {| frameIds: Set<string>, namespaces: Set<string> |};\n\nexport type SceneErrors = {\n  topicsMissingFrameIds: Map<string, ErrorDetails>,\n  topicsMissingTransforms: Map<string, ErrorDetails>,\n  topicsWithBadFrameIds: Map<string, ErrorDetails>,\n  topicsWithError: Map<string, string>,\n  rootTransformID: string,\n};\n\ntype SceneErrorTopics = {\n  topicsWithBadFrameIds: Set<string>,\n};\n\ntype SelectedNamespacesByTopic = { [topicName: string]: string[] };\n// constructs a scene containing all objects to be rendered\n// by consuming visualization topics from frames\n\nexport default class SceneBuilder implements MarkerProvider {\n  topics: Topic[] = [];\n  markers: Marker[] = [];\n  transforms: Transforms;\n  rootTransformID: string;\n  selectionState: any = {};\n  frame: Frame;\n  // TODO(JP): Get rid of these two different variables `errors` and `errorsByTopic` which we\n  // have to keep in sync.\n  errors: SceneErrors = {\n    rootTransformID: \"\",\n    topicsMissingFrameIds: new Map(),\n    topicsMissingTransforms: new Map(),\n    topicsWithBadFrameIds: new Map(),\n    topicsWithError: new Map(),\n  };\n  errorsByTopic: { [topicName: string]: string[] } = {};\n  reportedErrorTopics: SceneErrorTopics = {\n    topicsWithBadFrameIds: new Set(),\n  };\n  maps = [];\n  flattenedZHeightPose: ?Pose = null;\n  scene = {};\n  collectors: { [string]: MessageCollector } = {};\n  _clock: Time;\n  _playerId: ?string = null;\n  _topicSettings: TopicSettingsCollection = {};\n  _onForceUpdate: ?() => void = null;\n\n  allNamespaces: Namespace[] = [];\n  // TODO(Audrey): remove enabledNamespaces once we release topic groups\n  enabledNamespaces: Namespace[] = [];\n  selectedNamespacesByTopic: ?{ [topicName: string]: Set<string> };\n  flatten: boolean = false;\n  bounds: Bounds = new Bounds();\n\n  // list of topics that need to be rerendered because the frame has new values\n  // or because a prop affecting its rendering was changed\n  topicsToRender: Set<string> = new Set();\n\n  // stored message arrays allowing used to re-render topics even when the latest\n  // frame does not not contain that topic\n  lastSeenMessages: { [string]: Message[] } = {};\n\n  setTransforms = (transforms: Transforms, rootTransformID: string) => {\n    this.transforms = transforms;\n    this.rootTransformID = rootTransformID;\n    this.errors.rootTransformID = rootTransformID;\n  };\n\n  clear() {\n    for (const topic of this.topics) {\n      const collector = this.collectors[topic.name];\n      if (collector) {\n        collector.flush();\n      }\n    }\n  }\n\n  setPlayerId(playerId: string) {\n    if (this._playerId !== playerId) {\n      this.reportedErrorTopics.topicsWithBadFrameIds.clear();\n      this.errors = {\n        rootTransformID: \"\",\n        topicsMissingFrameIds: new Map(),\n        topicsMissingTransforms: new Map(),\n        topicsWithBadFrameIds: new Map(),\n        topicsWithError: new Map(),\n      };\n      this._updateErrorsByTopic();\n    }\n    this._playerId = playerId;\n  }\n\n  setTopicSettings(settings: TopicSettingsCollection) {\n    this._topicSettings = settings;\n  }\n\n  // set the topics the scene builder should consume from each frame\n  setTopics(topics: Topic[]) {\n    const topicsToFlush = this.topics.filter((topic) => !topics.find((other) => other.name === topic.name));\n    // Sort the topics by name so the render order is consistent.\n    this.topics = topics.sort(naturalSort(\"name\"));\n    // IMPORTANT: when topics change, we also need to reset the frame so that\n    // setFrame gets called correctly to set the topicsToRender and lastSeenMessages\n    this.frame = {};\n    // Delete message collectors we don't need anymore\n    topicsToFlush.forEach((topic) => {\n      const collector = this.collectors[topic.name];\n      if (collector) {\n        collector.flush();\n        delete this.collectors[topic.name];\n      }\n    });\n  }\n\n  setFrame(frame: Frame) {\n    if (this.frame === frame) {\n      return;\n    }\n    this.frame = frame;\n    for (const topic of this.topics) {\n      if (topic.name in frame) {\n        this.topicsToRender.add(topic.name);\n      }\n    }\n\n    // Note we save even topics that are not rendered since they may be used by non-rendered topics\n    Object.assign(this.lastSeenMessages, frame);\n  }\n\n  setFlattenMarkers(flatten: boolean): void {\n    this.flatten = flatten;\n  }\n\n  setEnabledNamespaces(namespaces: Namespace[]) {\n    this.enabledNamespaces = namespaces;\n  }\n\n  setSelectedNamespacesByTopic(selectedNamespacesByTopic: SelectedNamespacesByTopic) {\n    this.selectedNamespacesByTopic = mapValues(selectedNamespacesByTopic, (namespaces) => new Set(namespaces));\n  }\n\n  setGlobalVariables = (globalVariables: any = {}) => {\n    const { selectionState, topicsToRender } = getGlobalHooks()\n      .perPanelHooks()\n      .ThreeDimensionalViz.setGlobalVariablesInSceneBuilder(\n        globalVariables,\n        this.selectionState,\n        this.topicsToRender,\n        this.topics\n      );\n    this.selectionState = selectionState;\n    this.topicsToRender = topicsToRender;\n  };\n\n  hasErrors() {\n    const { topicsMissingFrameIds, topicsMissingTransforms, topicsWithBadFrameIds, topicsWithError } = this.errors;\n    return (\n      topicsMissingFrameIds.size !== 0 ||\n      topicsMissingTransforms.size !== 0 ||\n      topicsWithBadFrameIds.size !== 0 ||\n      topicsWithError.size !== 0\n    );\n  }\n\n  setOnForceUpdate(callback: () => void) {\n    this._onForceUpdate = callback;\n  }\n\n  _addError(map: Map<string, ErrorDetails>, topic: string): ErrorDetails {\n    let values = map.get(topic);\n    if (!values) {\n      values = { namespaces: new Set(), frameIds: new Set() };\n      map.set(topic, values);\n    }\n    this._updateErrorsByTopic();\n    return values;\n  }\n\n  _setTopicError = (topic: string, message: string) => {\n    this.errors.topicsWithError.set(topic, message);\n    this._updateErrorsByTopic();\n  };\n\n  // Update the field everytime when the errors changes in order to generate a new object to trigger TopicTree to rerender.\n  _updateErrorsByTopic() {\n    this.errorsByTopic = getSceneErrorsByTopic(this.errors);\n    if (this._onForceUpdate) {\n      this._onForceUpdate();\n    }\n  }\n\n  // keep a unique set of all seen namespaces\n  _consumeNamespace(topic: string, name: string) {\n    if (some(this.allNamespaces, (ns) => ns.topic === topic && ns.name === name)) {\n      return;\n    }\n    this.allNamespaces = this.allNamespaces.concat([{ topic, name }]);\n    if (this._onForceUpdate) {\n      this._onForceUpdate();\n    }\n  }\n\n  // Only public for tests.\n  namespaceIsEnabled(topic: string, name: string) {\n    if (this.selectedNamespacesByTopic) {\n      // enable all namespaces under a topic if it's not already set\n      return (\n        (this.selectedNamespacesByTopic[topic] && this.selectedNamespacesByTopic[topic].has(name)) ||\n        this.selectedNamespacesByTopic[topic] == null\n      );\n    }\n    return some(this.enabledNamespaces, (ns) => ns.topic === topic && ns.name === name);\n  }\n\n  _reportBadFrameId(topic: string) {\n    if (!this.reportedErrorTopics.topicsWithBadFrameIds.has(topic)) {\n      this.reportedErrorTopics.topicsWithBadFrameIds.add(topic);\n      sendNotification(\n        `Topic ${topic} has bad frame`,\n        \"Non-root transforms may be out of sync, since webviz uses the latest transform message instead of the one matching header.stamp\",\n        \"user\",\n        \"warn\"\n      );\n    }\n  }\n\n  _transformMarkerPose = (topic: string, marker: Marker): ?MutablePose => {\n    const { frame_id } = marker.header;\n\n    if (!frame_id) {\n      const error = this._addError(this.errors.topicsMissingFrameIds, topic);\n      error.namespaces.add(marker.ns);\n      return null;\n    }\n\n    if (frame_id === this.rootTransformID) {\n      // Transforming is a bit expensive, and this (no transformation necessary) is the common-case\n      // TODO: Need to deep-clone, callers mutate the result; fix this downstream.\n      return {\n        position: { ...marker.pose.position },\n        orientation: { ...marker.pose.orientation },\n      };\n    }\n\n    // frame_id !== this.rootTransformID.\n    // We continue to render these, though they may be inaccurate\n    this._reportBadFrameId(topic);\n    const badFrameError = this._addError(this.errors.topicsWithBadFrameIds, topic);\n    badFrameError.namespaces.add(marker.ns);\n    badFrameError.frameIds.add(frame_id);\n\n    const pose = this.transforms.apply(emptyPose(), marker.pose, frame_id, this.rootTransformID);\n    if (!pose) {\n      const topicMissingError = this._addError(this.errors.topicsMissingTransforms, topic);\n      topicMissingError.namespaces.add(marker.ns);\n      topicMissingError.frameIds.add(frame_id);\n    }\n    return pose;\n  };\n\n  _consumeMarkerArray = (topic: string, message: any): void => {\n    for (let i = 0; i < message.markers.length; i++) {\n      this._consumeMarker(topic, message.markers[i]);\n    }\n  };\n\n  _consumeMarker(topic: string, message: Marker): void {\n    if (message.ns) {\n      this._consumeNamespace(topic, message.ns);\n    }\n\n    // Every marker needs a name property as a unique id. In each topic, the namespace (`ns`) and\n    // identifier (`id`) uniquely identify the marker.\n    // See https://github.com/ros-visualization/rviz/blob/4b6c0f4/src/rviz/default_plugin/markers/marker_base.h#L56\n    // and https://github.com/ros-visualization/rviz/blob/4b6c0f4/src/rviz/default_plugin/marker_display.cpp#L422\n    const name = `${topic}/${message.ns}/${message.id}`;\n    switch (message.action) {\n      case 0: // add\n        break;\n      case 1: // deprecated in ros\n        this._setTopicError(topic, \"Marker.action=1 is deprecated\");\n        return;\n      case 2: // delete\n        this.collectors[topic].deleteMarker(name);\n        return;\n      case 3:\n        this.collectors[topic].deleteAll();\n        return;\n      default:\n        this._setTopicError(topic, `Unsupported action type: ${message.action}`);\n        return;\n    }\n\n    const pose = this._transformMarkerPose(topic, message);\n    if (!pose) {\n      return;\n    }\n    const marker = { ...message, name, pose };\n\n    const { points } = (marker: any);\n    const { position } = pose;\n\n    let minZ = Number.MAX_SAFE_INTEGER;\n\n    // if the marker has points, adjust bounds by the points\n    if (points && points.length) {\n      points.forEach((point) => {\n        const x = point.x + position.x;\n        const y = point.y + position.y;\n        const z = point.z + position.z;\n        minZ = Math.min(minZ, point.z);\n        this.bounds.update({ x, y, z });\n      });\n    } else {\n      // otherwise just adjust by the pose\n      minZ = Math.min(minZ, position.z);\n      this.bounds.update(position);\n    }\n\n    // if the minimum z value of any point (or the pose) is exactly 0\n    // then assume this marker can be flattened\n    if (minZ === 0 && this.flatten && this.flattenedZHeightPose) {\n      position.z = this.flattenedZHeightPose.position.z;\n    }\n\n    // HACK(jacob): rather than hard-coding this, we should\n    //  (a) produce this visualization dynamically from a non-marker topic\n    //  (b) fix translucency so it looks correct (harder)\n    marker.color = getGlobalHooks()\n      .perPanelHooks()\n      .ThreeDimensionalViz.getMarkerColor(topic, marker.color);\n\n    // allow topic settings to override marker color (see MarkerSettingsEditor.js)\n    const { overrideColor } = this._topicSettings[topic] || {};\n    if (overrideColor) {\n      marker.color = parseColorSetting(overrideColor);\n      marker.colors = [];\n    }\n\n    this.collectors[topic].addMarker(topic, marker);\n  }\n\n  _consumeOccupancyGrid = (topic: string, message: OccupancyGridMessage): void => {\n    const { frame_id } = message.header;\n\n    if (!frame_id) {\n      this._addError(this.errors.topicsMissingFrameIds, topic);\n      return;\n    }\n\n    if (frame_id !== this.rootTransformID) {\n      this._reportBadFrameId(topic);\n      const error = this._addError(this.errors.topicsWithBadFrameIds, topic);\n      error.frameIds.add(frame_id);\n    }\n\n    let pose = emptyPose();\n    pose = this.transforms.apply(pose, pose, frame_id, this.rootTransformID);\n    if (!pose) {\n      const error = this._addError(this.errors.topicsMissingTransforms, topic);\n      error.frameIds.add(frame_id);\n      return;\n    }\n\n    const type = 101;\n    // every marker needs a name property as a unique id\n    const name = `${topic}/${message.type}`;\n\n    // set ogrid texture & alpha based on current rviz settings\n    // in the future these will be customizable via the UI\n    const [alpha, map] = getGlobalHooks()\n      .perPanelHooks()\n      .ThreeDimensionalViz.getOccupancyGridValues(topic);\n\n    const mappedMessage = {\n      ...message,\n      alpha,\n      map,\n      type,\n      name,\n      pose,\n    };\n\n    // if we neeed to flatten the ogrid clone the position and change the z to match the flattenedZHeightPose\n    if (mappedMessage.info.origin.position.z === 0 && this.flattenedZHeightPose && this.flatten) {\n      const originalInfo = mappedMessage.info;\n      const originalPosition = originalInfo.origin.position;\n      mappedMessage.info = {\n        ...originalInfo,\n        origin: {\n          ...originalInfo.origin,\n          position: { ...originalPosition, z: this.flattenedZHeightPose.position.z },\n        },\n      };\n    }\n    this.collectors[topic].addMessage(topic, mappedMessage);\n  };\n\n  _consumeNonMarkerMessage = (topic: string, message: any, type: number): void => {\n    const sourcePose = emptyPose();\n    const pose = this.transforms.apply(sourcePose, sourcePose, message.header.frame_id, this.rootTransformID);\n    if (!pose) {\n      const error = this._addError(this.errors.topicsMissingTransforms, topic);\n      error.frameIds.add(message.header.frame_id);\n      return;\n    }\n\n    const decayTimeInSec = this._topicSettings[topic] && this._topicSettings[topic].decayTime;\n    const mappedMessage = {\n      ...message,\n      name: `${topic}/${message.type}`,\n      type,\n      pose,\n      // If a decay time is available, we assign a lifetime to this message\n      // Do not automatically assign a 0 (zero) decay time since that translates\n      // to an infinite lifetime. But do allow for 0 values based on user preferences.\n      lifetime: decayTimeInSec !== undefined ? fromSec(decayTimeInSec) : undefined,\n    };\n\n    this.collectors[topic].addMessage(topic, mappedMessage);\n  };\n\n  setCurrentTime = (currentTime: { sec: number, nsec: number }) => {\n    this.bounds.reset();\n\n    this._clock = currentTime;\n    // set the new clock value in all existing collectors\n    // including those for topics not included in this frame,\n    // so each can expire markers if they need to\n    for (const key in this.collectors) {\n      const collector = this.collectors[key];\n      collector.setClock(this._clock);\n    }\n  };\n\n  // extracts renderable markers from the ros frame\n  render() {\n    this.flattenedZHeightPose =\n      getGlobalHooks()\n        .perPanelHooks()\n        .ThreeDimensionalViz.getFlattenedPose(this.frame) || this.flattenedZHeightPose;\n\n    if (this.flattenedZHeightPose && this.flattenedZHeightPose.position) {\n      this.bounds.update(this.flattenedZHeightPose.position);\n    }\n    for (const topic of this.topicsToRender) {\n      try {\n        this._consumeTopic(topic);\n      } catch (error) {\n        this._setTopicError(topic, error.toString());\n      }\n    }\n    this.topicsToRender.clear();\n  }\n\n  _consumeMessage = (topic: string, msg: Message): void => {\n    const { message, datatype } = msg;\n    const SUPPORTED_MARKER_DATATYPES = getGlobalHooks().perPanelHooks().ThreeDimensionalViz.SUPPORTED_MARKER_DATATYPES;\n\n    switch (datatype) {\n      case SUPPORTED_MARKER_DATATYPES.VISUALIZATION_MSGS_MARKER_DATATYPE:\n        this._consumeMarker(topic, message);\n        break;\n      case SUPPORTED_MARKER_DATATYPES.VISUALIZATION_MSGS_MARKER_ARRAY_DATATYPE:\n        this._consumeMarkerArray(topic, message);\n        break;\n      case SUPPORTED_MARKER_DATATYPES.POSE_STAMPED_DATATYPE:\n        // make synthetic arrow marker from the stamped pose\n        this.collectors[topic].addMessage(topic, buildSyntheticArrowMarker(msg, this.flattenedZHeightPose));\n        break;\n      case SUPPORTED_MARKER_DATATYPES.NAV_MSGS_OCCUPANCY_GRID_DATATYPE:\n        // flatten btn: set empty z values to be at the same level as the flattenedZHeightPose\n        this._consumeOccupancyGrid(topic, message);\n        break;\n      case SUPPORTED_MARKER_DATATYPES.POINT_CLOUD_DATATYPE:\n        this._consumeNonMarkerMessage(topic, message, 102);\n        break;\n      case SUPPORTED_MARKER_DATATYPES.SENSOR_MSGS_LASER_SCAN_DATATYPE:\n        this._consumeNonMarkerMessage(topic, message, 104);\n        break;\n      case SUPPORTED_MARKER_DATATYPES.GEOMETRY_MSGS_POLYGON_STAMPED_DATATYPE: {\n        // convert Polygon to a line strip\n        const { polygon } = message;\n        if (polygon.points.length === 0) {\n          break;\n        }\n        const newMessage = {\n          ...message,\n          points: polygon.points,\n          closed: true,\n          scale: { x: 0.2 },\n          color: { r: 0, g: 1, b: 0, a: 1 },\n        };\n        this._consumeNonMarkerMessage(topic, newMessage, 4 /* line strip */);\n        break;\n      }\n      default: {\n        const { flattenedZHeightPose, collectors, errors, lastSeenMessages, selectionState } = this;\n        getGlobalHooks()\n          .perPanelHooks()\n          .ThreeDimensionalViz.consumeMessage(\n            topic,\n            msg,\n            {\n              consumeMarkerArray: this._consumeMarkerArray,\n              consumeNonMarkerMessage: this._consumeNonMarkerMessage,\n            },\n            { flattenedZHeightPose, collectors, errors, lastSeenMessages, selectionState }\n          );\n      }\n    }\n  };\n\n  _consumeTopic = (topic: string) => {\n    const messages = this.frame[topic] || this.lastSeenMessages[topic];\n    if (!messages) {\n      return;\n    }\n\n    this.errors.topicsMissingFrameIds.delete(topic);\n    this.errors.topicsMissingTransforms.delete(topic);\n    this.errors.topicsWithBadFrameIds.delete(topic);\n    this.errors.topicsWithError.delete(topic);\n    this.collectors[topic] = this.collectors[topic] || new MessageCollector();\n    this.collectors[topic].setClock(this._clock);\n    this.collectors[topic].flush();\n\n    for (let i = 0; i < messages.length; i++) {\n      this._consumeMessage(topic, messages[i]);\n    }\n  };\n\n  getScene(): Scene {\n    return {\n      bounds: this.bounds,\n      flattenedZHeightPose: this.flattenedZHeightPose,\n    };\n  }\n\n  renderMarkers(add: MarkerCollector) {\n    for (const topic of this.topics) {\n      const collector = this.collectors[topic.name];\n      if (!collector) {\n        continue;\n      }\n      const topicMarkers = collector.getMessages();\n      for (const message of topicMarkers) {\n        const marker: any = message;\n        if (marker.ns) {\n          if (!this.namespaceIsEnabled(topic.name, marker.ns)) {\n            continue;\n          }\n        }\n        // TODO(bmc): once we support more topic settings\n        // flesh this out to be more marker type agnostic\n        const settings = this._topicSettings[topic.name];\n        if (settings) {\n          marker.settings = settings;\n        }\n        this._addMarkerToCollector(add, topic, marker);\n      }\n    }\n  }\n\n  _addMarkerToCollector(add: MarkerCollector, topic: Topic, originalMarker: any) {\n    let marker = originalMarker;\n    switch (marker.type) {\n      case 1:\n      case 2:\n      case 3:\n        marker = { ...marker, points: undefined };\n        break;\n      case 4:\n        marker = { ...marker, primitive: \"line strip\" };\n        break;\n      case 6:\n        marker = { ...marker, primitive: \"lines\" };\n        break;\n    }\n    marker = { ...marker, interactionData: { topic: topic.name } };\n\n    // allow topic settings to override renderable marker command (see MarkerSettingsEditor.js)\n    const { overrideCommand } = this._topicSettings[topic.name] || {};\n\n    // prettier-ignore\n    switch (marker.type) {\n      case 0: return add.arrow(marker);\n      case 1: return add.cube(marker);\n      case 2: return add.sphere(marker);\n      case 3: return add.cylinder(marker);\n      case 4:\n        if (overrideCommand === LINED_CONVEX_HULL_RENDERING_SETTING) {\n          return add.linedConvexHull(marker);\n        }\n        return add.lineStrip(marker);\n      case 5:\n        if (overrideCommand === LINED_CONVEX_HULL_RENDERING_SETTING) {\n          return add.linedConvexHull(marker);\n        }\n        return add.lineList(marker);\n      case 6: return add.cubeList(marker);\n      case 7: return add.sphereList(marker);\n      case 8: return add.points(marker);\n      case 9: return add.text(marker);\n      // mesh resource not supported\n      case 11: return add.triangleList(marker);\n      case 101: return add.grid(marker);\n      case 102: return add.pointcloud(marker);\n      case 103: return add.poseMarker(marker);\n      case 104: return add.laserScan(marker);\n      case 107: return add.filledPolygon(marker);\n      case 108: return add.instancedLineList(marker);\n      default: {\n        getGlobalHooks()\n          .perPanelHooks()\n          .ThreeDimensionalViz.addMarkerToCollector(add, topic.name, marker, this._setTopicError);\n      }\n    }\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { TimeUtil, type Time } from \"rosbag\";\nimport uuid from \"uuid\";\n\nimport type { BaseMarker, StampedMessage } from \"webviz-core/src/types/Messages\";\n\nconst ZERO_TIME = { sec: 0, nsec: 0 };\n\nclass MessageWithLifetime {\n  message: StampedMessage;\n  receiveTime: Time;\n\n  constructor(message: StampedMessage, receiveTime: Time) {\n    this.message = message;\n    this.receiveTime = receiveTime;\n  }\n\n  // support in place update w/ mutation to avoid allocating\n  // a MarkerWithLifetime wrapper for every marker on every tick\n  // only allocate on new markers\n  update(message: StampedMessage, receiveTime: Time) {\n    this.message = message;\n    this.receiveTime = receiveTime;\n  }\n\n  isExpired(currentTime: Time) {\n    // cannot tell if a marker is expired if we don't have a clock yet\n    if (!currentTime) {\n      return false;\n    }\n    const lifetime = this.getLifetime();\n    if (!lifetime) {\n      // Do not expire markers if we can't tell what their lifetime is.\n      // They'll be flushed later if needed (see flush below)\n      return false;\n    }\n\n    if (TimeUtil.areSame(lifetime, ZERO_TIME)) {\n      // Do not expire markers with infinite lifetime (lifetime == 0)\n      return false;\n    }\n\n    // we use the receive time (clock) instead of the header stamp\n    // to match the behavior of rviz\n    const expiresAt = TimeUtil.add(this.receiveTime, lifetime);\n\n    return TimeUtil.isGreaterThan(currentTime, expiresAt);\n  }\n\n  getLifetime() {\n    const marker = ((this.message: any): BaseMarker);\n    return marker.lifetime;\n  }\n\n  // Returns 'true' if we have a valid lifetime (even for infinite lifetime)\n  // Returns 'false' if the message has no lifetime and must be flushed.\n  hasLifetime() {\n    return !!this.getLifetime();\n  }\n}\n\n// used to collect marker and non-marker visualization messages\n// for a given topic and ensure the lifecycle is managed properly\nexport default class MessageCollector {\n  markers: Map<string, MessageWithLifetime> = new Map();\n  clock: Time = { sec: 0, nsec: 0 };\n\n  setClock(clock: Time) {\n    if (!clock) {\n      return;\n    }\n\n    const clockMovedBackwards = TimeUtil.isGreaterThan(this.clock, clock);\n\n    if (clockMovedBackwards) {\n      this.markers.forEach((marker, key) => {\n        const markerReceivedAfterClock = TimeUtil.isGreaterThan(marker.receiveTime, clock);\n        if (markerReceivedAfterClock) {\n          this.markers.delete(key);\n        }\n      });\n      this.flush();\n    }\n    this.clock = clock;\n  }\n\n  flush() {\n    // clear out all null lifetime markers\n    this.markers.forEach((marker, key) => {\n      if (!marker.hasLifetime()) {\n        this.markers.delete(key);\n      }\n    });\n  }\n\n  _addItem(key: string, item: any): void {\n    const existing = this.markers.get(key);\n    if (existing) {\n      existing.update(item, this.clock);\n    } else {\n      this.markers.set(key, new MessageWithLifetime(item, this.clock));\n    }\n  }\n\n  addMarker(topic: string, marker: BaseMarker) {\n    const { name } = marker;\n    if (!name) {\n      return console.error(\"Cannot add marker, it is missing name\", marker);\n    }\n    this._addItem(name, marker);\n  }\n\n  deleteMarker(name: string) {\n    if (!name) {\n      return console.error(\"Cannot delete marker, it is missing name\");\n    }\n    this.markers.delete(name);\n  }\n\n  deleteAll() {\n    this.markers.clear();\n  }\n\n  addMessage(topic: string, message: any) {\n    if (message.lifetime) {\n      // Assuming that all future messages will have a decay time set,\n      // we need to immediately expire any pre-existing message that didn't have a decay time.\n      this.markers.delete(topic);\n\n      // Create a unique key for each new message.\n      const key = `${topic}/${uuid.v4()}`;\n      this._addItem(key, message);\n    } else {\n      // if future messages will not have a decay time set,\n      // we should expire any pre-existing message that have potentially longer decay times.\n      for (const key of this.markers.keys()) {\n        if (key.indexOf(`${topic}/`) === 0) {\n          this.markers.delete(key);\n        }\n      }\n      this._addItem(topic, message);\n    }\n  }\n\n  getMessages(): any[] {\n    const result = [];\n    this.markers.forEach((marker, key) => {\n      // Check if the marker has a lifetime and should be deleted\n      if (marker.hasLifetime() && marker.isExpired(this.clock)) {\n        this.markers.delete(key);\n      } else {\n        result.push(marker.message);\n      }\n    });\n    return result;\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { Point } from \"webviz-core/src/types/Messages\";\n\n// a single min/max value\nclass Bound {\n  min: number = Number.MAX_SAFE_INTEGER;\n  max: number = Number.MIN_SAFE_INTEGER;\n\n  // update the bound based on a value\n  update(value: number) {\n    this.min = Math.min(this.min, value);\n    this.max = Math.max(this.max, value);\n  }\n\n  reset() {\n    this.min = Number.MAX_SAFE_INTEGER;\n    this.max = Number.MIN_SAFE_INTEGER;\n  }\n}\n\n// represents x, y, and z min & max bounds for a 3d scene\nexport default class Bounds {\n  x: Bound;\n  y: Bound;\n  z: Bound;\n\n  constructor() {\n    this.x = new Bound();\n    this.y = new Bound();\n    this.z = new Bound();\n  }\n\n  // update the bounds based on a point\n  update(point: Point) {\n    this.x.update(point.x);\n    this.y.update(point.y);\n    this.z.update(point.z);\n  }\n\n  reset() {\n    this.x.reset();\n    this.y.reset();\n    this.z.reset();\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { Tabs } from \"antd\";\nimport { isEmpty, omit } from \"lodash\";\nimport React, { useCallback } from \"react\";\nimport styled from \"styled-components\";\n\nimport { type Save3DConfig } from \"../index\";\nimport Button from \"webviz-core/src/components/Button\";\nimport ErrorBoundary from \"webviz-core/src/components/ErrorBoundary\";\nimport Modal from \"webviz-core/src/components/Modal\";\nimport { RenderToBodyComponent } from \"webviz-core/src/components/renderToBody\";\nimport { getSettingsByColumnWithDefaults } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicGroups/topicGroupsMigrations\";\nimport { topicSettingsEditorForDatatype } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor\";\nimport type { Topic } from \"webviz-core/src/players/types\";\nimport { SECOND_SOURCE_PREFIX } from \"webviz-core/src/util/globalConstants\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\n// TODO(Audrey): show topic settings for base and feature side by side after TopicPickerV2 release.\nconst SHOW_SECOND_DATASOURCE = false;\n\nconst STopicSettingsEditor = styled.div`\n  background: ${colors.TOOLBAR};\n  color: ${colors.TEXT};\n  padding: 16px;\n`;\nconst STitle = styled.h3`\n  font-size: 20px;\n  font-size: 20px;\n  margin-right: 36px;\n  word-break: break-all;\n  line-height: 1.3;\n`;\n\nconst SDatatype = styled.p`\n  padding-bottom: 12px;\n`;\n\nconst SEditorWrapper = styled.div`\n  color: ${colors.TEXT};\n  width: 400px;\n`;\n\nfunction MainEditor({\n  datatype,\n  collectorMessage,\n  columnIndex,\n  onFieldChange,\n  onSettingsChange,\n  settings,\n  topicName,\n}: {|\n  datatype: string,\n  collectorMessage: any,\n  columnIndex: number,\n  onFieldChange: (fieldName: string, value: any) => void,\n  onSettingsChange: (settings: any | ((prevSettings: {}) => {})) => void,\n  settings: any,\n  topicName: string,\n|}) {\n  const Editor = topicSettingsEditorForDatatype(datatype);\n  if (!Editor) {\n    throw new Error(`No topic settings editor available for ${datatype}`);\n  }\n\n  return (\n    <ErrorBoundary>\n      <SEditorWrapper>\n        <Editor\n          message={collectorMessage}\n          onFieldChange={onFieldChange}\n          settings={settings}\n          onSettingsChange={onSettingsChange}\n        />\n        <Button\n          className=\"test-reset-settings-btn\"\n          style={{ marginTop: 8 }}\n          onClick={() => {\n            const defaultSettingsByColumn = getSettingsByColumnWithDefaults(topicName)?.settingsByColumn || [];\n            onSettingsChange(defaultSettingsByColumn[columnIndex]);\n          }}>\n          Reset to defaults\n        </Button>\n      </SEditorWrapper>\n    </ErrorBoundary>\n  );\n}\n\ntype Props = {|\n  currentEditingTopic: Topic,\n  hasFeatureColumn: boolean,\n  saveConfig: Save3DConfig,\n  sceneBuilderMessage: any,\n  setCurrentEditingTopic: (?Topic) => void,\n  topicSettings: { [topic: string]: any },\n|};\n\nfunction TopicSettingsModal({\n  currentEditingTopic,\n  currentEditingTopic: { datatype, name: topicName },\n  hasFeatureColumn,\n  saveConfig,\n  sceneBuilderMessage,\n  setCurrentEditingTopic,\n  topicSettings,\n}: Props) {\n  const onSettingsChange = useCallback(\n    (settings: any | ((prevSettings: {}) => {})) => {\n      if (typeof settings !== \"function\" && isEmpty(settings)) {\n        // Remove the field if the topic settings are empty to prevent the panelConfig from every growing.\n        saveConfig({ topicSettings: omit(topicSettings, [topicName]) });\n        return;\n      }\n      saveConfig({\n        topicSettings: {\n          ...topicSettings,\n          [topicName]: typeof settings === \"function\" ? settings(topicSettings[topicName] || {}) : settings,\n        },\n      });\n    },\n    [saveConfig, topicName, topicSettings]\n  );\n\n  const onFieldChange = useCallback(\n    (fieldName: string, value: any) => {\n      onSettingsChange((newSettings) => ({ ...newSettings, [fieldName]: value }));\n    },\n    [onSettingsChange]\n  );\n\n  const columnIndex = topicName.startsWith(SECOND_SOURCE_PREFIX) ? 1 : 0;\n  const nonPrefixedTopic = columnIndex === 1 ? topicName.substr(SECOND_SOURCE_PREFIX.length) : topicName;\n\n  const editorElem = (\n    <MainEditor\n      collectorMessage={sceneBuilderMessage}\n      columnIndex={columnIndex}\n      datatype={datatype}\n      onFieldChange={onFieldChange}\n      onSettingsChange={onSettingsChange}\n      settings={topicSettings[topicName] || {}}\n      topicName={SHOW_SECOND_DATASOURCE ? nonPrefixedTopic : topicName}\n    />\n  );\n  return (\n    <RenderToBodyComponent>\n      <Modal\n        onRequestClose={() => setCurrentEditingTopic(undefined)}\n        contentStyle={{\n          maxHeight: \"calc(100vh - 200px)\",\n          maxWidth: 480,\n          display: \"flex\",\n          flexDirection: \"column\",\n        }}>\n        <STopicSettingsEditor>\n          <STitle>{currentEditingTopic.name}</STitle>\n          <SDatatype>{currentEditingTopic.datatype}</SDatatype>\n          {hasFeatureColumn && SHOW_SECOND_DATASOURCE ? (\n            <div className=\"ant-component\">\n              <Tabs\n                activeKey={`${columnIndex}`}\n                onChange={(newKey) => {\n                  const newEditingTopicName =\n                    newKey === \"0\" ? nonPrefixedTopic : `${SECOND_SOURCE_PREFIX}${nonPrefixedTopic}`;\n                  setCurrentEditingTopic({ datatype, name: newEditingTopicName });\n                }}>\n                <Tabs.TabPane tab={\"base\"} key={\"0\"}>\n                  {editorElem}\n                </Tabs.TabPane>\n                <Tabs.TabPane tab={SECOND_SOURCE_PREFIX} key={\"1\"}>\n                  {editorElem}\n                </Tabs.TabPane>\n              </Tabs>\n            </div>\n          ) : (\n            editorElem\n          )}\n        </STopicSettingsEditor>\n      </Modal>\n    </RenderToBodyComponent>\n  );\n}\n\nexport default React.memo<Props>(TopicSettingsModal);\n","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport React from \"react\";\nexport default ((_ref) => {\n  let {\n    styles = {}\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"styles\"]);\n\n  return React.createElement(\n    \"svg\",\n    _extends({ width: \"167\", height: \"162\", viewBox: \"0 0 167 162\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\" }, props),\n    React.createElement(\"ellipse\", { cx: \"104.564\", cy: \"145.327\", rx: \"58.694\", ry: \"16.38\", fill: \"#242429\" }),\n    React.createElement(\"path\", { d: \"M16.2 5.82a4 4 0 0 1 4-4H36.25l6.398 8.046h49.452a6 6 0 0 1 6 6v5.064H16.2V5.82z\", fill: \"#36363D\" }),\n    React.createElement(\n      \"mask\",\n      { id: \"a\", fill: \"#fff\" },\n      React.createElement(\"path\", { d: \"M14.38 6a6 6 0 0 1 6-6h12.826a6 6 0 0 1 4.877 2.505l2.67 3.725a6 6 0 0 0 4.877 2.506H92.1a6 6 0 0 1 6 6v44.783a6 6 0 0 1-6 6H20.38a6 6 0 0 1-6-6V6z\" })\n    ),\n    React.createElement(\"path\", { d: \"M14.38 21.53H98.1v-2H14.38v2zM38.084 2.504L36.458 3.67l1.625-1.165zM92.1 63.52H20.381v4h71.718v-4zM20.381 2h12.825v-4H20.381v4zm16.077 1.67l2.669 3.725 3.251-2.33-2.669-3.724-3.251 2.33zm9.172 7.066H92.1v-4H45.63v4zM16.38 59.519v-38.99h-4v38.99h4zm0-38.99V6h-4v14.53h4zm79.72-5.793v5.793h3.999v-5.793h-4zm0 5.793v38.99h3.999v-38.99h-4zM39.126 7.395a8 8 0 0 0 6.503 3.34v-4a4 4 0 0 1-3.252-1.67l-3.251 2.33zM33.207 2a4 4 0 0 1 3.25 1.67l3.252-2.33A8 8 0 0 0 33.206-2v4zM20.38 63.519a4 4 0 0 1-4-4h-4a8 8 0 0 0 8 8v-4zm71.718 4a8 8 0 0 0 8-8h-4a4 4 0 0 1-4 4v4zm0-56.783a4 4 0 0 1 4 4h4a8 8 0 0 0-8-8v4zM20.381-2a8 8 0 0 0-8 8h4a4 4 0 0 1 4-4v-4z\", fill: \"#606066\", mask: \"url(#a)\" }),\n    React.createElement(\"circle\", { cx: \"98.649\", cy: \"77.989\", r: \"38.129\", fill: \"#19181C\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\"circle\", { cx: \"98.649\", cy: \"77.989\", r: \"29.939\", fill: \"#2D2D33\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\"rect\", { x: \"125.831\", y: \"113.941\", width: \"12.56\", height: \"43.173\", rx: \"6.28\", transform: \"rotate(-43.636 125.831 113.941)\", fill: \"#19181C\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\"path\", { d: \"M127.615 103.532l5.185 5.185M123.844 107.303l5.185 5.185\", stroke: \"#606066\", strokeWidth: \"2\" }),\n    React.createElement(\n      \"mask\",\n      { id: \"b\", fill: \"#fff\" },\n      React.createElement(\"path\", { d: \"M13.499 89.226a3 3 0 0 1 3.92-1.828l18.742 7.238 5.13 13.009-8.891 26.026a3 3 0 0 1-3.838 1.859l-24.761-8.74a3 3 0 0 1-1.84-3.799l11.538-33.765z\" })\n    ),\n    React.createElement(\"path\", { d: \"M32.704 104.276l-.941-.338-.328.914.904.355.365-.931zm2.516-9.978l-3.457 9.64 1.882.675 3.458-9.64-1.883-.675zm-2.881 10.909l8.586 3.369.73-1.862-8.586-3.369-.73 1.862zm8.951 2.438l1.893.647.238-.696-.27-.685-1.86.734zm-5.129-13.01l1.861-.733-.322-.816-.818-.316-.72 1.866zM3.801 126.79l-.666 1.886.666-1.886zm24.761 8.74l.666-1.886-.666 1.886zm3.838-1.859l-1.893-.647 1.893.647zm-3.172-.027l-24.761-8.74-1.332 3.772 24.762 8.74 1.33-3.772zM3.853 123.638l11.538-33.765-3.785-1.294L.068 122.345l3.785 1.293zm35.545-16.64l-8.89 26.026 3.784 1.293 8.89-26.025-3.784-1.294zm-22.7-17.735l18.743 7.239 1.44-3.732-18.742-7.238-1.441 3.731zM34.3 95.37l5.129 13.01 3.72-1.468-5.128-13.009-3.721 1.467zM4.467 124.904a1 1 0 0 1-.614-1.266l-3.785-1.293a5 5 0 0 0 3.067 6.331l1.332-3.772zm23.43 12.512a5 5 0 0 0 6.395-3.099l-3.785-1.293a1 1 0 0 1-1.28.62l-1.33 3.772zM15.39 89.873a1 1 0 0 1 1.307-.61l1.44-3.731a5 5 0 0 0-6.532 3.047l3.785 1.294z\", fill: \"#606066\", mask: \"url(#b)\" }),\n    React.createElement(\"path\", { d: \"M14.937 105l17.004 5.905M12.969 110.668l17.003 5.905M11 116.336l17.004 5.905\", stroke: \"#606066\", strokeWidth: \"2\", strokeLinecap: \"round\" })\n  );\n});","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { type Node } from \"react\";\nimport styled from \"styled-components\";\n\nimport renderNamespaceNodes, { type NamespaceNode } from \"./renderNamespaceNodes\";\nimport TreeNodeRow from \"./TreeNodeRow\";\nimport type {\n  DerivedCustomSettingsByKey,\n  GetIsNamespaceCheckedByDefault,\n  GetIsTreeNodeVisibleInScene,\n  GetIsTreeNodeVisibleInTree,\n  NamespacesByTopic,\n  SceneErrorsByKey,\n  SetCurrentEditingTopic,\n  ToggleNamespaceChecked,\n  ToggleNode,\n  TopicDisplayMode,\n  TreeNode,\n} from \"./types\";\nimport { generateNodeKey } from \"./useTopicTree\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport { TOPIC_DISPLAY_MODES } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSelector/TopicDisplayModeSelector\";\nimport naturalSort from \"webviz-core/src/util/naturalSort\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const SWITCHER_WIDTH = 24;\n\nexport const SToggles = styled.div`\n  display: flex;\n  align-items: center;\n`;\nexport const SToggle = styled.div`\n  width: 24px;\n  height: 24px;\n`;\n\nconst TooltipRow = styled.div`\n  margin: 4px 0;\n  &:first-child {\n    margin-top: 0;\n  }\n  &:last-child {\n    margin-bottom: 0;\n  }\n`;\nconst TooltipDescription = styled(TooltipRow)`\n  line-height: 1.3;\n  max-width: 300px;\n`;\n\nconst TooltipTable = styled.table`\n  th,\n  td {\n    border: none;\n    padding: 0;\n  }\n  td {\n    word-break: break-word;\n  }\n  max-width: 100%;\n  th {\n    color: ${colors.TEXT_MUTED};\n  }\n`;\n\ntype Props = {|\n  availableNamespacesByTopic: NamespacesByTopic,\n  checkedKeysSet: Set<string>,\n  children: TreeNode[],\n  derivedCustomSettingsByKey: DerivedCustomSettingsByKey,\n  filterText: string,\n  getIsNamespaceCheckedByDefault: GetIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene: GetIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree: GetIsTreeNodeVisibleInTree,\n  isXSWidth: boolean,\n  sceneErrorsByKey: SceneErrorsByKey,\n  setCurrentEditingTopic: SetCurrentEditingTopic,\n  toggleCheckAllAncestors: ToggleNode,\n  toggleCheckAllDescendants: ToggleNode,\n  toggleNamespaceChecked: ToggleNamespaceChecked,\n  toggleNodeChecked: ToggleNode,\n  toggleNodeExpanded: ToggleNode,\n  topicDisplayMode: TopicDisplayMode,\n  width: number,\n|};\n\nexport type TreeUINode = {| title: Node, key: string, children?: TreeUINode[], disabled?: boolean |};\n\n// A recursive function for generating tree nodes UI. Must use function instead of React component as the\n// return signature is different from React component.\nexport default function renderTreeNodes({\n  availableNamespacesByTopic,\n  checkedKeysSet,\n  children,\n  derivedCustomSettingsByKey,\n  filterText,\n  getIsNamespaceCheckedByDefault,\n  getIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree,\n  isXSWidth,\n  sceneErrorsByKey,\n  setCurrentEditingTopic,\n  toggleCheckAllAncestors,\n  toggleCheckAllDescendants,\n  toggleNamespaceChecked,\n  toggleNodeChecked,\n  toggleNodeExpanded,\n  topicDisplayMode,\n  width,\n}: Props): TreeUINode[] {\n  const titleWidth = width - SWITCHER_WIDTH;\n  return children\n    .filter((item) => getIsTreeNodeVisibleInTree(item.key))\n    .map((item) => {\n      const { key, providerAvailable } = item;\n      const nodeVisibleInScene = getIsTreeNodeVisibleInScene(item);\n\n      const showVisible = topicDisplayMode === TOPIC_DISPLAY_MODES.SHOW_SELECTED.value;\n      const showAvailable = topicDisplayMode === TOPIC_DISPLAY_MODES.SHOW_AVAILABLE.value;\n      // Render all nodes regardless of the displayMode when datasources are unavailable.\n      if (providerAvailable && ((showVisible && !nodeVisibleInScene) || (showAvailable && !item.available))) {\n        return null;\n      }\n\n      const itemChildren = item.type === \"group\" ? item.children : [];\n      const topicName = item.type === \"topic\" ? item.topicName : \"\";\n\n      const availableNamespaces = (topicName && availableNamespacesByTopic[topicName]) || [];\n      const namespaceNodes: NamespaceNode[] = filterMap(availableNamespaces, (namespace) => {\n        const namespaceKey = generateNodeKey({ topicName, namespace });\n        const visible = checkedKeysSet.has(namespaceKey) || getIsNamespaceCheckedByDefault(topicName);\n        // Don't render namespaces that are not visible when the user selected to view Visible only.\n        if (providerAvailable && showVisible && !visible) {\n          return undefined;\n        }\n        return {\n          key: namespaceKey,\n          namespace,\n          checked: visible,\n        };\n      });\n\n      const tooltips = [];\n      if (topicName) {\n        tooltips.push(\n          <TooltipRow key={tooltips.length}>\n            <TooltipTable>\n              <tbody>\n                <tr>\n                  <th>Topic:</th>\n                  <td>\n                    <tt>{topicName}</tt>\n                  </td>\n                </tr>\n                {item.type === \"topic\" && item.datatype && (\n                  <tr>\n                    <th>Type:</th>\n                    <td>\n                      <tt>{item.datatype}</tt>\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </TooltipTable>\n          </TooltipRow>\n        );\n      }\n      if (item.description) {\n        tooltips.push(<TooltipDescription key={tooltips.length}>{item.description}</TooltipDescription>);\n      }\n\n      const title = (\n        <TreeNodeRow\n          checkedKeysSet={checkedKeysSet}\n          node={item}\n          nodeVisibleInScene={nodeVisibleInScene}\n          hasChildren={itemChildren.length > 0 || namespaceNodes.length > 0}\n          isXSWidth={isXSWidth}\n          toggleCheckAllAncestors={toggleCheckAllAncestors}\n          toggleCheckAllDescendants={toggleCheckAllDescendants}\n          toggleNodeChecked={toggleNodeChecked}\n          toggleNodeExpanded={toggleNodeExpanded}\n          sceneErrors={sceneErrorsByKey[item.key]}\n          setCurrentEditingTopic={setCurrentEditingTopic}\n          derivedCustomSettings={derivedCustomSettingsByKey[key]}\n          width={titleWidth}\n          filterText={filterText}\n          {...(tooltips.length ? { tooltips } : undefined)}\n        />\n      );\n\n      const childrenNodes = [];\n      if (item.type === \"topic\" && namespaceNodes.length > 0) {\n        childrenNodes.push(\n          ...renderNamespaceNodes({\n            children: namespaceNodes.sort(naturalSort(\"namespace\")),\n            getIsTreeNodeVisibleInScene,\n            getIsTreeNodeVisibleInTree,\n            isXSWidth,\n            toggleCheckAllAncestors,\n            toggleNamespaceChecked,\n            topicNode: item,\n            width: titleWidth,\n            overrideColor: derivedCustomSettingsByKey[key] && derivedCustomSettingsByKey[key].overrideColor,\n            filterText,\n          })\n        );\n      }\n      if (itemChildren) {\n        childrenNodes.push(\n          ...renderTreeNodes({\n            availableNamespacesByTopic,\n            checkedKeysSet,\n            children: itemChildren,\n            getIsTreeNodeVisibleInScene,\n            getIsTreeNodeVisibleInTree,\n            getIsNamespaceCheckedByDefault,\n            isXSWidth,\n            toggleCheckAllAncestors,\n            toggleCheckAllDescendants,\n            toggleNamespaceChecked,\n            toggleNodeChecked,\n            toggleNodeExpanded,\n            topicDisplayMode,\n            sceneErrorsByKey,\n            setCurrentEditingTopic,\n            derivedCustomSettingsByKey,\n            width: titleWidth,\n            filterText,\n          })\n        );\n      }\n      return {\n        key,\n        title,\n        ...(childrenNodes.length ? { children: childrenNodes } : undefined),\n        // Add `disabled` so that the switcher has the correct color.\n        disabled: !nodeVisibleInScene,\n      };\n    })\n    .filter(Boolean);\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\n\nimport NodeName from \"./NodeName\";\nimport { type TreeUINode } from \"./renderTreeNodes\";\nimport { TREE_SPACING } from \"./TopicTreeV2\";\nimport { SToggles, STreeNodeRow, SLeft, SRightActions, ICON_SIZE, SDotMenuPlaceholder } from \"./TreeNodeRow\";\nimport type {\n  ToggleNode,\n  TreeTopicNode,\n  GetIsTreeNodeVisibleInScene,\n  GetIsTreeNodeVisibleInTree,\n  ToggleNamespaceChecked,\n} from \"./types\";\nimport VisibilityToggle, { TOGGLE_WRAPPER_SIZE } from \"./VisibilityToggle\";\n\nconst OUTER_LEFT_MARGIN = 12;\nconst INNER_LEFT_MARGIN = 8;\n\nexport type NamespaceNode = {|\n  checked: boolean,\n  key: string,\n  namespace: string,\n|};\n\ntype Props = {|\n  children: NamespaceNode[],\n  getIsTreeNodeVisibleInScene: GetIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree: GetIsTreeNodeVisibleInTree,\n  isXSWidth: boolean,\n  overrideColor: ?string,\n  toggleCheckAllAncestors: ToggleNode,\n  toggleNamespaceChecked: ToggleNamespaceChecked,\n  topicNode: TreeTopicNode,\n  width: number,\n  filterText: string,\n|};\n\n// Must use function instead of React component as Tree/TreeNode can only accept TreeNode as children.\nexport default function renderNamespaceNodes({\n  children,\n  getIsTreeNodeVisibleInScene,\n  getIsTreeNodeVisibleInTree,\n  isXSWidth,\n  overrideColor,\n  toggleCheckAllAncestors,\n  toggleNamespaceChecked,\n  topicNode,\n  width,\n  filterText,\n}: Props): TreeUINode[] {\n  return children\n    .filter(({ key }) => getIsTreeNodeVisibleInTree(key))\n    .map(({ key, namespace, checked }) => {\n      const nodeVisibleInScene = getIsTreeNodeVisibleInScene(topicNode, key);\n      const rowWidth = width - (isXSWidth ? 0 : TREE_SPACING * 2) - OUTER_LEFT_MARGIN;\n      const rightActionWidth = topicNode.available ? TOGGLE_WRAPPER_SIZE + ICON_SIZE : ICON_SIZE;\n      const maxNodeNameLen = rowWidth - rightActionWidth - INNER_LEFT_MARGIN * 2;\n\n      const title = (\n        <STreeNodeRow\n          visibleInScene={nodeVisibleInScene}\n          style={{\n            width: rowWidth,\n            marginLeft: `-${OUTER_LEFT_MARGIN}px`,\n          }}>\n          <SLeft>\n            <NodeName\n              isXSWidth={isXSWidth}\n              maxWidth={maxNodeNameLen}\n              displayName={namespace}\n              topicName={\"\"}\n              searchText={filterText}\n            />\n          </SLeft>\n          <SRightActions>\n            {topicNode.available && (\n              <SToggles>\n                <VisibilityToggle\n                  dataTest={`visibility-toggle~${key}`}\n                  checked={checked}\n                  onAltToggle={() => toggleCheckAllAncestors(key, topicNode.topicName)}\n                  onToggle={() => toggleNamespaceChecked({ topicName: topicNode.topicName, namespaceKey: key })}\n                  overrideColor={overrideColor}\n                  visibleInScene={nodeVisibleInScene}\n                />\n              </SToggles>\n            )}\n            <SDotMenuPlaceholder />\n          </SRightActions>\n        </STreeNodeRow>\n      );\n      return { key, title };\n    });\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React from \"react\";\nimport Highlighter from \"react-highlight-words\";\nimport styled from \"styled-components\";\n\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nconst HIGHLIGHT_CLASSNAME = \"rc-TextHighlight-highlight\";\nconst STextHighlight = styled.span`\n  .${HIGHLIGHT_CLASSNAME} {\n    color: ${colors.BLUE};\n    background: none;\n    padding: 0;\n  }\n`;\n\ntype Props = {|\n  targetStr: string,\n  searchText?: string,\n|};\n\nexport default function TextHighlight({ targetStr = \"\", searchText = \"\" }: Props) {\n  if (!searchText) {\n    return targetStr;\n  }\n\n  return (\n    <STextHighlight>\n      <Highlighter\n        autoEscape\n        highlightClassName={HIGHLIGHT_CLASSNAME}\n        searchWords={[searchText]}\n        textToHighlight={targetStr}\n      />\n    </STextHighlight>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\n\nexport const DEFAULT_END_TEXT_LENGTH = 16;\n\nexport const STextMiddleTruncate = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n`;\n\nconst SStart = styled.div`\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  flex-shrink: 1;\n`;\n\nconst SEnd = styled.div`\n  white-space: nowrap;\n  flex-basis: content;\n  flex-grow: 0;\n  flex-shrink: 0;\n  max-width: 100%;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\ntype Props = {|\n  tooltips?: React.Node[],\n  text: string,\n  endTextLength?: number,\n  style?: { [attr: string]: string | number },\n  testShowTooltip?: boolean,\n|};\n\nexport default function TextMiddleTruncate({ tooltips, text, endTextLength, style, testShowTooltip }: Props) {\n  const startTextLen = Math.max(0, text.length - (endTextLength || DEFAULT_END_TEXT_LENGTH));\n  const startText = text.substr(0, startTextLen);\n  const endText = text.substr(startTextLen);\n\n  const elem = (\n    <STextMiddleTruncate style={style}>\n      <SStart>{startText}</SStart>\n      <SEnd>{endText}</SEnd>\n    </STextMiddleTruncate>\n  );\n  return tooltips ? (\n    <Tooltip contents={tooltips} placement=\"bottom\" defaultShown={testShowTooltip}>\n      {elem}\n    </Tooltip>\n  ) : (\n    elem\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport LayersIcon from \"@mdi/svg/svg/layers.svg\";\nimport PinIcon from \"@mdi/svg/svg/pin.svg\";\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nimport { type Save3DConfig } from \"../index\";\nimport Icon from \"webviz-core/src/components/Icon\";\nimport KeyboardShortcut from \"webviz-core/src/components/KeyboardShortcut\";\nimport Tooltip from \"webviz-core/src/components/Tooltip\";\nimport { colors } from \"webviz-core/src/util/sharedStyleConstants\";\n\nexport const SWITCHER_HEIGHT = 28;\nconst STopicTreeSwitcher = styled.div`\n  width: 56px;\n  display: flex;\n  height: ${SWITCHER_HEIGHT}px;\n  position: relative;\n`;\n\nconst SErrorsBadge = styled.div`\n  position: absolute;\n  top: -4px;\n  left: 24px;\n  width: 10px;\n  height: 10px;\n  border-radius: 5px;\n  background-color: ${colors.RED};\n`;\n\n/* TODO(Audrey): stay consistent with other buttons in the 3D panel, will consolidate later. */\nconst SIconWrapper = styled.div`\n  width: 28px;\n  border-radius: 4px;\n  padding: 4px;\n  position: absolute;\n  top: 0;\n  left: 0;\n`;\n\ntype Props = {|\n  pinTopics: boolean,\n  renderTopicTree: boolean,\n  saveConfig: Save3DConfig,\n  setShowTopicTree: (boolean) => void,\n  showErrorBadge: boolean,\n  showTopicTree: boolean,\n|};\n\nexport default function TopicTreeSwitcher({\n  pinTopics,\n  renderTopicTree,\n  saveConfig,\n  setShowTopicTree,\n  showErrorBadge,\n  showTopicTree,\n}: Props) {\n  return (\n    <STopicTreeSwitcher>\n      <SIconWrapper\n        style={{\n          backgroundColor: renderTopicTree ? \"transparent\" : \"#2d2c33\",\n          opacity: renderTopicTree ? \"0\" : \"1\",\n          transition: `all 0.1s ease-out`,\n        }}>\n        <Icon\n          tooltipProps={{ placement: \"top\", contents: <KeyboardShortcut keys={[\"T\"]} /> }}\n          dataTest=\"open-topic-picker\"\n          active={renderTopicTree}\n          fade\n          medium\n          onClick={() => setShowTopicTree(!showTopicTree)}>\n          <LayersIcon />\n        </Icon>\n      </SIconWrapper>\n      <SIconWrapper\n        style={{\n          transform: `translate(0px,${renderTopicTree ? 0 : 28}px)`,\n          opacity: renderTopicTree ? \"1\" : \"0\",\n          transition: `all 0.3s ease-in-out`,\n          pointerEvents: renderTopicTree ? \"unset\" : \"none\",\n        }}>\n        <Icon\n          tooltipProps={{ placement: \"top\", contents: \"Pin topic picker\" }}\n          small\n          fade\n          active={pinTopics}\n          onClick={() => {\n            // Keep TopicTree open after unpin.\n            setShowTopicTree(true);\n            saveConfig({ pinTopics: !pinTopics }, { keepLayoutInUrl: true });\n          }}\n          style={{ color: pinTopics ? colors.HIGHLIGHT : colors.LIGHT }}>\n          <PinIcon />\n        </Icon>\n      </SIconWrapper>\n      {showErrorBadge && (\n        <Tooltip contents=\"Errors found in selected topics/namespaces\" placement=\"top\">\n          <SErrorsBadge />\n        </Tooltip>\n      )}\n    </STopicTreeSwitcher>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mapKeys, difference } from \"lodash\";\nimport { useMemo, useRef } from \"react\";\n\nimport type { UseSceneBuilderAndTransformsDataInput, UseSceneBuilderAndTransformsDataOutput } from \"./types\";\nimport { generateNodeKey } from \"./useTopicTree\";\nimport useDataSourceInfo from \"webviz-core/src/PanelAPI/useDataSourceInfo\";\nimport { useChangeDetector, useDeepMemo } from \"webviz-core/src/util/hooks\";\n\n// Derived namespace and error information for TopicTree from sceneBuilder and transforms.\nexport default function useSceneBuilderAndTransformsData({\n  sceneBuilder,\n  transforms,\n  staticallyAvailableNamespacesByTopic,\n}: UseSceneBuilderAndTransformsDataInput): UseSceneBuilderAndTransformsDataOutput {\n  const { playerId } = useDataSourceInfo();\n  const hasChangedPlayerId = useChangeDetector([playerId], false);\n\n  const newAvailableTfs = transforms\n    .values()\n    .map(({ id }) => id)\n    .filter(Boolean);\n  const availableTfsRef = useRef<string[]>(newAvailableTfs);\n  if (hasChangedPlayerId) {\n    // If we have changed the playerId - meaning that we've added or removed a source - recalculate the available TFs\n    // from scratch.\n    availableTfsRef.current = newAvailableTfs;\n  } else {\n    const tfsNotYetAdded = difference(newAvailableTfs, availableTfsRef.current);\n    // Only add TFs, never remove them. If we've seen them once in the bag, they may re-appear.\n    // NOTE: changing this to instead show the exact TFs available at this point in time is NOT advisable. There is a\n    // subtle bug that will lead to the topic tree \"jumping\" in position as TFs are quickly removed and then re-added\n    // whenever a topic is added.\n    if (tfsNotYetAdded.length) {\n      availableTfsRef.current = [...availableTfsRef.current, ...tfsNotYetAdded];\n    }\n  }\n  const availableTfs = availableTfsRef.current;\n\n  const availableNamespacesByTopic = useMemo(\n    () => {\n      const result = { ...staticallyAvailableNamespacesByTopic };\n      for (const { name, topic } of sceneBuilder.allNamespaces) {\n        result[topic] = result[topic] || [];\n        result[topic].push(name);\n      }\n      if (availableTfs.length) {\n        result[\"/tf\"] = availableTfs;\n      }\n      return result;\n    },\n    [availableTfs, sceneBuilder.allNamespaces, staticallyAvailableNamespacesByTopic]\n  );\n\n  const sceneErrorsByKey = useMemo(\n    () => mapKeys(sceneBuilder.errorsByTopic, (value, topicName) => generateNodeKey({ topicName })),\n    [sceneBuilder.errorsByTopic]\n  );\n\n  const sceneErrorsByKeyMemo = useDeepMemo(sceneErrorsByKey);\n\n  return { availableNamespacesByTopic, sceneErrorsByKey: sceneErrorsByKeyMemo };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { mat4, quat, vec3 } from \"gl-matrix\";\nimport type { Vec3 } from \"gl-matrix\";\n\nimport Transforms, { Transform } from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport type { Marker, ArrowMarker, Color, MutablePose } from \"webviz-core/src/types/Messages\";\nimport type { MarkerProvider, MarkerCollector } from \"webviz-core/src/types/Scene\";\nimport { MARKER_MSG_TYPES } from \"webviz-core/src/util/globalConstants\";\n\nconst originPosition = { x: 0, y: 0, z: 0 };\nconst originOrientation = { x: 0, y: 0, z: 0, w: 1 };\n\nconst defaultArrowMarker = {\n  id: \"\",\n  header: {\n    frame_id: \"\",\n    stamp: {\n      sec: 0,\n      nsec: 0,\n    },\n  },\n  ns: \"tf-axes\",\n  type: 0,\n  action: 0,\n};\n\nconst defaultArrowScale = { x: 0.2, y: 0.02, z: 0.02 };\n\nconst getOriginPose = (): MutablePose => ({\n  position: { ...originPosition },\n  orientation: { ...originOrientation },\n});\n\nconst unitXVector = vec3.fromValues(1, 0, 0);\n\ntype Axis = ArrowMarker & {\n  id: string,\n  color: Color,\n  unitVector: Vec3,\n};\n\nconst originAxes: Array<Axis> = [\n  {\n    ...defaultArrowMarker,\n    scale: { ...defaultArrowScale },\n    pose: {\n      position: { ...originPosition },\n      orientation: { ...originOrientation },\n    },\n    id: \"X\",\n    color: { r: 1, g: 0, b: 0, a: 1 },\n    unitVector: vec3.fromValues(1, 0, 0),\n  },\n  {\n    ...defaultArrowMarker,\n    scale: { ...defaultArrowScale },\n    pose: {\n      position: { ...originPosition },\n      orientation: { ...originOrientation },\n    },\n    id: \"Y\",\n    color: { r: 0, g: 1, b: 0, a: 1 },\n    unitVector: vec3.fromValues(0, 1, 0),\n  },\n  {\n    ...defaultArrowMarker,\n    scale: { ...defaultArrowScale },\n    pose: {\n      position: { ...originPosition },\n      orientation: { ...originOrientation },\n    },\n    id: \"Z\",\n    color: { r: 0, g: 0, b: 1, a: 1 },\n    unitVector: vec3.fromValues(0, 0, 1),\n  },\n];\n\nconst tempOrientation = [0, 0, 0, 0];\n\nconst getTransformedAxisArrowMarker = (id: string, transform: Transform, axis: Axis, rootTransformID: string) => {\n  const { unitVector, id: axisId } = axis;\n  quat.rotationTo(tempOrientation, unitXVector, unitVector);\n  const pose = {\n    position: { ...originPosition },\n    orientation: { x: tempOrientation[0], y: tempOrientation[1], z: tempOrientation[2], w: tempOrientation[3] },\n  };\n\n  transform.apply(pose, pose, rootTransformID);\n\n  return {\n    ...axis,\n    id: `${id}-${axisId}axis`,\n    name: `${id}-${axisId}axis`,\n    pose,\n  };\n};\n\nconst getAxesArrowMarkers = (id: string, transform: Transform, rootTransformID: string): ArrowMarker[] => {\n  return originAxes.map((axis) => getTransformedAxisArrowMarker(id, transform, axis, rootTransformID));\n};\n\nconst getAxisTextMarker = (id: string, transform: Transform, rootTransformID: string): Marker => {\n  const textPose = getOriginPose();\n  transform.apply(textPose, textPose, rootTransformID);\n  // Lower it a little in world coordinates so it appears slightly below the axis origin (like in rviz).\n  textPose.position.z = textPose.position.z - 0.02;\n  return {\n    header: {\n      frame_id: \"\",\n      stamp: {\n        sec: 0,\n        nsec: 0,\n      },\n    },\n    ns: \"tf-axes\",\n    action: 0,\n    scale: { x: 1, y: 1, z: 1 },\n    color: { r: 1, g: 1, b: 1, a: 1 },\n    id: `${id}-name`,\n    name: `${id}-name`,\n    pose: textPose,\n    type: MARKER_MSG_TYPES.TEXT_VIEW_FACING,\n    text: id,\n  };\n};\n\nconst tempTranslation = [0, 0, 0];\n// So we don't create a lot of effectively unused vectors / quats.\nconst throwawayQuat = { ...originOrientation };\n\nconst getArrowToParentMarkers = (id: string, transform: Transform, rootTransformID: string): ArrowMarker[] => {\n  const { parent } = transform;\n  if (!parent || !parent.valid) {\n    return [];\n  }\n\n  mat4.getTranslation(tempTranslation, transform.matrix);\n  if (vec3.length(tempTranslation) <= 0) {\n    // If the parent's position is on the child, we don't need to draw an arrow between them.\n    return [];\n  }\n\n  const childPose: MutablePose = { position: { ...originPosition }, orientation: throwawayQuat };\n  transform.apply(childPose, childPose, rootTransformID);\n\n  const parentPose = { position: { ...originPosition }, orientation: throwawayQuat };\n  parent.apply(parentPose, parentPose, rootTransformID);\n\n  return [\n    {\n      ...defaultArrowMarker,\n      pose: {\n        position: { ...originPosition },\n        orientation: { ...originOrientation },\n      },\n      id: `${id}-childToParentArrow`,\n      color: { r: 1, g: 1, b: 0, a: 1 },\n      points: [childPose.position, parentPose.position],\n      scale: {\n        // Intentionally different scale from the other arrows, to make the arrow head reasonable.\n        x: 0.02,\n        y: 0.01,\n        z: 0.05,\n      },\n    },\n  ];\n};\n\nexport default class TransformsBuilder implements MarkerProvider {\n  transforms: Transforms;\n  rootTransformID: string;\n  selections: string[] = [];\n\n  setTransforms = (transforms: Transforms, rootTransformID: string) => {\n    this.transforms = transforms;\n    this.rootTransformID = rootTransformID;\n  };\n\n  addMarkersForTransform(add: MarkerCollector, id: string, transform: Transform, rootTransformID: string) {\n    if (!transform.isChildOfTransform(rootTransformID)) {\n      return;\n    }\n    const markersForTransform: Marker[] = [\n      ...getAxesArrowMarkers(id, transform, rootTransformID),\n      ...getArrowToParentMarkers(id, transform, rootTransformID),\n      getAxisTextMarker(id, transform, rootTransformID),\n    ];\n    for (const marker of markersForTransform) {\n      switch (marker.type) {\n        case 0:\n          add.arrow(marker);\n          break;\n        case 9:\n          add.text(marker);\n          break;\n        default:\n          console.warn(\"Marker for transform not supported\", marker);\n      }\n    }\n  }\n\n  setSelectedTransforms(selections: string[]) {\n    this.selections = selections;\n  }\n\n  renderMarkers = (add: MarkerCollector) => {\n    const { selections, transforms } = this;\n    if (!transforms) {\n      return;\n    }\n    for (const key of selections) {\n      const transform = this.transforms.get(key);\n      if (!transform.valid) {\n        // If a marker doesn't exist yet, skip rendering for now, we might get the\n        // transform in a later message, so we still want to keep it in selections.\n        continue;\n      }\n      this.addMarkersForTransform(add, key, transform, this.rootTransformID);\n    }\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useMemo, type Node } from \"react\";\nimport {\n  Worldview,\n  Arrows,\n  Cubes,\n  Cylinders,\n  GLText,\n  Lines,\n  Points,\n  Spheres,\n  Text,\n  Triangles,\n  FilledPolygons,\n  type CameraState,\n  type MouseHandler,\n  createInstancedGetChildrenForHitmap,\n} from \"regl-worldview\";\n\nimport { useExperimentalFeature } from \"webviz-core/src/components/ExperimentalFeatures\";\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport {\n  OccupancyGrids,\n  LaserScans,\n  PointClouds,\n  GPUPointClouds,\n  PoseMarkers,\n  LinedConvexHulls,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/commands\";\nimport { type WorldSearchTextProps, useGLText } from \"webviz-core/src/panels/ThreeDimensionalViz/SearchText\";\nimport inScreenshotTests from \"webviz-core/src/stories/inScreenshotTests\";\nimport type { TextMarker } from \"webviz-core/src/types/Messages\";\nimport type { MarkerCollector, MarkerProvider } from \"webviz-core/src/types/Scene\";\n\ntype Props = {|\n  autoTextBackgroundColor: boolean,\n  cameraState: CameraState,\n  children?: Node,\n  isPlaying: boolean,\n  markerProviders: MarkerProvider[],\n  onCameraStateChange: (CameraState) => void,\n  onClick: MouseHandler,\n  onDoubleClick: MouseHandler,\n  onMouseDown?: MouseHandler,\n  onMouseMove?: MouseHandler,\n  onMouseUp?: MouseHandler,\n  ...WorldSearchTextProps,\n|};\n\nfunction getMarkers(markerProviders: MarkerProvider[]) {\n  const markers = {};\n  const collector = {};\n  getGlobalHooks()\n    .perPanelHooks()\n    .ThreeDimensionalViz.allSupportedMarkers.forEach((field) => {\n      if (!markers[field]) {\n        markers[field] = [];\n      }\n      collector[field] = (o) => markers[field].push(o);\n    });\n\n  markerProviders.forEach((provider) => {\n    if (provider) {\n      provider.renderMarkers(((collector: any): MarkerCollector));\n    }\n  });\n\n  return markers;\n}\n\n// Generate an alphabet for text makers with the most\n// used ASCII characters to prevent recreating the texture\n// atlas too many times for dynamic texts.\nconst ALPHABET = (() => {\n  const start = 32; // SPACE\n  const end = 125; // \"}\"\n  return new Array(end - start + 1).fill().map((_, i) => String.fromCodePoint(start + i));\n})();\n\nexport default function World({\n  onClick,\n  autoTextBackgroundColor,\n  children,\n  onCameraStateChange,\n  cameraState,\n  cameraState: { perspective },\n  isPlaying,\n  markerProviders,\n  onDoubleClick,\n  onMouseDown,\n  onMouseMove,\n  onMouseUp,\n  setSearchTextMatches,\n  searchText,\n  searchTextOpen,\n  selectedMatchIndex,\n  searchTextMatches,\n}: Props) {\n  const getChildrenForHitmap = useMemo(() => createInstancedGetChildrenForHitmap(2), []);\n  const {\n    arrow,\n    cube,\n    cubeList,\n    cylinder,\n    filledPolygon,\n    grid,\n    instancedLineList,\n    laserScan,\n    linedConvexHull,\n    lineList,\n    lineStrip,\n    pointcloud,\n    points,\n    poseMarker,\n    sphere,\n    sphereList,\n    text,\n    triangleList,\n    ...rest\n  } = getMarkers(markerProviders);\n  const additionalMarkers = getGlobalHooks()\n    .perPanelHooks()\n    .ThreeDimensionalViz.renderAdditionalMarkers(rest);\n\n  const glTextEnabled = useExperimentalFeature(\"glText\");\n  const TextComponent = glTextEnabled ? GLText : Text;\n\n  // Only actually used when GLText is enabled.\n  const textMarkers = useGLText({\n    glTextEnabled,\n    text: (text: TextMarker[]),\n    setSearchTextMatches,\n    searchText,\n    searchTextOpen,\n    selectedMatchIndex,\n    searchTextMatches,\n  });\n\n  const gpuPointCloudsEnabled = useExperimentalFeature(\"gpuPointCloud\");\n  const PointCloudsComponent = gpuPointCloudsEnabled ? GPUPointClouds : PointClouds;\n\n  return (\n    <Worldview\n      cameraState={cameraState}\n      enableStackedObjectEvents={!isPlaying}\n      hideDebug={inScreenshotTests()}\n      onCameraStateChange={onCameraStateChange}\n      // Rendering the hitmap is an expensive operation and we want to avoid\n      // doing it when the user is dragging the view with the mouse. By ignoring\n      // these events, the only way to select an object is when receiving an \"onClick\" event.\n      disableHitmapForEvents={[\"onMouseDown\", \"onMouseMove\", \"onMouseUp\"]}\n      onClick={onClick}\n      onDoubleClick={onDoubleClick}\n      onMouseDown={onMouseDown}\n      onMouseMove={onMouseMove}\n      onMouseUp={onMouseUp}>\n      {children}\n      <OccupancyGrids layerIndex={-1}>{grid}</OccupancyGrids>\n      {additionalMarkers}\n      <Lines>{[...lineList, ...lineStrip]}</Lines>\n      <Arrows>{arrow}</Arrows>\n      <Points>{points}</Points>\n      <PointCloudsComponent>{pointcloud}</PointCloudsComponent>\n      <Triangles>{triangleList}</Triangles>\n      <Spheres>{[...sphere, ...sphereList]}</Spheres>\n      <Cylinders>{cylinder}</Cylinders>\n      <Cubes>{[...cube, ...cubeList]}</Cubes>\n      <PoseMarkers>{poseMarker}</PoseMarkers>\n      <LaserScans>{laserScan}</LaserScans>\n      <TextComponent\n        layerIndex={10}\n        alphabet={ALPHABET}\n        scaleInvariantFontSize={14}\n        autoBackgroundColor={autoTextBackgroundColor}>\n        {textMarkers}\n      </TextComponent>\n      <FilledPolygons>{filledPolygon}</FilledPolygons>\n      <Lines getChildrenForHitmap={getChildrenForHitmap}>{instancedLineList}</Lines>\n      <LinedConvexHulls>{linedConvexHull}</LinedConvexHulls>\n    </Worldview>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nexport { default as PoseMarkers } from \"./PoseMarkers\";\nexport { default as LaserScans } from \"./LaserScans\";\nexport { default as OccupancyGrids } from \"./OccupancyGrids\";\nexport { default as PointClouds } from \"./Pointclouds\";\nexport { default as GPUPointClouds } from \"./GPUPointClouds\";\nexport { default as LinedConvexHulls } from \"./LinedConvexHulls\";\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { vec3 } from \"gl-matrix\";\nimport React, { type Node } from \"react\";\nimport { Arrows, pointToVec3, vec3ToPoint, orientationToVec4, type Arrow } from \"regl-worldview\";\n\nimport CarModel from \"./CarModel\";\nimport { parseColorSetting } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicGroups/TopicSettingsEditor\";\n\ntype Props = {\n  children: Arrow[],\n};\n\n// $FlowFixMe - flow doesn't have a definition for React.memo\nexport default React.memo(function PoseMarkers({ children }: Props): Node[] {\n  const models = [];\n  const markers = [];\n  children.forEach((marker, i) => {\n    if (marker.settings && marker.settings.useCarModel) {\n      const { pose, settings, interactionData } = marker;\n      models.push(<CarModel key={i}>{{ pose, alpha: settings.alpha || 1, interactionData }}</CarModel>);\n    } else {\n      const { settings } = marker;\n      if (settings && settings.color && typeof settings.color === \"string\") {\n        marker = { ...marker, color: parseColorSetting(settings.color) };\n      }\n\n      if (settings && settings.size) {\n        marker = {\n          ...marker,\n          scale: {\n            x: settings.size.shaftWidth || marker.scale.x,\n            y: settings.size.headWidth || marker.scale.y,\n            z: settings.size.headLength || marker.scale.z,\n          },\n        };\n      }\n\n      const pos = pointToVec3(marker.pose.position);\n      const orientation = orientationToVec4(marker.pose.orientation);\n      const dir = vec3.transformQuat([0, 0, 0], [1, 0, 0], orientation);\n      // the total length of the arrow is 4.7, we move the tail backwards by 0.88 (prev implementation)\n      const tipPoint = vec3.scaleAndAdd([0, 0, 0], pos, dir, 3.82);\n      const tailPoint = vec3.scaleAndAdd([0, 0, 0], pos, dir, -0.88);\n      markers.push({ ...marker, points: [vec3ToPoint(tailPoint), vec3ToPoint(tipPoint)] });\n    }\n  });\n\n  return models.concat(<Arrows key=\"arrows\">{markers}</Arrows>);\n});\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport { vec3 } from \"gl-matrix\";\nimport React from \"react\";\nimport { GLTFScene, parseGLB, type Pose, type Scale } from \"regl-worldview\";\n\nimport carModelURL from \"webviz-core/src/panels/ThreeDimensionalViz/commands/CarModel/carModel.glb\";\nimport { type InteractionData } from \"webviz-core/src/panels/ThreeDimensionalViz/Interactions/types\";\n\nasync function loadCarModel() {\n  const response = await fetch(carModelURL);\n  if (!response.ok) {\n    throw new Error(`unable to load car model: ${response.status}`);\n  }\n  const model = await parseGLB(await response.arrayBuffer());\n  const nodes = [...model.json.nodes];\n\n  // overwrite the translation component of the root node so the car's center is its rear axle\n  const translation = [0, 0, 0];\n  vec3.lerp(translation, model.json.accessors[1].min, model.json.accessors[1].max, 0.5);\n  vec3.scale(translation, translation, -nodes[0].scale[0]);\n  translation[1] += 56.075834;\n  translation[2] += 136.19549;\n  nodes[0] = { ...nodes[0], translation };\n\n  return {\n    ...model,\n    json: {\n      ...model.json,\n      nodes,\n\n      // change sampler minFilter to avoid blurry textures\n      samplers: model.json.samplers.map((sampler) => ({\n        ...sampler,\n        minFilter: WebGLRenderingContext.LINEAR,\n      })),\n    },\n  };\n}\n\ntype Props = {|\n  children: {|\n    pose: Pose,\n    scale?: Scale,\n    alpha?: number,\n    interactionData?: InteractionData,\n  |},\n|};\n\n// default scale is 0.01 because the model's units are centimeters\nexport default function CarModel({\n  children: { pose, alpha = 1, scale = { x: 0.01, y: 0.01, z: 0.01 }, interactionData },\n}: Props) {\n  return <GLTFScene model={loadCarModel}>{{ pose, alpha, scale, interactionData }}</GLTFScene>;\n}\n","module.exports = __webpack_public_path__ + \"6a934943c1d8e69a6799d947c1987ac2.glb\";","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { range } from \"lodash\";\nimport * as React from \"react\";\nimport {\n  Command,\n  withPose,\n  type Regl,\n  type CommonCommandProps,\n  nonInstancedGetChildrenForHitmap,\n} from \"regl-worldview\";\n\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport type { LaserScan } from \"webviz-core/src/types/Messages\";\n\nconst laserScan = (regl: Regl) =>\n  withPose({\n    primitive: \"points\",\n    vert: getGlobalHooks().perPanelHooks().ThreeDimensionalViz.LaserScanVert,\n    frag: `\n  precision mediump float;\n  varying vec4 vColor;\n  uniform bool isCircle;\n  void main () {\n    if (isCircle && length(gl_PointCoord * 2.0 - 1.0) > 1.0) {\n      discard;\n    }\n\n    gl_FragColor = vColor;\n  }\n  `,\n\n    uniforms: {\n      pointSize: (context, props) => (props.settings && props.settings.pointSize) || 4,\n      isCircle: (context, props) => (props.settings && props.settings.pointShape === \"circle\") || false,\n      // Color is not included in the LaserScan message - it's only included if the color is added by\n      // getChildrenForHitmap.\n      isHitmap: (context, props) => !!props.color,\n\n      angle_min: regl.prop(\"angle_min\"),\n      angle_increment: regl.prop(\"angle_increment\"),\n      range_min: regl.prop(\"range_min\"),\n      range_max: regl.prop(\"range_max\"),\n    },\n\n    attributes: {\n      index: (context, props) => range(props.ranges.length),\n      range: regl.prop(\"ranges\"),\n      intensity: (context, props) =>\n        props.intensities.length === props.ranges.length\n          ? props.intensities\n          : new Float32Array(props.ranges.length).fill(1),\n      hitmapColor: (context, props) => new Array(props.ranges.length).fill(props.color || [0, 0, 0, 1]),\n    },\n\n    count: regl.prop(\"ranges.length\"),\n  });\n\ntype Props = { ...CommonCommandProps, children: LaserScan[] };\n\nexport default function LaserScans(props: Props) {\n  return <Command getChildrenForHitmap={nonInstancedGetChildrenForHitmap} {...props} reglCommand={laserScan} />;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport { Command, withPose, pointToVec3, defaultBlend, type CommonCommandProps } from \"regl-worldview\";\n\nimport { getGlobalHooks } from \"webviz-core/src/loadWebviz\";\nimport { TextureCache } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/utils\";\nimport type { OccupancyGridMessage } from \"webviz-core/src/types/Messages\";\n\nconst occupancyGrids = (regl: any) => {\n  // make a buffer holding the verticies of a 1x1 plane\n  // it will be resized in the shader\n  const positionBuffer = regl.buffer([0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0]);\n\n  const cache = new TextureCache(regl);\n  const paletteTextures = {};\n\n  return withPose({\n    primitive: \"triangle strip\",\n\n    vert: `\n    precision lowp float;\n\n    uniform mat4 projection, view;\n    uniform vec3 offset;\n    uniform vec4 orientation;\n    uniform float width, height, resolution, alpha;\n\n    attribute vec3 point;\n\n    #WITH_POSE\n\n    varying vec2 uv;\n    varying float vAlpha;\n\n    void main () {\n      // set the texture uv to the unscaled vertext point\n      uv = vec2(point.x, point.y);\n\n      // compute the plane vertex dimensions\n      float planeWidth = width * resolution;\n      float planeHeight = height * resolution;\n\n      // rotate the point by the ogrid orientation & scale the point by the plane vertex dimensions\n      vec3 position = rotate(point, orientation) * vec3(planeWidth, planeHeight, 1.);\n\n      // move the vertex by the marker offset\n      vec3 loc = applyPose(position + offset);\n      vAlpha = alpha;\n      gl_Position = projection * view * vec4(loc, 1);\n    }\n    `,\n    frag: `\n    precision lowp float;\n\n    varying vec2 uv;\n    varying float vAlpha;\n\n    uniform sampler2D palette;\n    uniform sampler2D data;\n\n    void main () {\n      // look up the point in our data texture corresponding to\n      // the current point being shaded\n      vec4 point = texture2D(data, uv);\n\n      // vec2(point.a, 0.5) is similar to textelFetch for webGL 1.0\n      // it looks up a point along our 1 dimentional palette\n      // http://www.lighthouse3d.com/tutorials/glsl-tutorial/texture-coordinates/\n      gl_FragColor = texture2D(palette, vec2(point.a, 0.5));\n      gl_FragColor.a *= vAlpha;\n    }\n    `,\n    blend: defaultBlend,\n\n    depth: { enable: true, mask: false },\n\n    attributes: {\n      point: positionBuffer,\n    },\n\n    uniforms: {\n      width: regl.prop(\"info.width\"),\n      height: regl.prop(\"info.height\"),\n      resolution: regl.prop(\"info.resolution\"),\n      // make alpha a uniform so in the future it can be controlled by topic settings\n      alpha: (context: any, props: OccupancyGridMessage) => {\n        return props.alpha || 0.5;\n      },\n      offset: (context: any, props: OccupancyGridMessage) => {\n        return pointToVec3(props.info.origin.position);\n      },\n      orientation: (context: any, props: OccupancyGridMessage) => {\n        const { x, y, z, w } = props.info.origin.orientation;\n        return [x, y, z, w];\n      },\n      palette: (context: any, props: OccupancyGridMessage) => {\n        const palette = getGlobalHooks()\n          .perPanelHooks()\n          .ThreeDimensionalViz.getMapPalette(props.map);\n        // track which palettes we've uploaded as textures\n        if (paletteTextures[palette]) {\n          return paletteTextures[palette];\n        }\n        // if we haven't already uploaded this palette, upload it to the GPU\n        paletteTextures[palette] = regl.texture({\n          format: \"rgba\",\n          type: \"uint8\",\n          mipmap: false,\n          data: palette,\n          width: 256,\n          height: 1,\n        });\n        return paletteTextures[palette];\n      },\n      data: (context: any, props: any) => {\n        return cache.get(props);\n      },\n    },\n\n    count: 4,\n  });\n};\n\ntype Props = { ...CommonCommandProps, children: OccupancyGridMessage[] };\n\nexport default function OccupancyGrids(props: Props) {\n  // We can click through OccupancyGrids.\n  return <Command getChildrenForHitmap={null} {...props} reglCommand={occupancyGrids} />;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport * as React from \"react\";\nimport {\n  Command,\n  withPose,\n  type Regl,\n  type CommonCommandProps,\n  type AssignNextColorsFn,\n  type MouseEventObject,\n} from \"regl-worldview\";\n\nimport filterMap from \"webviz-core/src/filterMap\";\nimport { memoizedMapMarker } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/PointCloudBuilder\";\nimport { type PointCloud } from \"webviz-core/src/types/Messages\";\n\nconst pointCloud = (regl: Regl) => {\n  const pointCloudCommand = withPose({\n    primitive: \"points\",\n    vert: `\n      precision mediump float;\n\n      // this comes from the camera\n      uniform mat4 projection, view;\n\n      #WITH_POSE\n\n      attribute vec3 position;\n      attribute vec3 color;\n      uniform float pointSize;\n      varying vec3 fragColor;\n      void main () {\n        gl_PointSize = pointSize;\n        vec3 p = applyPose(position);\n        gl_Position = projection * view * vec4(p, 1);\n        fragColor = color;\n      }\n  `,\n    frag: `\n      precision mediump float;\n      varying vec3 fragColor;\n      uniform bool isCircle;\n      void main () {\n        if (isCircle) {\n          vec3 normal;\n          normal.xy = gl_PointCoord * 2.0 - 1.0;\n          float r2 = dot(normal.xy, normal.xy);\n          if (r2 > 1.0) {\n            discard;\n          }\n        }\n        gl_FragColor = vec4(fragColor.x / 255.0, fragColor.y / 255.0, fragColor.z / 255.0, 1);\n      }\n  `,\n    attributes: {\n      position: regl.prop(\"points\"),\n      color: regl.prop(\"colors\"),\n    },\n\n    uniforms: {\n      pointSize: (context, props) => {\n        return props.settings?.pointSize || 2;\n      },\n      isCircle: (context, props) => {\n        return props.settings?.pointShape ? props.settings?.pointShape === \"circle\" : true;\n      },\n    },\n\n    count: (context, props) => {\n      return props.points.length / 3;\n    },\n  });\n\n  const command = regl(pointCloudCommand);\n\n  return (props: any) => {\n    command(props);\n  };\n};\n\nfunction instancedGetChildrenForHitmap<\n  T: {\n    points: Float32Array,\n    colors: Uint8Array | number[],\n    settings: {\n      pointSize?: number,\n    },\n  }\n>(props: T[], assignNextColors: AssignNextColorsFn, excludedObjects: MouseEventObject[]): T[] {\n  return filterMap(props, (prop) => {\n    // exclude all points if one has been interacted with because iterating through all points in\n    // in pointcloud object is expensive\n    const isInExcludedObjects = excludedObjects.find(({ object }) => object === prop);\n    if (isInExcludedObjects) {\n      return null;\n    }\n    const hitmapProp = { ...prop };\n    const instanceCount = Math.ceil(prop.points.length / 3);\n    if (instanceCount < 1) {\n      return null;\n    }\n    const idColors = assignNextColors(prop, instanceCount);\n    const allColors = [];\n    idColors.forEach((color) => {\n      allColors.push(color[0] * 255);\n      allColors.push(color[1] * 255);\n      allColors.push(color[2] * 255);\n    });\n    hitmapProp.colors = allColors;\n    // expand the interaction area\n    hitmapProp.settings = hitmapProp.settings ? { ...hitmapProp.settings } : {};\n    hitmapProp.settings.pointSize = (hitmapProp.settings.pointSize || 2) * 5;\n    return hitmapProp;\n  });\n}\n\ntype Props = { ...CommonCommandProps, children: PointCloud[] };\n\nexport default function PointClouds({ children, ...rest }: Props) {\n  const decodedMarkers = children.map(memoizedMapMarker);\n  return (\n    <Command getChildrenForHitmap={instancedGetChildrenForHitmap} {...rest} reglCommand={pointCloud}>\n      {decodedMarkers}\n    </Command>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport React, { useRef } from \"react\";\nimport {\n  Command,\n  withPose,\n  type Regl,\n  type CommonCommandProps,\n  type AssignNextColorsFn,\n  type MouseEventObject,\n} from \"regl-worldview\";\n\nimport { FLOAT_SIZE } from \"./buffers\";\nimport { updateMarkerCache } from \"./memoization\";\nimport type { MemoizedMarker, MemoizedVertexBuffer, VertexBuffer } from \"./types\";\nimport VertexBufferCache from \"./VertexBufferCache\";\nimport filterMap from \"webviz-core/src/filterMap\";\nimport { DEFAULT_FLAT_COLOR } from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/PointCloudSettingsEditor\";\nimport type { PointCloud } from \"webviz-core/src/types/Messages\";\n\nconst COLOR_MODE_FLAT = 0;\nconst COLOR_MODE_RGB = 1;\nconst COLOR_MODE_BGR = -1;\nconst COLOR_MODE_GRADIENT = 2;\nconst COLOR_MODE_RAINBOW = 3;\n\nfunction parseHexColor(color: string) {\n  const parsedFlatColor = parseInt(color.slice(1), 16);\n  return [(parsedFlatColor >> 16) & 0xff, (parsedFlatColor >> 8) & 0xff, parsedFlatColor & 0xff, 1];\n}\n\n// Implements a custom caching mechanism for vertex buffers.\n// Any memoized vertex buffer needs to be re-created whenever the Regl context\n// changes. That happens mostly when resizing the canvas or adding/removing new\n// panels on Webviz. Whenever Regl context changes, pointCloud() is called again\n// and creates new instances for both position and color caches, leading to regenerating\n// all buffers again.\n// Memoized buffers are automatically deleted by WebGL whenever its context\n// changes. There's no need to manually delete them.\nconst pointCloud = (regl: Regl) => {\n  // The same vertex buffer can be used for both positions and colors (see comments in color attribute below).\n  // For that reason, we need to keep two independent caches.\n  const positionBufferCache = new VertexBufferCache();\n  const colorBufferCache = new VertexBufferCache();\n\n  const getCachedBuffer = (cache: VertexBufferCache, vertexBuffer: VertexBuffer): MemoizedVertexBuffer => {\n    const { buffer, offset, stride } = vertexBuffer;\n    let memoized = cache.get(vertexBuffer);\n    if (\n      !memoized ||\n      memoized.vertexBuffer.buffer !== buffer ||\n      memoized.offset !== FLOAT_SIZE * offset ||\n      memoized.stride !== FLOAT_SIZE * stride\n    ) {\n      // If this is a new vertex buffer or if its content has changed somehow\n      // (rendering to hitmap or different settings), create a new memoized\n      // GPU buffer with the correct offset and stride and add it to the cache.\n      memoized = {\n        vertexBuffer,\n        buffer: regl.buffer(buffer),\n        offset: FLOAT_SIZE * offset,\n        stride: FLOAT_SIZE * stride,\n        divisor: 0,\n      };\n      cache.set(vertexBuffer, memoized);\n    }\n    return memoized;\n  };\n\n  const pointCloudCommand = withPose({\n    primitive: \"points\",\n    vert: `\n      precision mediump float;\n\n      // this comes from the camera\n      uniform mat4 projection, view;\n\n      #WITH_POSE\n\n      attribute vec3 position;\n      attribute vec3 color; // color values in range [0-255]\n\n      uniform float pointSize;\n      uniform int colorMode;\n      uniform vec4 flatColor;\n      uniform vec4 minGradientColor;\n      uniform vec4 maxGradientColor;\n      uniform float minColorFieldValue;\n      uniform float maxColorFieldValue;\n\n      varying vec3 fragColor;\n\n      float getFieldValue() {\n        return color.x;\n      }\n\n      float getFieldValue_UNORM() {\n        float value = getFieldValue();\n        float colorFieldRange = maxColorFieldValue - minColorFieldValue;\n        if (abs(colorFieldRange) < 0.00001) {\n          return 0.0;\n        }\n        return max(0.0, min((value - minColorFieldValue) / colorFieldRange, 1.0));\n      }\n\n      vec3 gradientColor() {\n        float pct = getFieldValue_UNORM();\n        return mix(minGradientColor, maxGradientColor, pct).rgb;\n      }\n\n      // taken from http://docs.ros.org/jade/api/rviz/html/c++/point__cloud__transformers_8cpp_source.html\n      // line 47\n      vec3 rainbowColor() {\n        float pct = getFieldValue_UNORM();\n        float h = (1.0 - pct) * 5.0 + 1.0;\n        float i = floor(h);\n        float f = fract(h);\n        // if i is even\n        if (mod(i, 2.0) < 1.0) {\n          f = 1.0 - f;\n        }\n        float n = 1.0 - f;\n        vec3 ret = vec3(0);\n        if (i <= 1.0) {\n          ret = vec3(n, 0.0, 1.0);\n        } else if (i == 2.0) {\n          ret = vec3(0.0, n, 1.0);\n        } else if (i == 3.0) {\n          ret = vec3(0.0, 1.0, n);\n        } else if (i == 4.0) {\n          ret = vec3(n, 1.0, 0.0);\n        } else {\n          ret = vec3(1.0, n, 0.0);\n        }\n        return 255.0 * ret;\n      }\n\n      void main () {\n        gl_PointSize = pointSize;\n        vec3 p = applyPose(position);\n        gl_Position = projection * view * vec4(p, 1);\n\n        if (colorMode == ${COLOR_MODE_GRADIENT}) {\n          fragColor = gradientColor();\n        } else if (colorMode == ${COLOR_MODE_RAINBOW}) {\n          fragColor = rainbowColor();\n        } else if (colorMode == ${COLOR_MODE_BGR}) {\n          fragColor = vec3(color.b, color.g, color.r);\n        } else if (colorMode == ${COLOR_MODE_RGB}) {\n          fragColor = color;\n        } else {\n          fragColor = flatColor.rgb;\n        }\n      }\n    `,\n    frag: `\n      precision mediump float;\n      varying vec3 fragColor;\n      uniform bool isCircle;\n      void main () {\n        if (isCircle) {\n          // gl_PointCoord give us the coordinate of this pixel relative to the current point's position\n          // In order to render a circle, we normalize and compute the distance from the current point.\n          // Discard any fragments that are too far away from the center\n          vec3 normal;\n          normal.xy = gl_PointCoord * 2.0 - 1.0;\n          float r2 = dot(normal.xy, normal.xy);\n          if (r2 > 1.0) {\n            discard;\n          }\n        }\n        gl_FragColor = vec4(fragColor / 255.0, 1.0);\n      }\n    `,\n    attributes: {\n      position: (context, props) => {\n        return getCachedBuffer(positionBufferCache, props.positionBuffer);\n      },\n      color: (context, props) => {\n        const { hitmapColors, settings } = props;\n        const { colorMode } = settings;\n        if (hitmapColors) {\n          // If colors are provided, we use those instead what is indicated by colorMode\n          // This is a common scenario when rendering to the hitmap, for example.\n          // Unfortunately, we cannot memoize hitmap colors since new objects can be added\n          // to the scene hierarchy at any time.\n          return hitmapColors;\n        }\n\n        // If we're using \"flat\" color mode, we pass the actual color in a uniform (see uniforms below)\n        // But we still need to provide some color buffer, even if it's not going to be used.\n        // Instead of creating a dummy buffer, we just send the one we have for position.\n        // TODO (Hernan): I tried using the constant option provided by Regl, but it leads to\n        // visual artifacts. I need to check if this is a bug in Regl.\n        const colorBuffer = !colorMode || colorMode.mode === \"flat\" ? props.positionBuffer : props.colorBuffer;\n        return getCachedBuffer(colorBufferCache, colorBuffer);\n      },\n    },\n\n    uniforms: {\n      pointSize: (context, props) => {\n        return props.settings?.pointSize || 2;\n      },\n      isCircle: (context, props) => {\n        return props.settings?.pointShape ? props.settings?.pointShape === \"circle\" : true;\n      },\n      colorMode: (context, props) => {\n        const { settings, is_bigendian, hitmapColors } = props;\n        if (hitmapColors) {\n          // We're providing a colors array in RGB format\n          return COLOR_MODE_RGB;\n        }\n        const { colorMode } = settings;\n        if (colorMode.mode === \"flat\") {\n          return COLOR_MODE_FLAT;\n        } else if (colorMode.mode === \"gradient\") {\n          return COLOR_MODE_GRADIENT;\n        } else if (colorMode.mode === \"rainbow\") {\n          return COLOR_MODE_RAINBOW;\n        }\n        return is_bigendian ? COLOR_MODE_RGB : COLOR_MODE_BGR;\n      },\n      flatColor: (context, props) => {\n        const { colorMode } = props.settings;\n        return parseHexColor(colorMode.flatColor || DEFAULT_FLAT_COLOR);\n      },\n      minGradientColor: (context, props) => {\n        const { colorMode } = props.settings;\n        return parseHexColor(colorMode.minColor || DEFAULT_FLAT_COLOR);\n      },\n      maxGradientColor: (context, props) => {\n        const { colorMode } = props.settings;\n        return parseHexColor(colorMode.maxColor || DEFAULT_FLAT_COLOR);\n      },\n      minColorFieldValue: (context, props) => {\n        return props.minColorValue;\n      },\n      maxColorFieldValue: (context, props) => {\n        return props.maxColorValue;\n      },\n    },\n\n    count: (context, props) => {\n      return props.pointCount;\n    },\n  });\n\n  const command = regl(pointCloudCommand);\n\n  return (props: any) => {\n    // Call 'onPreRender' for both caches before rendering a frame.\n    positionBufferCache.onPreRender();\n    colorBufferCache.onPreRender();\n\n    // Execute command\n    command(props);\n\n    // Call 'onPostRender' for both caches after rendering a frame\n    // This will delete any unused GPU buffer and prevent memory leaks.\n    positionBufferCache.onPostRender();\n    colorBufferCache.onPostRender();\n  };\n};\n\nfunction instancedGetChildrenForHitmap<\n  T: {\n    hitmapColors?: Uint8Array | number[],\n    width?: number,\n    height?: number,\n    settings?: {\n      pointSize?: number,\n    },\n  }\n>(props: T[], assignNextColors: AssignNextColorsFn, excludedObjects: MouseEventObject[]): T[] {\n  return filterMap(props, (prop) => {\n    // exclude all points if one has been interacted with because iterating through all points\n    // in pointcloud object is expensive\n    const isInExcludedObjects = excludedObjects.find(({ object }) => object === prop);\n    if (isInExcludedObjects) {\n      return null;\n    }\n    const hitmapProp = { ...prop };\n    const { width, height } = prop;\n    if (!width || !height) {\n      return null;\n    }\n    const instanceCount = Math.ceil(width * height);\n    if (instanceCount < 1) {\n      return null;\n    }\n    const idColors = assignNextColors(prop, instanceCount);\n    const allColors = [];\n    idColors.forEach((color) => {\n      allColors.push(color[0] * 255);\n      allColors.push(color[1] * 255);\n      allColors.push(color[2] * 255);\n    });\n    hitmapProp.hitmapColors = allColors;\n    // expand the interaction area\n    hitmapProp.settings = hitmapProp.settings ? { ...hitmapProp.settings } : {};\n    hitmapProp.settings.pointSize = (hitmapProp.settings.pointSize || 2) * 5;\n    return hitmapProp;\n  });\n}\n\ntype Props = { ...CommonCommandProps, children: PointCloud[] };\n\nexport default function PointClouds({ children, ...rest }: Props) {\n  const markerCache = useRef(new Map<Uint8Array, MemoizedMarker>());\n  markerCache.current = updateMarkerCache(markerCache.current, children);\n  const decodedMarkers = [...markerCache.current.values()].map((decoded) => decoded.marker);\n  return (\n    <Command getChildrenForHitmap={instancedGetChildrenForHitmap} {...rest} reglCommand={pointCloud}>\n      {decodedMarkers}\n    </Command>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { isEqual } from \"lodash\";\n\nimport { decodeMarker } from \"./decodeMarker\";\nimport type { MemoizedMarker, PointCloudMarker } from \"./types\";\n\n// Implement manual memoization for markers.\n// When rendering point clouds, we always receive the markers that need to be drawn so there's no\n// need to keep track of instances that are not rendered anymore.\nexport function updateMarkerCache(\n  existing: Map<Uint8Array, MemoizedMarker>,\n  markers: PointCloudMarker[]\n): Map<Uint8Array, MemoizedMarker> {\n  const markerCache = new Map<Uint8Array, MemoizedMarker>();\n  markers.forEach((marker) => {\n    let decoded = existing.get(marker.data);\n    // Check if a decoded marker already exists in cache. If not, decode it and save it for later use\n    // Compare 'settings' by deep-equality since they may be change by user. Also, the instance is different when re-rendering Layout\n    // Compare 'hitmapColors' by reference because the same marker msg may contain different values\n    if (!decoded || !isEqual(marker.settings, decoded.settings) || marker.hitmapColors !== decoded.hitmapColors) {\n      decoded = {\n        marker: decodeMarker(marker),\n        settings: marker.settings,\n        hitmapColors: marker.hitmapColors,\n      };\n    }\n    markerCache.set(marker.data, decoded);\n  });\n  return markerCache;\n}\n\n// Get a memoized marker, if one exists in cache\n// This function is used for testing purposes\nexport function memoizedMarker(cache: Map<Uint8Array, MemoizedMarker>, marker: PointCloudMarker): ?PointCloudMarker {\n  return cache.get(marker.data)?.marker;\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport { createPositionBuffer, createColorBuffer, getVertexCount, getVertexValue } from \"./buffers\";\nimport type { PointCloudMarker } from \"./types\";\nimport { getFieldOffsetsAndReaders } from \"webviz-core/src/panels/ThreeDimensionalViz/commands/Pointclouds/PointCloudBuilder\";\nimport {\n  DEFAULT_FLAT_COLOR,\n  type ColorMode,\n} from \"webviz-core/src/panels/ThreeDimensionalViz/TopicSettingsEditor/PointCloudSettingsEditor\";\n\n// Decode a marker and generate position and color buffers for rendering\n// The resulting marker should be memoized for better performance\nexport function decodeMarker(marker: PointCloudMarker) {\n  const { fields = [], settings = {}, point_step: stride, width, height, hitmapColors, data } = marker;\n  const offsetsAndReaders = getFieldOffsetsAndReaders(fields);\n  const { rgb: { offset: rgbOffset } = {} } = offsetsAndReaders;\n\n  // Calculate the number of points in the cloud.\n  // Do not use data.length, since it doesn't work with sparse point clouds.\n  const pointCount = width * height;\n\n  const colorMode: ColorMode = settings.colorMode\n    ? settings.colorMode\n    : rgbOffset != null\n    ? { mode: \"rgb\" }\n    : { mode: \"flat\", flatColor: DEFAULT_FLAT_COLOR };\n\n  const isHitmap = !!hitmapColors;\n\n  const positionBuffer = createPositionBuffer({\n    data,\n    fields: offsetsAndReaders,\n    pointCount,\n    stride,\n  });\n\n  // If hitmapColors are provided, we don't need a colorBuffer\n  // This check will also avoid computing min/max values on CPU\n  // since they're not needed for hitmap.\n  const colorBuffer = isHitmap\n    ? null\n    : createColorBuffer({\n        data,\n        fields: offsetsAndReaders,\n        colorMode,\n        pointCount,\n        stride,\n      });\n\n  let minColorValue: number = Number.POSITIVE_INFINITY;\n  let maxColorValue: number = Number.NEGATIVE_INFINITY;\n\n  // For some color modes, we need to compute min/max values for the selected color field\n  // Unfortunately, we cannot do this in GPU and we need to traverse the color array to\n  // fetch the required values.\n  // These calculations can be ignored if we're rendering to the hitmap\n  if (colorBuffer && !isHitmap && (colorMode.mode === \"gradient\" || colorMode.mode === \"rainbow\")) {\n    let hasMinValue = false;\n    if (colorMode.minValue) {\n      hasMinValue = true;\n      minColorValue = colorMode.minValue;\n    }\n    let hasMaxValue = false;\n    if (colorMode.maxValue) {\n      hasMaxValue = true;\n      maxColorValue = colorMode.maxValue;\n    }\n    // It's possible for colorMode to provide min/max values (which may be different than\n    // the actual min/max values in the color buffer).\n    if (!hasMinValue || !hasMaxValue) {\n      for (let i = 0; i < getVertexCount(colorBuffer); i++) {\n        const pos = getVertexValue(positionBuffer, i);\n        if (Number.isNaN(pos)) {\n          // if the position is NaN then don't count this point\n          // this is to support non-dense point clouds\n          // https://answers.ros.org/question/234455/pointcloud2-and-pointfield/\n          continue;\n        }\n        const value = getVertexValue(colorBuffer, i);\n        if (!Number.isNaN(value)) {\n          if (!hasMinValue && value < minColorValue) {\n            minColorValue = value;\n          }\n          if (!hasMaxValue && value > maxColorValue) {\n            maxColorValue = value;\n          }\n        }\n      }\n    }\n  }\n\n  return {\n    ...marker,\n    // Make sure settings are always available\n    settings: {\n      ...settings,\n      colorMode,\n    },\n    pointCount,\n    positionBuffer,\n    colorBuffer,\n    minColorValue,\n    maxColorValue,\n    hitmapColors,\n  };\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport type { MemoizedVertexBuffer, VertexBuffer } from \"./types\";\n\n// Implements a double buffer caching for vertex buffers.\n// We keep track of both the current and the previous frames to tell\n// which vertex buffer are not used anymore and need to be deleted.\nexport default class VertexBufferCache {\n  _current = new Map<Float32Array, MemoizedVertexBuffer>();\n  _previous = new Map<Float32Array, MemoizedVertexBuffer>();\n\n  // Call this method before rendering to initialize\n  // the cache for the current frame.\n  onPreRender() {\n    this._previous = this._current;\n    this._current = new Map<Float32Array, MemoizedVertexBuffer>();\n  }\n\n  // Get a vertex buffer from the cache.\n  get(key: VertexBuffer): ?MemoizedVertexBuffer {\n    const { buffer } = key;\n    let existing = this._current.get(buffer);\n    if (existing) {\n      // The vertex buffer exists in the current frame\n      return existing;\n    }\n    existing = this._previous.get(buffer);\n    if (existing) {\n      // The vertex buffer was not used in the current frame yet\n      // but there is valid cached instance in the previous frame.\n      // Move the cached value to the current frame to prevent it\n      // from being deleted when executing onPostRender().\n      this.set(key, existing);\n      this._previous.delete(buffer);\n      return existing;\n    }\n    // The vertex buffer has not being cached neither in the current\n    // nor in the previous frame.\n    return null;\n  }\n\n  // Set a cached value for a vertex buffer\n  set(key: VertexBuffer, value: MemoizedVertexBuffer) {\n    const existing = this._current.get(key.buffer);\n    if (existing) {\n      if (existing === value) {\n        // Nothing to do\n        return;\n      }\n      // A vertex buffer should not change in the same frame,\n      // but if it does, we need override the existing cached value\n      // and delete it's buffer.\n      this._deleteBuffer(existing);\n    }\n    this._current.set(key.buffer, value);\n  }\n\n  // Call this function after rendering a frame to delete unused buffers\n  onPostRender() {\n    this._previous.forEach(this._deleteBuffer);\n    this._previous.clear();\n  }\n\n  _deleteBuffer(cached: MemoizedVertexBuffer) {\n    const { buffer } = cached;\n    if (buffer) {\n      // Destroy GPU buffer\n      buffer.destroy();\n    } else {\n      console.warn(\"Cannot destroy buffer\", cached);\n    }\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2019-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport flatMap from \"lodash/flatMap\";\nimport uniqBy from \"lodash/uniqBy\";\nimport qh from \"quickhull3d\";\nimport * as React from \"react\";\nimport {\n  Triangles,\n  Lines,\n  type Line,\n  type TriangleList,\n  type CommonCommandProps,\n  getChildrenForHitmapWithOriginalMarker,\n  nonInstancedGetChildrenForHitmap,\n  shouldConvert,\n  pointToVec3,\n  vec4ToRGBA,\n} from \"regl-worldview\";\n\ntype Props = {\n  children: Line[],\n  ...CommonCommandProps,\n};\n\nfunction getTriangleChildrenForHitmap(props: Line[], assignNextColors, excludedObjects): TriangleList[] {\n  // This getChildrenForHitmap function takes lines and returns triangles.\n  const triangles = props\n    .map((line) => {\n      // Make sure all points are in vec3 format and unique.\n      const points = uniqBy(\n        line.points.map((point) => (shouldConvert(point) ? pointToVec3(point) : point)),\n        ([x, y, z]) => `${x}:${y}:${z}`\n      );\n      // We need a minimum of 4 points to do the convex hull algorithm.\n      if (points.length < 4) {\n        return null;\n      }\n      // Try to run hulling on the face indices. If there is an error, discard the result.\n      let faceIndices;\n      try {\n        faceIndices = qh(points);\n      } catch (error) {\n        console.error(error);\n        return null;\n      }\n\n      // From the point indices of each face, find the points and flatmap to get the points of the triangles.\n      const trianglePoints = flatMap(faceIndices, ([index1, index2, index3]) => {\n        return [points[index1], points[index2], points[index3]];\n      });\n      const convertedColor = typeof line.color.r === \"number\" ? line.color : vec4ToRGBA(line.color);\n      return {\n        pose: line.pose,\n        scale: line.scale,\n        color: convertedColor,\n        points: trianglePoints,\n        originalMarker: line.originalMarker,\n      };\n    })\n    .filter(Boolean);\n\n  return getChildrenForHitmapWithOriginalMarker(triangles, assignNextColors, excludedObjects);\n}\n\nexport default function LinedConvexHulls({ children, ...rest }: Props) {\n  return (\n    <React.Fragment>\n      {/* Render all the lines, even if we can't generate a convex hull from them. */}\n      <Lines getChildrenForHitmap={nonInstancedGetChildrenForHitmap} {...rest}>\n        {children}\n      </Lines>\n      <Triangles getChildrenForHitmap={getTriangleChildrenForHitmap} {...rest}>\n        {/*\n         * These Line objects are not renderable by the Triangle shader. But since we're only rendering them inside the\n         * hitmap, we convert them from lines to triangle objects in the `getTriangleChildrenForHitmap` function above.\n         */}\n        {children.map((line) => ({ ...line, originalMarker: line, onlyRenderInHitmap: true }))}\n      </Triangles>\n    </React.Fragment>\n  );\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nimport hoistNonReactStatics from \"hoist-non-react-statics\";\nimport PropTypes from \"prop-types\";\nimport * as React from \"react\";\n\nimport { getGlobalHooks } from \"../../loadWebviz\";\nimport Transforms from \"webviz-core/src/panels/ThreeDimensionalViz/Transforms\";\nimport type { Frame } from \"webviz-core/src/players/types\";\nimport { TRANSFORM_STATIC_TOPIC, TRANSFORM_TOPIC } from \"webviz-core/src/util/globalConstants\";\n\ntype State = {| transforms: Transforms |};\n\nfunction withTransforms<Props: *>(ChildComponent: React.ComponentType<Props>) {\n  class Component extends React.PureComponent<$Shape<{| frame: Frame, cleared: boolean, forwardedRef: any |}>, State> {\n    static displayName = `withTransforms(${ChildComponent.displayName || ChildComponent.name || \"\"})`;\n    static contextTypes = { store: PropTypes.any };\n\n    state: State = { transforms: new Transforms() };\n\n    static getDerivedStateFromProps(nextProps: Props, prevState: State): ?$Shape<State> {\n      const { frame, cleared } = nextProps;\n      let { transforms } = prevState;\n      if (cleared) {\n        transforms = new Transforms();\n      }\n\n      getGlobalHooks()\n        .perPanelHooks()\n        .ThreeDimensionalViz.consumePose(frame, transforms);\n\n      const tfs = frame[TRANSFORM_TOPIC];\n      if (tfs) {\n        for (const msg of tfs) {\n          for (const tf of msg.message.transforms) {\n            if (tf.child_frame_id !== getGlobalHooks().perPanelHooks().ThreeDimensionalViz.skipTranformFrame) {\n              transforms.consume(tf);\n            }\n          }\n        }\n      }\n      const tfs_static = frame[TRANSFORM_STATIC_TOPIC];\n      if (tfs_static) {\n        for (const msg of tfs_static) {\n          for (const tf of msg.message.transforms) {\n            transforms.consume(tf);\n          }\n        }\n      }\n\n      return { transforms };\n    }\n\n    render() {\n      // $FlowFixMe - can't seem to figure out how to properly type this.\n      return <ChildComponent {...this.props} ref={this.props.forwardedRef} transforms={this.state.transforms} />;\n    }\n  }\n  return hoistNonReactStatics(\n    React.forwardRef((props, ref) => {\n      return <Component {...props} forwardedRef={ref} />;\n    }),\n    ChildComponent\n  );\n}\n\nexport default withTransforms;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\nexport default `\n  precision mediump float;\n\n  uniform mat4 projection, view;\n\n  #WITH_POSE\n\n  uniform float pointSize;\n  uniform float angle_min;\n  uniform float angle_increment;\n  uniform float range_min;\n  uniform float range_max;\n  uniform bool isHitmap;\n\n  attribute float index;\n  attribute float range;\n  attribute float intensity;\n  attribute vec4 hitmapColor;\n\n  varying vec4 vColor;\n\n  void main () {\n    float angle = angle_min + index * angle_increment;\n    vec3 p = applyPose(vec3(range * cos(angle), range * sin(angle), 0));\n\n    gl_Position = projection * view * vec4(p, 1);\n    gl_PointSize = pointSize;\n\n    if (range < range_min || range > range_max || intensity == 0.0) {\n      gl_PointSize = 0.;\n    } else if (isHitmap) {\n      vColor = hitmapColor;\n    } else {\n      vColor = vec4(0.5, 0.5, 1, 1);\n    }\n  }\n`;\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\nimport ChartJSChart from \"chart.js\";\n\nimport installMulticolorLineChart from \"webviz-core/src/util/multicolorLineChart\";\n\nexport default function installChartjs(Chart: any = ChartJSChart) {\n  const annotationPlugin = require(\"chartjs-plugin-annotation\");\n  const datalabelPlugin = require(\"chartjs-plugin-datalabels\");\n  Chart.plugins.register(annotationPlugin);\n  Chart.plugins.register(datalabelPlugin);\n  installMulticolorLineChart(Chart);\n\n  // Otherwise we'd get labels everywhere.\n  Chart.defaults.global.plugins.datalabels = {};\n  Chart.defaults.global.plugins.datalabels.display = false;\n\n  if (Chart.plugins.count() !== 5) {\n    throw new Error(\n      \"Incorrect number of Chart.js plugins; one probably has not loaded correctly (make sure we don't have duplicate chart.js instances when running `yarn list`.\"\n    );\n  }\n}\n","// @flow\n//\n//  Copyright (c) 2018-present, Cruise LLC\n//\n//  This source code is licensed under the Apache License, Version 2.0,\n//  found in the LICENSE file in the root directory of this source tree.\n//  You may not use this file except in compliance with the License.\n\n/* eslint-disable no-underscore-dangle */\n// From https://github.com/chartjs/Chart.js/issues/4895#issuecomment-341874938\nexport default function installMulticolorLineChart(Chart: any) {\n  Chart.defaults.multicolorLine = Chart.defaults.scatter;\n  Chart.controllers.multicolorLine = Chart.controllers.scatter.extend({\n    draw(ease) {\n      let startIndex = 0;\n      const meta = this.getMeta();\n      const points = meta.data || [];\n      const colors = this.getDataset().colors;\n      const area = this.chart.chartArea;\n      const { multicolorLineYOffset } = this.chart.options.plugins || {};\n      if (multicolorLineYOffset) {\n        meta.dataset._children.forEach((data) => {\n          if (!data._view.originalY) {\n            data._view.originalY = data._view.y;\n          }\n          data._view.y = data._view.originalY + multicolorLineYOffset;\n        });\n      }\n      const originalDatasets = meta.dataset._children.filter((data) => {\n        return !isNaN(data._view.y);\n      });\n\n      function setColor(newColor, { dataset }) {\n        dataset._view.borderColor = newColor;\n      }\n\n      if (!colors) {\n        Chart.controllers.scatter.prototype.draw.call(this, ease);\n        return;\n      }\n\n      for (let i = 2; i <= colors.length; i++) {\n        if (colors[i - 1] !== colors[i]) {\n          setColor(colors[i - 1], meta);\n          meta.dataset._children = originalDatasets.slice(startIndex, i);\n          meta.dataset.draw();\n          startIndex = i - 1;\n        }\n      }\n\n      meta.dataset._children = originalDatasets.slice(startIndex);\n      meta.dataset.draw();\n      meta.dataset._children = originalDatasets;\n\n      points.forEach((point) => {\n        point.draw(area);\n      });\n    },\n  });\n}\n"],"sourceRoot":""}